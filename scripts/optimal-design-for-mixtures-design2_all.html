<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Paweł Wiczling*">
<meta name="dcterms.date" content="2024-12-19">

<title>Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="optimal-design-for-mixtures-design2_all_files/libs/clipboard/clipboard.min.js"></script>
<script src="optimal-design-for-mixtures-design2_all_files/libs/quarto-html/quarto.js"></script>
<script src="optimal-design-for-mixtures-design2_all_files/libs/quarto-html/popper.min.js"></script>
<script src="optimal-design-for-mixtures-design2_all_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="optimal-design-for-mixtures-design2_all_files/libs/quarto-html/anchor.min.js"></script>
<link href="optimal-design-for-mixtures-design2_all_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="optimal-design-for-mixtures-design2_all_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="optimal-design-for-mixtures-design2_all_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="optimal-design-for-mixtures-design2_all_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="optimal-design-for-mixtures-design2_all_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="optimal-design-for-mixtures-design2_all_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="optimal-design-for-mixtures-design2_all_files/libs/tabwid-1.1.3/tabwid.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#priors" id="toc-priors" class="nav-link" data-scroll-target="#priors">Priors</a></li>
  <li><a href="#read-the-results" id="toc-read-the-results" class="nav-link" data-scroll-target="#read-the-results">Read the results</a></li>
  <li><a href="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" id="toc-stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" class="nav-link" data-scroll-target="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables">Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</a>
  <ul class="collapse">
  <li><a href="#compile-stan-models" id="toc-compile-stan-models" class="nav-link" data-scroll-target="#compile-stan-models">Compile stan models</a></li>
  <li><a href="#simulate-retention-times-and-create-datasets" id="toc-simulate-retention-times-and-create-datasets" class="nav-link" data-scroll-target="#simulate-retention-times-and-create-datasets">Simulate retention times and create datasets</a></li>
  <li><a href="#optimization" id="toc-optimization" class="nav-link" data-scroll-target="#optimization">Optimization</a></li>
  <li><a href="#optimization-tg-constrained" id="toc-optimization-tg-constrained" class="nav-link" data-scroll-target="#optimization-tg-constrained">Optimization tg constrained</a>
  <ul class="collapse">
  <li><a href="#read-the-results-and-compare" id="toc-read-the-results-and-compare" class="nav-link" data-scroll-target="#read-the-results-and-compare">Read the results and compare</a></li>
  <li><a href="#table" id="toc-table" class="nav-link" data-scroll-target="#table">Table</a></li>
  <li><a href="#stan-simulations" id="toc-stan-simulations" class="nav-link" data-scroll-target="#stan-simulations">Stan simulations</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#stan-multiple-analytes.-monoprotic-analytes.-fi-tg-and-ph-for-meoh-and-acn-as-design-variables" id="toc-stan-multiple-analytes.-monoprotic-analytes.-fi-tg-and-ph-for-meoh-and-acn-as-design-variables" class="nav-link" data-scroll-target="#stan-multiple-analytes.-monoprotic-analytes.-fi-tg-and-ph-for-meoh-and-acn-as-design-variables">Stan multiple analytes. Monoprotic analytes. fi, tg and pH for MeOH and ACN as design variables</a>
  <ul class="collapse">
  <li><a href="#compile-stan-models-1" id="toc-compile-stan-models-1" class="nav-link" data-scroll-target="#compile-stan-models-1">Compile stan models</a></li>
  <li><a href="#simulate-retention-times-and-create-data-sets" id="toc-simulate-retention-times-and-create-data-sets" class="nav-link" data-scroll-target="#simulate-retention-times-and-create-data-sets">Simulate retention times and create data sets</a></li>
  <li><a href="#optimize" id="toc-optimize" class="nav-link" data-scroll-target="#optimize">Optimize</a></li>
  <li><a href="#optimize-tg-constrain" id="toc-optimize-tg-constrain" class="nav-link" data-scroll-target="#optimize-tg-constrain">Optimize tg constrain</a>
  <ul class="collapse">
  <li><a href="#read-the-results-and-compare-1" id="toc-read-the-results-and-compare-1" class="nav-link" data-scroll-target="#read-the-results-and-compare-1">Read the results and compare</a></li>
  <li><a href="#table-1" id="toc-table-1" class="nav-link" data-scroll-target="#table-1">Table</a></li>
  <li><a href="#stan-simulations-1" id="toc-stan-simulations-1" class="nav-link" data-scroll-target="#stan-simulations-1">Stan simulations</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-as-design-variables" id="toc-stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-as-design-variables" class="nav-link" data-scroll-target="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-as-design-variables">Stan multiple analytes. Single form analytes. fi and tg for MeOH as design variables</a>
  <ul class="collapse">
  <li><a href="#compile-stan-models-2" id="toc-compile-stan-models-2" class="nav-link" data-scroll-target="#compile-stan-models-2">Compile stan models</a></li>
  <li><a href="#simulate-retention-times-and-create-datasets-1" id="toc-simulate-retention-times-and-create-datasets-1" class="nav-link" data-scroll-target="#simulate-retention-times-and-create-datasets-1">Simulate retention times and create datasets</a></li>
  <li><a href="#optimization-1" id="toc-optimization-1" class="nav-link" data-scroll-target="#optimization-1">Optimization</a>
  <ul class="collapse">
  <li><a href="#read-the-results-and-compare-2" id="toc-read-the-results-and-compare-2" class="nav-link" data-scroll-target="#read-the-results-and-compare-2">Read the results and compare</a></li>
  <li><a href="#table-2" id="toc-table-2" class="nav-link" data-scroll-target="#table-2">Table</a></li>
  <li><a href="#stan-simulations-2" id="toc-stan-simulations-2" class="nav-link" data-scroll-target="#stan-simulations-2">Stan simulations</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-acn-as-design-variables" id="toc-stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-acn-as-design-variables" class="nav-link" data-scroll-target="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-acn-as-design-variables">Stan multiple analytes. Single form analytes. fi and tg for ACN as design variables</a>
  <ul class="collapse">
  <li><a href="#compile-stan-models-3" id="toc-compile-stan-models-3" class="nav-link" data-scroll-target="#compile-stan-models-3">Compile stan models</a></li>
  <li><a href="#simulate-retention-times-and-create-datasets-2" id="toc-simulate-retention-times-and-create-datasets-2" class="nav-link" data-scroll-target="#simulate-retention-times-and-create-datasets-2">Simulate retention times and create datasets</a></li>
  <li><a href="#optimization-2" id="toc-optimization-2" class="nav-link" data-scroll-target="#optimization-2">Optimization</a>
  <ul class="collapse">
  <li><a href="#read-the-results-and-compare-3" id="toc-read-the-results-and-compare-3" class="nav-link" data-scroll-target="#read-the-results-and-compare-3">Read the results and compare</a></li>
  <li><a href="#table-3" id="toc-table-3" class="nav-link" data-scroll-target="#table-3">Table</a></li>
  <li><a href="#stan-simulations-3" id="toc-stan-simulations-3" class="nav-link" data-scroll-target="#stan-simulations-3">Stan simulations</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#manuscript-plots" id="toc-manuscript-plots" class="nav-link" data-scroll-target="#manuscript-plots">Manuscript plots</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#licenses" id="toc-licenses" class="nav-link" data-scroll-target="#licenses">Licenses</a></li>
  <li><a href="#original-computing-environment" id="toc-original-computing-environment" class="nav-link" data-scroll-target="#original-computing-environment">Original Computing Environment</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Paweł Wiczling* </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Department of Biopharmaceutics and Pharmacodynamics, Medical University of Gdańsk, Gen.&nbsp;J. Hallera 107, 80-416 Gdańsk, Poland
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 19, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setup" class="level1">
<h1>Setup</h1>
<p>The packages we will use are listed below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(numDeriv)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mrgmisc)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>select <span class="ot">=</span> dplyr<span class="sc">::</span>select</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("metrumresearchgroup/mrgmisc")</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># for parallel calculation use linux (mclaplly), i.e. Ubuntu 24.04 on Windows WSL</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># usethis::edit_r_environ(), add PROCESSX_NOTIFY_OLD_SIGCHLD = 1 ????</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#' Helper functions</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"helper_functions.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' folder shortcuts:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>figures_dir1 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"figures"</span>, <span class="st">"design2_all"</span>,<span class="st">"N"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>tables_dir1  <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"tables"</span>, <span class="st">"design2_all"</span>,<span class="st">"N"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>figures_dir2 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"figures"</span>, <span class="st">"design2_all"</span>,<span class="st">"NI"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>tables_dir2  <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"tables"</span>, <span class="st">"design2_all"</span>,<span class="st">"NI"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>figures_dir3 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"figures"</span>, <span class="st">"design2_all"</span>,<span class="st">"MeOH"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>tables_dir3  <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"tables"</span>, <span class="st">"design2_all"</span>,<span class="st">"MeOH"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>figures_dir4 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"figures"</span>, <span class="st">"design2_all"</span>,<span class="st">"ACN"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>tables_dir4  <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"tables"</span>, <span class="st">"design2_all"</span>,<span class="st">"ACN"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>figures_dir5 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"figures"</span>, <span class="st">"manuscript_optional"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>tables_dir5  <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"tables"</span>, <span class="st">"manuscript_optional"</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(figures_dir1)) <span class="fu">dir.create</span>(figures_dir1, <span class="at">recursive =</span> T)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(tables_dir1)) <span class="fu">dir.create</span>(tables_dir1, <span class="at">recursive =</span> T)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(figures_dir2)) <span class="fu">dir.create</span>(figures_dir2, <span class="at">recursive =</span> T)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(tables_dir2)) <span class="fu">dir.create</span>(tables_dir2, <span class="at">recursive =</span> T)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(figures_dir3)) <span class="fu">dir.create</span>(figures_dir3, <span class="at">recursive =</span> T)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(tables_dir3)) <span class="fu">dir.create</span>(tables_dir3, <span class="at">recursive =</span> T)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(figures_dir4)) <span class="fu">dir.create</span>(figures_dir4, <span class="at">recursive =</span> T)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(tables_dir4)) <span class="fu">dir.create</span>(tables_dir4, <span class="at">recursive =</span> T)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(figures_dir5)) <span class="fu">dir.create</span>(figures_dir5, <span class="at">recursive =</span> T)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(tables_dir5)) <span class="fu">dir.create</span>(tables_dir5, <span class="at">recursive =</span> T)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>thisScript <span class="ot">&lt;-</span> <span class="st">"optimal-design-for-mixtures-design2-all"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>my.ggsave <span class="ot">&lt;-</span> <span class="cf">function</span>(.plot, .filename, <span class="at">.path=</span>figures_dir, <span class="at">.height=</span> <span class="dv">7</span>, <span class="at">.width=</span> <span class="dv">6</span>) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot=</span>.plot, <span class="at">filename=</span>.filename, <span class="at">path=</span>.path, <span class="at">height=</span>.height, <span class="at">width=</span>.width)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>my.ggsave.png <span class="ot">&lt;-</span> <span class="cf">function</span>(.plot, .filename, <span class="at">.path=</span>figures_dir, <span class="at">.height=</span><span class="dv">7</span>, <span class="at">.width=</span> <span class="dv">6</span>) {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot=</span>.plot, <span class="at">filename=</span>.filename, <span class="at">path=</span>.path, <span class="at">height=</span>.height, <span class="at">width=</span>.width)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
</section>
<section id="priors" class="level1">
<h1>Priors</h1>
<p>Priors are based on the follwoing article “Comparison of Chromatographic Stationary Phases Using a Bayesian-Based Multilevel Model” by Paweł Wiczling and Agnieszka Kamedulska published in Analytical Chemistry 2024 96 (3), 1310-1319.</p>
<p>In this work a simplified approach is taken with the focus on the neutral, acidic and basic forms of an analytes and single chromatographic stationary phase - assuming the pKa and changes of pKa with organic modifier are known.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fun_generate_priors defined in helper_functions.R</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>priorsN_MeOH<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N_MeOH"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>priorsN_ACN<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N_ACN"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>priorsN<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>priorsA<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"A"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>priorsB<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"B"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>priorsNB<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"NB"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>priorsNA<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"NA"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here I consider a design space that consist of linear organic modifier gradients ranging from 10 to 90 min and organic modifier content ranging from 0.05 to 0.2 for MeOH and ACN.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>hplcparam_candidates_df <span class="ot">=</span> <span class="fu">expand_grid</span>(<span class="at">tg=</span><span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">90</span>,<span class="at">by=</span><span class="dv">10</span>), </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">td=</span><span class="fl">2.1</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">to=</span><span class="fl">0.532</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">te=</span><span class="fl">0.04</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fio =</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="at">by=</span><span class="fl">0.05</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fif =</span> <span class="fl">0.8</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">m=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">xpH=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="read-the-results" class="level1">
<h1>Read the results</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#to avoid recalculations</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"../data/results-mixtures-design2.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" class="level1">
<h1>Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</h1>
<section id="compile-stan-models" class="level2">
<h2 class="anchored" data-anchor-id="compile-stan-models">Compile stan models</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mod_analytes_gq<span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-gq.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>mod_analytes_sim <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-sim.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>mod_analytes <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>mod_analytes<span class="sc">$</span><span class="fu">compile</span>(<span class="at">compile_model_methods=</span><span class="cn">TRUE</span>,<span class="at">force_recompile=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulate-retention-times-and-create-datasets" class="level2">
<h2 class="anchored" data-anchor-id="simulate-retention-times-and-create-datasets">Simulate retention times and create datasets</h2>
<p>Probability for neutral, acidic and basic is 0.4, 0.3, 0.3 with logP being sampled from 2.2+-2 and constrained between 0.5 and 7.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data_ma<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>nObs <span class="ot">=</span> <span class="fu">nrow</span>(data_ma);</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>nAnalytes <span class="ot">=</span><span class="dv">50</span>;</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> <span class="dv">1234</span>;</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>n_param <span class="ot">=</span> <span class="dv">3</span>;</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>n_rep <span class="ot">=</span> <span class="dv">10</span>;</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_rep) {</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]] <span class="ot">=</span> <span class="fu">list</span>(<span class="at">nObs=</span>nObs,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nAnalytes=</span>nAnalytes,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">steps =</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>data_ma<span class="sc">$</span>m,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">hplcparam=</span><span class="fu">as.matrix</span>(data_ma<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(tg,td,to,te,fio,fif,m))),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">include_prior =</span> <span class="dv">1</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">run_estimation=</span><span class="dv">1</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nSel =</span> nObs,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="dv">1</span><span class="sc">:</span>nObs)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>fit_gq  <span class="ot">=</span> mod_analytes_gq<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> datastruct_prior_ma[[i]],</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> cseed,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">fixed_param =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">iter_sampling=</span><span class="dv">1</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">matrix</span>(fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"y_hat_sim"</span>),nAnalytes,nObs)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>logPobs <span class="ot">=</span> fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"logPobs"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>N1A2B3 <span class="ot">=</span> fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"N1A2B3"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>param <span class="ot">=</span> <span class="fu">matrix</span>(fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"paramsim"</span>),nAnalytes,<span class="dv">3</span>)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma[[i]]<span class="ot">=</span>datastruct_prior_ma[[i]];</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma[[i]]<span class="sc">$</span>include_prior <span class="ot">=</span> <span class="fl">0.01</span>;</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>inits[[i]]<span class="ot">=</span>param</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> cseed<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mean_log_det_stan <span class="ot">=</span> <span class="cf">function</span>(data, init, chosen_indices, S){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>init_ma <span class="ot">=</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">param=</span>init)}</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>selected <span class="ot">=</span> chosen_indices;</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>nSel <span class="ot">=</span> <span class="fu">length</span>(chosen_indices);</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a> fit_opt  <span class="ot">=</span> mod_analytes<span class="sc">$</span><span class="fu">optimize</span>(</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_dir =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"stanfiles"</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_basename =</span> S,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>   <span class="at">seed =</span> cseed,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>   <span class="at">init =</span> init_ma,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">jacobian =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>   <span class="at">show_messages =</span> F)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a> mode<span class="ot">=</span>fit_opt<span class="sc">$</span><span class="fu">unconstrain_variables</span>(<span class="fu">list</span>(<span class="at">param =</span> fit_opt<span class="sc">$</span><span class="fu">mle</span>(<span class="st">"param"</span>)))</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a> hessian <span class="ot">=</span> fit_opt<span class="sc">$</span><span class="fu">hessian</span>(<span class="at">unconstrained_variables =</span> mode)<span class="sc">$</span>hessian</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>logdet <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span>data<span class="sc">$</span>nAnalytes,\(i) <span class="fu">log</span>(<span class="fu">det</span>(<span class="sc">-</span>hessian[((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">3</span>),((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">3</span>)]))))</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(logdet)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">65</span>,<span class="dv">66</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co"># quick test:</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>z_prior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan</span>(datastruct_prior_ma[[i]], inits[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>z_noprior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan</span>(datastruct_noprior_ma[[i]], inits[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(<span class="fu">unlist</span>(z_prior)),<span class="fu">mean</span>(<span class="fu">unlist</span>(z_noprior)))</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.08178 12.96005</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"14.08178 12.96005"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>14.08178 12.96005</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>logP <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]<span class="sc">$</span>logPobs))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>NAB <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]<span class="sc">$</span>N1A2B3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="optimization" class="level2">
<h2 class="anchored" data-anchor-id="optimization">Optimization</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">68</span>) <span class="co"># initial values</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fws_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">71</span>,<span class="dv">65</span>,<span class="dv">68</span>) <span class="co"># initial values</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>fws_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">65</span>,<span class="dv">68</span>) <span class="co"># initial values</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>fws_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">71</span>,<span class="dv">65</span>,<span class="dv">68</span>) <span class="co"># initial values</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>fws_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">71</span>,<span class="dv">65</span>,<span class="dv">68</span>) <span class="co"># initial values</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>fws_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">66</span>,<span class="dv">23</span>,<span class="dv">71</span>,<span class="dv">65</span>,<span class="dv">70</span>) <span class="co"># initial values</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>fws_prior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">66</span>,<span class="dv">23</span>,<span class="dv">71</span>,<span class="dv">65</span>,<span class="dv">72</span>) <span class="co"># initial values</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>fws_noprior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="optimization-tg-constrained" class="level2">
<h2 class="anchored" data-anchor-id="optimization-tg-constrained">Optimization tg constrained</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#p=2 and 3 are the same as for unconstrained</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">65</span>,<span class="dv">66</span>) <span class="co"># initial values</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>fwstgc_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par_tgconstraint</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">tg_constraint =</span> <span class="dv">270</span>,<span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">65</span>,<span class="dv">66</span>) <span class="co"># initial values</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>fwstgc_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par_tgconstraint</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">tg_constraint =</span> <span class="dv">270</span>,<span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">39</span>,<span class="dv">24</span>,<span class="dv">65</span>,<span class="dv">68</span>) <span class="co"># initial values</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>fwstgc_prior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par_tgconstraint</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">tg_constraint =</span> <span class="dv">270</span>,<span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">39</span>,<span class="dv">24</span>,<span class="dv">65</span>,<span class="dv">68</span>) <span class="co"># initial values</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>fwstgc_noprior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par_tgconstraint</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">tg_constraint =</span> <span class="dv">270</span>,<span class="at">n_iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="read-the-results-and-compare" class="level3">
<h3 class="anchored" data-anchor-id="read-the-results-and-compare">Read the results and compare</h3>
<section id="unconstrained" class="level4">
<h4 class="anchored" data-anchor-id="unconstrained">Unconstrained</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">65</span>,<span class="dv">66</span>) <span class="co"># ref</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">65</span>,<span class="dv">66</span>) <span class="co"># ref</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>fws_prior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>fws_noprior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">68</span>) <span class="co"># p=2</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>fws_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">71</span>,<span class="dv">65</span>,<span class="dv">68</span>) <span class="co"># p=3</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">65</span>,<span class="dv">68</span>) <span class="co"># p=3</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>fws_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>fws_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">71</span>,<span class="dv">65</span>,<span class="dv">68</span>) <span class="co"># p=4</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">71</span>,<span class="dv">65</span>,<span class="dv">68</span>) <span class="co"># p=4</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>fws_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>fws_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">66</span>,<span class="dv">23</span>,<span class="dv">71</span>,<span class="dv">65</span>,<span class="dv">70</span>) <span class="co"># p=5</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">66</span>,<span class="dv">23</span>,<span class="dv">71</span>,<span class="dv">65</span>,<span class="dv">72</span>) <span class="co"># p=5</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>fws_prior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>fws_noprior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>summary_results <span class="ot">=</span> <span class="fu">tibble</span>( <span class="at">logP =</span> logP,</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_2 =</span> fws_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(prior_ref<span class="sc">:</span>noprior_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(summary_results, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value))<span class="sc">+</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>value, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"log(|FIM|)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-logDet-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>summary_results_diff <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_2 =</span> fws_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_prior_2 =</span> (fws_prior_2 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_3 =</span> (fws_prior_3 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_3 =</span> (fws_noprior_3 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_4 =</span> (fws_prior_4 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_4 =</span> (fws_noprior_4 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_5 =</span> (fws_prior_5 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_5 =</span> (fws_noprior_5 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_prior_2<span class="sc">:</span>d_noprior_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diff, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Efficiency relative to the reference design"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>summary_results_diffprior <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_ref  =</span> (fws_prior_ref<span class="sc">-</span>fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_3 =</span> (fws_prior_3<span class="sc">-</span>fws_noprior_3)<span class="sc">/</span>n_param,</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_4 =</span> (fws_prior_4<span class="sc">-</span>fws_noprior_4)<span class="sc">/</span>n_param,</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_5 =</span> (fws_prior_5<span class="sc">-</span>fws_noprior_5)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_ref<span class="sc">:</span>d_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diffprior, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Effect of prior on design efficiency"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">100</span>),</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">100</span>)),</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-logDet-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-logDet-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-logDet-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>f2_1 <span class="ot">=</span> p2</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>f3_1 <span class="ot">=</span> p3</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-abs.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-abs.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-rel.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-rel.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-prioreff.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-prioreff.png"</span>), <span class="at">.path =</span> figures_dir1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="table" class="level3">
<h3 class="anchored" data-anchor-id="table">Table</h3>
<section id="unconstrained-1" class="level4">
<h4 class="anchored" data-anchor-id="unconstrained-1">Unconstrained</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>data_ma<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">line=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>combined_results <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="at">prior_ref =</span> fws_prior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="at">prior_2 =</span> fws_prior_2<span class="sc">$</span>chosen_indices,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_2 =</span> <span class="dv">10000</span><span class="sc">+</span>fws_prior_2<span class="sc">$</span>chosen_indices, <span class="co"># dummy</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="at">prior_3 =</span> fws_prior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_3 =</span> fws_noprior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="at">prior_4 =</span> fws_prior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_4 =</span> fws_noprior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="at">prior_5 =</span> fws_prior_5<span class="sc">$</span>chosen_indices,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_5 =</span> fws_noprior_5<span class="sc">$</span>chosen_indices)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>selected_exp <span class="ot">=</span> <span class="fu">enframe</span>(combined_results)<span class="sc">%&gt;%</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">line=</span>value, <span class="at">Name =</span> name) <span class="sc">%&gt;%</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_ma, <span class="at">by =</span> <span class="st">"line"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">arrange</span>(Name,tg, fio)<span class="sc">%&gt;%</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(line,xpH,m,td,to,te,fif)) <span class="sc">%&gt;%</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Name, <span class="st">'noprior'</span>), <span class="st">"No prior"</span>, <span class="st">"Prior"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>tab1<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Prior"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>tab2<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"No prior"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">set_formatter</span>(</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>  tab2, </span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">tg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x) ),</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">fio =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, x) )</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab1, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>)</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab2, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>) </span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>, <span class="at">color=</span><span class="cn">NA</span>),</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>)</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> gg<span class="sc">+</span>p1<span class="sc">+</span>p2<span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-table.pdf"</span>), <span class="at">.path =</span> tables_dir1)</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-table.png"</span>), <span class="at">.path =</span> tables_dir1)</span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>tab1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-41fdf580{}.cl-41f408fe{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-41f810c0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-41f810ca{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-41f83c4e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-41f83c58{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-41f83c62{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-41f83c6c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-41f83c6d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-41f83c6e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-41fdf580"><thead><tr style="overflow-wrap:break-word;"><th class="cl-41f83c4e"><p class="cl-41f810c0"><span class="cl-41f408fe">Name</span></p></th><th class="cl-41f83c58"><p class="cl-41f810ca"><span class="cl-41f408fe">tg</span></p></th><th class="cl-41f83c58"><p class="cl-41f810ca"><span class="cl-41f408fe">fio</span></p></th><th class="cl-41f83c4e"><p class="cl-41f810c0"><span class="cl-41f408fe">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">prior_2</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.05</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.10</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">prior_3</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.05</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.10</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.20</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">prior_4</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">30</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.20</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.05</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.10</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.20</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">prior_5</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">30</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.20</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.05</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.05</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.15</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.20</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">prior_ref</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">30</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.05</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">30</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.05</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6c"><p class="cl-41f810ca"><span class="cl-41f408fe">0.05</span></p></td><td class="cl-41f83c62"><p class="cl-41f810c0"><span class="cl-41f408fe">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-41f83c6d"><p class="cl-41f810c0"><span class="cl-41f408fe"></span></p></td><td class="cl-41f83c6e"><p class="cl-41f810ca"><span class="cl-41f408fe">90</span></p></td><td class="cl-41f83c6e"><p class="cl-41f810ca"><span class="cl-41f408fe">0.05</span></p></td><td class="cl-41f83c6d"><p class="cl-41f810c0"><span class="cl-41f408fe">ACN</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-4210985c{}.cl-42057fbc{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4209711c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-42097126{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-4209987c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-42099886{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-42099887{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-42099890{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4209989a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-420998a4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-4210985c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-4209987c"><p class="cl-4209711c"><span class="cl-42057fbc">Name</span></p></th><th class="cl-42099886"><p class="cl-42097126"><span class="cl-42057fbc">tg</span></p></th><th class="cl-42099886"><p class="cl-42097126"><span class="cl-42057fbc">fio</span></p></th><th class="cl-4209987c"><p class="cl-4209711c"><span class="cl-42057fbc">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">noprior_2</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"></span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"> </span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"> </span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"> </span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"> </span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">noprior_3</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"></span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">30</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.20</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">90</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.05</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">90</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.10</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">noprior_4</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"></span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">30</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.20</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">90</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.05</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">90</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.10</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">90</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.20</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">noprior_5</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"></span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">30</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.20</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">90</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.05</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">90</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.05</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">90</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.20</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">90</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.20</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">noprior_ref</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc"></span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">30</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.05</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">30</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.05</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">90</span></p></td><td class="cl-42099890"><p class="cl-42097126"><span class="cl-42057fbc">0.05</span></p></td><td class="cl-42099887"><p class="cl-4209711c"><span class="cl-42057fbc">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4209989a"><p class="cl-4209711c"><span class="cl-42057fbc"></span></p></td><td class="cl-420998a4"><p class="cl-42097126"><span class="cl-42057fbc">90</span></p></td><td class="cl-420998a4"><p class="cl-42097126"><span class="cl-42057fbc">0.05</span></p></td><td class="cl-4209989a"><p class="cl-4209711c"><span class="cl-42057fbc">ACN</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="tg-constrained" class="level4">
<h4 class="anchored" data-anchor-id="tg-constrained">tg constrained</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data_ma<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">line=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>combined_results <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="at">prior_ref =</span> fwstgc_prior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_ref =</span> fwstgc_noprior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="at">prior_2 =</span> fwstgc_prior_2<span class="sc">$</span>chosen_indices,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_2 =</span> <span class="dv">10000</span><span class="sc">+</span>fwstgc_prior_2<span class="sc">$</span>chosen_indices, <span class="co"># dummy</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="at">prior_3 =</span> fwstgc_prior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_3 =</span> fwstgc_noprior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="at">prior_4 =</span> fwstgc_prior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_4 =</span> fwstgc_noprior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="at">prior_5 =</span> fwstgc_prior_5<span class="sc">$</span>chosen_indices,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_5 =</span> fwstgc_noprior_5<span class="sc">$</span>chosen_indices)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>selected_exp <span class="ot">=</span> <span class="fu">enframe</span>(combined_results)<span class="sc">%&gt;%</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">line=</span>value, <span class="at">Name =</span> name) <span class="sc">%&gt;%</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_ma, <span class="at">by =</span> <span class="st">"line"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">arrange</span>(Name,tg, fio)<span class="sc">%&gt;%</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(line,xpH,m,td,to,te,fif)) <span class="sc">%&gt;%</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Name, <span class="st">'noprior'</span>), <span class="st">"No prior"</span>, <span class="st">"Prior"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>tab1<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Prior"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>tab2<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"No prior"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">set_formatter</span>(</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  tab2, </span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">tg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x) ),</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">fio =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, x) )</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab1, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>)</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab2, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>) </span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>, <span class="at">color=</span><span class="cn">NA</span>),</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>)</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> gg<span class="sc">+</span>p1<span class="sc">+</span>p2<span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-table-tgc.pdf"</span>), <span class="at">.path =</span> tables_dir1)</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-table-tgc.png"</span>), <span class="at">.path =</span> tables_dir1)</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>tab1</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="stan-simulations" class="level3">
<h3 class="anchored" data-anchor-id="stan-simulations">Stan simulations</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>prior_ma_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>noprior_ma_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_2<span class="sc">$</span>chosen_indices <span class="co"># p=2</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>prior_ma_2 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>prior_ma_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>noprior_ma_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>prior_ma_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>noprior_ma_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>prior_ma_5 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>noprior_ma_5 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="gradient-conditions" class="level4">
<h4 class="anchored" data-anchor-id="gradient-conditions">Gradient conditions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>p31<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(prior_ma_5<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>p32<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(noprior_ma_5<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>iresults <span class="ot">=</span> <span class="fu">rbind</span>(prior_ma_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>                prior_ma_2<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>                 prior_ma_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>                 prior_ma_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>),</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>                 prior_ma_5<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_5"</span>),</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_5<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_5"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ivar =</span> <span class="fu">if_else</span>(ivar<span class="sc">&gt;</span><span class="fl">1e6</span>,<span class="fl">1e6</span>,ivar)) <span class="sc">%&gt;%</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.factor</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB))</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">1000000</span>))<span class="sc">+</span>    </span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>idx_exemple_analytes <span class="ot">=</span> iresults <span class="sc">%&gt;%</span></span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">==</span><span class="st">"prior_ref"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ivar)<span class="sc">%&gt;%</span></span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which</span>(<span class="fu">row_number</span>() <span class="sc">%%</span> <span class="dv">100</span> <span class="sc">==</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(i)<span class="sc">%&gt;%</span><span class="fu">pull</span>()</span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>iresults <span class="sc">%&gt;%</span></span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-42945e4e{}.cl-4288c2dc{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-428d95d2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-428d95dc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-428dca98{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-428dcaa2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-428dcaac{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-428dcaad{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-428dcab6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-428dcab7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-42945e4e"><thead><tr style="overflow-wrap:break-word;"><th class="cl-428dca98"><p class="cl-428d95d2"><span class="cl-4288c2dc">method</span></p></th><th class="cl-428dcaa2"><p class="cl-428d95dc"><span class="cl-4288c2dc">&lt;=1x</span></p></th><th class="cl-428dcaa2"><p class="cl-428d95dc"><span class="cl-4288c2dc">&lt;=2x</span></p></th><th class="cl-428dcaa2"><p class="cl-428d95dc"><span class="cl-4288c2dc">&lt;=3x</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-428dcaac"><p class="cl-428d95d2"><span class="cl-4288c2dc">noprior_3</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.000</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.464</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.688</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-428dcaac"><p class="cl-428d95d2"><span class="cl-4288c2dc">noprior_4</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.004</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.860</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.930</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-428dcaac"><p class="cl-428d95d2"><span class="cl-4288c2dc">noprior_5</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.704</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.926</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.946</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-428dcaac"><p class="cl-428d95d2"><span class="cl-4288c2dc">noprior_ref</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.000</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.420</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.750</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-428dcaac"><p class="cl-428d95d2"><span class="cl-4288c2dc">prior_2</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.028</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.182</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.484</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-428dcaac"><p class="cl-428d95d2"><span class="cl-4288c2dc">prior_3</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.082</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.684</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.860</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-428dcaac"><p class="cl-428d95d2"><span class="cl-4288c2dc">prior_4</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.114</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.980</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.992</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-428dcaac"><p class="cl-428d95d2"><span class="cl-4288c2dc">prior_5</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.906</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.982</span></p></td><td class="cl-428dcaad"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.992</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-428dcab6"><p class="cl-428d95d2"><span class="cl-4288c2dc">prior_ref</span></p></td><td class="cl-428dcab7"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.072</span></p></td><td class="cl-428dcab7"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.822</span></p></td><td class="cl-428dcab7"><p class="cl-428d95dc"><span class="cl-4288c2dc">0.992</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>f55_1<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">"target"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value,<span class="at">color=</span><span class="fu">as.factor</span>(target)))<span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Probability"</span>, <span class="at">y =</span> <span class="st">"Method"</span>, <span class="at">color =</span> <span class="st">"target"</span>)<span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.9</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>f55_1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prob.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>f55_1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prob.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prior-p5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-noprior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-noprior-p5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-maxvar.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-maxvar.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>p31</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-gra-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>p32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-gra-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-gra-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>f33_1<span class="ot">=</span>p33</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>f55_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-gra-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># iiresults&lt;-iresults %&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     pivot_wider(names_from = "method", values_from = ivar) %&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(d_prior_2 = prior_2/prior_ref,</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">#          d_prior_3 = prior_3/prior_ref,</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">#          d_noprior_3 = noprior_3/noprior_ref,</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">#          d_prior_4 = prior_4/prior_ref,</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co">#          d_noprior_4 = noprior_4/noprior_ref,</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">#          d_prior_5 = prior_5/prior_ref,</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">#          d_noprior_5 = noprior_5/noprior_ref)%&gt;%</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(d_prior_2:d_noprior_5, names_to = "method")%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c(prior_ref:noprior_5))</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># test2=iresults %&gt;%</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x=logP,y=ivar, color=as.factor(Type)))+</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point()+</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x="logP", y="max(Var)", color = "Type")+   </span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                      trans='log10',</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                       breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.001, 1000)),</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                       labels=scales::trans_format('log10', scales::math_format(10^.x))) + </span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~method, scales = "free_y")</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   test2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="isocratic-conditions" class="level4">
<h4 class="anchored" data-anchor-id="isocratic-conditions">Isocratic conditions</h4>
<section id="individual-plots" class="level5">
<h5 class="anchored" data-anchor-id="individual-plots">Individual plots</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>plot_id <span class="ot">=</span> <span class="cf">function</span>(results) { </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  results <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>CV<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">ymin =</span> llog10tr, <span class="at">ymax =</span> ulog10tr), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>mlog10tr), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"log(tr)"</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">10</span>, <span class="at">name=</span><span class="st">"%CV"</span>)) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(i<span class="sc">~</span>mod) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>results_prior_ma_ref<span class="ot">&lt;-</span>prior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_ref<span class="ot">&lt;-</span>noprior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>results_prior_ma_2<span class="ot">&lt;-</span>prior_ma_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>results_prior_ma_3<span class="ot">&lt;-</span>prior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> mrgmisc<span class="sc">::</span><span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_3<span class="ot">&lt;-</span>noprior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>results_prior_ma_4<span class="ot">&lt;-</span>prior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_4<span class="ot">&lt;-</span>noprior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a>results_prior_ma_5<span class="ot">&lt;-</span>prior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_5<span class="ot">&lt;-</span>noprior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ref <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_ref,plot_id) </span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ref <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_ref,plot_id) </span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_2 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_2,plot_id) </span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_3 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_3,plot_id) </span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_3 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_3,plot_id) </span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_4 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_4,plot_id) </span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_4 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_4,plot_id) </span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_5 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_5,plot_id) </span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_5 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_5,plot_id) </span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ref.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb32-99"><a href="#cb32-99" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ref.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb32-100"><a href="#cb32-100" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_5[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb32-101"><a href="#cb32-101" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_5[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb32-102"><a href="#cb32-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-103"><a href="#cb32-103" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ref </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-izo-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ref </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-izo-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-izo-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-izo-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_3 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-izo-summary-5.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-izo-summary-6.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-izo-summary-7.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_5  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-izo-summary-8.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_5 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-izo-summary-9.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combined" class="level5">
<h5 class="anchored" data-anchor-id="combined">Combined</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>plot_id <span class="ot">=</span> <span class="cf">function</span>(results) { </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  results <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>CV)) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">ymin =</span> llog10tr, <span class="at">ymax =</span> ulog10tr), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>mlog10tr), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"log(tr)"</span>,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">1</span>, <span class="at">name=</span><span class="st">"%CV"</span>)) <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(i<span class="sc">~</span>mod) <span class="sc">+</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>izoresults <span class="ot">=</span> <span class="fu">rbind</span>( prior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>                prior_ma_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>                 prior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>                 prior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>),</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>                 prior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_5"</span>),</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_5"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&lt;=</span><span class="fu">log10</span>(<span class="dv">100</span>))<span class="sc">%&gt;%</span></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&gt;=</span><span class="fu">log10</span>(<span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.numeric</span>(c),</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(i,method,c)<span class="sc">%&gt;%</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(i,method) <span class="sc">%&gt;%</span></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">imaxcv =</span> <span class="fu">max</span>(CV), <span class="at">imincv =</span> <span class="fu">min</span>(CV), <span class="at">aveCV =</span> pracma<span class="sc">::</span><span class="fu">trapz</span>(c, CV)<span class="sc">/</span>(<span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">imaxcv =</span> <span class="fu">if_else</span>(imaxcv<span class="sc">&gt;</span><span class="fl">1e4</span>,<span class="fl">1e4</span>,imaxcv))<span class="sc">%&gt;%</span></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.integer</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB)) </span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">10000</span>))<span class="sc">+</span>    </span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb51-74"><a href="#cb51-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-75"><a href="#cb51-75" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-izo-combined-CV.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb51-76"><a href="#cb51-76" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-izo-combined-CV.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb51-77"><a href="#cb51-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-78"><a href="#cb51-78" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-izo-summary-combined-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>f44_1 <span class="ot">=</span> p33</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># test ----</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>p77_1<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>p77_2<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">10000</span>))<span class="sc">+</span>    </span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>p77<span class="ot">=</span>p77_1<span class="sc">+</span>p77_2<span class="sc">+</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>p77</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-izo-summary-combined-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
</section>
<section id="stan-multiple-analytes.-monoprotic-analytes.-fi-tg-and-ph-for-meoh-and-acn-as-design-variables" class="level1">
<h1>Stan multiple analytes. Monoprotic analytes. fi, tg and pH for MeOH and ACN as design variables</h1>
<section id="compile-stan-models-1" class="level2">
<h2 class="anchored" data-anchor-id="compile-stan-models-1">Compile stan models</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>mod_mono_analytes_gq <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-monoprotic-analytes-gq.stan"</span>, </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>mod_mono_analytes_sim <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-monoprotic-analytes-sim.stan"</span>, </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>mod_mono_analytes <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-monoprotic-analytes.stan"</span>, </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>mod_mono_analytes<span class="sc">$</span><span class="fu">compile</span>(<span class="at">compile_model_methods=</span><span class="cn">TRUE</span>,<span class="at">force_recompile=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulate-retention-times-and-create-data-sets" class="level2">
<h2 class="anchored" data-anchor-id="simulate-retention-times-and-create-data-sets">Simulate retention times and create data sets</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>data_ma_pH<span class="ot">=</span>hplcparam_candidates_df</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>nObs <span class="ot">=</span> <span class="fu">nrow</span>(data_ma_pH);</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>nAnalytes <span class="ot">=</span><span class="dv">50</span>;</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> <span class="dv">1234</span>;</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>n_param <span class="ot">=</span> <span class="dv">6</span>;</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>n_rep <span class="ot">=</span> <span class="dv">10</span>;</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma_pH<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_pH<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>inits_pH <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_rep) {</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_pH[[i]] <span class="ot">=</span> <span class="fu">list</span>(<span class="at">nObs=</span>nObs,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nAnalytes=</span>nAnalytes,</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">steps=</span> <span class="dv">4</span><span class="sc">+</span><span class="dv">6</span><span class="sc">*</span>data_ma_pH<span class="sc">$</span>m,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">hplcparam=</span> <span class="fu">as.matrix</span>(data_ma_pH<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(tg,td,to,te,fio,fif,m,xpH))),</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">include_prior=</span> <span class="dv">1</span>,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">run_estimation=</span><span class="dv">1</span>,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nSel=</span> nObs,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="dv">1</span><span class="sc">:</span>nObs)</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>fit_gq_pH  <span class="ot">=</span> mod_mono_analytes_gq<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> datastruct_prior_ma_pH[[i]],</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> cseed,</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">fixed_param =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">iter_sampling=</span><span class="dv">1</span>)</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_pH[[i]]<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">matrix</span>(fit_gq_pH<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, </span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>                                                           <span class="at">variable =</span> <span class="st">"y_hat_sim"</span>),nAnalytes,nObs)</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_pH[[i]]<span class="sc">$</span>logPobs <span class="ot">=</span> fit_gq_pH<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, </span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">variable =</span> <span class="st">"logPobs"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_pH[[i]]<span class="sc">$</span>A1B2 <span class="ot">=</span> fit_gq_pH<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, </span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">variable =</span> <span class="st">"A1B2"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>param <span class="ot">=</span> <span class="fu">matrix</span>(fit_gq_pH<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, </span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>                               <span class="at">variable =</span> <span class="st">"paramsim"</span>),nAnalytes,<span class="dv">6</span>)</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma_pH[[i]]<span class="ot">=</span>datastruct_prior_ma_pH[[i]];</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma_pH[[i]]<span class="sc">$</span>include_prior <span class="ot">=</span> <span class="fl">0.01</span>;</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>inits_pH[[i]]<span class="ot">=</span>param</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> cseed<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mean_log_det_stan_pH <span class="ot">=</span> <span class="cf">function</span>(data_pH, init_pH, chosen_indices, S){</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>init_ma_pH <span class="ot">=</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">param=</span>init_pH)}</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>data_pH<span class="sc">$</span>selected <span class="ot">=</span> chosen_indices;</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>data_pH<span class="sc">$</span>nSel <span class="ot">=</span> <span class="fu">length</span>(chosen_indices);</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a> fit_opt  <span class="ot">=</span> mod_mono_analytes<span class="sc">$</span><span class="fu">optimize</span>(</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data_pH,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_dir =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"stanfiles"</span>),</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_basename =</span> S, <span class="co">#paste(chosen_indices, collapse = ""),</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>   <span class="at">seed =</span> cseed,</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>   <span class="at">init =</span> init_ma_pH,</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">jacobian =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>   <span class="at">show_messages =</span> F)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a> mode<span class="ot">=</span>fit_opt<span class="sc">$</span><span class="fu">unconstrain_variables</span>(<span class="fu">list</span>(<span class="at">param =</span> fit_opt<span class="sc">$</span><span class="fu">mle</span>(<span class="st">"param"</span>)))</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a> hessian <span class="ot">=</span> fit_opt<span class="sc">$</span><span class="fu">hessian</span>(<span class="at">unconstrained_variables =</span> mode)<span class="sc">$</span>hessian</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>logdet <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span>data_pH<span class="sc">$</span>nAnalytes,\(i) <span class="fu">log</span>(<span class="fu">det</span>(<span class="sc">-</span>hessian[((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">6</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">6</span><span class="sc">+</span><span class="dv">6</span>),((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">6</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">6</span><span class="sc">+</span><span class="dv">6</span>)]))))</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(logdet)</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="co"># data_ma_pH%&gt;%mutate(line = 1:n())%&gt;%filter(tg %in% c(30,90), fio==0.05)%&gt;%select(line)%&gt;%pull()</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">35</span>,<span class="dv">36</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">131</span>,<span class="dv">132</span>)</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a><span class="co"># quick test:</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>z_prior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan_pH</span>(datastruct_prior_ma_pH[[i]], inits_pH[[i]], chosen_indices, i))</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>z_noprior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan_pH</span>(datastruct_noprior_ma_pH[[i]], inits_pH[[i]], chosen_indices, i))</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(<span class="fu">unlist</span>(z_prior)),<span class="fu">mean</span>(<span class="fu">unlist</span>(z_noprior)))</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29.78770 27.07936</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>logP <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_prior_ma_pH),\(i) datastruct_prior_ma_pH[[i]]<span class="sc">$</span>logPobs))</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>AB <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_prior_ma_pH),\(i) datastruct_prior_ma_pH[[i]]<span class="sc">$</span>A1B2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="optimize" class="level2">
<h2 class="anchored" data-anchor-id="optimize">Optimize</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">137</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>fw_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">137</span>,<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">136</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>fw_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">142</span>,<span class="dv">137</span>,<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">136</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>fw_prior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">136</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>fw_prior_6 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">45</span>,<span class="dv">46</span>,<span class="dv">133</span>,<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">136</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>fw_noprior_6 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">45</span>,<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">136</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>fw_prior_7 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">142</span>,<span class="dv">45</span>,<span class="dv">46</span>,<span class="dv">133</span>,<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">136</span>)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>fw_noprior_7 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">46</span>,<span class="dv">135</span>,<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">143</span>,<span class="dv">136</span>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>fw_prior_8 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">46</span>,<span class="dv">135</span>,<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">143</span>,<span class="dv">136</span>)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>fw_noprior_8 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">46</span>,<span class="dv">135</span>,<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">143</span>,<span class="dv">136</span>)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>fw_prior_9 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">46</span>,<span class="dv">135</span>,<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">143</span>,<span class="dv">136</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>fw_noprior_9 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">139</span>,<span class="dv">46</span>,<span class="dv">135</span>,<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">143</span>,<span class="dv">136</span>)</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>fw_prior_10 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">139</span>,<span class="dv">46</span>,<span class="dv">135</span>,<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">143</span>,<span class="dv">136</span>)</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>fw_noprior_10 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="optimize-tg-constrain" class="level2">
<h2 class="anchored" data-anchor-id="optimize-tg-constrain">Optimize tg constrain</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">35</span>,<span class="dv">36</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">131</span>,<span class="dv">132</span>) <span class="co">#init</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>fwtgc_prior_8 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par_tgconstraint</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="at">tg_constraint =</span> <span class="dv">480</span>, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">35</span>,<span class="dv">36</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">131</span>,<span class="dv">132</span>) <span class="co">#init</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>fwtgc_noprior_8 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par_tgconstraint</span>(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, <span class="at">tg_constraint =</span> <span class="dv">480</span>,<span class="at">n_iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="read-the-results-and-compare-1" class="level3">
<h3 class="anchored" data-anchor-id="read-the-results-and-compare-1">Read the results and compare</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">137</span>) <span class="co"># p=3</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>fw_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">137</span>,<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">136</span>) <span class="co"># p=4</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>fw_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">142</span>,<span class="dv">137</span>,<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">136</span>) <span class="co"># p=5</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>fw_prior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">35</span>,<span class="dv">36</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">131</span>,<span class="dv">132</span>) <span class="co"># ref </span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">35</span>,<span class="dv">36</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">131</span>,<span class="dv">132</span>) <span class="co"># ref </span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>fw_prior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>fw_noprior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">136</span>) <span class="co"># p=6</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">45</span>,<span class="dv">46</span>,<span class="dv">133</span>,<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">136</span>) <span class="co"># p=6</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>fw_prior_6 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>fw_noprior_6 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">45</span>,<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">136</span>) <span class="co"># p=7 </span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">142</span>,<span class="dv">45</span>,<span class="dv">46</span>,<span class="dv">133</span>,<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">136</span>) <span class="co"># p=7</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>fw_prior_7 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>fw_noprior_7 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">46</span>,<span class="dv">135</span>,<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">143</span>,<span class="dv">136</span>) <span class="co"># p=8 </span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">46</span>,<span class="dv">139</span>,<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>, <span class="dv">45</span>, <span class="dv">136</span>) <span class="co"># p=8</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>fw_prior_8 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>fw_noprior_8 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">132</span>, <span class="dv">46</span>, <span class="dv">135</span>, <span class="dv">141</span>, <span class="dv">142</span>, <span class="dv">129</span>, <span class="dv">130</span>, <span class="dv">143</span>, <span class="dv">140</span>) <span class="co"># p=9 </span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">46</span>, <span class="dv">135</span>, <span class="dv">141</span>, <span class="dv">142</span>, <span class="dv">129</span>, <span class="dv">130</span>, <span class="dv">143</span>, <span class="dv">136</span>) <span class="co"># p=9 </span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>fw_prior_9 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>fw_noprior_9 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">132</span>,<span class="dv">45</span>,<span class="dv">46</span>,<span class="dv">135</span>,<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">143</span>,<span class="dv">140</span>) <span class="co"># p=10 </span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>fw_prior_10 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">45</span>,<span class="dv">132</span>,<span class="dv">46</span>,<span class="dv">135</span>,<span class="dv">141</span>,<span class="dv">142</span>,<span class="dv">129</span>,<span class="dv">130</span>,<span class="dv">143</span>,<span class="dv">144</span>) <span class="co"># p=10 </span></span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>fw_noprior_10 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a> chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>,<span class="dv">30</span>,<span class="dv">47</span>,<span class="dv">46</span>,<span class="dv">141</span>,<span class="dv">130</span>,<span class="dv">135</span>,<span class="dv">136</span>) <span class="co"># p=8 </span></span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a> chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">29</span>,<span class="dv">46</span>,<span class="dv">45</span>,<span class="dv">30</span>,<span class="dv">133</span>,<span class="dv">130</span>,<span class="dv">139</span>,<span class="dv">132</span>) <span class="co"># p=8</span></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a> fwtgc_prior_8 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a> fwtgc_noprior_8 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>summary_results <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Type =</span> AB,</span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a>                         <span class="at">prior_ref =</span> fw_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a>                        <span class="at">noprior_ref =</span> fw_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a>                         <span class="at">prior_03 =</span> fw_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a>                         <span class="at">prior_04 =</span> fw_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a>                         <span class="at">prior_05 =</span> fw_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_06 =</span> fw_prior_6<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_06 =</span> fw_noprior_6<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_07 =</span> fw_prior_7<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_07 =</span> fw_noprior_7<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_08 =</span> fw_prior_8<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_08 =</span> fw_noprior_8<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_09 =</span> fw_prior_9<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_09 =</span> fw_noprior_9<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-56"><a href="#cb61-56" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_10 =</span> fw_prior_10<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-57"><a href="#cb61-57" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_10 =</span> fw_noprior_10<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb61-58"><a href="#cb61-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(prior_ref<span class="sc">:</span>noprior_10, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb61-59"><a href="#cb61-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-60"><a href="#cb61-60" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">ggplot</span>(summary_results, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value))<span class="sc">+</span></span>
<span id="cb61-61"><a href="#cb61-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb61-62"><a href="#cb61-62" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>value, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb61-63"><a href="#cb61-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb61-64"><a href="#cb61-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"log(|FIM|)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)</span>
<span id="cb61-65"><a href="#cb61-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-66"><a href="#cb61-66" aria-hidden="true" tabindex="-1"></a>summary_results_diff <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb61-67"><a href="#cb61-67" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Type =</span> AB,</span>
<span id="cb61-68"><a href="#cb61-68" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fw_prior_ref =</span> fw_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-69"><a href="#cb61-69" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_noprior_ref =</span> fw_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-70"><a href="#cb61-70" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fw_prior_3 =</span> fw_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-71"><a href="#cb61-71" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fw_prior_4 =</span> fw_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-72"><a href="#cb61-72" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fw_prior_5 =</span> fw_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-73"><a href="#cb61-73" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_prior_6 =</span> fw_prior_6<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-74"><a href="#cb61-74" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_noprior_6 =</span> fw_noprior_6<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-75"><a href="#cb61-75" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_prior_7 =</span> fw_prior_7<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-76"><a href="#cb61-76" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_noprior_7 =</span> fw_noprior_7<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-77"><a href="#cb61-77" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_prior_8 =</span> fw_prior_8<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-78"><a href="#cb61-78" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_noprior_8 =</span> fw_noprior_8<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-79"><a href="#cb61-79" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_prior_9 =</span> fw_prior_9<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-80"><a href="#cb61-80" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_noprior_9 =</span> fw_noprior_9<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-81"><a href="#cb61-81" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_prior_10 =</span> fw_prior_10<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-82"><a href="#cb61-82" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_noprior_10 =</span> fw_noprior_10<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb61-83"><a href="#cb61-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_prior_03 =</span> (fw_prior_3 <span class="sc">-</span> fw_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb61-84"><a href="#cb61-84" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_04 =</span> (fw_prior_4 <span class="sc">-</span> fw_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb61-85"><a href="#cb61-85" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_05 =</span> (fw_prior_5 <span class="sc">-</span> fw_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb61-86"><a href="#cb61-86" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_06 =</span> (fw_prior_6 <span class="sc">-</span> fw_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb61-87"><a href="#cb61-87" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_06 =</span> (fw_noprior_6 <span class="sc">-</span> fw_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb61-88"><a href="#cb61-88" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_07 =</span> (fw_prior_7 <span class="sc">-</span> fw_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb61-89"><a href="#cb61-89" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_07 =</span> (fw_noprior_7 <span class="sc">-</span> fw_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb61-90"><a href="#cb61-90" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_08 =</span> (fw_prior_8 <span class="sc">-</span> fw_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb61-91"><a href="#cb61-91" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_08 =</span> (fw_noprior_8 <span class="sc">-</span> fw_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb61-92"><a href="#cb61-92" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_09 =</span> (fw_prior_9 <span class="sc">-</span> fw_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb61-93"><a href="#cb61-93" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_09 =</span> (fw_noprior_9 <span class="sc">-</span> fw_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb61-94"><a href="#cb61-94" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_10 =</span> (fw_prior_10 <span class="sc">-</span> fw_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb61-95"><a href="#cb61-95" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_10 =</span> (fw_noprior_10 <span class="sc">-</span> fw_noprior_ref)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb61-96"><a href="#cb61-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_prior_03<span class="sc">:</span>d_noprior_10, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb61-97"><a href="#cb61-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-98"><a href="#cb61-98" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diff, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb61-99"><a href="#cb61-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb61-100"><a href="#cb61-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb61-101"><a href="#cb61-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb61-102"><a href="#cb61-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Efficiency relative to the reference design"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb61-103"><a href="#cb61-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)</span>
<span id="cb61-104"><a href="#cb61-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-105"><a href="#cb61-105" aria-hidden="true" tabindex="-1"></a>summary_results_diffprior <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb61-106"><a href="#cb61-106" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Type =</span> AB,</span>
<span id="cb61-107"><a href="#cb61-107" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fw_prior_ref =</span> fw_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-108"><a href="#cb61-108" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_noprior_ref =</span> fw_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-109"><a href="#cb61-109" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fw_prior_3 =</span> fw_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-110"><a href="#cb61-110" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fw_prior_4 =</span> fw_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-111"><a href="#cb61-111" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fw_prior_5 =</span> fw_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-112"><a href="#cb61-112" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_prior_6 =</span> fw_prior_6<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-113"><a href="#cb61-113" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_noprior_6 =</span> fw_noprior_6<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-114"><a href="#cb61-114" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_prior_7 =</span> fw_prior_7<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-115"><a href="#cb61-115" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_noprior_7 =</span> fw_noprior_7<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-116"><a href="#cb61-116" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_prior_8 =</span> fw_prior_8<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-117"><a href="#cb61-117" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_noprior_8 =</span> fw_noprior_8<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-118"><a href="#cb61-118" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_prior_9 =</span> fw_prior_9<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-119"><a href="#cb61-119" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_noprior_9 =</span> fw_noprior_9<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-120"><a href="#cb61-120" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_prior_10 =</span> fw_prior_10<span class="sc">$</span>log_det_FIM,</span>
<span id="cb61-121"><a href="#cb61-121" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fw_noprior_10 =</span> fw_noprior_10<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb61-122"><a href="#cb61-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_ref  =</span> (fw_prior_ref<span class="sc">-</span>fw_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb61-123"><a href="#cb61-123" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_06 =</span> (fw_prior_6<span class="sc">-</span>fw_noprior_6)<span class="sc">/</span>n_param,</span>
<span id="cb61-124"><a href="#cb61-124" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_07 =</span> (fw_prior_7<span class="sc">-</span>fw_noprior_7)<span class="sc">/</span>n_param,</span>
<span id="cb61-125"><a href="#cb61-125" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_08 =</span> (fw_prior_8<span class="sc">-</span>fw_noprior_8)<span class="sc">/</span>n_param,</span>
<span id="cb61-126"><a href="#cb61-126" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_09 =</span> (fw_prior_9<span class="sc">-</span>fw_noprior_9)<span class="sc">/</span>n_param,</span>
<span id="cb61-127"><a href="#cb61-127" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_10 =</span> (fw_prior_10<span class="sc">-</span>fw_noprior_10)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb61-128"><a href="#cb61-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_ref<span class="sc">:</span>d_10, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb61-129"><a href="#cb61-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-130"><a href="#cb61-130" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diffprior, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb61-131"><a href="#cb61-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb61-132"><a href="#cb61-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb61-133"><a href="#cb61-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb61-134"><a href="#cb61-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Effect of prior on design efficiency"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb61-135"><a href="#cb61-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb61-136"><a href="#cb61-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">100</span>),</span>
<span id="cb61-137"><a href="#cb61-137" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb61-138"><a href="#cb61-138" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">100</span>)),</span>
<span id="cb61-139"><a href="#cb61-139" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb61-140"><a href="#cb61-140" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-logDet-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-logDet-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-logDet-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>f2_2 <span class="ot">=</span> p2</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>f3_2 <span class="ot">=</span> p3</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-logdFIM-abs.pdf"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-logdFIM-abs.png"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-logdFIM-rel.pdf"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-logdFIM-rel.png"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-logdFIM-prioreff.pdf"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-logdFIM-prioreff.png"</span>), <span class="at">.path =</span> figures_dir2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="table-1" class="level3">
<h3 class="anchored" data-anchor-id="table-1">Table</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>data_ma_pH<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">line=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>combined_results <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="at">prior_ref =</span> fw_prior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_ref =</span> fw_noprior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="at">prior_3 =</span> fw_prior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="at">prior_4 =</span> fw_prior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="at">prior_5 =</span> fw_prior_5<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_3 =</span> <span class="dv">10000</span><span class="sc">+</span>fw_prior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_4 =</span> <span class="dv">10000</span><span class="sc">+</span>fw_prior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_5 =</span> <span class="dv">10000</span><span class="sc">+</span>fw_prior_5<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="at">prior_6 =</span> fw_prior_6<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_6 =</span> fw_noprior_6<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="at">prior_7 =</span> fw_prior_7<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_7 =</span> fw_noprior_7<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="at">prior_8 =</span> fw_prior_8<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_8 =</span> fw_noprior_8<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a><span class="at">prior_9 =</span> fw_prior_9<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_9 =</span> fw_noprior_9<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a><span class="at">prior_10 =</span> fw_prior_10<span class="sc">$</span>chosen_indices,</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_10 =</span> fw_noprior_10<span class="sc">$</span>chosen_indices)</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>selected_exp <span class="ot">=</span> <span class="fu">enframe</span>(combined_results)<span class="sc">%&gt;%</span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">line=</span>value, <span class="at">Name =</span> name) <span class="sc">%&gt;%</span></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_ma_pH, <span class="at">by =</span> <span class="st">"line"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>   <span class="fu">arrange</span>(Name,xpH,tg, fio)<span class="sc">%&gt;%</span></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xpH =</span> <span class="fu">if_else</span>(xpH<span class="sc">==</span><span class="dv">0</span>, <span class="st">"N"</span>, <span class="st">"I"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(line,m,td,to,te,fif)) <span class="sc">%&gt;%</span></span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Name, <span class="st">'noprior'</span>), <span class="st">"No prior"</span>, <span class="st">"Prior"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>tab1<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Prior"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>tab2<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"No prior"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">set_formatter</span>(</span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>  tab2, </span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">tg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x) ),</span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">fio =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, x) )</span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab1, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>)</span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab2, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>) </span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(</span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>, <span class="at">color=</span><span class="cn">NA</span>),</span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb65-63"><a href="#cb65-63" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>)</span>
<span id="cb65-64"><a href="#cb65-64" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb65-65"><a href="#cb65-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-66"><a href="#cb65-66" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> gg<span class="sc">+</span>p1<span class="sc">+</span>p2<span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb65-67"><a href="#cb65-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-table.pdf"</span>), <span class="at">.path =</span> tables_dir2)</span>
<span id="cb65-69"><a href="#cb65-69" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-table.png"</span>), <span class="at">.path =</span> tables_dir2)</span>
<span id="cb65-70"><a href="#cb65-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-71"><a href="#cb65-71" aria-hidden="true" tabindex="-1"></a>tab1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c98c5d84{}.cl-c97cd76a{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c983be86{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c983be9a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c98404e0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c98404ea{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c98404eb{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c98404f4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c98404f5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c98404fe{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c98c5d84"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c98404e0"><p class="cl-c983be86"><span class="cl-c97cd76a">Name</span></p></th><th class="cl-c98404ea"><p class="cl-c983be9a"><span class="cl-c97cd76a">tg</span></p></th><th class="cl-c98404ea"><p class="cl-c983be9a"><span class="cl-c97cd76a">fio</span></p></th><th class="cl-c98404e0"><p class="cl-c983be86"><span class="cl-c97cd76a">xpH</span></p></th><th class="cl-c98404e0"><p class="cl-c983be86"><span class="cl-c97cd76a">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">prior_10</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">30</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.10</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">30</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.15</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">prior_3</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.15</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.15</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">prior_4</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.15</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.15</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.10</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">prior_5</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.15</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.15</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.10</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">prior_6</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.15</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.10</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">prior_7</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">30</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.15</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.10</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">prior_8</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.10</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">30</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.10</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">prior_9</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.10</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">30</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.15</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.20</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">prior_ref</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">30</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">30</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">N</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">30</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">30</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404f4"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404eb"><p class="cl-c983be86"><span class="cl-c97cd76a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c98404f5"><p class="cl-c983be86"><span class="cl-c97cd76a"></span></p></td><td class="cl-c98404fe"><p class="cl-c983be9a"><span class="cl-c97cd76a">90</span></p></td><td class="cl-c98404fe"><p class="cl-c983be9a"><span class="cl-c97cd76a">0.05</span></p></td><td class="cl-c98404f5"><p class="cl-c983be86"><span class="cl-c97cd76a">I</span></p></td><td class="cl-c98404f5"><p class="cl-c983be86"><span class="cl-c97cd76a">ACN</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c9aca53a{}.cl-c99dd78a{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c9a4691a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c9a46924{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c9a498ae{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c9a498b8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c9a498c2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c9a498c3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c9a498cc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c9a498cd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c9aca53a"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c9a498ae"><p class="cl-c9a4691a"><span class="cl-c99dd78a">Name</span></p></th><th class="cl-c9a498b8"><p class="cl-c9a46924"><span class="cl-c99dd78a">tg</span></p></th><th class="cl-c9a498b8"><p class="cl-c9a46924"><span class="cl-c99dd78a">fio</span></p></th><th class="cl-c9a498ae"><p class="cl-c9a4691a"><span class="cl-c99dd78a">xpH</span></p></th><th class="cl-c9a498ae"><p class="cl-c9a4691a"><span class="cl-c99dd78a">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">noprior_10</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.10</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">noprior_3</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">noprior_4</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">noprior_5</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"> </span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">noprior_6</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.10</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.15</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.10</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">noprior_7</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.10</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.15</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.10</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">noprior_8</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.15</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.10</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">noprior_9</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.10</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.10</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.20</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">noprior_ref</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">N</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">30</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498c3"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498c2"><p class="cl-c9a4691a"><span class="cl-c99dd78a">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9a498cc"><p class="cl-c9a4691a"><span class="cl-c99dd78a"></span></p></td><td class="cl-c9a498cd"><p class="cl-c9a46924"><span class="cl-c99dd78a">90</span></p></td><td class="cl-c9a498cd"><p class="cl-c9a46924"><span class="cl-c99dd78a">0.05</span></p></td><td class="cl-c9a498cc"><p class="cl-c9a4691a"><span class="cl-c99dd78a">I</span></p></td><td class="cl-c9a498cc"><p class="cl-c9a4691a"><span class="cl-c99dd78a">ACN</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="stan-simulations-1" class="level3">
<h3 class="anchored" data-anchor-id="stan-simulations-1">Stan simulations</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_prior_ref<span class="sc">$</span>chosen_indices</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>prior_ma_pH_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_noprior_ref<span class="sc">$</span>chosen_indices</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>noprior_ma_pH_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_noprior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_prior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>prior_ma_pH_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_prior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>prior_ma_pH_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_prior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>prior_ma_pH_5 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_prior_6<span class="sc">$</span>chosen_indices <span class="co"># p=6</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>prior_ma_pH_6 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_noprior_6<span class="sc">$</span>chosen_indices  <span class="co"># p=6</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>noprior_ma_pH_6 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_noprior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_prior_7<span class="sc">$</span>chosen_indices  <span class="co"># p=7 </span></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>prior_ma_pH_7 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_noprior_7<span class="sc">$</span>chosen_indices <span class="co"># p=7</span></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>noprior_ma_pH_7 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_noprior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_prior_8<span class="sc">$</span>chosen_indices  <span class="co"># p=8</span></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>prior_ma_pH_8 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_noprior_8<span class="sc">$</span>chosen_indices  <span class="co"># p=8</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>noprior_ma_pH_8 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_noprior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_prior_9<span class="sc">$</span>chosen_indices  <span class="co"># p=9</span></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>prior_ma_pH_9 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_noprior_9<span class="sc">$</span>chosen_indices  <span class="co"># p=9</span></span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>noprior_ma_pH_9 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_noprior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_prior_10<span class="sc">$</span>chosen_indices  <span class="co"># p=10</span></span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>prior_ma_pH_10 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a>chosen_indices<span class="ot">=</span>fw_noprior_10<span class="sc">$</span>chosen_indices  <span class="co"># p=10</span></span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a>noprior_ma_pH_10 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_pH</span>(mod_mono_analytes_sim, datastruct_noprior_ma_pH, inits_pH, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="gradient-conditions-1" class="level4">
<h4 class="anchored" data-anchor-id="gradient-conditions-1">Gradient conditions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> fw_prior_10<span class="sc">$</span>chosen_indices<span class="co"># p=10</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> fw_noprior_10<span class="sc">$</span>chosen_indices <span class="co"># p=10</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>p31<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(prior_ma_pH_10<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices_prior,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pH_f =</span> <span class="fu">if_else</span>(xpH<span class="sc">==</span><span class="dv">0</span>,<span class="st">"N"</span>, <span class="st">"A or B"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(pH_f<span class="sc">~</span>m_f)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>p32<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(noprior_ma_pH_10<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices_noprior,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pH_f =</span> <span class="fu">if_else</span>(xpH<span class="sc">==</span><span class="dv">0</span>,<span class="st">"N"</span>, <span class="st">"A or B"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(pH_f<span class="sc">~</span>m_f)</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>iresults <span class="ot">=</span> <span class="fu">rbind</span>(prior_ma_pH_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_pH_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>                  prior_ma_pH_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_03"</span>),</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>                  prior_ma_pH_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_04"</span>),</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>                   prior_ma_pH_5<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_05"</span>),</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>                 prior_ma_pH_6<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_06"</span>),</span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_pH_6<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_06"</span>),</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>                 prior_ma_pH_7<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_07"</span>),</span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_pH_7<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_07"</span>),</span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>                 prior_ma_pH_8<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_08"</span>),</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_pH_8<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_08"</span>),</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>                 prior_ma_pH_9<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_09"</span>),</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_pH_9<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_09"</span>),</span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>                 prior_ma_pH_10<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_10"</span>),</span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_pH_10<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_10"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ivar =</span> <span class="fu">if_else</span>(ivar<span class="sc">&gt;</span><span class="fl">1e6</span>,<span class="fl">1e6</span>,ivar))<span class="sc">%&gt;%</span></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.factor</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB))</span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">1000000</span>))<span class="sc">+</span>    </span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb68-80"><a href="#cb68-80" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb68-82"><a href="#cb68-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-83"><a href="#cb68-83" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb68-84"><a href="#cb68-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb68-85"><a href="#cb68-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-86"><a href="#cb68-86" aria-hidden="true" tabindex="-1"></a>idx_exemple_analytes <span class="ot">=</span> iresults <span class="sc">%&gt;%</span></span>
<span id="cb68-87"><a href="#cb68-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">==</span><span class="st">"prior_ref"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-88"><a href="#cb68-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ivar)<span class="sc">%&gt;%</span></span>
<span id="cb68-89"><a href="#cb68-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which</span>(<span class="fu">row_number</span>() <span class="sc">%%</span> <span class="dv">100</span> <span class="sc">==</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-90"><a href="#cb68-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(i)<span class="sc">%&gt;%</span>pull</span>
<span id="cb68-91"><a href="#cb68-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-92"><a href="#cb68-92" aria-hidden="true" tabindex="-1"></a>iresults <span class="sc">%&gt;%</span></span>
<span id="cb68-93"><a href="#cb68-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb68-94"><a href="#cb68-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb68-95"><a href="#cb68-95" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb68-96"><a href="#cb68-96" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-97"><a href="#cb68-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-ca21ac36{}.cl-ca187aa8{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ca1c39ea{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ca1c39fe{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ca1c624e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ca1c6262{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ca1c6263{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ca1c626c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ca1c626d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ca1c626e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-ca21ac36"><thead><tr style="overflow-wrap:break-word;"><th class="cl-ca1c624e"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">method</span></p></th><th class="cl-ca1c6262"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">&lt;=1x</span></p></th><th class="cl-ca1c6262"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">&lt;=2x</span></p></th><th class="cl-ca1c6262"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">&lt;=3x</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">noprior_06</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.000</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.316</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.640</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">noprior_07</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.000</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.372</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.820</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">noprior_08</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.000</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.718</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.878</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">noprior_09</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.008</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.738</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.882</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">noprior_10</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.526</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.840</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.900</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">noprior_ref</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.000</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.234</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.682</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">prior_03</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.000</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.006</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.038</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">prior_04</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.000</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.030</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.278</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">prior_05</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.000</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.332</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.660</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">prior_06</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.006</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.596</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.810</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">prior_07</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.024</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.842</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.936</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">prior_08</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.230</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.892</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.934</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">prior_09</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.660</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.894</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.934</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c6263"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">prior_10</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.864</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.976</span></p></td><td class="cl-ca1c626c"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.982</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ca1c626d"><p class="cl-ca1c39ea"><span class="cl-ca187aa8">prior_ref</span></p></td><td class="cl-ca1c626e"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.028</span></p></td><td class="cl-ca1c626e"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.922</span></p></td><td class="cl-ca1c626e"><p class="cl-ca1c39fe"><span class="cl-ca187aa8">0.998</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>f55_2<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">"target"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value,<span class="at">color=</span><span class="fu">as.factor</span>(target)))<span class="sc">+</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Probability"</span>, <span class="at">y =</span> <span class="st">"Method"</span>, <span class="at">color =</span> <span class="st">"target"</span>)<span class="sc">+</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.9</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>f55_2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-gra-prob.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>f55_2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-gra-prob.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-gra-prior-p10.pdf"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-gra-prior-p10.png"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-gra-noprior-p10.pdf"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-gra-noprior-p10.png"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-gra-maxvar.pdf"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"monoprotic-analytes-gra-maxvar.png"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>p31</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-gra-summary-v2-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>p32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-gra-summary-v2-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-gra-summary-v2-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>f33_2<span class="ot">=</span>p33</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>f55_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-gra-summary-v2-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="izocratic-conditions" class="level4">
<h4 class="anchored" data-anchor-id="izocratic-conditions">Izocratic conditions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>plot_id <span class="ot">=</span> <span class="cf">function</span>(results) { </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  results <span class="sc">%&gt;%</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>CV<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">ymin =</span> llog10tr, <span class="at">ymax =</span> ulog10tr), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>mlog10tr), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"log(tr)"</span>,</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">10</span>, <span class="at">name=</span><span class="st">"%CV"</span>)) <span class="sc">+</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(i<span class="sc">~</span>mod<span class="sc">+</span>form) <span class="sc">+</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>results_prior_ma_pH_ref<span class="ot">&lt;-</span>prior_ma_pH_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_pH_ref<span class="ot">&lt;-</span>noprior_ma_pH_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>results_prior_ma_pH_3<span class="ot">&lt;-</span>prior_ma_pH_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a>results_prior_ma_pH_4<span class="ot">&lt;-</span>prior_ma_pH_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a>results_prior_ma_pH_5<span class="ot">&lt;-</span>prior_ma_pH_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-51"><a href="#cb73-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-52"><a href="#cb73-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-53"><a href="#cb73-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-54"><a href="#cb73-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-55"><a href="#cb73-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-56"><a href="#cb73-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-57"><a href="#cb73-57" aria-hidden="true" tabindex="-1"></a>results_prior_ma_pH_6<span class="ot">&lt;-</span>prior_ma_pH_6<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-58"><a href="#cb73-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-59"><a href="#cb73-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-60"><a href="#cb73-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-61"><a href="#cb73-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-62"><a href="#cb73-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-63"><a href="#cb73-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-64"><a href="#cb73-64" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_pH_6<span class="ot">&lt;-</span>noprior_ma_pH_6<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-65"><a href="#cb73-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-66"><a href="#cb73-66" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-67"><a href="#cb73-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-68"><a href="#cb73-68" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-69"><a href="#cb73-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-70"><a href="#cb73-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-71"><a href="#cb73-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-72"><a href="#cb73-72" aria-hidden="true" tabindex="-1"></a>results_prior_ma_pH_7<span class="ot">&lt;-</span>prior_ma_pH_7<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-73"><a href="#cb73-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-74"><a href="#cb73-74" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-75"><a href="#cb73-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-76"><a href="#cb73-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-77"><a href="#cb73-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-78"><a href="#cb73-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-79"><a href="#cb73-79" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_pH_7<span class="ot">&lt;-</span>noprior_ma_pH_7<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-80"><a href="#cb73-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-81"><a href="#cb73-81" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-82"><a href="#cb73-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-83"><a href="#cb73-83" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-84"><a href="#cb73-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-85"><a href="#cb73-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-86"><a href="#cb73-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-87"><a href="#cb73-87" aria-hidden="true" tabindex="-1"></a>results_prior_ma_pH_8<span class="ot">&lt;-</span>prior_ma_pH_8<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-88"><a href="#cb73-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-89"><a href="#cb73-89" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-90"><a href="#cb73-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-91"><a href="#cb73-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-92"><a href="#cb73-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-93"><a href="#cb73-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-94"><a href="#cb73-94" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_pH_8<span class="ot">&lt;-</span>noprior_ma_pH_8<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-95"><a href="#cb73-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-96"><a href="#cb73-96" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-97"><a href="#cb73-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-98"><a href="#cb73-98" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-99"><a href="#cb73-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-100"><a href="#cb73-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-101"><a href="#cb73-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-102"><a href="#cb73-102" aria-hidden="true" tabindex="-1"></a>results_prior_ma_pH_9<span class="ot">&lt;-</span>prior_ma_pH_9<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-103"><a href="#cb73-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-104"><a href="#cb73-104" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-105"><a href="#cb73-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-106"><a href="#cb73-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-107"><a href="#cb73-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-108"><a href="#cb73-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-109"><a href="#cb73-109" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_pH_9<span class="ot">&lt;-</span>noprior_ma_pH_9<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-110"><a href="#cb73-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-111"><a href="#cb73-111" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-112"><a href="#cb73-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-113"><a href="#cb73-113" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-114"><a href="#cb73-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-115"><a href="#cb73-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-116"><a href="#cb73-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-117"><a href="#cb73-117" aria-hidden="true" tabindex="-1"></a>results_prior_ma_pH_10<span class="ot">&lt;-</span>prior_ma_pH_10<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-118"><a href="#cb73-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-119"><a href="#cb73-119" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-120"><a href="#cb73-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-121"><a href="#cb73-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-122"><a href="#cb73-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-123"><a href="#cb73-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-124"><a href="#cb73-124" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_pH_10<span class="ot">&lt;-</span>noprior_ma_pH_10<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb73-125"><a href="#cb73-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb73-126"><a href="#cb73-126" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb73-127"><a href="#cb73-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb73-128"><a href="#cb73-128" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb73-129"><a href="#cb73-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb73-130"><a href="#cb73-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb73-131"><a href="#cb73-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-132"><a href="#cb73-132" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_ref <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_pH_ref,plot_id) </span>
<span id="cb73-133"><a href="#cb73-133" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_pH_ref <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_pH_ref,plot_id) </span>
<span id="cb73-134"><a href="#cb73-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-135"><a href="#cb73-135" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_3 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_pH_3,plot_id) </span>
<span id="cb73-136"><a href="#cb73-136" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_4 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_pH_4,plot_id) </span>
<span id="cb73-137"><a href="#cb73-137" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_5 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_pH_5,plot_id) </span>
<span id="cb73-138"><a href="#cb73-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-139"><a href="#cb73-139" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_6 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_pH_6,plot_id) </span>
<span id="cb73-140"><a href="#cb73-140" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_pH_6 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_pH_6,plot_id) </span>
<span id="cb73-141"><a href="#cb73-141" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_7 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_pH_7,plot_id) </span>
<span id="cb73-142"><a href="#cb73-142" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_pH_7 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_pH_7,plot_id) </span>
<span id="cb73-143"><a href="#cb73-143" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_8 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_pH_8,plot_id) </span>
<span id="cb73-144"><a href="#cb73-144" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_pH_8 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_pH_8,plot_id) </span>
<span id="cb73-145"><a href="#cb73-145" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_9 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_pH_9,plot_id) </span>
<span id="cb73-146"><a href="#cb73-146" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_pH_9 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_pH_9,plot_id) </span>
<span id="cb73-147"><a href="#cb73-147" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_10 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_pH_10,plot_id) </span>
<span id="cb73-148"><a href="#cb73-148" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_pH_10 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_pH_10,plot_id) </span>
<span id="cb73-149"><a href="#cb73-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-150"><a href="#cb73-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-151"><a href="#cb73-151" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_pH_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-pH-ref.pdf"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb73-152"><a href="#cb73-152" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_pH_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-pH-ref.png"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb73-153"><a href="#cb73-153" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_pH_10[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-pH-10.pdf"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb73-154"><a href="#cb73-154" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_pH_10[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-pH-10.png"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb73-155"><a href="#cb73-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-156"><a href="#cb73-156" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_ref</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_pH_ref</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-5.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-6.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_pH_6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-7.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_7</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-8.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_pH_7</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-9.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_8</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-10.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_pH_8</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-11.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_9</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-12.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_pH_9</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-13.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_pH_10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-14.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_pH_10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/monoprotic-analytes-izo-summary-v2-15.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_pH_ref[[i]])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="combined-1" class="level5">
<h5 class="anchored" data-anchor-id="combined-1">Combined</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>izoresults <span class="ot">=</span> <span class="fu">rbind</span>(</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>                   prior_ma_pH_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_pH_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>                  prior_ma_pH_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_03"</span>),</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>                  prior_ma_pH_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_04"</span>),</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>                   prior_ma_pH_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_05"</span>),</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>                 prior_ma_pH_6<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_06"</span>),</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_pH_6<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_06"</span>),</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>                 prior_ma_pH_7<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_07"</span>),</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_pH_7<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_07"</span>),</span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>                 prior_ma_pH_8<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_08"</span>),</span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_pH_8<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_08"</span>),</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>                 prior_ma_pH_9<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_09"</span>),</span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_pH_9<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_09"</span>),</span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a>                 prior_ma_pH_10<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_10"</span>),</span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_pH_10<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_10"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&lt;=</span><span class="fu">log10</span>(<span class="dv">100</span>))<span class="sc">%&gt;%</span></span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&gt;=</span><span class="fu">log10</span>(<span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.numeric</span>(c),</span>
<span id="cb104-37"><a href="#cb104-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb104-38"><a href="#cb104-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(i,method,c)<span class="sc">%&gt;%</span></span>
<span id="cb104-39"><a href="#cb104-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(i,method) <span class="sc">%&gt;%</span></span>
<span id="cb104-40"><a href="#cb104-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">imaxcv =</span> <span class="fu">max</span>(CV), <span class="at">imincv =</span> <span class="fu">min</span>(CV), <span class="at">aveCV =</span> pracma<span class="sc">::</span><span class="fu">trapz</span>(c, CV)<span class="sc">/</span>(<span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb104-41"><a href="#cb104-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">imaxcv =</span> <span class="fu">if_else</span>(imaxcv<span class="sc">&gt;</span><span class="fl">1e4</span>,<span class="fl">1e4</span>,imaxcv))<span class="sc">%&gt;%</span></span>
<span id="cb104-42"><a href="#cb104-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.integer</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB))</span>
<span id="cb104-43"><a href="#cb104-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-44"><a href="#cb104-44" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb104-45"><a href="#cb104-45" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb104-46"><a href="#cb104-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb104-47"><a href="#cb104-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb104-48"><a href="#cb104-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb104-49"><a href="#cb104-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb104-50"><a href="#cb104-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb104-51"><a href="#cb104-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb104-52"><a href="#cb104-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-53"><a href="#cb104-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb104-54"><a href="#cb104-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb104-55"><a href="#cb104-55" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb104-56"><a href="#cb104-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb104-57"><a href="#cb104-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-58"><a href="#cb104-58" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb104-59"><a href="#cb104-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb104-60"><a href="#cb104-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb104-61"><a href="#cb104-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb104-62"><a href="#cb104-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb104-63"><a href="#cb104-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb104-64"><a href="#cb104-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb104-65"><a href="#cb104-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">10000</span>))<span class="sc">+</span>    </span>
<span id="cb104-66"><a href="#cb104-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb104-67"><a href="#cb104-67" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb104-68"><a href="#cb104-68" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb104-69"><a href="#cb104-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-70"><a href="#cb104-70" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb104-71"><a href="#cb104-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb104-72"><a href="#cb104-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-73"><a href="#cb104-73" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-izo-summary-pH-combined-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>f44_2 <span class="ot">=</span> p33</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"NI-izo-combined-CV.pdf"</span>), <span class="at">.path =</span> figures_dir2)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"NI-izo-combined-CV.png"</span>), <span class="at">.path =</span> figures_dir2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
</section>
</section>
<section id="stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-as-design-variables" class="level1">
<h1>Stan multiple analytes. Single form analytes. fi and tg for MeOH as design variables</h1>
<section id="compile-stan-models-2" class="level2">
<h2 class="anchored" data-anchor-id="compile-stan-models-2">Compile stan models</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>mod_analytes_MeOH_gq<span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-MeOH-gq.stan"</span>, </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>mod_analytes_MeOH_sim <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-MeOH-sim.stan"</span>,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>mod_analytes_MeOH <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-MeOH.stan"</span>, </span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>mod_analytes_MeOH<span class="sc">$</span><span class="fu">compile</span>(<span class="at">compile_model_methods=</span><span class="cn">TRUE</span>,<span class="at">force_recompile=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulate-retention-times-and-create-datasets-1" class="level2">
<h2 class="anchored" data-anchor-id="simulate-retention-times-and-create-datasets-1">Simulate retention times and create datasets</h2>
<p>Probability of occurrence 0.4 neutral, 0.3 A, 0.3 B with <span class="math inline">\(log P\)</span> being sampled from 2.2 <span class="math inline">\(\pm\)</span> 2 and constrained between 0.5 and 7.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>data_ma_MeOH<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>, m<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>nObs <span class="ot">=</span> <span class="fu">nrow</span>(data_ma_MeOH);</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>nAnalytes <span class="ot">=</span><span class="dv">50</span>;</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> <span class="dv">1234</span>;</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>n_param <span class="ot">=</span> <span class="dv">3</span>;</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>n_rep <span class="ot">=</span> <span class="dv">10</span>;</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma_MeOH<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_MeOH<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>inits_MeOH <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_rep) {</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_MeOH[[i]] <span class="ot">=</span> <span class="fu">list</span>(<span class="at">nObs=</span>nObs,</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nAnalytes=</span>nAnalytes,</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">steps =</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>data_ma_MeOH<span class="sc">$</span>m,</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">hplcparam=</span><span class="fu">as.matrix</span>(data_ma_MeOH<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(tg,td,to,te,fio,fif,m))),</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">include_prior =</span> <span class="dv">1</span>,</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">run_estimation=</span><span class="dv">1</span>,</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nSel =</span> nObs,</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="dv">1</span><span class="sc">:</span>nObs)</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>fit_MeOH_gq  <span class="ot">=</span> mod_analytes_MeOH_gq<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> datastruct_prior_ma_MeOH[[i]],</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> cseed,</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">fixed_param =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">iter_sampling=</span><span class="dv">1</span>)</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_MeOH[[i]]<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">matrix</span>(fit_MeOH_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"y_hat_sim"</span>),nAnalytes,nObs)</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_MeOH[[i]]<span class="sc">$</span>logPobs <span class="ot">=</span> fit_MeOH_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"logPobs"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_MeOH[[i]]<span class="sc">$</span>N1A2B3 <span class="ot">=</span> fit_MeOH_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"N1A2B3"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>param <span class="ot">=</span> <span class="fu">matrix</span>(fit_MeOH_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"paramsim"</span>),nAnalytes,<span class="dv">2</span>)</span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma_MeOH[[i]]<span class="ot">=</span>datastruct_prior_ma_MeOH[[i]];</span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma_MeOH[[i]]<span class="sc">$</span>include_prior <span class="ot">=</span> <span class="fl">0.01</span>;</span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a>inits_MeOH[[i]]<span class="ot">=</span>param</span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> cseed<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>mean_log_det_stan_MeOH <span class="ot">=</span> <span class="cf">function</span>(data, init, chosen_indices, S){</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>init_ma <span class="ot">=</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">param=</span>init)}</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>selected <span class="ot">=</span> chosen_indices;</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>nSel <span class="ot">=</span> <span class="fu">length</span>(chosen_indices);</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a> fit_MeOH_opt  <span class="ot">=</span> mod_analytes_MeOH<span class="sc">$</span><span class="fu">optimize</span>(</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data,</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_dir =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"stanfiles"</span>),</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_basename =</span> S,</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>   <span class="at">seed =</span> cseed,</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>   <span class="at">init =</span> init_ma,</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">jacobian =</span> <span class="cn">TRUE</span>,</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>   <span class="at">show_messages =</span> F)</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a> mode<span class="ot">=</span>fit_MeOH_opt<span class="sc">$</span><span class="fu">unconstrain_variables</span>(<span class="fu">list</span>(<span class="at">param =</span> fit_MeOH_opt<span class="sc">$</span><span class="fu">mle</span>(<span class="st">"param"</span>)))</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a> hessian <span class="ot">=</span> fit_MeOH_opt<span class="sc">$</span><span class="fu">hessian</span>(<span class="at">unconstrained_variables =</span> mode)<span class="sc">$</span>hessian</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>logdet <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span>data<span class="sc">$</span>nAnalytes,\(i) <span class="fu">log</span>(<span class="fu">det</span>(<span class="sc">-</span>hessian[((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span>),((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span>)]))))</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(logdet)</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">33</span>)</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>logP <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_prior_ma_MeOH),\(i) datastruct_prior_ma_MeOH[[i]]<span class="sc">$</span>logPobs))</span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>NAB <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_prior_ma_MeOH),\(i) datastruct_prior_ma_MeOH[[i]]<span class="sc">$</span>N1A2B3))</span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a><span class="co"># quick test:</span></span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a>z_prior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan_MeOH</span>(datastruct_prior_ma_MeOH[[i]], inits_MeOH[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a>z_noprior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan_MeOH</span>(datastruct_noprior_ma_MeOH[[i]], inits_MeOH[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(<span class="fu">unlist</span>(z_prior)),<span class="fu">mean</span>(<span class="fu">unlist</span>(z_noprior)))</span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.749208 7.684150</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"8.749208 7.684150"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "8.749208 7.684150"</code></pre>
</div>
</div>
</section>
<section id="optimization-1" class="level2">
<h2 class="anchored" data-anchor-id="optimization-1">Optimization</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>) <span class="co"># initial values</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>fws_MeOH_prior_1 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">36</span>,<span class="dv">33</span>) <span class="co"># initial values</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>fws_MeOH_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">36</span>,<span class="dv">33</span>) <span class="co"># initial values</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>fws_MeOH_noprior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">33</span>,<span class="dv">36</span>) <span class="co"># initial values</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>fws_MeOH_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">33</span>,<span class="dv">36</span>) <span class="co"># initial values</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>fws_MeOH_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">33</span>,<span class="dv">36</span>) <span class="co"># initial values</span></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>fws_MeOH_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">33</span>,<span class="dv">36</span>) <span class="co"># initial values</span></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>fws_MeOH_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="read-the-results-and-compare-2" class="level3">
<h3 class="anchored" data-anchor-id="read-the-results-and-compare-2">Read the results and compare</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">33</span>) <span class="co"># ref</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">33</span>) <span class="co"># ref</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>fws_MeOH_prior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>fws_MeOH_noprior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>) <span class="co"># p=1</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>fws_MeOH_prior_1 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>,<span class="dv">36</span>) <span class="co"># p=2</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">33</span>) <span class="co"># p=2</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>fws_MeOH_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>fws_MeOH_noprior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">33</span>,<span class="dv">36</span>) <span class="co"># p=3</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">33</span>,<span class="dv">36</span>) <span class="co"># p=3</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>fws_MeOH_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>fws_MeOH_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">34</span>,<span class="dv">33</span>,<span class="dv">36</span>) <span class="co"># p=4</span></span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">11</span>,<span class="dv">33</span>,<span class="dv">36</span>) <span class="co"># p=4</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>fws_MeOH_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>fws_MeOH_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>summary_results <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Type =</span> NAB,</span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">prior_ref =</span> fws_MeOH_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_ref =</span> fws_MeOH_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_1 =</span> fws_MeOH_prior_1<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_2 =</span> fws_MeOH_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_2 =</span> fws_MeOH_noprior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_3 =</span> fws_MeOH_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_3 =</span> fws_MeOH_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_4 =</span> fws_MeOH_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_4 =</span> fws_MeOH_noprior_4<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(prior_ref<span class="sc">:</span>noprior_4, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">ggplot</span>(summary_results, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value))<span class="sc">+</span></span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>value, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"log(|FIM|)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)</span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a>summary_results_diff <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Type =</span> NAB,</span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fws_prior_ref =</span> fws_MeOH_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_MeOH_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_1 =</span> fws_MeOH_prior_1<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_2 =</span> fws_MeOH_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_2 =</span> fws_MeOH_noprior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_MeOH_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_MeOH_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_MeOH_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_MeOH_noprior_4<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb114-54"><a href="#cb114-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_prior_1 =</span> (fws_prior_1 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb114-55"><a href="#cb114-55" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_2 =</span> (fws_prior_2 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb114-56"><a href="#cb114-56" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_2 =</span> (fws_noprior_2 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb114-57"><a href="#cb114-57" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_3 =</span> (fws_prior_3 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb114-58"><a href="#cb114-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_3 =</span> (fws_noprior_3 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb114-59"><a href="#cb114-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_4 =</span> (fws_prior_4 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb114-60"><a href="#cb114-60" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_4 =</span> (fws_noprior_4 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb114-61"><a href="#cb114-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_prior_1<span class="sc">:</span>d_noprior_4, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb114-62"><a href="#cb114-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-63"><a href="#cb114-63" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diff, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb114-64"><a href="#cb114-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb114-65"><a href="#cb114-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb114-66"><a href="#cb114-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb114-67"><a href="#cb114-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Efficiency relative to the reference design"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb114-68"><a href="#cb114-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)</span>
<span id="cb114-69"><a href="#cb114-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-70"><a href="#cb114-70" aria-hidden="true" tabindex="-1"></a>summary_results_diffprior <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb114-71"><a href="#cb114-71" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Type =</span> NAB,</span>
<span id="cb114-72"><a href="#cb114-72" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fws_prior_ref =</span> fws_MeOH_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-73"><a href="#cb114-73" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_MeOH_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-74"><a href="#cb114-74" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_2 =</span> fws_MeOH_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-75"><a href="#cb114-75" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_2 =</span> fws_MeOH_noprior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-76"><a href="#cb114-76" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_MeOH_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-77"><a href="#cb114-77" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_MeOH_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-78"><a href="#cb114-78" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_MeOH_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb114-79"><a href="#cb114-79" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_MeOH_noprior_4<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb114-80"><a href="#cb114-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_ref  =</span> (fws_prior_ref<span class="sc">-</span>fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb114-81"><a href="#cb114-81" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_2 =</span> (fws_prior_2<span class="sc">-</span>fws_noprior_2)<span class="sc">/</span>n_param,</span>
<span id="cb114-82"><a href="#cb114-82" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_3 =</span> (fws_prior_3<span class="sc">-</span>fws_noprior_3)<span class="sc">/</span>n_param,</span>
<span id="cb114-83"><a href="#cb114-83" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_4 =</span> (fws_prior_4<span class="sc">-</span>fws_noprior_4)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb114-84"><a href="#cb114-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_ref<span class="sc">:</span>d_4, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb114-85"><a href="#cb114-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-86"><a href="#cb114-86" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diffprior, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb114-87"><a href="#cb114-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb114-88"><a href="#cb114-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb114-89"><a href="#cb114-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb114-90"><a href="#cb114-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Effect of prior on design efficiency"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb114-91"><a href="#cb114-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb114-92"><a href="#cb114-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">100</span>),</span>
<span id="cb114-93"><a href="#cb114-93" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb114-94"><a href="#cb114-94" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">100</span>)),</span>
<span id="cb114-95"><a href="#cb114-95" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb114-96"><a href="#cb114-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-97"><a href="#cb114-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-98"><a href="#cb114-98" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-MeOH-logDet-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-MeOH-logDet-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-MeOH-logDet-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>f2_3<span class="ot">=</span> p2</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>f3_3 <span class="ot">=</span> p3</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-logdFIM-abs.pdf"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-logdFIM-abs.png"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-logdFIM-rel.pdf"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-logdFIM-rel.png"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-logdFIM-prioreff.pdf"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-logdFIM-prioreff.png"</span>), <span class="at">.path =</span> figures_dir3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="table-2" class="level3">
<h3 class="anchored" data-anchor-id="table-2">Table</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>data_ma_MeOH<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>, m<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">line=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>combined_results <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="at">prior_ref =</span> fws_MeOH_prior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_ref =</span> fws_MeOH_noprior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_1 =</span> fws_MeOH_prior_1<span class="sc">$</span>chosen_indices,</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="at">prior_1 =</span> <span class="dv">10000</span><span class="sc">+</span>fws_MeOH_prior_1<span class="sc">$</span>chosen_indices,</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_2 =</span> fws_MeOH_prior_2<span class="sc">$</span>chosen_indices,</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_2 =</span> fws_MeOH_noprior_2<span class="sc">$</span>chosen_indices,</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_3 =</span> fws_MeOH_prior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_3 =</span> fws_MeOH_noprior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_4 =</span> fws_MeOH_prior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_4 =</span> fws_MeOH_noprior_4<span class="sc">$</span>chosen_indices)</span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>selected_exp <span class="ot">=</span> <span class="fu">enframe</span>(combined_results)<span class="sc">%&gt;%</span></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">line=</span>value, <span class="at">Name =</span> name) <span class="sc">%&gt;%</span></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_ma_MeOH, <span class="at">by =</span> <span class="st">"line"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(line,xpH,m,td,to,te,fif)) <span class="sc">%&gt;%</span></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Name, <span class="st">'noprior'</span>), <span class="st">"No prior"</span>, <span class="st">"Prior"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>tab1<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Prior"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb118-30"><a href="#cb118-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-31"><a href="#cb118-31" aria-hidden="true" tabindex="-1"></a>tab2<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb118-32"><a href="#cb118-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"No prior"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb118-33"><a href="#cb118-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb118-34"><a href="#cb118-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-35"><a href="#cb118-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb118-36"><a href="#cb118-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-37"><a href="#cb118-37" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">set_formatter</span>(</span>
<span id="cb118-38"><a href="#cb118-38" aria-hidden="true" tabindex="-1"></a>  tab2, </span>
<span id="cb118-39"><a href="#cb118-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">tg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x) ),</span>
<span id="cb118-40"><a href="#cb118-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">fio =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, x) )</span>
<span id="cb118-41"><a href="#cb118-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb118-42"><a href="#cb118-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-43"><a href="#cb118-43" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab1, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>)</span>
<span id="cb118-44"><a href="#cb118-44" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab2, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>) </span>
<span id="cb118-45"><a href="#cb118-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-46"><a href="#cb118-46" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb118-47"><a href="#cb118-47" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(</span>
<span id="cb118-48"><a href="#cb118-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb118-49"><a href="#cb118-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>, <span class="at">color=</span><span class="cn">NA</span>),</span>
<span id="cb118-50"><a href="#cb118-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb118-51"><a href="#cb118-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb118-52"><a href="#cb118-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb118-53"><a href="#cb118-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>)</span>
<span id="cb118-54"><a href="#cb118-54" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb118-55"><a href="#cb118-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-56"><a href="#cb118-56" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> gg<span class="sc">+</span>p1<span class="sc">+</span>p2<span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb118-57"><a href="#cb118-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-58"><a href="#cb118-58" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-table.pdf"</span>), <span class="at">.path =</span> tables_dir3)</span>
<span id="cb118-59"><a href="#cb118-59" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-table.png"</span>), <span class="at">.path =</span> tables_dir3)</span>
<span id="cb118-60"><a href="#cb118-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-61"><a href="#cb118-61" aria-hidden="true" tabindex="-1"></a>tab1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-27536fc0{}.cl-274a3630{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-274de60e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-274de618{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-274e0d46{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-274e0d50{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-274e0d51{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-274e0d5a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-274e0d5b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-274e0d64{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-27536fc0"><thead><tr style="overflow-wrap:break-word;"><th class="cl-274e0d46"><p class="cl-274de60e"><span class="cl-274a3630">Name</span></p></th><th class="cl-274e0d50"><p class="cl-274de618"><span class="cl-274a3630">tg</span></p></th><th class="cl-274e0d50"><p class="cl-274de618"><span class="cl-274a3630">fio</span></p></th><th class="cl-274e0d46"><p class="cl-274de60e"><span class="cl-274a3630">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">prior_ref</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">30</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">0.05</span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">90</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">0.05</span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">prior_1</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">90</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">0.05</span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">-1</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">-1.00</span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">prior_2</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">90</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">0.05</span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">90</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">0.20</span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">prior_3</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">30</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">0.20</span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">90</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">0.05</span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">90</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">0.20</span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">prior_4</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">30</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">0.20</span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">90</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">0.10</span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">90</span></p></td><td class="cl-274e0d5a"><p class="cl-274de618"><span class="cl-274a3630">0.05</span></p></td><td class="cl-274e0d51"><p class="cl-274de60e"><span class="cl-274a3630">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-274e0d5b"><p class="cl-274de60e"><span class="cl-274a3630"></span></p></td><td class="cl-274e0d64"><p class="cl-274de618"><span class="cl-274a3630">90</span></p></td><td class="cl-274e0d64"><p class="cl-274de618"><span class="cl-274a3630">0.20</span></p></td><td class="cl-274e0d5b"><p class="cl-274de60e"><span class="cl-274a3630">MeOH</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-2762f88c{}.cl-275946f2{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-275d3488{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-275d349c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-275d5c88{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-275d5c92{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-275d5c9c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-275d5c9d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-275d5c9e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-275d5ca6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-2762f88c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-275d5c88"><p class="cl-275d3488"><span class="cl-275946f2">Name</span></p></th><th class="cl-275d5c92"><p class="cl-275d349c"><span class="cl-275946f2">tg</span></p></th><th class="cl-275d5c92"><p class="cl-275d349c"><span class="cl-275946f2">fio</span></p></th><th class="cl-275d5c88"><p class="cl-275d3488"><span class="cl-275946f2">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">noprior_ref</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">30</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">0.05</span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">90</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">0.05</span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">noprior_2</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">30</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">0.20</span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">90</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">0.05</span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">noprior_3</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">30</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">0.20</span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">90</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">0.05</span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">90</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">0.20</span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">noprior_4</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">30</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">0.20</span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">30</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">0.15</span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">90</span></p></td><td class="cl-275d5c9d"><p class="cl-275d349c"><span class="cl-275946f2">0.05</span></p></td><td class="cl-275d5c9c"><p class="cl-275d3488"><span class="cl-275946f2">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-275d5c9e"><p class="cl-275d3488"><span class="cl-275946f2"></span></p></td><td class="cl-275d5ca6"><p class="cl-275d349c"><span class="cl-275946f2">90</span></p></td><td class="cl-275d5ca6"><p class="cl-275d349c"><span class="cl-275946f2">0.20</span></p></td><td class="cl-275d5c9e"><p class="cl-275d3488"><span class="cl-275946f2">MeOH</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="stan-simulations-2" class="level3">
<h3 class="anchored" data-anchor-id="stan-simulations-2">Stan simulations</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_MeOH_prior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>prior_ma_MeOH_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results_MeOH</span>(mod_analytes_MeOH_sim, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_MeOH_noprior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>noprior_ma_MeOH_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results_MeOH</span>(mod_analytes_MeOH_sim, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_MeOH_prior_1<span class="sc">$</span>chosen_indices <span class="co"># p=1</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>prior_ma_MeOH_1 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_MeOH</span>(mod_analytes_MeOH_sim, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_MeOH_prior_2<span class="sc">$</span>chosen_indices <span class="co"># p=2</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>prior_ma_MeOH_2 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_MeOH</span>(mod_analytes_MeOH_sim, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_MeOH_noprior_2<span class="sc">$</span>chosen_indices <span class="co"># p=2</span></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>noprior_ma_MeOH_2 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_MeOH</span>(mod_analytes_MeOH_sim, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_MeOH_prior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>prior_ma_MeOH_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_MeOH</span>(mod_analytes_MeOH_sim, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_MeOH_noprior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>noprior_ma_MeOH_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_MeOH</span>(mod_analytes_MeOH_sim, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_MeOH_prior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>prior_ma_MeOH_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_MeOH</span>(mod_analytes_MeOH_sim, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_MeOH_noprior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a>noprior_ma_MeOH_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_MeOH</span>(mod_analytes_MeOH_sim, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="gradient-conditions-2" class="level4">
<h4 class="anchored" data-anchor-id="gradient-conditions-2">Gradient conditions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_MeOH_prior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>p31<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>, m<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(prior_ma_MeOH_3<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_MeOH_noprior_3<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>p32<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>, m<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(noprior_ma_MeOH_3<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a>iresults <span class="ot">=</span> <span class="fu">rbind</span>(</span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a>                 prior_ma_MeOH_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_MeOH_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a>                prior_ma_MeOH_1<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_1"</span>),</span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a>                 prior_ma_MeOH_2<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb121-34"><a href="#cb121-34" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_MeOH_2<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb121-35"><a href="#cb121-35" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_2"</span>),</span>
<span id="cb121-36"><a href="#cb121-36" aria-hidden="true" tabindex="-1"></a>                 prior_ma_MeOH_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb121-37"><a href="#cb121-37" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb121-38"><a href="#cb121-38" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_MeOH_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb121-39"><a href="#cb121-39" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb121-40"><a href="#cb121-40" aria-hidden="true" tabindex="-1"></a>                 prior_ma_MeOH_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb121-41"><a href="#cb121-41" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb121-42"><a href="#cb121-42" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_MeOH_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb121-43"><a href="#cb121-43" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb121-44"><a href="#cb121-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ivar =</span> <span class="fu">if_else</span>(ivar<span class="sc">&gt;</span><span class="fl">1e6</span>,<span class="fl">1e6</span>,ivar))<span class="sc">%&gt;%</span></span>
<span id="cb121-45"><a href="#cb121-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.factor</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB))</span>
<span id="cb121-46"><a href="#cb121-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-47"><a href="#cb121-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-48"><a href="#cb121-48" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb121-49"><a href="#cb121-49" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb121-50"><a href="#cb121-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb121-51"><a href="#cb121-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb121-52"><a href="#cb121-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb121-53"><a href="#cb121-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb121-54"><a href="#cb121-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb121-55"><a href="#cb121-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb121-56"><a href="#cb121-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb121-57"><a href="#cb121-57" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb121-58"><a href="#cb121-58" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb121-59"><a href="#cb121-59" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb121-60"><a href="#cb121-60" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb121-61"><a href="#cb121-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb121-62"><a href="#cb121-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb121-63"><a href="#cb121-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb121-64"><a href="#cb121-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb121-65"><a href="#cb121-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb121-66"><a href="#cb121-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">1000000</span>))<span class="sc">+</span></span>
<span id="cb121-67"><a href="#cb121-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb121-68"><a href="#cb121-68" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb121-69"><a href="#cb121-69" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb121-70"><a href="#cb121-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-71"><a href="#cb121-71" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb121-72"><a href="#cb121-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb121-73"><a href="#cb121-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-74"><a href="#cb121-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-75"><a href="#cb121-75" aria-hidden="true" tabindex="-1"></a>idx_exemple_analytes <span class="ot">=</span> iresults <span class="sc">%&gt;%</span></span>
<span id="cb121-76"><a href="#cb121-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">==</span><span class="st">"prior_ref"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb121-77"><a href="#cb121-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ivar)<span class="sc">%&gt;%</span></span>
<span id="cb121-78"><a href="#cb121-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which</span>(<span class="fu">row_number</span>() <span class="sc">%%</span> <span class="dv">100</span> <span class="sc">==</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb121-79"><a href="#cb121-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(i)<span class="sc">%&gt;%</span><span class="fu">pull</span>()</span>
<span id="cb121-80"><a href="#cb121-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-81"><a href="#cb121-81" aria-hidden="true" tabindex="-1"></a>iresults <span class="sc">%&gt;%</span></span>
<span id="cb121-82"><a href="#cb121-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb121-83"><a href="#cb121-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb121-84"><a href="#cb121-84" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb121-85"><a href="#cb121-85" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>))<span class="sc">%&gt;%</span></span>
<span id="cb121-86"><a href="#cb121-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-27c45046{}.cl-27b875fa{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-27bca2ec{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-27bca300{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-27bccc90{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27bccca4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27bccca5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27bcccae{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27bcccaf{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27bcccb8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-27c45046"><thead><tr style="overflow-wrap:break-word;"><th class="cl-27bccc90"><p class="cl-27bca2ec"><span class="cl-27b875fa">method</span></p></th><th class="cl-27bccca4"><p class="cl-27bca300"><span class="cl-27b875fa">&lt;=1x</span></p></th><th class="cl-27bccca4"><p class="cl-27bca300"><span class="cl-27b875fa">&lt;=2x</span></p></th><th class="cl-27bccca4"><p class="cl-27bca300"><span class="cl-27b875fa">&lt;=3x</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-27bccca5"><p class="cl-27bca2ec"><span class="cl-27b875fa">noprior_2</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.000</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.546</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.710</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-27bccca5"><p class="cl-27bca2ec"><span class="cl-27b875fa">noprior_3</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.494</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.934</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.962</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-27bccca5"><p class="cl-27bca2ec"><span class="cl-27b875fa">noprior_4</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.750</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.968</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.968</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-27bccca5"><p class="cl-27bca2ec"><span class="cl-27b875fa">noprior_ref</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.000</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.268</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.524</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-27bccca5"><p class="cl-27bca2ec"><span class="cl-27b875fa">prior_1</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.026</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.186</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.450</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-27bccca5"><p class="cl-27bca2ec"><span class="cl-27b875fa">prior_2</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.286</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.766</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.890</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-27bccca5"><p class="cl-27bca2ec"><span class="cl-27b875fa">prior_3</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.842</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.996</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">1.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-27bccca5"><p class="cl-27bca2ec"><span class="cl-27b875fa">prior_4</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.944</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">0.994</span></p></td><td class="cl-27bcccae"><p class="cl-27bca300"><span class="cl-27b875fa">1.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-27bcccaf"><p class="cl-27bca2ec"><span class="cl-27b875fa">prior_ref</span></p></td><td class="cl-27bcccb8"><p class="cl-27bca300"><span class="cl-27b875fa">0.080</span></p></td><td class="cl-27bcccb8"><p class="cl-27bca300"><span class="cl-27b875fa">0.622</span></p></td><td class="cl-27bcccb8"><p class="cl-27bca300"><span class="cl-27b875fa">0.982</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>f55_3<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">"target"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value,<span class="at">color=</span><span class="fu">as.factor</span>(target)))<span class="sc">+</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Probability"</span>, <span class="at">y =</span> <span class="st">"Method"</span>, <span class="at">color =</span> <span class="st">"target"</span>)<span class="sc">+</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.9</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>f55_3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-gra-prob.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>f55_3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-gra-prob.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-gra-prior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-gra-prior-p5.png"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-gra-noprior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-gra-noprior-p5.png"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-gra-maxvar.pdf"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-MeOH-gra-maxvar.png"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>p31</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-gra-MeOH-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>p32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-gra-MeOH-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-gra-MeOH-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>f33_3<span class="ot">=</span>p33</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>f55_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-gra-MeOH-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="isocratic-conditions-1" class="level4">
<h4 class="anchored" data-anchor-id="isocratic-conditions-1">Isocratic conditions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>plot_id <span class="ot">=</span> <span class="cf">function</span>(results) {</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  results <span class="sc">%&gt;%</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>CV<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">ymin =</span> llog10tr, <span class="at">ymax =</span> ulog10tr), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>mlog10tr), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"log(tr)"</span>,</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">10</span>, <span class="at">name=</span><span class="st">"%CV"</span>)) <span class="sc">+</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(i<span class="sc">~</span>mod) <span class="sc">+</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>results_prior_ma_MeOH_ref<span class="ot">&lt;-</span>prior_ma_MeOH_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_MeOH_ref<span class="ot">&lt;-</span>noprior_ma_MeOH_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>results_prior_ma_MeOH_1<span class="ot">&lt;-</span>prior_ma_MeOH_1<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-43"><a href="#cb126-43" aria-hidden="true" tabindex="-1"></a>results_prior_ma_MeOH_2<span class="ot">&lt;-</span>prior_ma_MeOH_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb126-44"><a href="#cb126-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb126-45"><a href="#cb126-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb126-46"><a href="#cb126-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb126-47"><a href="#cb126-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb126-48"><a href="#cb126-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> mrgmisc<span class="sc">::</span><span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb126-49"><a href="#cb126-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb126-50"><a href="#cb126-50" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_MeOH_2<span class="ot">&lt;-</span>noprior_ma_MeOH_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb126-51"><a href="#cb126-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb126-52"><a href="#cb126-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb126-53"><a href="#cb126-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb126-54"><a href="#cb126-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb126-55"><a href="#cb126-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb126-56"><a href="#cb126-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb126-57"><a href="#cb126-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-58"><a href="#cb126-58" aria-hidden="true" tabindex="-1"></a>results_prior_ma_MeOH_3<span class="ot">&lt;-</span>prior_ma_MeOH_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb126-59"><a href="#cb126-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb126-60"><a href="#cb126-60" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb126-61"><a href="#cb126-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb126-62"><a href="#cb126-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb126-63"><a href="#cb126-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb126-64"><a href="#cb126-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb126-65"><a href="#cb126-65" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_MeOH_3<span class="ot">&lt;-</span>noprior_ma_MeOH_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb126-66"><a href="#cb126-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb126-67"><a href="#cb126-67" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb126-68"><a href="#cb126-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb126-69"><a href="#cb126-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb126-70"><a href="#cb126-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb126-71"><a href="#cb126-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb126-72"><a href="#cb126-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-73"><a href="#cb126-73" aria-hidden="true" tabindex="-1"></a>results_prior_ma_MeOH_4<span class="ot">&lt;-</span>prior_ma_MeOH_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb126-74"><a href="#cb126-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb126-75"><a href="#cb126-75" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb126-76"><a href="#cb126-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb126-77"><a href="#cb126-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb126-78"><a href="#cb126-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb126-79"><a href="#cb126-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb126-80"><a href="#cb126-80" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_MeOH_4<span class="ot">&lt;-</span>noprior_ma_MeOH_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb126-81"><a href="#cb126-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb126-82"><a href="#cb126-82" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb126-83"><a href="#cb126-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb126-84"><a href="#cb126-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb126-85"><a href="#cb126-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb126-86"><a href="#cb126-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb126-87"><a href="#cb126-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-88"><a href="#cb126-88" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_MeOH_ref <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_MeOH_ref,plot_id)</span>
<span id="cb126-89"><a href="#cb126-89" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_MeOH_ref <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_MeOH_ref,plot_id)</span>
<span id="cb126-90"><a href="#cb126-90" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_MeOH_1 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_MeOH_1,plot_id)</span>
<span id="cb126-91"><a href="#cb126-91" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_MeOH_2 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_MeOH_2,plot_id)</span>
<span id="cb126-92"><a href="#cb126-92" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_MeOH_2 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_MeOH_2,plot_id)</span>
<span id="cb126-93"><a href="#cb126-93" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_MeOH_3 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_MeOH_3,plot_id)</span>
<span id="cb126-94"><a href="#cb126-94" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_MeOH_3 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_MeOH_3,plot_id)</span>
<span id="cb126-95"><a href="#cb126-95" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_MeOH_4 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_MeOH_4,plot_id)</span>
<span id="cb126-96"><a href="#cb126-96" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_MeOH_4 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_MeOH_4,plot_id)</span>
<span id="cb126-97"><a href="#cb126-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-98"><a href="#cb126-98" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_MeOH_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-MeOH-ref.pdf"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb126-99"><a href="#cb126-99" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_MeOH_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-MeOH-ref.png"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb126-100"><a href="#cb126-100" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_MeOH_3[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-MeOH-3.pdf"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb126-101"><a href="#cb126-101" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_MeOH_3[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-MeOH-3.png"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb126-102"><a href="#cb126-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-103"><a href="#cb126-103" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_MeOH_ref</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-MeOH-izo-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_MeOH_ref</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-MeOH-izo-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_MeOH_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-MeOH-izo-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_MeOH_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-MeOH-izo-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_MeOH_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-MeOH-izo-summary-5.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_MeOH_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-MeOH-izo-summary-6.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_MeOH_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-MeOH-izo-summary-7.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_MeOH_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-MeOH-izo-summary-8.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_MeOH_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-MeOH-izo-summary-9.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="combined-2" class="level5">
<h5 class="anchored" data-anchor-id="combined-2">Combined</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>izoresults <span class="ot">=</span> <span class="fu">rbind</span>( prior_ma_MeOH_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_MeOH_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>                prior_ma_MeOH_1<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_1"</span>),</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>                 prior_ma_MeOH_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_MeOH_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_2"</span>),</span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>                 prior_ma_MeOH_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_MeOH_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>                 prior_ma_MeOH_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_MeOH_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&lt;=</span><span class="fu">log10</span>(<span class="dv">100</span>))<span class="sc">%&gt;%</span></span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&gt;=</span><span class="fu">log10</span>(<span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.numeric</span>(c),</span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(i,method,c)<span class="sc">%&gt;%</span></span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(i,method) <span class="sc">%&gt;%</span></span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">imaxcv =</span> <span class="fu">max</span>(CV), <span class="at">imincv =</span> <span class="fu">min</span>(CV), <span class="at">aveCV =</span> pracma<span class="sc">::</span><span class="fu">trapz</span>(c, CV)<span class="sc">/</span>(<span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">imaxcv =</span> <span class="fu">if_else</span>(imaxcv<span class="sc">&gt;</span><span class="fl">1e4</span>,<span class="fl">1e4</span>,imaxcv))<span class="sc">%&gt;%</span></span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.integer</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB))</span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb145-31"><a href="#cb145-31" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb145-32"><a href="#cb145-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb145-33"><a href="#cb145-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb145-34"><a href="#cb145-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb145-35"><a href="#cb145-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb145-36"><a href="#cb145-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb145-37"><a href="#cb145-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb145-38"><a href="#cb145-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-39"><a href="#cb145-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb145-40"><a href="#cb145-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb145-41"><a href="#cb145-41" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb145-42"><a href="#cb145-42" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb145-43"><a href="#cb145-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-44"><a href="#cb145-44" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb145-45"><a href="#cb145-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb145-46"><a href="#cb145-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb145-47"><a href="#cb145-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb145-48"><a href="#cb145-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb145-49"><a href="#cb145-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb145-50"><a href="#cb145-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb145-51"><a href="#cb145-51" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb145-52"><a href="#cb145-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">10000</span>))<span class="sc">+</span>    </span>
<span id="cb145-53"><a href="#cb145-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb145-54"><a href="#cb145-54" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb145-55"><a href="#cb145-55" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb145-56"><a href="#cb145-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-57"><a href="#cb145-57" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb145-58"><a href="#cb145-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb145-59"><a href="#cb145-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-60"><a href="#cb145-60" aria-hidden="true" tabindex="-1"></a>f44_3 <span class="ot">=</span> p33</span>
<span id="cb145-61"><a href="#cb145-61" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-MeOH-izo-combined-CV.pdf"</span>), <span class="at">.path =</span> figures_dir3)</span>
<span id="cb145-62"><a href="#cb145-62" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-MeOH-izo-combined-CV.png"</span>), <span class="at">.path =</span> figures_dir3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
</section>
</section>
<section id="stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-acn-as-design-variables" class="level1">
<h1>Stan multiple analytes. Single form analytes. fi and tg for ACN as design variables</h1>
<section id="compile-stan-models-3" class="level2">
<h2 class="anchored" data-anchor-id="compile-stan-models-3">Compile stan models</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>mod_analytes_ACN_gq<span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-ACN-gq.stan"</span>, </span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>mod_analytes_ACN_sim <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-ACN-sim.stan"</span>,</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>mod_analytes_ACN <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-ACN.stan"</span>, </span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>mod_analytes_ACN<span class="sc">$</span><span class="fu">compile</span>(<span class="at">compile_model_methods=</span><span class="cn">TRUE</span>,<span class="at">force_recompile=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulate-retention-times-and-create-datasets-2" class="level2">
<h2 class="anchored" data-anchor-id="simulate-retention-times-and-create-datasets-2">Simulate retention times and create datasets</h2>
<p>Probability of occurrence 0.4 neutral, 0.3 A, 0.3 B with <span class="math inline">\(log P\)</span> being sampled from 2.2 <span class="math inline">\(\pm\)</span> 2 and constrained between 0.5 and 7.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>data_ma_ACN<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>, m<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>nObs <span class="ot">=</span> <span class="fu">nrow</span>(data_ma_ACN);</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>nAnalytes <span class="ot">=</span><span class="dv">50</span>;</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> <span class="dv">1234</span>;</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>n_param <span class="ot">=</span> <span class="dv">3</span>;</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>n_rep <span class="ot">=</span> <span class="dv">10</span>;</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma_ACN<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_ACN<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>inits_ACN <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_rep) {</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_ACN[[i]] <span class="ot">=</span> <span class="fu">list</span>(<span class="at">nObs=</span>nObs,</span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nAnalytes=</span>nAnalytes,</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">steps =</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>data_ma_ACN<span class="sc">$</span>m,</span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">hplcparam=</span><span class="fu">as.matrix</span>(data_ma_ACN<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(tg,td,to,te,fio,fif,m))),</span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">include_prior =</span> <span class="dv">1</span>,</span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">run_estimation=</span><span class="dv">1</span>,</span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nSel =</span> nObs,</span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="dv">1</span><span class="sc">:</span>nObs)</span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a>fit_ACN_gq  <span class="ot">=</span> mod_analytes_ACN_gq<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> datastruct_prior_ma_ACN[[i]],</span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> cseed,</span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">fixed_param =</span> <span class="cn">TRUE</span>,</span>
<span id="cb147-25"><a href="#cb147-25" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb147-26"><a href="#cb147-26" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">iter_sampling=</span><span class="dv">1</span>)</span>
<span id="cb147-27"><a href="#cb147-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-28"><a href="#cb147-28" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_ACN[[i]]<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">matrix</span>(fit_ACN_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"y_hat_sim"</span>),nAnalytes,nObs)</span>
<span id="cb147-29"><a href="#cb147-29" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_ACN[[i]]<span class="sc">$</span>logPobs <span class="ot">=</span> fit_ACN_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"logPobs"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb147-30"><a href="#cb147-30" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma_ACN[[i]]<span class="sc">$</span>N1A2B3 <span class="ot">=</span> fit_ACN_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"N1A2B3"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb147-31"><a href="#cb147-31" aria-hidden="true" tabindex="-1"></a>param <span class="ot">=</span> <span class="fu">matrix</span>(fit_ACN_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"paramsim"</span>),nAnalytes,<span class="dv">2</span>)</span>
<span id="cb147-32"><a href="#cb147-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-33"><a href="#cb147-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-34"><a href="#cb147-34" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma_ACN[[i]]<span class="ot">=</span>datastruct_prior_ma_ACN[[i]];</span>
<span id="cb147-35"><a href="#cb147-35" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma_ACN[[i]]<span class="sc">$</span>include_prior <span class="ot">=</span> <span class="fl">0.01</span>;</span>
<span id="cb147-36"><a href="#cb147-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-37"><a href="#cb147-37" aria-hidden="true" tabindex="-1"></a>inits_ACN[[i]]<span class="ot">=</span>param</span>
<span id="cb147-38"><a href="#cb147-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-39"><a href="#cb147-39" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> cseed<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb147-40"><a href="#cb147-40" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>mean_log_det_stan_ACN <span class="ot">=</span> <span class="cf">function</span>(data, init, chosen_indices, S){</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>init_ma <span class="ot">=</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">param=</span>init)}</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>selected <span class="ot">=</span> chosen_indices;</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>nSel <span class="ot">=</span> <span class="fu">length</span>(chosen_indices);</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a> fit_ACN_opt  <span class="ot">=</span> mod_analytes_ACN<span class="sc">$</span><span class="fu">optimize</span>(</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data,</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_dir =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"stanfiles"</span>),</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_basename =</span> S,</span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>   <span class="at">seed =</span> cseed,</span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>   <span class="at">init =</span> init_ma,</span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">jacobian =</span> <span class="cn">TRUE</span>,</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>   <span class="at">show_messages =</span> F)</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a> mode<span class="ot">=</span>fit_ACN_opt<span class="sc">$</span><span class="fu">unconstrain_variables</span>(<span class="fu">list</span>(<span class="at">param =</span> fit_ACN_opt<span class="sc">$</span><span class="fu">mle</span>(<span class="st">"param"</span>)))</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a> hessian <span class="ot">=</span> fit_ACN_opt<span class="sc">$</span><span class="fu">hessian</span>(<span class="at">unconstrained_variables =</span> mode)<span class="sc">$</span>hessian</span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>logdet <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span>data<span class="sc">$</span>nAnalytes,\(i) <span class="fu">log</span>(<span class="fu">det</span>(<span class="sc">-</span>hessian[((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span>),((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span>)]))))</span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(logdet)</span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">33</span>)</span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a><span class="co"># quick test:</span></span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a>z_prior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan_ACN</span>(datastruct_prior_ma_ACN[[i]], inits_ACN[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a>z_noprior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan_ACN</span>(datastruct_noprior_ma_ACN[[i]], inits_ACN[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb149-30"><a href="#cb149-30" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(<span class="fu">unlist</span>(z_prior)),<span class="fu">mean</span>(<span class="fu">unlist</span>(z_noprior)))</span>
<span id="cb149-31"><a href="#cb149-31" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.059532 7.116247</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"8.059532 7.116247"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "8.059532 7.116247"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>logP <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_prior_ma_ACN),\(i) datastruct_prior_ma_ACN[[i]]<span class="sc">$</span>logPobs))</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>NAB <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_prior_ma_ACN),\(i) datastruct_prior_ma_ACN[[i]]<span class="sc">$</span>N1A2B3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="optimization-2" class="level2">
<h2 class="anchored" data-anchor-id="optimization-2">Optimization</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>) <span class="co"># initial values</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>fws_ACN_prior_1 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">33</span>) <span class="co"># initial values</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>fws_ACN_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">33</span>) <span class="co"># initial values</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>fws_ACN_noprior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">33</span>,<span class="dv">16</span>) <span class="co"># initial values</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>fws_ACN_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">33</span>,<span class="dv">36</span>) <span class="co"># initial values</span></span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>fws_ACN_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">34</span>,<span class="dv">33</span>,<span class="dv">16</span>) <span class="co"># initial values</span></span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>fws_ACN_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">34</span>,<span class="dv">33</span>,<span class="dv">16</span>) <span class="co"># initial values</span></span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>fws_ACN_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="read-the-results-and-compare-3" class="level3">
<h3 class="anchored" data-anchor-id="read-the-results-and-compare-3">Read the results and compare</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">33</span>) <span class="co"># ref</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">33</span>) <span class="co"># ref</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>fws_ACN_prior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>fws_ACN_noprior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>) <span class="co"># p=1</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>fws_ACN_prior_1 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">33</span>) <span class="co"># p=2</span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">33</span>) <span class="co"># p=2</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>fws_ACN_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>fws_ACN_noprior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">33</span>, <span class="dv">36</span>) <span class="co"># p=3</span></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">33</span>, <span class="dv">36</span>) <span class="co"># p=3</span></span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>fws_ACN_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>fws_ACN_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">36</span>, <span class="dv">33</span>, <span class="dv">11</span>) <span class="co"># p=4</span></span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">34</span>, <span class="dv">33</span>, <span class="dv">36</span>) <span class="co"># p=4</span></span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a>fws_ACN_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a>fws_ACN_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>summary_results <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Type =</span> NAB,</span>
<span id="cb155-26"><a href="#cb155-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">prior_ref =</span> fws_ACN_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-27"><a href="#cb155-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_ref =</span> fws_ACN_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-28"><a href="#cb155-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_1 =</span> fws_ACN_prior_1<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-29"><a href="#cb155-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_2 =</span> fws_ACN_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-30"><a href="#cb155-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_2 =</span> fws_ACN_noprior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-31"><a href="#cb155-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_3 =</span> fws_ACN_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-32"><a href="#cb155-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_3 =</span> fws_ACN_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-33"><a href="#cb155-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_4 =</span> fws_ACN_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-34"><a href="#cb155-34" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_4 =</span> fws_ACN_noprior_4<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb155-35"><a href="#cb155-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(prior_ref<span class="sc">:</span>noprior_4, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb155-36"><a href="#cb155-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-37"><a href="#cb155-37" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">ggplot</span>(summary_results, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value))<span class="sc">+</span></span>
<span id="cb155-38"><a href="#cb155-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb155-39"><a href="#cb155-39" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>value, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb155-40"><a href="#cb155-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb155-41"><a href="#cb155-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"log(|FIM|)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)</span>
<span id="cb155-42"><a href="#cb155-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-43"><a href="#cb155-43" aria-hidden="true" tabindex="-1"></a>summary_results_diff <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb155-44"><a href="#cb155-44" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Type =</span> NAB,</span>
<span id="cb155-45"><a href="#cb155-45" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fws_prior_ref =</span> fws_ACN_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-46"><a href="#cb155-46" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_ACN_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-47"><a href="#cb155-47" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_1 =</span> fws_ACN_prior_1<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-48"><a href="#cb155-48" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_2 =</span> fws_ACN_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-49"><a href="#cb155-49" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_2 =</span> fws_ACN_noprior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-50"><a href="#cb155-50" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_ACN_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-51"><a href="#cb155-51" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_ACN_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-52"><a href="#cb155-52" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_ACN_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-53"><a href="#cb155-53" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_ACN_noprior_4<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb155-54"><a href="#cb155-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_prior_1 =</span> (fws_prior_1 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb155-55"><a href="#cb155-55" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_2 =</span> (fws_prior_2 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb155-56"><a href="#cb155-56" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_2 =</span> (fws_noprior_2 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb155-57"><a href="#cb155-57" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_3 =</span> (fws_prior_3 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb155-58"><a href="#cb155-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_3 =</span> (fws_noprior_3 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb155-59"><a href="#cb155-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_4 =</span> (fws_prior_4 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb155-60"><a href="#cb155-60" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_4 =</span> (fws_noprior_4 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb155-61"><a href="#cb155-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_prior_1<span class="sc">:</span>d_noprior_4, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb155-62"><a href="#cb155-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-63"><a href="#cb155-63" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diff, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb155-64"><a href="#cb155-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb155-65"><a href="#cb155-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb155-66"><a href="#cb155-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb155-67"><a href="#cb155-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Efficiency relative to the reference design"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb155-68"><a href="#cb155-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)</span>
<span id="cb155-69"><a href="#cb155-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-70"><a href="#cb155-70" aria-hidden="true" tabindex="-1"></a>summary_results_diffprior <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb155-71"><a href="#cb155-71" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Type =</span> NAB,</span>
<span id="cb155-72"><a href="#cb155-72" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fws_prior_ref =</span> fws_ACN_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-73"><a href="#cb155-73" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_ACN_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-74"><a href="#cb155-74" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_2 =</span> fws_ACN_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-75"><a href="#cb155-75" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_2 =</span> fws_ACN_noprior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-76"><a href="#cb155-76" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_ACN_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-77"><a href="#cb155-77" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_ACN_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-78"><a href="#cb155-78" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_ACN_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb155-79"><a href="#cb155-79" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_ACN_noprior_4<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb155-80"><a href="#cb155-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_ref  =</span> (fws_prior_ref<span class="sc">-</span>fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb155-81"><a href="#cb155-81" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_2 =</span> (fws_prior_2<span class="sc">-</span>fws_noprior_2)<span class="sc">/</span>n_param,</span>
<span id="cb155-82"><a href="#cb155-82" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_3 =</span> (fws_prior_3<span class="sc">-</span>fws_noprior_3)<span class="sc">/</span>n_param,</span>
<span id="cb155-83"><a href="#cb155-83" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_4 =</span> (fws_prior_4<span class="sc">-</span>fws_noprior_4)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb155-84"><a href="#cb155-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_ref<span class="sc">:</span>d_4, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb155-85"><a href="#cb155-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-86"><a href="#cb155-86" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diffprior, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb155-87"><a href="#cb155-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb155-88"><a href="#cb155-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb155-89"><a href="#cb155-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb155-90"><a href="#cb155-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Effect of prior on design efficiency"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb155-91"><a href="#cb155-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb155-92"><a href="#cb155-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">100</span>),</span>
<span id="cb155-93"><a href="#cb155-93" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb155-94"><a href="#cb155-94" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">100</span>)),</span>
<span id="cb155-95"><a href="#cb155-95" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb155-96"><a href="#cb155-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-97"><a href="#cb155-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-98"><a href="#cb155-98" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-ACN-logDet-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-ACN-logDet-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-ACN-logDet-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>f2_4 <span class="ot">=</span> p2</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>f3_4 <span class="ot">=</span> p3</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-logdFIM-abs.pdf"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-logdFIM-abs.png"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-logdFIM-rel.pdf"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-logdFIM-rel.png"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-logdFIM-prioreff.pdf"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-logdFIM-prioreff.png"</span>), <span class="at">.path =</span> figures_dir4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="table-3" class="level3">
<h3 class="anchored" data-anchor-id="table-3">Table</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>data_ma_ACN<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>, m<span class="sc">==</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">line=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>combined_results <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="at">prior_ref =</span> fws_MeOH_prior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_ref =</span> fws_ACN_noprior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_1 =</span> fws_ACN_prior_1<span class="sc">$</span>chosen_indices,</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a><span class="at">prior_1 =</span> <span class="dv">10000</span><span class="sc">+</span>fws_ACN_prior_1<span class="sc">$</span>chosen_indices,</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_2 =</span> fws_ACN_prior_2<span class="sc">$</span>chosen_indices,</span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_2 =</span> fws_ACN_noprior_2<span class="sc">$</span>chosen_indices,</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_3 =</span> fws_ACN_prior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_3 =</span> fws_ACN_noprior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_4 =</span> fws_ACN_prior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_4 =</span> fws_ACN_noprior_4<span class="sc">$</span>chosen_indices)</span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>selected_exp <span class="ot">=</span> <span class="fu">enframe</span>(combined_results)<span class="sc">%&gt;%</span></span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">line=</span>value, <span class="at">Name =</span> name) <span class="sc">%&gt;%</span></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_ma_ACN, <span class="at">by =</span> <span class="st">"line"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(Name,tg, fio)<span class="sc">%&gt;%</span></span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(line,xpH,m,td,to,te,fif)) <span class="sc">%&gt;%</span></span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Name, <span class="st">'noprior'</span>), <span class="st">"No prior"</span>, <span class="st">"Prior"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a>tab1<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Prior"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-32"><a href="#cb159-32" aria-hidden="true" tabindex="-1"></a>tab2<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb159-33"><a href="#cb159-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"No prior"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb159-34"><a href="#cb159-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb159-35"><a href="#cb159-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb159-36"><a href="#cb159-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb159-37"><a href="#cb159-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-38"><a href="#cb159-38" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">set_formatter</span>(</span>
<span id="cb159-39"><a href="#cb159-39" aria-hidden="true" tabindex="-1"></a>  tab2, </span>
<span id="cb159-40"><a href="#cb159-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">tg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x) ),</span>
<span id="cb159-41"><a href="#cb159-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">fio =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, x) )</span>
<span id="cb159-42"><a href="#cb159-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb159-43"><a href="#cb159-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-44"><a href="#cb159-44" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab1, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>)</span>
<span id="cb159-45"><a href="#cb159-45" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab2, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>) </span>
<span id="cb159-46"><a href="#cb159-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-47"><a href="#cb159-47" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb159-48"><a href="#cb159-48" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(</span>
<span id="cb159-49"><a href="#cb159-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb159-50"><a href="#cb159-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>, <span class="at">color=</span><span class="cn">NA</span>),</span>
<span id="cb159-51"><a href="#cb159-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb159-52"><a href="#cb159-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb159-53"><a href="#cb159-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb159-54"><a href="#cb159-54" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>)</span>
<span id="cb159-55"><a href="#cb159-55" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb159-56"><a href="#cb159-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-57"><a href="#cb159-57" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> gg<span class="sc">+</span>p1<span class="sc">+</span>p2<span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb159-58"><a href="#cb159-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-59"><a href="#cb159-59" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-table.pdf"</span>), <span class="at">.path =</span> tables_dir4)</span>
<span id="cb159-60"><a href="#cb159-60" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-table.png"</span>), <span class="at">.path =</span> tables_dir4)</span>
<span id="cb159-61"><a href="#cb159-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-62"><a href="#cb159-62" aria-hidden="true" tabindex="-1"></a>tab1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-78687d4c{}.cl-785e5a9c{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7862715e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-78627168{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7862a0a2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7862a0ac{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7862a0b6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7862a0b7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7862a0c0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7862a0ca{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-78687d4c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-7862a0a2"><p class="cl-7862715e"><span class="cl-785e5a9c">Name</span></p></th><th class="cl-7862a0ac"><p class="cl-78627168"><span class="cl-785e5a9c">tg</span></p></th><th class="cl-7862a0ac"><p class="cl-78627168"><span class="cl-785e5a9c">fio</span></p></th><th class="cl-7862a0a2"><p class="cl-7862715e"><span class="cl-785e5a9c">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">prior_1</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">90</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">0.05</span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">-1</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">-1.00</span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">prior_2</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">40</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">0.20</span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">90</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">0.05</span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">prior_3</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">30</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">0.20</span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">90</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">0.05</span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">90</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">0.20</span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">prior_4</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">30</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">0.15</span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">30</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">0.20</span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">90</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">0.05</span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">90</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">0.20</span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">prior_ref</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">30</span></p></td><td class="cl-7862a0b7"><p class="cl-78627168"><span class="cl-785e5a9c">0.05</span></p></td><td class="cl-7862a0b6"><p class="cl-7862715e"><span class="cl-785e5a9c">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7862a0c0"><p class="cl-7862715e"><span class="cl-785e5a9c"></span></p></td><td class="cl-7862a0ca"><p class="cl-78627168"><span class="cl-785e5a9c">90</span></p></td><td class="cl-7862a0ca"><p class="cl-78627168"><span class="cl-785e5a9c">0.05</span></p></td><td class="cl-7862a0c0"><p class="cl-7862715e"><span class="cl-785e5a9c">ACN</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-78792200{}.cl-786ee43e{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-78731658{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7873166c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-78734312{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7873431c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-78734326{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-78734327{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-78734330{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-78734331{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-78792200"><thead><tr style="overflow-wrap:break-word;"><th class="cl-78734312"><p class="cl-78731658"><span class="cl-786ee43e">Name</span></p></th><th class="cl-7873431c"><p class="cl-7873166c"><span class="cl-786ee43e">tg</span></p></th><th class="cl-7873431c"><p class="cl-7873166c"><span class="cl-786ee43e">fio</span></p></th><th class="cl-78734312"><p class="cl-78731658"><span class="cl-786ee43e">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">noprior_2</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e"></span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">30</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">0.20</span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">90</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">0.05</span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">noprior_3</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e"></span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">30</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">0.20</span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">90</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">0.05</span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">90</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">0.20</span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">noprior_4</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e"></span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">30</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">0.20</span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">90</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">0.05</span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">90</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">0.10</span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">90</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">0.20</span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">noprior_ref</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e"></span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">30</span></p></td><td class="cl-78734327"><p class="cl-7873166c"><span class="cl-786ee43e">0.05</span></p></td><td class="cl-78734326"><p class="cl-78731658"><span class="cl-786ee43e">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78734330"><p class="cl-78731658"><span class="cl-786ee43e"></span></p></td><td class="cl-78734331"><p class="cl-7873166c"><span class="cl-786ee43e">90</span></p></td><td class="cl-78734331"><p class="cl-7873166c"><span class="cl-786ee43e">0.05</span></p></td><td class="cl-78734330"><p class="cl-78731658"><span class="cl-786ee43e">ACN</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="stan-simulations-3" class="level3">
<h3 class="anchored" data-anchor-id="stan-simulations-3">Stan simulations</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_ACN_prior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>prior_ma_ACN_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results_ACN</span>(mod_analytes_ACN_sim, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_ACN_noprior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>noprior_ma_ACN_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results_ACN</span>(mod_analytes_ACN_sim, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_ACN_prior_1<span class="sc">$</span>chosen_indices <span class="co"># p=1</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>prior_ma_ACN_1 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_ACN</span>(mod_analytes_ACN_sim, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_ACN_prior_2<span class="sc">$</span>chosen_indices <span class="co"># p=2</span></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>prior_ma_ACN_2 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_ACN</span>(mod_analytes_ACN_sim, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_ACN_noprior_2<span class="sc">$</span>chosen_indices <span class="co"># p=2</span></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>noprior_ma_ACN_2 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_ACN</span>(mod_analytes_ACN_sim, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_ACN_prior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>prior_ma_ACN_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_ACN</span>(mod_analytes_ACN_sim, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_ACN_noprior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>noprior_ma_ACN_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_ACN</span>(mod_analytes_ACN_sim, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_ACN_prior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>prior_ma_ACN_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_ACN</span>(mod_analytes_ACN_sim, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, <span class="dv">10</span>)</span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_ACN_noprior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a>noprior_ma_ACN_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results_ACN</span>(mod_analytes_ACN_sim, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="gradient-conditions-3" class="level4">
<h4 class="anchored" data-anchor-id="gradient-conditions-3">Gradient conditions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_ACN_prior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>p31<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>, m<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(prior_ma_ACN_3<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"ACN"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_ACN_noprior_3<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>p32<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>, m<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(noprior_ma_ACN_3<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"ACN"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a>iresults <span class="ot">=</span> <span class="fu">rbind</span>( prior_ma_ACN_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb162-27"><a href="#cb162-27" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ACN_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb162-28"><a href="#cb162-28" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb162-29"><a href="#cb162-29" aria-hidden="true" tabindex="-1"></a>                prior_ma_ACN_1<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb162-30"><a href="#cb162-30" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_1"</span>),</span>
<span id="cb162-31"><a href="#cb162-31" aria-hidden="true" tabindex="-1"></a>                 prior_ma_ACN_2<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb162-32"><a href="#cb162-32" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb162-33"><a href="#cb162-33" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ACN_2<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb162-34"><a href="#cb162-34" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_2"</span>),</span>
<span id="cb162-35"><a href="#cb162-35" aria-hidden="true" tabindex="-1"></a>                 prior_ma_ACN_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb162-36"><a href="#cb162-36" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb162-37"><a href="#cb162-37" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ACN_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb162-38"><a href="#cb162-38" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb162-39"><a href="#cb162-39" aria-hidden="true" tabindex="-1"></a>                 prior_ma_ACN_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb162-40"><a href="#cb162-40" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb162-41"><a href="#cb162-41" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ACN_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb162-42"><a href="#cb162-42" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb162-43"><a href="#cb162-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ivar =</span> <span class="fu">if_else</span>(ivar<span class="sc">&gt;</span><span class="fl">1e6</span>,<span class="fl">1e6</span>,ivar))<span class="sc">%&gt;%</span></span>
<span id="cb162-44"><a href="#cb162-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.factor</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB))</span>
<span id="cb162-45"><a href="#cb162-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-46"><a href="#cb162-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-47"><a href="#cb162-47" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb162-48"><a href="#cb162-48" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb162-49"><a href="#cb162-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb162-50"><a href="#cb162-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb162-51"><a href="#cb162-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb162-52"><a href="#cb162-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb162-53"><a href="#cb162-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb162-54"><a href="#cb162-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb162-55"><a href="#cb162-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb162-56"><a href="#cb162-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb162-57"><a href="#cb162-57" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb162-58"><a href="#cb162-58" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb162-59"><a href="#cb162-59" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb162-60"><a href="#cb162-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb162-61"><a href="#cb162-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb162-62"><a href="#cb162-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb162-63"><a href="#cb162-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb162-64"><a href="#cb162-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb162-65"><a href="#cb162-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">1000000</span>))<span class="sc">+</span></span>
<span id="cb162-66"><a href="#cb162-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb162-67"><a href="#cb162-67" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb162-68"><a href="#cb162-68" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb162-69"><a href="#cb162-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-70"><a href="#cb162-70" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb162-71"><a href="#cb162-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb162-72"><a href="#cb162-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-73"><a href="#cb162-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-74"><a href="#cb162-74" aria-hidden="true" tabindex="-1"></a>idx_exemple_analytes <span class="ot">=</span> iresults <span class="sc">%&gt;%</span></span>
<span id="cb162-75"><a href="#cb162-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">==</span><span class="st">"prior_ref"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb162-76"><a href="#cb162-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ivar)<span class="sc">%&gt;%</span></span>
<span id="cb162-77"><a href="#cb162-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which</span>(<span class="fu">row_number</span>() <span class="sc">%%</span> <span class="dv">100</span> <span class="sc">==</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb162-78"><a href="#cb162-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(i)<span class="sc">%&gt;%</span><span class="fu">pull</span>()</span>
<span id="cb162-79"><a href="#cb162-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-80"><a href="#cb162-80" aria-hidden="true" tabindex="-1"></a>iresults <span class="sc">%&gt;%</span></span>
<span id="cb162-81"><a href="#cb162-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb162-82"><a href="#cb162-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb162-83"><a href="#cb162-83" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb162-84"><a href="#cb162-84" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb162-85"><a href="#cb162-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-78df4062{}.cl-78d254ba{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-78d901fc{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-78d90210{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-78d931ae{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-78d931b8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-78d931c2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-78d931cc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-78d931d6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-78d931d7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-78df4062"><thead><tr style="overflow-wrap:break-word;"><th class="cl-78d931ae"><p class="cl-78d901fc"><span class="cl-78d254ba">method</span></p></th><th class="cl-78d931b8"><p class="cl-78d90210"><span class="cl-78d254ba">&lt;=1x</span></p></th><th class="cl-78d931b8"><p class="cl-78d90210"><span class="cl-78d254ba">&lt;=2x</span></p></th><th class="cl-78d931b8"><p class="cl-78d90210"><span class="cl-78d254ba">&lt;=3x</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-78d931c2"><p class="cl-78d901fc"><span class="cl-78d254ba">noprior_2</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.030</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.570</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.814</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78d931c2"><p class="cl-78d901fc"><span class="cl-78d254ba">noprior_3</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.344</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.878</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.930</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78d931c2"><p class="cl-78d901fc"><span class="cl-78d254ba">noprior_4</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.410</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.902</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.942</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78d931c2"><p class="cl-78d901fc"><span class="cl-78d254ba">noprior_ref</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.000</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.348</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.464</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78d931c2"><p class="cl-78d901fc"><span class="cl-78d254ba">prior_1</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.060</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.126</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.360</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78d931c2"><p class="cl-78d901fc"><span class="cl-78d254ba">prior_2</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.326</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.898</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.970</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78d931c2"><p class="cl-78d901fc"><span class="cl-78d254ba">prior_3</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.722</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.990</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.992</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78d931c2"><p class="cl-78d901fc"><span class="cl-78d254ba">prior_4</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.956</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.994</span></p></td><td class="cl-78d931cc"><p class="cl-78d90210"><span class="cl-78d254ba">0.994</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-78d931d6"><p class="cl-78d901fc"><span class="cl-78d254ba">prior_ref</span></p></td><td class="cl-78d931d7"><p class="cl-78d90210"><span class="cl-78d254ba">0.148</span></p></td><td class="cl-78d931d7"><p class="cl-78d90210"><span class="cl-78d254ba">0.624</span></p></td><td class="cl-78d931d7"><p class="cl-78d90210"><span class="cl-78d254ba">0.914</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>f55_4<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">"target"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value,<span class="at">color=</span><span class="fu">as.factor</span>(target)))<span class="sc">+</span></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Probability"</span>, <span class="at">y =</span> <span class="st">"Method"</span>, <span class="at">color =</span> <span class="st">"target"</span>)<span class="sc">+</span></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.9</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>f55_4, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-gra-prob.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>f55_4, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-gra-prob.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-gra-prior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-gra-prior-p5.png"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-ACN-noprior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-gra-noprior-p5.png"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-ACN-maxvar.pdf"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-ACN-gra-maxvar.png"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a>p31</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-gra-ACN-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>p32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-gra-ACN-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-gra-ACN-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>f33_4<span class="ot">=</span>p33</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>f55_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-gra-ACN-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="isocratic-conditions-2" class="level4">
<h4 class="anchored" data-anchor-id="isocratic-conditions-2">Isocratic conditions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>plot_id <span class="ot">=</span> <span class="cf">function</span>(results) {</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  results <span class="sc">%&gt;%</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>CV<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">ymin =</span> llog10tr, <span class="at">ymax =</span> ulog10tr), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>mlog10tr), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"log(tr)"</span>,</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">10</span>, <span class="at">name=</span><span class="st">"%CV"</span>)) <span class="sc">+</span></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(i<span class="sc">~</span>mod) <span class="sc">+</span></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a>results_prior_ma_ACN_ref<span class="ot">&lt;-</span>prior_ma_ACN_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-27"><a href="#cb167-27" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_ACN_ref<span class="ot">&lt;-</span>noprior_ma_ACN_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb167-28"><a href="#cb167-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb167-29"><a href="#cb167-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb167-30"><a href="#cb167-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb167-31"><a href="#cb167-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb167-32"><a href="#cb167-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb167-33"><a href="#cb167-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb167-34"><a href="#cb167-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-35"><a href="#cb167-35" aria-hidden="true" tabindex="-1"></a>results_prior_ma_ACN_1<span class="ot">&lt;-</span>prior_ma_ACN_1<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb167-36"><a href="#cb167-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb167-37"><a href="#cb167-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb167-38"><a href="#cb167-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb167-39"><a href="#cb167-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb167-40"><a href="#cb167-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb167-41"><a href="#cb167-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb167-42"><a href="#cb167-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-43"><a href="#cb167-43" aria-hidden="true" tabindex="-1"></a>results_prior_ma_ACN_2<span class="ot">&lt;-</span>prior_ma_ACN_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb167-44"><a href="#cb167-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb167-45"><a href="#cb167-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb167-46"><a href="#cb167-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb167-47"><a href="#cb167-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb167-48"><a href="#cb167-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> mrgmisc<span class="sc">::</span><span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb167-49"><a href="#cb167-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb167-50"><a href="#cb167-50" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_ACN_2<span class="ot">&lt;-</span>noprior_ma_ACN_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb167-51"><a href="#cb167-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb167-52"><a href="#cb167-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb167-53"><a href="#cb167-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb167-54"><a href="#cb167-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb167-55"><a href="#cb167-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb167-56"><a href="#cb167-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb167-57"><a href="#cb167-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-58"><a href="#cb167-58" aria-hidden="true" tabindex="-1"></a>results_prior_ma_ACN_3<span class="ot">&lt;-</span>prior_ma_ACN_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb167-59"><a href="#cb167-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb167-60"><a href="#cb167-60" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb167-61"><a href="#cb167-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb167-62"><a href="#cb167-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb167-63"><a href="#cb167-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb167-64"><a href="#cb167-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb167-65"><a href="#cb167-65" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_ACN_3<span class="ot">&lt;-</span>noprior_ma_ACN_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb167-66"><a href="#cb167-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb167-67"><a href="#cb167-67" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb167-68"><a href="#cb167-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb167-69"><a href="#cb167-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb167-70"><a href="#cb167-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb167-71"><a href="#cb167-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb167-72"><a href="#cb167-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-73"><a href="#cb167-73" aria-hidden="true" tabindex="-1"></a>results_prior_ma_ACN_4<span class="ot">&lt;-</span>prior_ma_ACN_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb167-74"><a href="#cb167-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb167-75"><a href="#cb167-75" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb167-76"><a href="#cb167-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb167-77"><a href="#cb167-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb167-78"><a href="#cb167-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb167-79"><a href="#cb167-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb167-80"><a href="#cb167-80" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_ACN_4<span class="ot">&lt;-</span>noprior_ma_ACN_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb167-81"><a href="#cb167-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb167-82"><a href="#cb167-82" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb167-83"><a href="#cb167-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb167-84"><a href="#cb167-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb167-85"><a href="#cb167-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb167-86"><a href="#cb167-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb167-87"><a href="#cb167-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-88"><a href="#cb167-88" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ACN_ref <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_ACN_ref,plot_id)</span>
<span id="cb167-89"><a href="#cb167-89" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ACN_ref <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_ACN_ref,plot_id)</span>
<span id="cb167-90"><a href="#cb167-90" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ACN_1 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_ACN_1,plot_id)</span>
<span id="cb167-91"><a href="#cb167-91" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ACN_2 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_ACN_2,plot_id)</span>
<span id="cb167-92"><a href="#cb167-92" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ACN_2 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_ACN_2,plot_id)</span>
<span id="cb167-93"><a href="#cb167-93" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ACN_3 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_ACN_3,plot_id)</span>
<span id="cb167-94"><a href="#cb167-94" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ACN_3 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_ACN_3,plot_id)</span>
<span id="cb167-95"><a href="#cb167-95" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ACN_4 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_ACN_4,plot_id)</span>
<span id="cb167-96"><a href="#cb167-96" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ACN_4 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_ACN_4,plot_id)</span>
<span id="cb167-97"><a href="#cb167-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-98"><a href="#cb167-98" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_ACN_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ACN-ref.pdf"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb167-99"><a href="#cb167-99" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_ACN_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ACN-ref.png"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb167-100"><a href="#cb167-100" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_ACN_3[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ACN-3.pdf"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb167-101"><a href="#cb167-101" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_ACN_3[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ACN-3.png"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb167-102"><a href="#cb167-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-103"><a href="#cb167-103" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ACN_ref</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-ACN-izo-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ACN_ref</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-ACN-izo-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ACN_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-ACN-izo-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ACN_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-ACN-izo-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ACN_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-ACN-izo-summary-5.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ACN_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-ACN-izo-summary-6.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ACN_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-ACN-izo-summary-7.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ACN_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-ACN-izo-summary-8.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ACN_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-ACN-izo-summary-9.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="combined-3" class="level5">
<h5 class="anchored" data-anchor-id="combined-3">Combined</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>izoresults <span class="ot">=</span> <span class="fu">rbind</span>(prior_ma_ACN_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ACN_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>                prior_ma_ACN_1<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_1"</span>),</span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>                 prior_ma_ACN_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ACN_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_2"</span>),</span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a>                 prior_ma_ACN_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ACN_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a>                 prior_ma_ACN_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb186-18"><a href="#cb186-18" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb186-19"><a href="#cb186-19" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ACN_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb186-20"><a href="#cb186-20" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb186-21"><a href="#cb186-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&lt;=</span><span class="fu">log10</span>(<span class="dv">100</span>))<span class="sc">%&gt;%</span></span>
<span id="cb186-22"><a href="#cb186-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&gt;=</span><span class="fu">log10</span>(<span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb186-23"><a href="#cb186-23" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.numeric</span>(c),</span>
<span id="cb186-24"><a href="#cb186-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb186-25"><a href="#cb186-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(i,method,c)<span class="sc">%&gt;%</span></span>
<span id="cb186-26"><a href="#cb186-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(i,method) <span class="sc">%&gt;%</span></span>
<span id="cb186-27"><a href="#cb186-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">imaxcv =</span> <span class="fu">max</span>(CV), <span class="at">imincv =</span> <span class="fu">min</span>(CV), <span class="at">aveCV =</span> pracma<span class="sc">::</span><span class="fu">trapz</span>(c, CV)<span class="sc">/</span>(<span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb186-28"><a href="#cb186-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">imaxcv =</span> <span class="fu">if_else</span>(imaxcv<span class="sc">&gt;</span><span class="fl">1e4</span>,<span class="fl">1e4</span>,imaxcv))<span class="sc">%&gt;%</span></span>
<span id="cb186-29"><a href="#cb186-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.integer</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB)) </span>
<span id="cb186-30"><a href="#cb186-30" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb186-31"><a href="#cb186-31" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb186-32"><a href="#cb186-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb186-33"><a href="#cb186-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb186-34"><a href="#cb186-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb186-35"><a href="#cb186-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb186-36"><a href="#cb186-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb186-37"><a href="#cb186-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb186-38"><a href="#cb186-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb186-39"><a href="#cb186-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb186-40"><a href="#cb186-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb186-41"><a href="#cb186-41" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb186-42"><a href="#cb186-42" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb186-43"><a href="#cb186-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-44"><a href="#cb186-44" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb186-45"><a href="#cb186-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb186-46"><a href="#cb186-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb186-47"><a href="#cb186-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb186-48"><a href="#cb186-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb186-49"><a href="#cb186-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb186-50"><a href="#cb186-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb186-51"><a href="#cb186-51" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb186-52"><a href="#cb186-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">10000</span>))<span class="sc">+</span>    </span>
<span id="cb186-53"><a href="#cb186-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb186-54"><a href="#cb186-54" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb186-55"><a href="#cb186-55" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb186-56"><a href="#cb186-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-57"><a href="#cb186-57" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb186-58"><a href="#cb186-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb186-59"><a href="#cb186-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-60"><a href="#cb186-60" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-ACN-izo-combined-CV.pdf"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb186-61"><a href="#cb186-61" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-ACN-izo-combined-CV.png"</span>), <span class="at">.path =</span> figures_dir4)</span>
<span id="cb186-62"><a href="#cb186-62" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/single-form-analytes-izo-summary-ACN-combined-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>f44_4 <span class="ot">=</span> p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
</section>
</section>
<section id="manuscript-plots" class="level1">
<h1>Manuscript plots</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>figure1 <span class="ot">&lt;-</span> ((f2_3<span class="sc">|</span>f2_4)<span class="sc">/</span>(f2_1<span class="sc">|</span>f2_2))<span class="sc">+</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)<span class="sc">+</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">&amp;</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>,<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>figure1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"eficiency_relative.pdf"</span>), <span class="at">.path =</span> figures_dir5)</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>figure1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"eficiency_relative.png"</span>), <span class="at">.path =</span> figures_dir5)</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>figure2 <span class="ot">&lt;-</span> ((f3_3<span class="sc">|</span>f3_4)<span class="sc">/</span>(f3_1<span class="sc">|</span>f3_2))<span class="sc">+</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)<span class="sc">+</span></span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">&amp;</span></span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>,<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>                                <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>                                <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))</span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>figure2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"eficiency_prior.pdf"</span>), <span class="at">.path =</span> figures_dir5)</span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>figure2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"eficiency_prior.png"</span>), <span class="at">.path =</span> figures_dir5)</span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-19"><a href="#cb188-19" aria-hidden="true" tabindex="-1"></a>figure3 <span class="ot">&lt;-</span> ((f33_3<span class="sc">|</span>f33_4)<span class="sc">/</span>(f33_1<span class="sc">|</span>f33_2))<span class="sc">+</span></span>
<span id="cb188-20"><a href="#cb188-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)<span class="sc">+</span></span>
<span id="cb188-21"><a href="#cb188-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">" "</span>,<span class="st">"B"</span>,<span class="st">" "</span>,<span class="st">"C"</span>,<span class="st">" "</span>,<span class="st">"D"</span>, <span class="st">""</span>))) <span class="sc">&amp;</span></span>
<span id="cb188-22"><a href="#cb188-22" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>,<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb188-23"><a href="#cb188-23" aria-hidden="true" tabindex="-1"></a>                                <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb188-24"><a href="#cb188-24" aria-hidden="true" tabindex="-1"></a>                                <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))</span>
<span id="cb188-25"><a href="#cb188-25" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>figure3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"max_standardized_variance.pdf"</span>), <span class="at">.path =</span> figures_dir5)</span>
<span id="cb188-26"><a href="#cb188-26" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>figure3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"max_standardized_variance.png"</span>), <span class="at">.path =</span> figures_dir5)</span>
<span id="cb188-27"><a href="#cb188-27" aria-hidden="true" tabindex="-1"></a>figure4 <span class="ot">&lt;-</span> ((f44_3<span class="sc">|</span>f44_4)<span class="sc">/</span>(f44_1<span class="sc">|</span>f44_2))<span class="sc">+</span></span>
<span id="cb188-28"><a href="#cb188-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)<span class="sc">+</span></span>
<span id="cb188-29"><a href="#cb188-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">" "</span>,<span class="st">"B"</span>,<span class="st">" "</span>,<span class="st">"C"</span>,<span class="st">" "</span>,<span class="st">"D"</span>, <span class="st">""</span>))) <span class="sc">&amp;</span></span>
<span id="cb188-30"><a href="#cb188-30" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>,<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb188-31"><a href="#cb188-31" aria-hidden="true" tabindex="-1"></a>                                <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb188-32"><a href="#cb188-32" aria-hidden="true" tabindex="-1"></a>                                <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))</span>
<span id="cb188-33"><a href="#cb188-33" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>figure4, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"cv_izo.pdf"</span>), <span class="at">.path =</span> figures_dir5)</span>
<span id="cb188-34"><a href="#cb188-34" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>figure4, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"cv_izo.pdf.png"</span>), <span class="at">.path =</span> figures_dir5)</span>
<span id="cb188-35"><a href="#cb188-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-36"><a href="#cb188-36" aria-hidden="true" tabindex="-1"></a>figure5 <span class="ot">&lt;-</span> ((f55_3<span class="sc">|</span>f55_4)<span class="sc">/</span>(f55_1<span class="sc">|</span>f55_2))<span class="sc">+</span></span>
<span id="cb188-37"><a href="#cb188-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)<span class="sc">+</span></span>
<span id="cb188-38"><a href="#cb188-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">&amp;</span></span>
<span id="cb188-39"><a href="#cb188-39" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>,<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb188-40"><a href="#cb188-40" aria-hidden="true" tabindex="-1"></a>                                <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb188-41"><a href="#cb188-41" aria-hidden="true" tabindex="-1"></a>                                <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))</span>
<span id="cb188-42"><a href="#cb188-42" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>figure5, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"max_standardized_variance_probability.pdf"</span>), <span class="at">.path =</span> figures_dir5)</span>
<span id="cb188-43"><a href="#cb188-43" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>figure5, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"max_standardized_variance_probability.png"</span>), <span class="at">.path =</span> figures_dir5)</span>
<span id="cb188-44"><a href="#cb188-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-45"><a href="#cb188-45" aria-hidden="true" tabindex="-1"></a>figure1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/composite-plots-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>figure2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/composite-plots-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>figure3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/composite-plots-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>figure4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/composite-plots-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>figure5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_all_files/figure-html/composite-plots-5.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="st">"results-mixtures-d2-temp.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" role="list">

</div>
</section>
<section id="licenses" class="level1 unnumbered">
<h1 class="unnumbered">Licenses</h1>
<ul>
<li>Code &amp; copy; 2024, Paweł Wiczling, licensed under BSD-3.</li>
<li>Text &amp; copy; 2024, Paweł Wiczling, licensed under CC-BY-NC 4.0.</li>
</ul>
</section>
<section id="original-computing-environment" class="level1 unnumbered">
<h1 class="unnumbered">Original Computing Environment</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.3 (2024-02-29)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 24.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: Europe/Warsaw
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] flextable_0.9.7     tibble_3.2.1        here_1.0.1         
 [4] reshape2_1.4.4      stringr_1.5.1       patchwork_1.3.0    
 [7] mrgmisc_0.2.1       purrr_1.0.2         tidyr_1.3.1        
[10] mvtnorm_1.3-1       ggplot2_3.5.1       dplyr_1.1.4        
[13] numDeriv_2016.8-1.1 pracma_2.4.4        cmdstanr_0.8.1     

loaded via a namespace (and not attached):
 [1] gtable_0.3.5            tensorA_0.36.2.1        xfun_0.48              
 [4] htmlwidgets_1.6.4       processx_3.8.4          vctrs_0.6.5            
 [7] tools_4.3.3             ps_1.8.0                generics_0.1.3         
[10] parallel_4.3.3          fansi_1.0.6             pkgconfig_2.0.3        
[13] data.table_1.16.2       checkmate_2.3.2         uuid_1.2-1             
[16] distributional_0.5.0    lifecycle_1.0.4         compiler_4.3.3         
[19] farver_2.1.2            textshaping_0.4.0       munsell_0.5.1          
[22] codetools_0.2-19        fontquiver_0.2.1        fontLiberation_0.1.0   
[25] htmltools_0.5.8.1       yaml_2.3.10             pillar_1.9.0           
[28] openssl_2.2.2           abind_1.4-8             fontBitstreamVera_0.1.1
[31] posterior_1.6.0         zip_2.3.1               tidyselect_1.2.1       
[34] digest_0.6.37           stringi_1.8.4           labeling_0.4.3         
[37] rprojroot_2.0.4         fastmap_1.2.0           grid_4.3.3             
[40] colorspace_2.1-1        cli_3.6.3               magrittr_2.0.3         
[43] utf8_1.2.4              withr_3.0.1             gdtools_0.4.0          
[46] scales_1.3.0            backports_1.5.0         rmarkdown_2.28         
[49] officer_0.6.7           askpass_1.2.1           ragg_1.3.3             
[52] evaluate_1.0.1          knitr_1.48              viridisLite_0.4.2      
[55] rlang_1.1.4             isoband_0.2.7           Rcpp_1.0.13            
[58] glue_1.8.0              xml2_1.3.6              rstudioapi_0.17.0      
[61] jsonlite_1.8.9          R6_2.5.1                plyr_1.8.9             
[64] systemfonts_1.1.0      </code></pre>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb196" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC"</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Paweł Wiczling*"</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="co">      - name: "Department of Biopharmaceutics and Pharmacodynamics, Medical University of Gdańsk, Gen. J. Hallera 107, 80-416 Gdańsk, Poland"</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.Date())`"</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true  </span></span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 7</span></span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 7</span></span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setuphtml, include=FALSE}</span></span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(cache=TRUE, message=FALSE, error=FALSE, warning=FALSE, comment=NA, out.width='95%')</span></span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a><span class="in">#usethis::create_github_token()</span></span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup</span></span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a>The packages we will use are listed below.</span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a><span class="in">library(cmdstanr)</span></span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true" tabindex="-1"></a><span class="in">library(pracma)</span></span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true" tabindex="-1"></a><span class="in">library(numDeriv)</span></span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb196-32"><a href="#cb196-32" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb196-33"><a href="#cb196-33" aria-hidden="true" tabindex="-1"></a><span class="in">library(mvtnorm)</span></span>
<span id="cb196-34"><a href="#cb196-34" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr)</span></span>
<span id="cb196-35"><a href="#cb196-35" aria-hidden="true" tabindex="-1"></a><span class="in">library(purrr)</span></span>
<span id="cb196-36"><a href="#cb196-36" aria-hidden="true" tabindex="-1"></a><span class="in">library(mrgmisc)</span></span>
<span id="cb196-37"><a href="#cb196-37" aria-hidden="true" tabindex="-1"></a><span class="in">library(patchwork)</span></span>
<span id="cb196-38"><a href="#cb196-38" aria-hidden="true" tabindex="-1"></a><span class="in">library(stringr)</span></span>
<span id="cb196-39"><a href="#cb196-39" aria-hidden="true" tabindex="-1"></a><span class="in">library(reshape2)</span></span>
<span id="cb196-40"><a href="#cb196-40" aria-hidden="true" tabindex="-1"></a><span class="in">library(here)</span></span>
<span id="cb196-41"><a href="#cb196-41" aria-hidden="true" tabindex="-1"></a><span class="in">library(tibble)</span></span>
<span id="cb196-42"><a href="#cb196-42" aria-hidden="true" tabindex="-1"></a><span class="in">library(flextable)</span></span>
<span id="cb196-43"><a href="#cb196-43" aria-hidden="true" tabindex="-1"></a><span class="in">select = dplyr::select</span></span>
<span id="cb196-44"><a href="#cb196-44" aria-hidden="true" tabindex="-1"></a><span class="in"># remotes::install_github("metrumresearchgroup/mrgmisc")</span></span>
<span id="cb196-45"><a href="#cb196-45" aria-hidden="true" tabindex="-1"></a><span class="in"># for parallel calculation use linux (mclaplly), i.e. Ubuntu 24.04 on Windows WSL</span></span>
<span id="cb196-46"><a href="#cb196-46" aria-hidden="true" tabindex="-1"></a><span class="in"># usethis::edit_r_environ(), add PROCESSX_NOTIFY_OLD_SIGCHLD = 1 ????</span></span>
<span id="cb196-47"><a href="#cb196-47" aria-hidden="true" tabindex="-1"></a><span class="in">#' Helper functions</span></span>
<span id="cb196-48"><a href="#cb196-48" aria-hidden="true" tabindex="-1"></a><span class="in">source("helper_functions.R")</span></span>
<span id="cb196-49"><a href="#cb196-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-50"><a href="#cb196-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-51"><a href="#cb196-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{r paths}</span></span>
<span id="cb196-52"><a href="#cb196-52" aria-hidden="true" tabindex="-1"></a><span class="in">#' folder shortcuts:</span></span>
<span id="cb196-53"><a href="#cb196-53" aria-hidden="true" tabindex="-1"></a><span class="in">figures_dir1 &lt;- here("deliv", "figures", "design2_all","N")</span></span>
<span id="cb196-54"><a href="#cb196-54" aria-hidden="true" tabindex="-1"></a><span class="in">tables_dir1  &lt;- here("deliv", "tables", "design2_all","N")</span></span>
<span id="cb196-55"><a href="#cb196-55" aria-hidden="true" tabindex="-1"></a><span class="in">figures_dir2 &lt;- here("deliv", "figures", "design2_all","NI")</span></span>
<span id="cb196-56"><a href="#cb196-56" aria-hidden="true" tabindex="-1"></a><span class="in">tables_dir2  &lt;- here("deliv", "tables", "design2_all","NI")</span></span>
<span id="cb196-57"><a href="#cb196-57" aria-hidden="true" tabindex="-1"></a><span class="in">figures_dir3 &lt;- here("deliv", "figures", "design2_all","MeOH")</span></span>
<span id="cb196-58"><a href="#cb196-58" aria-hidden="true" tabindex="-1"></a><span class="in">tables_dir3  &lt;- here("deliv", "tables", "design2_all","MeOH")</span></span>
<span id="cb196-59"><a href="#cb196-59" aria-hidden="true" tabindex="-1"></a><span class="in">figures_dir4 &lt;- here("deliv", "figures", "design2_all","ACN")</span></span>
<span id="cb196-60"><a href="#cb196-60" aria-hidden="true" tabindex="-1"></a><span class="in">tables_dir4  &lt;- here("deliv", "tables", "design2_all","ACN")</span></span>
<span id="cb196-61"><a href="#cb196-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-62"><a href="#cb196-62" aria-hidden="true" tabindex="-1"></a><span class="in">figures_dir5 &lt;- here("deliv", "figures", "manuscript_optional")</span></span>
<span id="cb196-63"><a href="#cb196-63" aria-hidden="true" tabindex="-1"></a><span class="in">tables_dir5  &lt;- here("deliv", "tables", "manuscript_optional")</span></span>
<span id="cb196-64"><a href="#cb196-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-65"><a href="#cb196-65" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(figures_dir1)) dir.create(figures_dir1, recursive = T)</span></span>
<span id="cb196-66"><a href="#cb196-66" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(tables_dir1)) dir.create(tables_dir1, recursive = T)</span></span>
<span id="cb196-67"><a href="#cb196-67" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(figures_dir2)) dir.create(figures_dir2, recursive = T)</span></span>
<span id="cb196-68"><a href="#cb196-68" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(tables_dir2)) dir.create(tables_dir2, recursive = T)</span></span>
<span id="cb196-69"><a href="#cb196-69" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(figures_dir3)) dir.create(figures_dir3, recursive = T)</span></span>
<span id="cb196-70"><a href="#cb196-70" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(tables_dir3)) dir.create(tables_dir3, recursive = T)</span></span>
<span id="cb196-71"><a href="#cb196-71" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(figures_dir4)) dir.create(figures_dir4, recursive = T)</span></span>
<span id="cb196-72"><a href="#cb196-72" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(tables_dir4)) dir.create(tables_dir4, recursive = T)</span></span>
<span id="cb196-73"><a href="#cb196-73" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(figures_dir5)) dir.create(figures_dir5, recursive = T)</span></span>
<span id="cb196-74"><a href="#cb196-74" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(tables_dir5)) dir.create(tables_dir5, recursive = T)</span></span>
<span id="cb196-75"><a href="#cb196-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-76"><a href="#cb196-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-77"><a href="#cb196-77" aria-hidden="true" tabindex="-1"></a><span class="in">thisScript &lt;- "optimal-design-for-mixtures-design2-all"</span></span>
<span id="cb196-78"><a href="#cb196-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-79"><a href="#cb196-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-80"><a href="#cb196-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r helper-save-functions}</span></span>
<span id="cb196-81"><a href="#cb196-81" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave &lt;- function(.plot, .filename, .path=figures_dir, .height= 7, .width= 6) {</span></span>
<span id="cb196-82"><a href="#cb196-82" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(plot=.plot, filename=.filename, path=.path, height=.height, width=.width)</span></span>
<span id="cb196-83"><a href="#cb196-83" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-84"><a href="#cb196-84" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png &lt;- function(.plot, .filename, .path=figures_dir, .height=7, .width= 6) {</span></span>
<span id="cb196-85"><a href="#cb196-85" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(plot=.plot, filename=.filename, path=.path, height=.height, width=.width)</span></span>
<span id="cb196-86"><a href="#cb196-86" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-87"><a href="#cb196-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-88"><a href="#cb196-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-89"><a href="#cb196-89" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb196-90"><a href="#cb196-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-91"><a href="#cb196-91" aria-hidden="true" tabindex="-1"></a><span class="fu"># Priors</span></span>
<span id="cb196-92"><a href="#cb196-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-93"><a href="#cb196-93" aria-hidden="true" tabindex="-1"></a>Priors are based on the follwoing article "Comparison of Chromatographic Stationary Phases Using a Bayesian-Based Multilevel Model" by Paweł Wiczling and Agnieszka Kamedulska published in Analytical Chemistry 2024 96 (3), 1310-1319. </span>
<span id="cb196-94"><a href="#cb196-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-95"><a href="#cb196-95" aria-hidden="true" tabindex="-1"></a>In this work a simplified approach is taken with the focus on the neutral, acidic and basic forms of an analytes and single chromatographic stationary phase - assuming the pKa and changes of pKa with organic modifier are known.</span>
<span id="cb196-96"><a href="#cb196-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-97"><a href="#cb196-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r literature-priors}</span></span>
<span id="cb196-98"><a href="#cb196-98" aria-hidden="true" tabindex="-1"></a><span class="in"># fun_generate_priors defined in helper_functions.R</span></span>
<span id="cb196-99"><a href="#cb196-99" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN_MeOH=fun_generate_priors("N_MeOH", logP=2.2)</span></span>
<span id="cb196-100"><a href="#cb196-100" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN_ACN=fun_generate_priors("N_ACN", logP=2.2)</span></span>
<span id="cb196-101"><a href="#cb196-101" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN=fun_generate_priors("N", logP=2.2)</span></span>
<span id="cb196-102"><a href="#cb196-102" aria-hidden="true" tabindex="-1"></a><span class="in">priorsA=fun_generate_priors("A", logP=2.2)</span></span>
<span id="cb196-103"><a href="#cb196-103" aria-hidden="true" tabindex="-1"></a><span class="in">priorsB=fun_generate_priors("B", logP=2.2)</span></span>
<span id="cb196-104"><a href="#cb196-104" aria-hidden="true" tabindex="-1"></a><span class="in">priorsNB=fun_generate_priors("NB", logP=2.2)</span></span>
<span id="cb196-105"><a href="#cb196-105" aria-hidden="true" tabindex="-1"></a><span class="in">priorsNA=fun_generate_priors("NA", logP=2.2)</span></span>
<span id="cb196-106"><a href="#cb196-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-107"><a href="#cb196-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-108"><a href="#cb196-108" aria-hidden="true" tabindex="-1"></a>Here I consider a design space that consist of linear organic modifier gradients ranging from 10 to 90 min and organic modifier content ranging from 0.05 to 0.2 for MeOH and ACN.</span>
<span id="cb196-109"><a href="#cb196-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-110"><a href="#cb196-110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r design-space}</span></span>
<span id="cb196-111"><a href="#cb196-111" aria-hidden="true" tabindex="-1"></a><span class="in">hplcparam_candidates_df = expand_grid(tg=seq(10,90,by=10), </span></span>
<span id="cb196-112"><a href="#cb196-112" aria-hidden="true" tabindex="-1"></a><span class="in">                                          td=2.1, </span></span>
<span id="cb196-113"><a href="#cb196-113" aria-hidden="true" tabindex="-1"></a><span class="in">                                          to=0.532,</span></span>
<span id="cb196-114"><a href="#cb196-114" aria-hidden="true" tabindex="-1"></a><span class="in">                                          te=0.04, </span></span>
<span id="cb196-115"><a href="#cb196-115" aria-hidden="true" tabindex="-1"></a><span class="in">                                          fio = seq(0.05, 0.2, by=0.05),</span></span>
<span id="cb196-116"><a href="#cb196-116" aria-hidden="true" tabindex="-1"></a><span class="in">                                          fif = 0.8,</span></span>
<span id="cb196-117"><a href="#cb196-117" aria-hidden="true" tabindex="-1"></a><span class="in">                                          m=c(0,1),</span></span>
<span id="cb196-118"><a href="#cb196-118" aria-hidden="true" tabindex="-1"></a><span class="in">                                          xpH=c(0,1))</span></span>
<span id="cb196-119"><a href="#cb196-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-120"><a href="#cb196-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-121"><a href="#cb196-121" aria-hidden="true" tabindex="-1"></a><span class="fu"># Read the results</span></span>
<span id="cb196-122"><a href="#cb196-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-123"><a href="#cb196-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-results}</span></span>
<span id="cb196-124"><a href="#cb196-124" aria-hidden="true" tabindex="-1"></a><span class="in"> #to avoid recalculations</span></span>
<span id="cb196-125"><a href="#cb196-125" aria-hidden="true" tabindex="-1"></a><span class="in">load(file = "../data/results-mixtures-design2.RData")</span></span>
<span id="cb196-126"><a href="#cb196-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-127"><a href="#cb196-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-128"><a href="#cb196-128" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</span></span>
<span id="cb196-129"><a href="#cb196-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-130"><a href="#cb196-130" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile stan models</span></span>
<span id="cb196-131"><a href="#cb196-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-compilation}</span></span>
<span id="cb196-132"><a href="#cb196-132" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_gq= cmdstan_model("../stan/hplc-gra-single-form-analytes-gq.stan", stanc_options = list("O1"))</span></span>
<span id="cb196-133"><a href="#cb196-133" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_sim = cmdstan_model("../stan/hplc-gra-single-form-analytes-sim.stan", stanc_options = list("O1"))</span></span>
<span id="cb196-134"><a href="#cb196-134" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes = cmdstan_model("../stan/hplc-gra-single-form-analytes.stan", stanc_options = list("O1"))</span></span>
<span id="cb196-135"><a href="#cb196-135" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes$compile(compile_model_methods=TRUE,force_recompile=TRUE)</span></span>
<span id="cb196-136"><a href="#cb196-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-137"><a href="#cb196-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-138"><a href="#cb196-138" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulate retention times and create datasets</span></span>
<span id="cb196-139"><a href="#cb196-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-140"><a href="#cb196-140" aria-hidden="true" tabindex="-1"></a>Probability for neutral, acidic and basic is 0.4, 0.3, 0.3 with logP being sampled from 2.2+-2 and constrained between 0.5 and 7.</span>
<span id="cb196-141"><a href="#cb196-141" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-142"><a href="#cb196-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-simulations}</span></span>
<span id="cb196-143"><a href="#cb196-143" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma=hplcparam_candidates_df%&gt;%filter(xpH==0)</span></span>
<span id="cb196-144"><a href="#cb196-144" aria-hidden="true" tabindex="-1"></a><span class="in">nObs = nrow(data_ma);</span></span>
<span id="cb196-145"><a href="#cb196-145" aria-hidden="true" tabindex="-1"></a><span class="in">nAnalytes =50;</span></span>
<span id="cb196-146"><a href="#cb196-146" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = 1234;</span></span>
<span id="cb196-147"><a href="#cb196-147" aria-hidden="true" tabindex="-1"></a><span class="in">n_param = 3;</span></span>
<span id="cb196-148"><a href="#cb196-148" aria-hidden="true" tabindex="-1"></a><span class="in">n_rep = 10;</span></span>
<span id="cb196-149"><a href="#cb196-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-150"><a href="#cb196-150" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma=list()</span></span>
<span id="cb196-151"><a href="#cb196-151" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma=list()</span></span>
<span id="cb196-152"><a href="#cb196-152" aria-hidden="true" tabindex="-1"></a><span class="in">inits = list()</span></span>
<span id="cb196-153"><a href="#cb196-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-154"><a href="#cb196-154" aria-hidden="true" tabindex="-1"></a><span class="in">for (i in 1:n_rep) {</span></span>
<span id="cb196-155"><a href="#cb196-155" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]] = list(nObs=nObs,</span></span>
<span id="cb196-156"><a href="#cb196-156" aria-hidden="true" tabindex="-1"></a><span class="in">                   nAnalytes=nAnalytes,</span></span>
<span id="cb196-157"><a href="#cb196-157" aria-hidden="true" tabindex="-1"></a><span class="in">                   steps = 4 + 6*data_ma$m,</span></span>
<span id="cb196-158"><a href="#cb196-158" aria-hidden="true" tabindex="-1"></a><span class="in">                   hplcparam=as.matrix(data_ma%&gt;%dplyr::select(c(tg,td,to,te,fio,fif,m))),</span></span>
<span id="cb196-159"><a href="#cb196-159" aria-hidden="true" tabindex="-1"></a><span class="in">                   include_prior = 1,</span></span>
<span id="cb196-160"><a href="#cb196-160" aria-hidden="true" tabindex="-1"></a><span class="in">                   run_estimation=1,</span></span>
<span id="cb196-161"><a href="#cb196-161" aria-hidden="true" tabindex="-1"></a><span class="in">                   nSel = nObs,</span></span>
<span id="cb196-162"><a href="#cb196-162" aria-hidden="true" tabindex="-1"></a><span class="in">                   selected = 1:nObs)</span></span>
<span id="cb196-163"><a href="#cb196-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-164"><a href="#cb196-164" aria-hidden="true" tabindex="-1"></a><span class="in">fit_gq  = mod_analytes_gq$sample(data = datastruct_prior_ma[[i]],</span></span>
<span id="cb196-165"><a href="#cb196-165" aria-hidden="true" tabindex="-1"></a><span class="in">                                         seed = cseed,</span></span>
<span id="cb196-166"><a href="#cb196-166" aria-hidden="true" tabindex="-1"></a><span class="in">                                         fixed_param = TRUE,</span></span>
<span id="cb196-167"><a href="#cb196-167" aria-hidden="true" tabindex="-1"></a><span class="in">                                         chains = 1,</span></span>
<span id="cb196-168"><a href="#cb196-168" aria-hidden="true" tabindex="-1"></a><span class="in">                                         iter_sampling=1)</span></span>
<span id="cb196-169"><a href="#cb196-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-170"><a href="#cb196-170" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$trobs = matrix(fit_gq$draws(format = "matrix", variable = "y_hat_sim"),nAnalytes,nObs)</span></span>
<span id="cb196-171"><a href="#cb196-171" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$logPobs = fit_gq$draws(format = "matrix", variable = "logPobs")[1:nAnalytes]</span></span>
<span id="cb196-172"><a href="#cb196-172" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$N1A2B3 = fit_gq$draws(format = "matrix", variable = "N1A2B3")[1:nAnalytes]</span></span>
<span id="cb196-173"><a href="#cb196-173" aria-hidden="true" tabindex="-1"></a><span class="in">param = matrix(fit_gq$draws(format = "matrix", variable = "paramsim"),nAnalytes,3)</span></span>
<span id="cb196-174"><a href="#cb196-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-175"><a href="#cb196-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-176"><a href="#cb196-176" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma[[i]]=datastruct_prior_ma[[i]];</span></span>
<span id="cb196-177"><a href="#cb196-177" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma[[i]]$include_prior = 0.01;</span></span>
<span id="cb196-178"><a href="#cb196-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-179"><a href="#cb196-179" aria-hidden="true" tabindex="-1"></a><span class="in">inits[[i]]=param</span></span>
<span id="cb196-180"><a href="#cb196-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-181"><a href="#cb196-181" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = cseed+1</span></span>
<span id="cb196-182"><a href="#cb196-182" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-183"><a href="#cb196-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-184"><a href="#cb196-184" aria-hidden="true" tabindex="-1"></a><span class="in">mean_log_det_stan = function(data, init, chosen_indices, S){</span></span>
<span id="cb196-185"><a href="#cb196-185" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-186"><a href="#cb196-186" aria-hidden="true" tabindex="-1"></a><span class="in">init_ma = function(){list(param=init)}</span></span>
<span id="cb196-187"><a href="#cb196-187" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-188"><a href="#cb196-188" aria-hidden="true" tabindex="-1"></a><span class="in">data$selected = chosen_indices;</span></span>
<span id="cb196-189"><a href="#cb196-189" aria-hidden="true" tabindex="-1"></a><span class="in">data$nSel = length(chosen_indices);</span></span>
<span id="cb196-190"><a href="#cb196-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-191"><a href="#cb196-191" aria-hidden="true" tabindex="-1"></a><span class="in"> fit_opt  = mod_analytes$optimize(</span></span>
<span id="cb196-192"><a href="#cb196-192" aria-hidden="true" tabindex="-1"></a><span class="in">   data = data,</span></span>
<span id="cb196-193"><a href="#cb196-193" aria-hidden="true" tabindex="-1"></a><span class="in">   output_dir = here::here("stanfiles"),</span></span>
<span id="cb196-194"><a href="#cb196-194" aria-hidden="true" tabindex="-1"></a><span class="in">   output_basename = S,</span></span>
<span id="cb196-195"><a href="#cb196-195" aria-hidden="true" tabindex="-1"></a><span class="in">   seed = cseed,</span></span>
<span id="cb196-196"><a href="#cb196-196" aria-hidden="true" tabindex="-1"></a><span class="in">   init = init_ma,</span></span>
<span id="cb196-197"><a href="#cb196-197" aria-hidden="true" tabindex="-1"></a><span class="in">   jacobian = TRUE,</span></span>
<span id="cb196-198"><a href="#cb196-198" aria-hidden="true" tabindex="-1"></a><span class="in">   show_messages = F)</span></span>
<span id="cb196-199"><a href="#cb196-199" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb196-200"><a href="#cb196-200" aria-hidden="true" tabindex="-1"></a><span class="in"> mode=fit_opt$unconstrain_variables(list(param = fit_opt$mle("param")))</span></span>
<span id="cb196-201"><a href="#cb196-201" aria-hidden="true" tabindex="-1"></a><span class="in"> hessian = fit_opt$hessian(unconstrained_variables = mode)$hessian</span></span>
<span id="cb196-202"><a href="#cb196-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-203"><a href="#cb196-203" aria-hidden="true" tabindex="-1"></a><span class="in">logdet = unlist(purrr::map(1:data$nAnalytes,\(i) log(det(-hessian[((i-1)*3+1):((i-1)*3+3),((i-1)*3+1):((i-1)*3+3)]))))</span></span>
<span id="cb196-204"><a href="#cb196-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-205"><a href="#cb196-205" aria-hidden="true" tabindex="-1"></a><span class="in">return(logdet)</span></span>
<span id="cb196-206"><a href="#cb196-206" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-207"><a href="#cb196-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-208"><a href="#cb196-208" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(17,18,65,66)</span></span>
<span id="cb196-209"><a href="#cb196-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-210"><a href="#cb196-210" aria-hidden="true" tabindex="-1"></a><span class="in"># quick test:</span></span>
<span id="cb196-211"><a href="#cb196-211" aria-hidden="true" tabindex="-1"></a><span class="in">z_prior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan(datastruct_prior_ma[[i]], inits[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb196-212"><a href="#cb196-212" aria-hidden="true" tabindex="-1"></a><span class="in">z_noprior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan(datastruct_noprior_ma[[i]], inits[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb196-213"><a href="#cb196-213" aria-hidden="true" tabindex="-1"></a><span class="in">test = c(mean(unlist(z_prior)),mean(unlist(z_noprior)))</span></span>
<span id="cb196-214"><a href="#cb196-214" aria-hidden="true" tabindex="-1"></a><span class="in">test</span></span>
<span id="cb196-215"><a href="#cb196-215" aria-hidden="true" tabindex="-1"></a><span class="in">cat("14.08178 12.96005")</span></span>
<span id="cb196-216"><a href="#cb196-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-217"><a href="#cb196-217" aria-hidden="true" tabindex="-1"></a><span class="in">logP = unlist(purrr::map(1:length(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]$logPobs))</span></span>
<span id="cb196-218"><a href="#cb196-218" aria-hidden="true" tabindex="-1"></a><span class="in">NAB = unlist(purrr::map(1:length(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]$N1A2B3))</span></span>
<span id="cb196-219"><a href="#cb196-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-220"><a href="#cb196-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-221"><a href="#cb196-221" aria-hidden="true" tabindex="-1"></a><span class="fu">## Optimization</span></span>
<span id="cb196-222"><a href="#cb196-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-optimization, eval=FALSE}</span></span>
<span id="cb196-223"><a href="#cb196-223" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(65,68) # initial values</span></span>
<span id="cb196-224"><a href="#cb196-224" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-225"><a href="#cb196-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-226"><a href="#cb196-226" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(71,65,68) # initial values</span></span>
<span id="cb196-227"><a href="#cb196-227" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-228"><a href="#cb196-228" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(23,65,68) # initial values</span></span>
<span id="cb196-229"><a href="#cb196-229" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-230"><a href="#cb196-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-231"><a href="#cb196-231" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(23,71,65,68) # initial values</span></span>
<span id="cb196-232"><a href="#cb196-232" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-233"><a href="#cb196-233" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(23,71,65,68) # initial values</span></span>
<span id="cb196-234"><a href="#cb196-234" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-235"><a href="#cb196-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-236"><a href="#cb196-236" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(66,23,71,65,70) # initial values</span></span>
<span id="cb196-237"><a href="#cb196-237" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-238"><a href="#cb196-238" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(66,23,71,65,72) # initial values</span></span>
<span id="cb196-239"><a href="#cb196-239" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-240"><a href="#cb196-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-241"><a href="#cb196-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-242"><a href="#cb196-242" aria-hidden="true" tabindex="-1"></a><span class="fu">## Optimization tg constrained</span></span>
<span id="cb196-243"><a href="#cb196-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-optimization-tgconstrain, eval=FALSE}</span></span>
<span id="cb196-244"><a href="#cb196-244" aria-hidden="true" tabindex="-1"></a><span class="in">#p=2 and 3 are the same as for unconstrained</span></span>
<span id="cb196-245"><a href="#cb196-245" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(17,18,65,66) # initial values</span></span>
<span id="cb196-246"><a href="#cb196-246" aria-hidden="true" tabindex="-1"></a><span class="in">fwstgc_prior_4 = fedorov_wynn_stan_par_tgconstraint(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, tg_constraint = 270,n_iter = 100)</span></span>
<span id="cb196-247"><a href="#cb196-247" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(17,18,65,66) # initial values</span></span>
<span id="cb196-248"><a href="#cb196-248" aria-hidden="true" tabindex="-1"></a><span class="in">fwstgc_noprior_4 = fedorov_wynn_stan_par_tgconstraint(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, tg_constraint = 270,n_iter = 100)</span></span>
<span id="cb196-249"><a href="#cb196-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-250"><a href="#cb196-250" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(1,39,24,65,68) # initial values</span></span>
<span id="cb196-251"><a href="#cb196-251" aria-hidden="true" tabindex="-1"></a><span class="in">fwstgc_prior_5 = fedorov_wynn_stan_par_tgconstraint(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, tg_constraint = 270,n_iter = 100)</span></span>
<span id="cb196-252"><a href="#cb196-252" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(1,39,24,65,68) # initial values</span></span>
<span id="cb196-253"><a href="#cb196-253" aria-hidden="true" tabindex="-1"></a><span class="in">fwstgc_noprior_5 = fedorov_wynn_stan_par_tgconstraint(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, tg_constraint = 270,n_iter = 100)</span></span>
<span id="cb196-254"><a href="#cb196-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-255"><a href="#cb196-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-256"><a href="#cb196-256" aria-hidden="true" tabindex="-1"></a><span class="fu">### Read the results and compare</span></span>
<span id="cb196-257"><a href="#cb196-257" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Unconstrained</span></span>
<span id="cb196-258"><a href="#cb196-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-logDet-summary}</span></span>
<span id="cb196-259"><a href="#cb196-259" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(17,18,65,66) # ref</span></span>
<span id="cb196-260"><a href="#cb196-260" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior= c(17,18,65,66) # ref</span></span>
<span id="cb196-261"><a href="#cb196-261" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-262"><a href="#cb196-262" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-263"><a href="#cb196-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-264"><a href="#cb196-264" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(65,68) # p=2</span></span>
<span id="cb196-265"><a href="#cb196-265" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-266"><a href="#cb196-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-267"><a href="#cb196-267" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(71,65,68) # p=3</span></span>
<span id="cb196-268"><a href="#cb196-268" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(23,65,68) # p=3</span></span>
<span id="cb196-269"><a href="#cb196-269" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-270"><a href="#cb196-270" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-271"><a href="#cb196-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-272"><a href="#cb196-272" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(23,71,65,68) # p=4</span></span>
<span id="cb196-273"><a href="#cb196-273" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(23,71,65,68) # p=4</span></span>
<span id="cb196-274"><a href="#cb196-274" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-275"><a href="#cb196-275" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-276"><a href="#cb196-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-277"><a href="#cb196-277" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(66,23,71,65,70) # p=5</span></span>
<span id="cb196-278"><a href="#cb196-278" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(66,23,71,65,72) # p=5</span></span>
<span id="cb196-279"><a href="#cb196-279" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-280"><a href="#cb196-280" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-281"><a href="#cb196-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-282"><a href="#cb196-282" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results = tibble( logP = logP,</span></span>
<span id="cb196-283"><a href="#cb196-283" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb196-284"><a href="#cb196-284" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb196-285"><a href="#cb196-285" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb196-286"><a href="#cb196-286" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_2 = fws_prior_2$log_det_FIM,</span></span>
<span id="cb196-287"><a href="#cb196-287" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb196-288"><a href="#cb196-288" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb196-289"><a href="#cb196-289" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb196-290"><a href="#cb196-290" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb196-291"><a href="#cb196-291" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb196-292"><a href="#cb196-292" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb196-293"><a href="#cb196-293" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(prior_ref:noprior_5, names_to = "method")</span></span>
<span id="cb196-294"><a href="#cb196-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-295"><a href="#cb196-295" aria-hidden="true" tabindex="-1"></a><span class="in">p1&lt;-ggplot(summary_results, aes(y=method,x=value))+</span></span>
<span id="cb196-296"><a href="#cb196-296" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-297"><a href="#cb196-297" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=value, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-298"><a href="#cb196-298" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-299"><a href="#cb196-299" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="log(|FIM|)", y = "Method")</span></span>
<span id="cb196-300"><a href="#cb196-300" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb196-301"><a href="#cb196-301" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diff = tibble(logP = logP,</span></span>
<span id="cb196-302"><a href="#cb196-302" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb196-303"><a href="#cb196-303" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb196-304"><a href="#cb196-304" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb196-305"><a href="#cb196-305" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_2 = fws_prior_2$log_det_FIM,</span></span>
<span id="cb196-306"><a href="#cb196-306" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb196-307"><a href="#cb196-307" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb196-308"><a href="#cb196-308" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb196-309"><a href="#cb196-309" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb196-310"><a href="#cb196-310" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb196-311"><a href="#cb196-311" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb196-312"><a href="#cb196-312" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_prior_2 = (fws_prior_2 - fws_prior_ref)/n_param,</span></span>
<span id="cb196-313"><a href="#cb196-313" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_3 = (fws_prior_3 - fws_prior_ref)/n_param,</span></span>
<span id="cb196-314"><a href="#cb196-314" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_3 = (fws_noprior_3 - fws_noprior_ref)/n_param,</span></span>
<span id="cb196-315"><a href="#cb196-315" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_4 = (fws_prior_4 - fws_prior_ref)/n_param,</span></span>
<span id="cb196-316"><a href="#cb196-316" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_4 = (fws_noprior_4 - fws_noprior_ref)/n_param,</span></span>
<span id="cb196-317"><a href="#cb196-317" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_5 = (fws_prior_5 - fws_prior_ref)/n_param,</span></span>
<span id="cb196-318"><a href="#cb196-318" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_5 = (fws_noprior_5 - fws_noprior_ref)/n_param)%&gt;%</span></span>
<span id="cb196-319"><a href="#cb196-319" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_prior_2:d_noprior_5, names_to = "method")</span></span>
<span id="cb196-320"><a href="#cb196-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-321"><a href="#cb196-321" aria-hidden="true" tabindex="-1"></a><span class="in">p2=ggplot(summary_results_diff, aes(y=method,x=exp(value)))+</span></span>
<span id="cb196-322"><a href="#cb196-322" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-323"><a href="#cb196-323" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-324"><a href="#cb196-324" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-325"><a href="#cb196-325" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Efficiency relative to the reference design", y = "Method")+</span></span>
<span id="cb196-326"><a href="#cb196-326" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")</span></span>
<span id="cb196-327"><a href="#cb196-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-328"><a href="#cb196-328" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diffprior = tibble(logP = logP,</span></span>
<span id="cb196-329"><a href="#cb196-329" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb196-330"><a href="#cb196-330" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb196-331"><a href="#cb196-331" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb196-332"><a href="#cb196-332" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb196-333"><a href="#cb196-333" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb196-334"><a href="#cb196-334" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb196-335"><a href="#cb196-335" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb196-336"><a href="#cb196-336" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb196-337"><a href="#cb196-337" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb196-338"><a href="#cb196-338" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_ref  = (fws_prior_ref-fws_noprior_ref)/n_param,</span></span>
<span id="cb196-339"><a href="#cb196-339" aria-hidden="true" tabindex="-1"></a><span class="in">         d_3 = (fws_prior_3-fws_noprior_3)/n_param,</span></span>
<span id="cb196-340"><a href="#cb196-340" aria-hidden="true" tabindex="-1"></a><span class="in">         d_4 = (fws_prior_4-fws_noprior_4)/n_param,</span></span>
<span id="cb196-341"><a href="#cb196-341" aria-hidden="true" tabindex="-1"></a><span class="in">         d_5 = (fws_prior_5-fws_noprior_5)/n_param)%&gt;%</span></span>
<span id="cb196-342"><a href="#cb196-342" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_ref:d_5, names_to = "method")</span></span>
<span id="cb196-343"><a href="#cb196-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-344"><a href="#cb196-344" aria-hidden="true" tabindex="-1"></a><span class="in">p3=ggplot(summary_results_diffprior, aes(y=method,x=exp(value)))+</span></span>
<span id="cb196-345"><a href="#cb196-345" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-346"><a href="#cb196-346" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-347"><a href="#cb196-347" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-348"><a href="#cb196-348" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Effect of prior on design efficiency", y = "Method")+</span></span>
<span id="cb196-349"><a href="#cb196-349" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")+</span></span>
<span id="cb196-350"><a href="#cb196-350" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0.5,100),</span></span>
<span id="cb196-351"><a href="#cb196-351" aria-hidden="true" tabindex="-1"></a><span class="in">                     trans='log10',</span></span>
<span id="cb196-352"><a href="#cb196-352" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.01, 100)),</span></span>
<span id="cb196-353"><a href="#cb196-353" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-354"><a href="#cb196-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-355"><a href="#cb196-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-356"><a href="#cb196-356" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb196-357"><a href="#cb196-357" aria-hidden="true" tabindex="-1"></a><span class="in">p2</span></span>
<span id="cb196-358"><a href="#cb196-358" aria-hidden="true" tabindex="-1"></a><span class="in">p3</span></span>
<span id="cb196-359"><a href="#cb196-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-360"><a href="#cb196-360" aria-hidden="true" tabindex="-1"></a><span class="in">f2_1 = p2</span></span>
<span id="cb196-361"><a href="#cb196-361" aria-hidden="true" tabindex="-1"></a><span class="in">f3_1 = p3</span></span>
<span id="cb196-362"><a href="#cb196-362" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p1, .filename=paste("single-form-analytes-logdFIM-abs.pdf"), .path = figures_dir1)</span></span>
<span id="cb196-363"><a href="#cb196-363" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p1, .filename=paste("single-form-analytes-logdFIM-abs.png"), .path = figures_dir1)</span></span>
<span id="cb196-364"><a href="#cb196-364" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p2, .filename=paste("single-form-analytes-logdFIM-rel.pdf"), .path = figures_dir1)</span></span>
<span id="cb196-365"><a href="#cb196-365" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p2, .filename=paste("single-form-analytes-logdFIM-rel.png"), .path = figures_dir1)</span></span>
<span id="cb196-366"><a href="#cb196-366" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p3, .filename=paste("single-form-analytes-logdFIM-prioreff.pdf"), .path = figures_dir1)</span></span>
<span id="cb196-367"><a href="#cb196-367" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p3, .filename=paste("single-form-analytes-logdFIM-prioreff.png"), .path = figures_dir1)</span></span>
<span id="cb196-368"><a href="#cb196-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-369"><a href="#cb196-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-370"><a href="#cb196-370" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table</span></span>
<span id="cb196-371"><a href="#cb196-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-372"><a href="#cb196-372" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Unconstrained</span></span>
<span id="cb196-373"><a href="#cb196-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-table}</span></span>
<span id="cb196-374"><a href="#cb196-374" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma=hplcparam_candidates_df%&gt;%filter(xpH==0)%&gt;%</span></span>
<span id="cb196-375"><a href="#cb196-375" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(line=1:n())</span></span>
<span id="cb196-376"><a href="#cb196-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-377"><a href="#cb196-377" aria-hidden="true" tabindex="-1"></a><span class="in">combined_results = list(</span></span>
<span id="cb196-378"><a href="#cb196-378" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ref = fws_prior_ref$chosen_indices,</span></span>
<span id="cb196-379"><a href="#cb196-379" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ref = fws_noprior_ref$chosen_indices,</span></span>
<span id="cb196-380"><a href="#cb196-380" aria-hidden="true" tabindex="-1"></a><span class="in">prior_2 = fws_prior_2$chosen_indices,</span></span>
<span id="cb196-381"><a href="#cb196-381" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_2 = 10000+fws_prior_2$chosen_indices, # dummy</span></span>
<span id="cb196-382"><a href="#cb196-382" aria-hidden="true" tabindex="-1"></a><span class="in">prior_3 = fws_prior_3$chosen_indices,</span></span>
<span id="cb196-383"><a href="#cb196-383" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_3 = fws_noprior_3$chosen_indices,</span></span>
<span id="cb196-384"><a href="#cb196-384" aria-hidden="true" tabindex="-1"></a><span class="in">prior_4 = fws_prior_4$chosen_indices,</span></span>
<span id="cb196-385"><a href="#cb196-385" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_4 = fws_noprior_4$chosen_indices,</span></span>
<span id="cb196-386"><a href="#cb196-386" aria-hidden="true" tabindex="-1"></a><span class="in">prior_5 = fws_prior_5$chosen_indices,</span></span>
<span id="cb196-387"><a href="#cb196-387" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_5 = fws_noprior_5$chosen_indices)</span></span>
<span id="cb196-388"><a href="#cb196-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-389"><a href="#cb196-389" aria-hidden="true" tabindex="-1"></a><span class="in">selected_exp = enframe(combined_results)%&gt;%</span></span>
<span id="cb196-390"><a href="#cb196-390" aria-hidden="true" tabindex="-1"></a><span class="in">   unnest(value) %&gt;%</span></span>
<span id="cb196-391"><a href="#cb196-391" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(line=value, Name = name) %&gt;%</span></span>
<span id="cb196-392"><a href="#cb196-392" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(data_ma, by = "line")%&gt;%</span></span>
<span id="cb196-393"><a href="#cb196-393" aria-hidden="true" tabindex="-1"></a><span class="in">   arrange(Name,tg, fio)%&gt;%</span></span>
<span id="cb196-394"><a href="#cb196-394" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Modifier = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb196-395"><a href="#cb196-395" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-c(line,xpH,m,td,to,te,fif)) %&gt;%</span></span>
<span id="cb196-396"><a href="#cb196-396" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(type = if_else(str_detect(Name, 'noprior'), "No prior", "Prior"))%&gt;%</span></span>
<span id="cb196-397"><a href="#cb196-397" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(where(is.numeric), ~replace_na(., -1)))</span></span>
<span id="cb196-398"><a href="#cb196-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-399"><a href="#cb196-399" aria-hidden="true" tabindex="-1"></a><span class="in">tab1&lt;-selected_exp %&gt;%</span></span>
<span id="cb196-400"><a href="#cb196-400" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "Prior") %&gt;%</span></span>
<span id="cb196-401"><a href="#cb196-401" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-type)%&gt;%</span></span>
<span id="cb196-402"><a href="#cb196-402" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb196-403"><a href="#cb196-403" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-404"><a href="#cb196-404" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-405"><a href="#cb196-405" aria-hidden="true" tabindex="-1"></a><span class="in">tab2&lt;-selected_exp %&gt;%</span></span>
<span id="cb196-406"><a href="#cb196-406" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "No prior")%&gt;%</span></span>
<span id="cb196-407"><a href="#cb196-407" aria-hidden="true" tabindex="-1"></a><span class="in">    select(-type)%&gt;%</span></span>
<span id="cb196-408"><a href="#cb196-408" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb196-409"><a href="#cb196-409" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-410"><a href="#cb196-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-411"><a href="#cb196-411" aria-hidden="true" tabindex="-1"></a><span class="in">tab2 &lt;- set_formatter(</span></span>
<span id="cb196-412"><a href="#cb196-412" aria-hidden="true" tabindex="-1"></a><span class="in">  tab2, </span></span>
<span id="cb196-413"><a href="#cb196-413" aria-hidden="true" tabindex="-1"></a><span class="in">  tg = function(x) ifelse(x==-1," ", sprintf("%d", x) ),</span></span>
<span id="cb196-414"><a href="#cb196-414" aria-hidden="true" tabindex="-1"></a><span class="in">  fio = function(x) ifelse(x==-1," ", sprintf("%.2f", x) )</span></span>
<span id="cb196-415"><a href="#cb196-415" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb196-416"><a href="#cb196-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-417"><a href="#cb196-417" aria-hidden="true" tabindex="-1"></a><span class="in">p1 = gen_grob(tab1, fit = "auto", just = "centre")</span></span>
<span id="cb196-418"><a href="#cb196-418" aria-hidden="true" tabindex="-1"></a><span class="in">p2 = gen_grob(tab2, fit = "auto", just = "centre") </span></span>
<span id="cb196-419"><a href="#cb196-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-420"><a href="#cb196-420" aria-hidden="true" tabindex="-1"></a><span class="in">gg&lt;-ggplot()+</span></span>
<span id="cb196-421"><a href="#cb196-421" aria-hidden="true" tabindex="-1"></a><span class="in">       theme(</span></span>
<span id="cb196-422"><a href="#cb196-422" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.background = element_rect(fill='transparent'),</span></span>
<span id="cb196-423"><a href="#cb196-423" aria-hidden="true" tabindex="-1"></a><span class="in">         plot.background = element_rect(fill='transparent', color=NA),</span></span>
<span id="cb196-424"><a href="#cb196-424" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.major = element_blank(),</span></span>
<span id="cb196-425"><a href="#cb196-425" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.minor = element_blank(),</span></span>
<span id="cb196-426"><a href="#cb196-426" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.background = element_rect(fill='transparent'),</span></span>
<span id="cb196-427"><a href="#cb196-427" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.box.background = element_rect(fill='transparent')</span></span>
<span id="cb196-428"><a href="#cb196-428" aria-hidden="true" tabindex="-1"></a><span class="in">       )</span></span>
<span id="cb196-429"><a href="#cb196-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-430"><a href="#cb196-430" aria-hidden="true" tabindex="-1"></a><span class="in">plot1 &lt;- gg+p1+p2+ plot_layout(ncol = 3, widths = c(1, 20,20))</span></span>
<span id="cb196-431"><a href="#cb196-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-432"><a href="#cb196-432" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plot1, .filename=paste("single-form-analytes-table.pdf"), .path = tables_dir1)</span></span>
<span id="cb196-433"><a href="#cb196-433" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plot1, .filename=paste("single-form-analytes-table.png"), .path = tables_dir1)</span></span>
<span id="cb196-434"><a href="#cb196-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-435"><a href="#cb196-435" aria-hidden="true" tabindex="-1"></a><span class="in">tab1</span></span>
<span id="cb196-436"><a href="#cb196-436" aria-hidden="true" tabindex="-1"></a><span class="in">tab2</span></span>
<span id="cb196-437"><a href="#cb196-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-438"><a href="#cb196-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-439"><a href="#cb196-439" aria-hidden="true" tabindex="-1"></a><span class="fu">#### tg constrained</span></span>
<span id="cb196-440"><a href="#cb196-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-table-tgc, eval=FALSE}</span></span>
<span id="cb196-441"><a href="#cb196-441" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma=hplcparam_candidates_df%&gt;%filter(xpH==0)%&gt;%</span></span>
<span id="cb196-442"><a href="#cb196-442" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(line=1:n())</span></span>
<span id="cb196-443"><a href="#cb196-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-444"><a href="#cb196-444" aria-hidden="true" tabindex="-1"></a><span class="in">combined_results = list(</span></span>
<span id="cb196-445"><a href="#cb196-445" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ref = fwstgc_prior_ref$chosen_indices,</span></span>
<span id="cb196-446"><a href="#cb196-446" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ref = fwstgc_noprior_ref$chosen_indices,</span></span>
<span id="cb196-447"><a href="#cb196-447" aria-hidden="true" tabindex="-1"></a><span class="in">prior_2 = fwstgc_prior_2$chosen_indices,</span></span>
<span id="cb196-448"><a href="#cb196-448" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_2 = 10000+fwstgc_prior_2$chosen_indices, # dummy</span></span>
<span id="cb196-449"><a href="#cb196-449" aria-hidden="true" tabindex="-1"></a><span class="in">prior_3 = fwstgc_prior_3$chosen_indices,</span></span>
<span id="cb196-450"><a href="#cb196-450" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_3 = fwstgc_noprior_3$chosen_indices,</span></span>
<span id="cb196-451"><a href="#cb196-451" aria-hidden="true" tabindex="-1"></a><span class="in">prior_4 = fwstgc_prior_4$chosen_indices,</span></span>
<span id="cb196-452"><a href="#cb196-452" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_4 = fwstgc_noprior_4$chosen_indices,</span></span>
<span id="cb196-453"><a href="#cb196-453" aria-hidden="true" tabindex="-1"></a><span class="in">prior_5 = fwstgc_prior_5$chosen_indices,</span></span>
<span id="cb196-454"><a href="#cb196-454" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_5 = fwstgc_noprior_5$chosen_indices)</span></span>
<span id="cb196-455"><a href="#cb196-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-456"><a href="#cb196-456" aria-hidden="true" tabindex="-1"></a><span class="in">selected_exp = enframe(combined_results)%&gt;%</span></span>
<span id="cb196-457"><a href="#cb196-457" aria-hidden="true" tabindex="-1"></a><span class="in">   unnest(value) %&gt;%</span></span>
<span id="cb196-458"><a href="#cb196-458" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(line=value, Name = name) %&gt;%</span></span>
<span id="cb196-459"><a href="#cb196-459" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(data_ma, by = "line")%&gt;%</span></span>
<span id="cb196-460"><a href="#cb196-460" aria-hidden="true" tabindex="-1"></a><span class="in">   arrange(Name,tg, fio)%&gt;%</span></span>
<span id="cb196-461"><a href="#cb196-461" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Modifier = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb196-462"><a href="#cb196-462" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-c(line,xpH,m,td,to,te,fif)) %&gt;%</span></span>
<span id="cb196-463"><a href="#cb196-463" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(type = if_else(str_detect(Name, 'noprior'), "No prior", "Prior"))%&gt;%</span></span>
<span id="cb196-464"><a href="#cb196-464" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(where(is.numeric), ~replace_na(., -1)))</span></span>
<span id="cb196-465"><a href="#cb196-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-466"><a href="#cb196-466" aria-hidden="true" tabindex="-1"></a><span class="in">tab1&lt;-selected_exp %&gt;%</span></span>
<span id="cb196-467"><a href="#cb196-467" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "Prior") %&gt;%</span></span>
<span id="cb196-468"><a href="#cb196-468" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-type)%&gt;%</span></span>
<span id="cb196-469"><a href="#cb196-469" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb196-470"><a href="#cb196-470" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-471"><a href="#cb196-471" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-472"><a href="#cb196-472" aria-hidden="true" tabindex="-1"></a><span class="in">tab2&lt;-selected_exp %&gt;%</span></span>
<span id="cb196-473"><a href="#cb196-473" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "No prior")%&gt;%</span></span>
<span id="cb196-474"><a href="#cb196-474" aria-hidden="true" tabindex="-1"></a><span class="in">    select(-type)%&gt;%</span></span>
<span id="cb196-475"><a href="#cb196-475" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb196-476"><a href="#cb196-476" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-477"><a href="#cb196-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-478"><a href="#cb196-478" aria-hidden="true" tabindex="-1"></a><span class="in">tab2 &lt;- set_formatter(</span></span>
<span id="cb196-479"><a href="#cb196-479" aria-hidden="true" tabindex="-1"></a><span class="in">  tab2, </span></span>
<span id="cb196-480"><a href="#cb196-480" aria-hidden="true" tabindex="-1"></a><span class="in">  tg = function(x) ifelse(x==-1," ", sprintf("%d", x) ),</span></span>
<span id="cb196-481"><a href="#cb196-481" aria-hidden="true" tabindex="-1"></a><span class="in">  fio = function(x) ifelse(x==-1," ", sprintf("%.2f", x) )</span></span>
<span id="cb196-482"><a href="#cb196-482" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb196-483"><a href="#cb196-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-484"><a href="#cb196-484" aria-hidden="true" tabindex="-1"></a><span class="in">p1 = gen_grob(tab1, fit = "auto", just = "centre")</span></span>
<span id="cb196-485"><a href="#cb196-485" aria-hidden="true" tabindex="-1"></a><span class="in">p2 = gen_grob(tab2, fit = "auto", just = "centre") </span></span>
<span id="cb196-486"><a href="#cb196-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-487"><a href="#cb196-487" aria-hidden="true" tabindex="-1"></a><span class="in">gg&lt;-ggplot()+</span></span>
<span id="cb196-488"><a href="#cb196-488" aria-hidden="true" tabindex="-1"></a><span class="in">       theme(</span></span>
<span id="cb196-489"><a href="#cb196-489" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.background = element_rect(fill='transparent'),</span></span>
<span id="cb196-490"><a href="#cb196-490" aria-hidden="true" tabindex="-1"></a><span class="in">         plot.background = element_rect(fill='transparent', color=NA),</span></span>
<span id="cb196-491"><a href="#cb196-491" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.major = element_blank(),</span></span>
<span id="cb196-492"><a href="#cb196-492" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.minor = element_blank(),</span></span>
<span id="cb196-493"><a href="#cb196-493" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.background = element_rect(fill='transparent'),</span></span>
<span id="cb196-494"><a href="#cb196-494" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.box.background = element_rect(fill='transparent')</span></span>
<span id="cb196-495"><a href="#cb196-495" aria-hidden="true" tabindex="-1"></a><span class="in">       )</span></span>
<span id="cb196-496"><a href="#cb196-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-497"><a href="#cb196-497" aria-hidden="true" tabindex="-1"></a><span class="in">plot1 &lt;- gg+p1+p2+ plot_layout(ncol = 3, widths = c(1, 20,20))</span></span>
<span id="cb196-498"><a href="#cb196-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-499"><a href="#cb196-499" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plot1, .filename=paste("single-form-analytes-table-tgc.pdf"), .path = tables_dir1)</span></span>
<span id="cb196-500"><a href="#cb196-500" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plot1, .filename=paste("single-form-analytes-table-tgc.png"), .path = tables_dir1)</span></span>
<span id="cb196-501"><a href="#cb196-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-502"><a href="#cb196-502" aria-hidden="true" tabindex="-1"></a><span class="in">tab1</span></span>
<span id="cb196-503"><a href="#cb196-503" aria-hidden="true" tabindex="-1"></a><span class="in">tab2</span></span>
<span id="cb196-504"><a href="#cb196-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-505"><a href="#cb196-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-506"><a href="#cb196-506" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stan simulations</span></span>
<span id="cb196-507"><a href="#cb196-507" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-laplace, eval=F}</span></span>
<span id="cb196-508"><a href="#cb196-508" aria-hidden="true" tabindex="-1"></a><span class="in">gc()</span></span>
<span id="cb196-509"><a href="#cb196-509" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_ref$chosen_indices # ref</span></span>
<span id="cb196-510"><a href="#cb196-510" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_ref = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb196-511"><a href="#cb196-511" aria-hidden="true" tabindex="-1"></a><span class="in">gc()</span></span>
<span id="cb196-512"><a href="#cb196-512" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_ref$chosen_indices # ref</span></span>
<span id="cb196-513"><a href="#cb196-513" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_ref = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb196-514"><a href="#cb196-514" aria-hidden="true" tabindex="-1"></a><span class="in">gc()</span></span>
<span id="cb196-515"><a href="#cb196-515" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_2$chosen_indices # p=2</span></span>
<span id="cb196-516"><a href="#cb196-516" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_2 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb196-517"><a href="#cb196-517" aria-hidden="true" tabindex="-1"></a><span class="in">gc()</span></span>
<span id="cb196-518"><a href="#cb196-518" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_3$chosen_indices # p=3</span></span>
<span id="cb196-519"><a href="#cb196-519" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_3 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb196-520"><a href="#cb196-520" aria-hidden="true" tabindex="-1"></a><span class="in">gc()</span></span>
<span id="cb196-521"><a href="#cb196-521" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_3$chosen_indices # p=3</span></span>
<span id="cb196-522"><a href="#cb196-522" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_3 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb196-523"><a href="#cb196-523" aria-hidden="true" tabindex="-1"></a><span class="in">gc()</span></span>
<span id="cb196-524"><a href="#cb196-524" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_4$chosen_indices # p=4</span></span>
<span id="cb196-525"><a href="#cb196-525" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_4 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb196-526"><a href="#cb196-526" aria-hidden="true" tabindex="-1"></a><span class="in">gc()</span></span>
<span id="cb196-527"><a href="#cb196-527" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_4$chosen_indices # p=4</span></span>
<span id="cb196-528"><a href="#cb196-528" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_4 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb196-529"><a href="#cb196-529" aria-hidden="true" tabindex="-1"></a><span class="in">gc()</span></span>
<span id="cb196-530"><a href="#cb196-530" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_5$chosen_indices # p=5</span></span>
<span id="cb196-531"><a href="#cb196-531" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_5 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb196-532"><a href="#cb196-532" aria-hidden="true" tabindex="-1"></a><span class="in">gc()</span></span>
<span id="cb196-533"><a href="#cb196-533" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_5$chosen_indices # p=5</span></span>
<span id="cb196-534"><a href="#cb196-534" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_5 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb196-535"><a href="#cb196-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-536"><a href="#cb196-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-537"><a href="#cb196-537" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gradient conditions</span></span>
<span id="cb196-538"><a href="#cb196-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-gra-summary}</span></span>
<span id="cb196-539"><a href="#cb196-539" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_5$chosen_indices # p=5</span></span>
<span id="cb196-540"><a href="#cb196-540" aria-hidden="true" tabindex="-1"></a><span class="in">p31=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb196-541"><a href="#cb196-541" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0)%&gt;%</span></span>
<span id="cb196-542"><a href="#cb196-542" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb196-543"><a href="#cb196-543" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(prior_ma_5$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb196-544"><a href="#cb196-544" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb196-545"><a href="#cb196-545" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb196-546"><a href="#cb196-546" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb196-547"><a href="#cb196-547" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb196-548"><a href="#cb196-548" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb196-549"><a href="#cb196-549" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb196-550"><a href="#cb196-550" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_5$chosen_indices # p=5</span></span>
<span id="cb196-551"><a href="#cb196-551" aria-hidden="true" tabindex="-1"></a><span class="in">p32=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb196-552"><a href="#cb196-552" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0)%&gt;%</span></span>
<span id="cb196-553"><a href="#cb196-553" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb196-554"><a href="#cb196-554" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(noprior_ma_5$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb196-555"><a href="#cb196-555" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb196-556"><a href="#cb196-556" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb196-557"><a href="#cb196-557" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb196-558"><a href="#cb196-558" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb196-559"><a href="#cb196-559" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb196-560"><a href="#cb196-560" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb196-561"><a href="#cb196-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-562"><a href="#cb196-562" aria-hidden="true" tabindex="-1"></a><span class="in">iresults = rbind(prior_ma_ref$iresults%&gt;%</span></span>
<span id="cb196-563"><a href="#cb196-563" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb196-564"><a href="#cb196-564" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ref$iresults%&gt;%</span></span>
<span id="cb196-565"><a href="#cb196-565" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb196-566"><a href="#cb196-566" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_2$iresults%&gt;%</span></span>
<span id="cb196-567"><a href="#cb196-567" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb196-568"><a href="#cb196-568" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_3$iresults%&gt;%</span></span>
<span id="cb196-569"><a href="#cb196-569" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb196-570"><a href="#cb196-570" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_3$iresults%&gt;%</span></span>
<span id="cb196-571"><a href="#cb196-571" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb196-572"><a href="#cb196-572" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_4$iresults%&gt;%</span></span>
<span id="cb196-573"><a href="#cb196-573" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb196-574"><a href="#cb196-574" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_4$iresults%&gt;%</span></span>
<span id="cb196-575"><a href="#cb196-575" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4"),</span></span>
<span id="cb196-576"><a href="#cb196-576" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_5$iresults%&gt;%</span></span>
<span id="cb196-577"><a href="#cb196-577" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_5"),</span></span>
<span id="cb196-578"><a href="#cb196-578" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_5$iresults%&gt;%</span></span>
<span id="cb196-579"><a href="#cb196-579" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_5"))%&gt;%</span></span>
<span id="cb196-580"><a href="#cb196-580" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(ivar = if_else(ivar&gt;1e6,1e6,ivar)) %&gt;%</span></span>
<span id="cb196-581"><a href="#cb196-581" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.factor(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB))</span></span>
<span id="cb196-582"><a href="#cb196-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-583"><a href="#cb196-583" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=iresults %&gt;%</span></span>
<span id="cb196-584"><a href="#cb196-584" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb196-585"><a href="#cb196-585" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-586"><a href="#cb196-586" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-587"><a href="#cb196-587" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-588"><a href="#cb196-588" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb196-589"><a href="#cb196-589" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb196-590"><a href="#cb196-590" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(0.1,100))+   </span></span>
<span id="cb196-591"><a href="#cb196-591" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-592"><a href="#cb196-592" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb196-593"><a href="#cb196-593" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-594"><a href="#cb196-594" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=iresults %&gt;%</span></span>
<span id="cb196-595"><a href="#cb196-595" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb196-596"><a href="#cb196-596" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-597"><a href="#cb196-597" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-598"><a href="#cb196-598" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-599"><a href="#cb196-599" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb196-600"><a href="#cb196-600" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb196-601"><a href="#cb196-601" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,1000000))+    </span></span>
<span id="cb196-602"><a href="#cb196-602" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-603"><a href="#cb196-603" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb196-604"><a href="#cb196-604" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-605"><a href="#cb196-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-606"><a href="#cb196-606" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb196-607"><a href="#cb196-607" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb196-608"><a href="#cb196-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-609"><a href="#cb196-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-610"><a href="#cb196-610" aria-hidden="true" tabindex="-1"></a><span class="in">idx_exemple_analytes = iresults %&gt;%</span></span>
<span id="cb196-611"><a href="#cb196-611" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(method=="prior_ref") %&gt;%</span></span>
<span id="cb196-612"><a href="#cb196-612" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(ivar)%&gt;%</span></span>
<span id="cb196-613"><a href="#cb196-613" aria-hidden="true" tabindex="-1"></a><span class="in">  slice(which(row_number() %% 100 == 1)) %&gt;%</span></span>
<span id="cb196-614"><a href="#cb196-614" aria-hidden="true" tabindex="-1"></a><span class="in">  select(i)%&gt;%pull()</span></span>
<span id="cb196-615"><a href="#cb196-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-616"><a href="#cb196-616" aria-hidden="true" tabindex="-1"></a><span class="in">iresults %&gt;%</span></span>
<span id="cb196-617"><a href="#cb196-617" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb196-618"><a href="#cb196-618" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb196-619"><a href="#cb196-619" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb196-620"><a href="#cb196-620" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb196-621"><a href="#cb196-621" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-622"><a href="#cb196-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-623"><a href="#cb196-623" aria-hidden="true" tabindex="-1"></a><span class="in">f55_1=iresults %&gt;%</span></span>
<span id="cb196-624"><a href="#cb196-624" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb196-625"><a href="#cb196-625" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb196-626"><a href="#cb196-626" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb196-627"><a href="#cb196-627" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb196-628"><a href="#cb196-628" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(`&lt;=1x`:`&lt;=3x`, names_to = "target") %&gt;%</span></span>
<span id="cb196-629"><a href="#cb196-629" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=value,color=as.factor(target)))+</span></span>
<span id="cb196-630"><a href="#cb196-630" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point()+</span></span>
<span id="cb196-631"><a href="#cb196-631" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Probability", y = "Method", color = "target")+</span></span>
<span id="cb196-632"><a href="#cb196-632" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 0.9, linetype="dotted")</span></span>
<span id="cb196-633"><a href="#cb196-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-634"><a href="#cb196-634" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=f55_1, .filename=paste("single-form-analytes-gra-prob.pdf"), .path = figures_dir1)</span></span>
<span id="cb196-635"><a href="#cb196-635" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=f55_1, .filename=paste("single-form-analytes-gra-prob.png"), .path = figures_dir1)</span></span>
<span id="cb196-636"><a href="#cb196-636" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p31, .filename=paste("single-form-analytes-gra-prior-p5.pdf"), .path = figures_dir1)</span></span>
<span id="cb196-637"><a href="#cb196-637" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p31, .filename=paste("single-form-analytes-gra-prior-p5.png"), .path = figures_dir1)</span></span>
<span id="cb196-638"><a href="#cb196-638" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p32, .filename=paste("single-form-analytes-gra-noprior-p5.pdf"), .path = figures_dir1)</span></span>
<span id="cb196-639"><a href="#cb196-639" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p32, .filename=paste("single-form-analytes-gra-noprior-p5.png"), .path = figures_dir1)</span></span>
<span id="cb196-640"><a href="#cb196-640" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-gra-maxvar.pdf"), .path = figures_dir1)</span></span>
<span id="cb196-641"><a href="#cb196-641" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-gra-maxvar.png"), .path = figures_dir1)</span></span>
<span id="cb196-642"><a href="#cb196-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-643"><a href="#cb196-643" aria-hidden="true" tabindex="-1"></a><span class="in">p31</span></span>
<span id="cb196-644"><a href="#cb196-644" aria-hidden="true" tabindex="-1"></a><span class="in">p32</span></span>
<span id="cb196-645"><a href="#cb196-645" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb196-646"><a href="#cb196-646" aria-hidden="true" tabindex="-1"></a><span class="in">f33_1=p33</span></span>
<span id="cb196-647"><a href="#cb196-647" aria-hidden="true" tabindex="-1"></a><span class="in">f55_1</span></span>
<span id="cb196-648"><a href="#cb196-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-649"><a href="#cb196-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-650"><a href="#cb196-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-651"><a href="#cb196-651" aria-hidden="true" tabindex="-1"></a><span class="in"># iiresults&lt;-iresults %&gt;%</span></span>
<span id="cb196-652"><a href="#cb196-652" aria-hidden="true" tabindex="-1"></a><span class="in">#     pivot_wider(names_from = "method", values_from = ivar) %&gt;%</span></span>
<span id="cb196-653"><a href="#cb196-653" aria-hidden="true" tabindex="-1"></a><span class="in">#   mutate(d_prior_2 = prior_2/prior_ref,</span></span>
<span id="cb196-654"><a href="#cb196-654" aria-hidden="true" tabindex="-1"></a><span class="in">#          d_prior_3 = prior_3/prior_ref,</span></span>
<span id="cb196-655"><a href="#cb196-655" aria-hidden="true" tabindex="-1"></a><span class="in">#          d_noprior_3 = noprior_3/noprior_ref,</span></span>
<span id="cb196-656"><a href="#cb196-656" aria-hidden="true" tabindex="-1"></a><span class="in">#          d_prior_4 = prior_4/prior_ref,</span></span>
<span id="cb196-657"><a href="#cb196-657" aria-hidden="true" tabindex="-1"></a><span class="in">#          d_noprior_4 = noprior_4/noprior_ref,</span></span>
<span id="cb196-658"><a href="#cb196-658" aria-hidden="true" tabindex="-1"></a><span class="in">#          d_prior_5 = prior_5/prior_ref,</span></span>
<span id="cb196-659"><a href="#cb196-659" aria-hidden="true" tabindex="-1"></a><span class="in">#          d_noprior_5 = noprior_5/noprior_ref)%&gt;%</span></span>
<span id="cb196-660"><a href="#cb196-660" aria-hidden="true" tabindex="-1"></a><span class="in">#   pivot_longer(d_prior_2:d_noprior_5, names_to = "method")%&gt;%</span></span>
<span id="cb196-661"><a href="#cb196-661" aria-hidden="true" tabindex="-1"></a><span class="in">#   select(-c(prior_ref:noprior_5))</span></span>
<span id="cb196-662"><a href="#cb196-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-663"><a href="#cb196-663" aria-hidden="true" tabindex="-1"></a><span class="in"># test2=iresults %&gt;%</span></span>
<span id="cb196-664"><a href="#cb196-664" aria-hidden="true" tabindex="-1"></a><span class="in">#   ggplot(aes(x=logP,y=ivar, color=as.factor(Type)))+</span></span>
<span id="cb196-665"><a href="#cb196-665" aria-hidden="true" tabindex="-1"></a><span class="in">#   geom_point()+</span></span>
<span id="cb196-666"><a href="#cb196-666" aria-hidden="true" tabindex="-1"></a><span class="in">#   labs(x="logP", y="max(Var)", color = "Type")+   </span></span>
<span id="cb196-667"><a href="#cb196-667" aria-hidden="true" tabindex="-1"></a><span class="in">#   scale_y_continuous(</span></span>
<span id="cb196-668"><a href="#cb196-668" aria-hidden="true" tabindex="-1"></a><span class="in">#                      trans='log10',</span></span>
<span id="cb196-669"><a href="#cb196-669" aria-hidden="true" tabindex="-1"></a><span class="in">#                       breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.001, 1000)),</span></span>
<span id="cb196-670"><a href="#cb196-670" aria-hidden="true" tabindex="-1"></a><span class="in">#                       labels=scales::trans_format('log10', scales::math_format(10^.x))) + </span></span>
<span id="cb196-671"><a href="#cb196-671" aria-hidden="true" tabindex="-1"></a><span class="in">#   facet_wrap(~method, scales = "free_y")</span></span>
<span id="cb196-672"><a href="#cb196-672" aria-hidden="true" tabindex="-1"></a><span class="in"># </span></span>
<span id="cb196-673"><a href="#cb196-673" aria-hidden="true" tabindex="-1"></a><span class="in">#   test2</span></span>
<span id="cb196-674"><a href="#cb196-674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-675"><a href="#cb196-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-676"><a href="#cb196-676" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Isocratic conditions</span></span>
<span id="cb196-677"><a href="#cb196-677" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Individual plots</span></span>
<span id="cb196-678"><a href="#cb196-678" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-izo-summary}</span></span>
<span id="cb196-679"><a href="#cb196-679" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb196-680"><a href="#cb196-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-681"><a href="#cb196-681" aria-hidden="true" tabindex="-1"></a><span class="in">plot_id = function(results) { </span></span>
<span id="cb196-682"><a href="#cb196-682" aria-hidden="true" tabindex="-1"></a><span class="in">  results %&gt;%</span></span>
<span id="cb196-683"><a href="#cb196-683" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=fi, y=CV/10)) +</span></span>
<span id="cb196-684"><a href="#cb196-684" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb196-685"><a href="#cb196-685" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(aes(x=fi, ymin = llog10tr, ymax = ulog10tr), alpha = 0.4, col = NA) +</span></span>
<span id="cb196-686"><a href="#cb196-686" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x=fi, y=mlog10tr), col = "black", size=0.25) +</span></span>
<span id="cb196-687"><a href="#cb196-687" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_y_continuous(</span></span>
<span id="cb196-688"><a href="#cb196-688" aria-hidden="true" tabindex="-1"></a><span class="in">    name = "log(tr)",</span></span>
<span id="cb196-689"><a href="#cb196-689" aria-hidden="true" tabindex="-1"></a><span class="in">    sec.axis = sec_axis(~.*10, name="%CV")) +</span></span>
<span id="cb196-690"><a href="#cb196-690" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0,1,by=0.2))+</span></span>
<span id="cb196-691"><a href="#cb196-691" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_grid(i~mod) +</span></span>
<span id="cb196-692"><a href="#cb196-692" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 1, linetype=2)+</span></span>
<span id="cb196-693"><a href="#cb196-693" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim=c(0,4))</span></span>
<span id="cb196-694"><a href="#cb196-694" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-695"><a href="#cb196-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-696"><a href="#cb196-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-697"><a href="#cb196-697" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_ref&lt;-prior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb196-698"><a href="#cb196-698" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-699"><a href="#cb196-699" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-700"><a href="#cb196-700" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-701"><a href="#cb196-701" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-702"><a href="#cb196-702" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-703"><a href="#cb196-703" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-704"><a href="#cb196-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-705"><a href="#cb196-705" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_ref&lt;-noprior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb196-706"><a href="#cb196-706" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-707"><a href="#cb196-707" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-708"><a href="#cb196-708" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-709"><a href="#cb196-709" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-710"><a href="#cb196-710" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-711"><a href="#cb196-711" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-712"><a href="#cb196-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-713"><a href="#cb196-713" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_2&lt;-prior_ma_2$izoresults%&gt;%</span></span>
<span id="cb196-714"><a href="#cb196-714" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-715"><a href="#cb196-715" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-716"><a href="#cb196-716" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-717"><a href="#cb196-717" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-718"><a href="#cb196-718" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-719"><a href="#cb196-719" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-720"><a href="#cb196-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-721"><a href="#cb196-721" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_3&lt;-prior_ma_3$izoresults%&gt;%</span></span>
<span id="cb196-722"><a href="#cb196-722" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-723"><a href="#cb196-723" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-724"><a href="#cb196-724" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-725"><a href="#cb196-725" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-726"><a href="#cb196-726" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = mrgmisc::ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-727"><a href="#cb196-727" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-728"><a href="#cb196-728" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_3&lt;-noprior_ma_3$izoresults%&gt;%</span></span>
<span id="cb196-729"><a href="#cb196-729" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-730"><a href="#cb196-730" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-731"><a href="#cb196-731" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-732"><a href="#cb196-732" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-733"><a href="#cb196-733" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-734"><a href="#cb196-734" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-735"><a href="#cb196-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-736"><a href="#cb196-736" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_4&lt;-prior_ma_4$izoresults%&gt;%</span></span>
<span id="cb196-737"><a href="#cb196-737" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-738"><a href="#cb196-738" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-739"><a href="#cb196-739" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-740"><a href="#cb196-740" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-741"><a href="#cb196-741" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-742"><a href="#cb196-742" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-743"><a href="#cb196-743" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_4&lt;-noprior_ma_4$izoresults%&gt;%</span></span>
<span id="cb196-744"><a href="#cb196-744" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-745"><a href="#cb196-745" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-746"><a href="#cb196-746" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-747"><a href="#cb196-747" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-748"><a href="#cb196-748" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-749"><a href="#cb196-749" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-750"><a href="#cb196-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-751"><a href="#cb196-751" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_5&lt;-prior_ma_5$izoresults%&gt;%</span></span>
<span id="cb196-752"><a href="#cb196-752" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-753"><a href="#cb196-753" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-754"><a href="#cb196-754" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-755"><a href="#cb196-755" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-756"><a href="#cb196-756" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-757"><a href="#cb196-757" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-758"><a href="#cb196-758" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_5&lt;-noprior_ma_5$izoresults%&gt;%</span></span>
<span id="cb196-759"><a href="#cb196-759" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-760"><a href="#cb196-760" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-761"><a href="#cb196-761" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-762"><a href="#cb196-762" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-763"><a href="#cb196-763" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-764"><a href="#cb196-764" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-765"><a href="#cb196-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-766"><a href="#cb196-766" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ref = map(results_prior_ma_ref,plot_id) </span></span>
<span id="cb196-767"><a href="#cb196-767" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ref = map(results_noprior_ma_ref,plot_id) </span></span>
<span id="cb196-768"><a href="#cb196-768" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_2 = map(results_prior_ma_2,plot_id) </span></span>
<span id="cb196-769"><a href="#cb196-769" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_3 = map(results_prior_ma_3,plot_id) </span></span>
<span id="cb196-770"><a href="#cb196-770" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_3 = map(results_noprior_ma_3,plot_id) </span></span>
<span id="cb196-771"><a href="#cb196-771" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_4 = map(results_prior_ma_4,plot_id) </span></span>
<span id="cb196-772"><a href="#cb196-772" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_4 = map(results_noprior_ma_4,plot_id) </span></span>
<span id="cb196-773"><a href="#cb196-773" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_5 = map(results_prior_ma_5,plot_id) </span></span>
<span id="cb196-774"><a href="#cb196-774" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_5 = map(results_noprior_ma_5,plot_id) </span></span>
<span id="cb196-775"><a href="#cb196-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-776"><a href="#cb196-776" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_ref[[1]], .filename=paste("plots-results-prior-ma-ref.pdf"), .path = figures_dir1)</span></span>
<span id="cb196-777"><a href="#cb196-777" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_ref[[1]], .filename=paste("plots-results-prior-ma-ref.png"), .path = figures_dir1)</span></span>
<span id="cb196-778"><a href="#cb196-778" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_5[[1]], .filename=paste("plots-results-prior-ma-5.pdf"), .path = figures_dir1)</span></span>
<span id="cb196-779"><a href="#cb196-779" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_5[[1]], .filename=paste("plots-results-prior-ma-5.png"), .path = figures_dir1)</span></span>
<span id="cb196-780"><a href="#cb196-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-781"><a href="#cb196-781" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ref </span></span>
<span id="cb196-782"><a href="#cb196-782" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ref </span></span>
<span id="cb196-783"><a href="#cb196-783" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_2</span></span>
<span id="cb196-784"><a href="#cb196-784" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_3</span></span>
<span id="cb196-785"><a href="#cb196-785" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_3 </span></span>
<span id="cb196-786"><a href="#cb196-786" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_4 </span></span>
<span id="cb196-787"><a href="#cb196-787" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_4 </span></span>
<span id="cb196-788"><a href="#cb196-788" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_5  </span></span>
<span id="cb196-789"><a href="#cb196-789" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_5 </span></span>
<span id="cb196-790"><a href="#cb196-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-791"><a href="#cb196-791" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb196-792"><a href="#cb196-792" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb196-793"><a href="#cb196-793" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb196-794"><a href="#cb196-794" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb196-795"><a href="#cb196-795" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb196-796"><a href="#cb196-796" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span>
<span id="cb196-797"><a href="#cb196-797" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-798"><a href="#cb196-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-799"><a href="#cb196-799" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Combined</span></span>
<span id="cb196-800"><a href="#cb196-800" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-izo-summary-combined}</span></span>
<span id="cb196-801"><a href="#cb196-801" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb196-802"><a href="#cb196-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-803"><a href="#cb196-803" aria-hidden="true" tabindex="-1"></a><span class="in">plot_id = function(results) { </span></span>
<span id="cb196-804"><a href="#cb196-804" aria-hidden="true" tabindex="-1"></a><span class="in">  results %&gt;%</span></span>
<span id="cb196-805"><a href="#cb196-805" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=fi, y=CV)) +</span></span>
<span id="cb196-806"><a href="#cb196-806" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb196-807"><a href="#cb196-807" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(aes(x=fi, ymin = llog10tr, ymax = ulog10tr), alpha = 0.4, col = NA) +</span></span>
<span id="cb196-808"><a href="#cb196-808" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x=fi, y=mlog10tr), col = "black", size=0.25) +</span></span>
<span id="cb196-809"><a href="#cb196-809" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_y_continuous(</span></span>
<span id="cb196-810"><a href="#cb196-810" aria-hidden="true" tabindex="-1"></a><span class="in">    name = "log(tr)",</span></span>
<span id="cb196-811"><a href="#cb196-811" aria-hidden="true" tabindex="-1"></a><span class="in">    sec.axis = sec_axis(~.*1, name="%CV")) +</span></span>
<span id="cb196-812"><a href="#cb196-812" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0,1,by=0.2))+</span></span>
<span id="cb196-813"><a href="#cb196-813" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_grid(i~mod) +</span></span>
<span id="cb196-814"><a href="#cb196-814" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 1, linetype=2)+</span></span>
<span id="cb196-815"><a href="#cb196-815" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim=c(0,4))</span></span>
<span id="cb196-816"><a href="#cb196-816" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-817"><a href="#cb196-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-818"><a href="#cb196-818" aria-hidden="true" tabindex="-1"></a><span class="in">izoresults = rbind( prior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb196-819"><a href="#cb196-819" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb196-820"><a href="#cb196-820" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb196-821"><a href="#cb196-821" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb196-822"><a href="#cb196-822" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_2$izoresults%&gt;%</span></span>
<span id="cb196-823"><a href="#cb196-823" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb196-824"><a href="#cb196-824" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_3$izoresults%&gt;%</span></span>
<span id="cb196-825"><a href="#cb196-825" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb196-826"><a href="#cb196-826" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_3$izoresults%&gt;%</span></span>
<span id="cb196-827"><a href="#cb196-827" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb196-828"><a href="#cb196-828" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_4$izoresults%&gt;%</span></span>
<span id="cb196-829"><a href="#cb196-829" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb196-830"><a href="#cb196-830" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_4$izoresults%&gt;%</span></span>
<span id="cb196-831"><a href="#cb196-831" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4"),</span></span>
<span id="cb196-832"><a href="#cb196-832" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_5$izoresults%&gt;%</span></span>
<span id="cb196-833"><a href="#cb196-833" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_5"),</span></span>
<span id="cb196-834"><a href="#cb196-834" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_5$izoresults%&gt;%</span></span>
<span id="cb196-835"><a href="#cb196-835" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_5")) %&gt;%</span></span>
<span id="cb196-836"><a href="#cb196-836" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&lt;=log10(100))%&gt;%</span></span>
<span id="cb196-837"><a href="#cb196-837" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&gt;=log10(5))%&gt;%</span></span>
<span id="cb196-838"><a href="#cb196-838" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c = as.numeric(c),</span></span>
<span id="cb196-839"><a href="#cb196-839" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-840"><a href="#cb196-840" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(i,method,c)%&gt;%</span></span>
<span id="cb196-841"><a href="#cb196-841" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(i,method) %&gt;%</span></span>
<span id="cb196-842"><a href="#cb196-842" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(imaxcv = max(CV), imincv = min(CV), aveCV = pracma::trapz(c, CV)/(n()-1)) %&gt;%</span></span>
<span id="cb196-843"><a href="#cb196-843" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(imaxcv = if_else(imaxcv&gt;1e4,1e4,imaxcv))%&gt;%</span></span>
<span id="cb196-844"><a href="#cb196-844" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.integer(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB)) </span></span>
<span id="cb196-845"><a href="#cb196-845" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb196-846"><a href="#cb196-846" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=izoresults %&gt;%</span></span>
<span id="cb196-847"><a href="#cb196-847" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb196-848"><a href="#cb196-848" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-849"><a href="#cb196-849" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-850"><a href="#cb196-850" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb196-851"><a href="#cb196-851" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-852"><a href="#cb196-852" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-853"><a href="#cb196-853" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb196-854"><a href="#cb196-854" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(1,100))+   </span></span>
<span id="cb196-855"><a href="#cb196-855" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-856"><a href="#cb196-856" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb196-857"><a href="#cb196-857" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-858"><a href="#cb196-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-859"><a href="#cb196-859" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=izoresults %&gt;%</span></span>
<span id="cb196-860"><a href="#cb196-860" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb196-861"><a href="#cb196-861" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-862"><a href="#cb196-862" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-863"><a href="#cb196-863" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb196-864"><a href="#cb196-864" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-865"><a href="#cb196-865" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb196-866"><a href="#cb196-866" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb196-867"><a href="#cb196-867" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,10000))+    </span></span>
<span id="cb196-868"><a href="#cb196-868" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-869"><a href="#cb196-869" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb196-870"><a href="#cb196-870" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-871"><a href="#cb196-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-872"><a href="#cb196-872" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb196-873"><a href="#cb196-873" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb196-874"><a href="#cb196-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-875"><a href="#cb196-875" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-izo-combined-CV.pdf"), .path = figures_dir1)</span></span>
<span id="cb196-876"><a href="#cb196-876" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-izo-combined-CV.png"), .path = figures_dir1)</span></span>
<span id="cb196-877"><a href="#cb196-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-878"><a href="#cb196-878" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb196-879"><a href="#cb196-879" aria-hidden="true" tabindex="-1"></a><span class="in">f44_1 = p33</span></span>
<span id="cb196-880"><a href="#cb196-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-881"><a href="#cb196-881" aria-hidden="true" tabindex="-1"></a><span class="in"># test ----</span></span>
<span id="cb196-882"><a href="#cb196-882" aria-hidden="true" tabindex="-1"></a><span class="in">p77_1=izoresults %&gt;%</span></span>
<span id="cb196-883"><a href="#cb196-883" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb196-884"><a href="#cb196-884" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-885"><a href="#cb196-885" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-886"><a href="#cb196-886" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb196-887"><a href="#cb196-887" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-888"><a href="#cb196-888" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb196-889"><a href="#cb196-889" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(1,100))+   </span></span>
<span id="cb196-890"><a href="#cb196-890" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-891"><a href="#cb196-891" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb196-892"><a href="#cb196-892" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-893"><a href="#cb196-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-894"><a href="#cb196-894" aria-hidden="true" tabindex="-1"></a><span class="in">p77_2=izoresults %&gt;%</span></span>
<span id="cb196-895"><a href="#cb196-895" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb196-896"><a href="#cb196-896" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-897"><a href="#cb196-897" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-898"><a href="#cb196-898" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb196-899"><a href="#cb196-899" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-900"><a href="#cb196-900" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb196-901"><a href="#cb196-901" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb196-902"><a href="#cb196-902" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,10000))+    </span></span>
<span id="cb196-903"><a href="#cb196-903" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-904"><a href="#cb196-904" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb196-905"><a href="#cb196-905" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-906"><a href="#cb196-906" aria-hidden="true" tabindex="-1"></a><span class="in">p77=p77_1+p77_2+</span></span>
<span id="cb196-907"><a href="#cb196-907" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb196-908"><a href="#cb196-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-909"><a href="#cb196-909" aria-hidden="true" tabindex="-1"></a><span class="in">p77</span></span>
<span id="cb196-910"><a href="#cb196-910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-911"><a href="#cb196-911" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stan multiple analytes. Monoprotic analytes. fi, tg and pH for MeOH and ACN as design variables</span></span>
<span id="cb196-912"><a href="#cb196-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-913"><a href="#cb196-913" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile stan models</span></span>
<span id="cb196-914"><a href="#cb196-914" aria-hidden="true" tabindex="-1"></a><span class="in">```{r monoprotic-analytes-compilation}</span></span>
<span id="cb196-915"><a href="#cb196-915" aria-hidden="true" tabindex="-1"></a><span class="in">mod_mono_analytes_gq = cmdstan_model("../stan/hplc-gra-monoprotic-analytes-gq.stan", </span></span>
<span id="cb196-916"><a href="#cb196-916" aria-hidden="true" tabindex="-1"></a><span class="in">                                      stanc_options = list("O1"))</span></span>
<span id="cb196-917"><a href="#cb196-917" aria-hidden="true" tabindex="-1"></a><span class="in">mod_mono_analytes_sim = cmdstan_model("../stan/hplc-gra-monoprotic-analytes-sim.stan", </span></span>
<span id="cb196-918"><a href="#cb196-918" aria-hidden="true" tabindex="-1"></a><span class="in">                                        stanc_options = list("O1"))</span></span>
<span id="cb196-919"><a href="#cb196-919" aria-hidden="true" tabindex="-1"></a><span class="in">mod_mono_analytes = cmdstan_model("../stan/hplc-gra-monoprotic-analytes.stan", </span></span>
<span id="cb196-920"><a href="#cb196-920" aria-hidden="true" tabindex="-1"></a><span class="in">                                   stanc_options = list("O1"))</span></span>
<span id="cb196-921"><a href="#cb196-921" aria-hidden="true" tabindex="-1"></a><span class="in">mod_mono_analytes$compile(compile_model_methods=TRUE,force_recompile=TRUE)</span></span>
<span id="cb196-922"><a href="#cb196-922" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-923"><a href="#cb196-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-924"><a href="#cb196-924" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulate retention times and create data sets</span></span>
<span id="cb196-925"><a href="#cb196-925" aria-hidden="true" tabindex="-1"></a><span class="in">```{r monoprotic-analytes-simulations}</span></span>
<span id="cb196-926"><a href="#cb196-926" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma_pH=hplcparam_candidates_df</span></span>
<span id="cb196-927"><a href="#cb196-927" aria-hidden="true" tabindex="-1"></a><span class="in">nObs = nrow(data_ma_pH);</span></span>
<span id="cb196-928"><a href="#cb196-928" aria-hidden="true" tabindex="-1"></a><span class="in">nAnalytes =50;</span></span>
<span id="cb196-929"><a href="#cb196-929" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = 1234;</span></span>
<span id="cb196-930"><a href="#cb196-930" aria-hidden="true" tabindex="-1"></a><span class="in">n_param = 6;</span></span>
<span id="cb196-931"><a href="#cb196-931" aria-hidden="true" tabindex="-1"></a><span class="in">n_rep = 10;</span></span>
<span id="cb196-932"><a href="#cb196-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-933"><a href="#cb196-933" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma_pH=list()</span></span>
<span id="cb196-934"><a href="#cb196-934" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_pH=list()</span></span>
<span id="cb196-935"><a href="#cb196-935" aria-hidden="true" tabindex="-1"></a><span class="in">inits_pH = list()</span></span>
<span id="cb196-936"><a href="#cb196-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-937"><a href="#cb196-937" aria-hidden="true" tabindex="-1"></a><span class="in">for (i in 1:n_rep) {</span></span>
<span id="cb196-938"><a href="#cb196-938" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_pH[[i]] = list(nObs=nObs,</span></span>
<span id="cb196-939"><a href="#cb196-939" aria-hidden="true" tabindex="-1"></a><span class="in">                   nAnalytes=nAnalytes,</span></span>
<span id="cb196-940"><a href="#cb196-940" aria-hidden="true" tabindex="-1"></a><span class="in">                   steps= 4+6*data_ma_pH$m,</span></span>
<span id="cb196-941"><a href="#cb196-941" aria-hidden="true" tabindex="-1"></a><span class="in">                   hplcparam= as.matrix(data_ma_pH%&gt;%dplyr::select(c(tg,td,to,te,fio,fif,m,xpH))),</span></span>
<span id="cb196-942"><a href="#cb196-942" aria-hidden="true" tabindex="-1"></a><span class="in">                   include_prior= 1,</span></span>
<span id="cb196-943"><a href="#cb196-943" aria-hidden="true" tabindex="-1"></a><span class="in">                   run_estimation=1,</span></span>
<span id="cb196-944"><a href="#cb196-944" aria-hidden="true" tabindex="-1"></a><span class="in">                   nSel= nObs,</span></span>
<span id="cb196-945"><a href="#cb196-945" aria-hidden="true" tabindex="-1"></a><span class="in">                   selected = 1:nObs)</span></span>
<span id="cb196-946"><a href="#cb196-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-947"><a href="#cb196-947" aria-hidden="true" tabindex="-1"></a><span class="in">fit_gq_pH  = mod_mono_analytes_gq$sample(data = datastruct_prior_ma_pH[[i]],</span></span>
<span id="cb196-948"><a href="#cb196-948" aria-hidden="true" tabindex="-1"></a><span class="in">                                         seed = cseed,</span></span>
<span id="cb196-949"><a href="#cb196-949" aria-hidden="true" tabindex="-1"></a><span class="in">                                         fixed_param = TRUE,</span></span>
<span id="cb196-950"><a href="#cb196-950" aria-hidden="true" tabindex="-1"></a><span class="in">                                         chains = 1,</span></span>
<span id="cb196-951"><a href="#cb196-951" aria-hidden="true" tabindex="-1"></a><span class="in">                                         iter_sampling=1)</span></span>
<span id="cb196-952"><a href="#cb196-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-953"><a href="#cb196-953" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_pH[[i]]$trobs = matrix(fit_gq_pH$draws(format = "matrix", </span></span>
<span id="cb196-954"><a href="#cb196-954" aria-hidden="true" tabindex="-1"></a><span class="in">                                                           variable = "y_hat_sim"),nAnalytes,nObs)</span></span>
<span id="cb196-955"><a href="#cb196-955" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_pH[[i]]$logPobs = fit_gq_pH$draws(format = "matrix", </span></span>
<span id="cb196-956"><a href="#cb196-956" aria-hidden="true" tabindex="-1"></a><span class="in">                                                      variable = "logPobs")[1:nAnalytes]</span></span>
<span id="cb196-957"><a href="#cb196-957" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_pH[[i]]$A1B2 = fit_gq_pH$draws(format = "matrix", </span></span>
<span id="cb196-958"><a href="#cb196-958" aria-hidden="true" tabindex="-1"></a><span class="in">                                                   variable = "A1B2")[1:nAnalytes]</span></span>
<span id="cb196-959"><a href="#cb196-959" aria-hidden="true" tabindex="-1"></a><span class="in">param = matrix(fit_gq_pH$draws(format = "matrix", </span></span>
<span id="cb196-960"><a href="#cb196-960" aria-hidden="true" tabindex="-1"></a><span class="in">                               variable = "paramsim"),nAnalytes,6)</span></span>
<span id="cb196-961"><a href="#cb196-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-962"><a href="#cb196-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-963"><a href="#cb196-963" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma_pH[[i]]=datastruct_prior_ma_pH[[i]];</span></span>
<span id="cb196-964"><a href="#cb196-964" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma_pH[[i]]$include_prior = 0.01;</span></span>
<span id="cb196-965"><a href="#cb196-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-966"><a href="#cb196-966" aria-hidden="true" tabindex="-1"></a><span class="in">inits_pH[[i]]=param</span></span>
<span id="cb196-967"><a href="#cb196-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-968"><a href="#cb196-968" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = cseed+1</span></span>
<span id="cb196-969"><a href="#cb196-969" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-970"><a href="#cb196-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-971"><a href="#cb196-971" aria-hidden="true" tabindex="-1"></a><span class="in">mean_log_det_stan_pH = function(data_pH, init_pH, chosen_indices, S){</span></span>
<span id="cb196-972"><a href="#cb196-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-973"><a href="#cb196-973" aria-hidden="true" tabindex="-1"></a><span class="in">init_ma_pH = function(){list(param=init_pH)}</span></span>
<span id="cb196-974"><a href="#cb196-974" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-975"><a href="#cb196-975" aria-hidden="true" tabindex="-1"></a><span class="in">data_pH$selected = chosen_indices;</span></span>
<span id="cb196-976"><a href="#cb196-976" aria-hidden="true" tabindex="-1"></a><span class="in">data_pH$nSel = length(chosen_indices);</span></span>
<span id="cb196-977"><a href="#cb196-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-978"><a href="#cb196-978" aria-hidden="true" tabindex="-1"></a><span class="in"> fit_opt  = mod_mono_analytes$optimize(</span></span>
<span id="cb196-979"><a href="#cb196-979" aria-hidden="true" tabindex="-1"></a><span class="in">   data = data_pH,</span></span>
<span id="cb196-980"><a href="#cb196-980" aria-hidden="true" tabindex="-1"></a><span class="in">   output_dir = here::here("stanfiles"),</span></span>
<span id="cb196-981"><a href="#cb196-981" aria-hidden="true" tabindex="-1"></a><span class="in">   output_basename = S, #paste(chosen_indices, collapse = ""),</span></span>
<span id="cb196-982"><a href="#cb196-982" aria-hidden="true" tabindex="-1"></a><span class="in">   seed = cseed,</span></span>
<span id="cb196-983"><a href="#cb196-983" aria-hidden="true" tabindex="-1"></a><span class="in">   init = init_ma_pH,</span></span>
<span id="cb196-984"><a href="#cb196-984" aria-hidden="true" tabindex="-1"></a><span class="in">   jacobian = TRUE,</span></span>
<span id="cb196-985"><a href="#cb196-985" aria-hidden="true" tabindex="-1"></a><span class="in">   show_messages = F)</span></span>
<span id="cb196-986"><a href="#cb196-986" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb196-987"><a href="#cb196-987" aria-hidden="true" tabindex="-1"></a><span class="in"> mode=fit_opt$unconstrain_variables(list(param = fit_opt$mle("param")))</span></span>
<span id="cb196-988"><a href="#cb196-988" aria-hidden="true" tabindex="-1"></a><span class="in"> hessian = fit_opt$hessian(unconstrained_variables = mode)$hessian</span></span>
<span id="cb196-989"><a href="#cb196-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-990"><a href="#cb196-990" aria-hidden="true" tabindex="-1"></a><span class="in">logdet = unlist(purrr::map(1:data_pH$nAnalytes,\(i) log(det(-hessian[((i-1)*6+1):((i-1)*6+6),((i-1)*6+1):((i-1)*6+6)]))))</span></span>
<span id="cb196-991"><a href="#cb196-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-992"><a href="#cb196-992" aria-hidden="true" tabindex="-1"></a><span class="in">return(logdet)</span></span>
<span id="cb196-993"><a href="#cb196-993" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-994"><a href="#cb196-994" aria-hidden="true" tabindex="-1"></a><span class="in"># data_ma_pH%&gt;%mutate(line = 1:n())%&gt;%filter(tg %in% c(30,90), fio==0.05)%&gt;%select(line)%&gt;%pull()</span></span>
<span id="cb196-995"><a href="#cb196-995" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(33,34,35,36,129,130,131,132)</span></span>
<span id="cb196-996"><a href="#cb196-996" aria-hidden="true" tabindex="-1"></a><span class="in"># quick test:</span></span>
<span id="cb196-997"><a href="#cb196-997" aria-hidden="true" tabindex="-1"></a><span class="in">z_prior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan_pH(datastruct_prior_ma_pH[[i]], inits_pH[[i]], chosen_indices, i))</span></span>
<span id="cb196-998"><a href="#cb196-998" aria-hidden="true" tabindex="-1"></a><span class="in">z_noprior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan_pH(datastruct_noprior_ma_pH[[i]], inits_pH[[i]], chosen_indices, i))</span></span>
<span id="cb196-999"><a href="#cb196-999" aria-hidden="true" tabindex="-1"></a><span class="in">test = c(mean(unlist(z_prior)),mean(unlist(z_noprior)))</span></span>
<span id="cb196-1000"><a href="#cb196-1000" aria-hidden="true" tabindex="-1"></a><span class="in">test</span></span>
<span id="cb196-1001"><a href="#cb196-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1002"><a href="#cb196-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1003"><a href="#cb196-1003" aria-hidden="true" tabindex="-1"></a><span class="in">logP = unlist(purrr::map(1:length(datastruct_prior_ma_pH),\(i) datastruct_prior_ma_pH[[i]]$logPobs))</span></span>
<span id="cb196-1004"><a href="#cb196-1004" aria-hidden="true" tabindex="-1"></a><span class="in">AB = unlist(purrr::map(1:length(datastruct_prior_ma_pH),\(i) datastruct_prior_ma_pH[[i]]$A1B2))</span></span>
<span id="cb196-1005"><a href="#cb196-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1006"><a href="#cb196-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1007"><a href="#cb196-1007" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1008"><a href="#cb196-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1009"><a href="#cb196-1009" aria-hidden="true" tabindex="-1"></a><span class="fu">## Optimize </span></span>
<span id="cb196-1010"><a href="#cb196-1010" aria-hidden="true" tabindex="-1"></a><span class="in">```{r monoprotic-analytes-optimize, eval = F}</span></span>
<span id="cb196-1011"><a href="#cb196-1011" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(130,139,137)</span></span>
<span id="cb196-1012"><a href="#cb196-1012" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1013"><a href="#cb196-1013" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(137,130,139,136)</span></span>
<span id="cb196-1014"><a href="#cb196-1014" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1015"><a href="#cb196-1015" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(142,137,130,139,136)</span></span>
<span id="cb196-1016"><a href="#cb196-1016" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_5 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1017"><a href="#cb196-1017" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(141,142,129,130,139,136)</span></span>
<span id="cb196-1018"><a href="#cb196-1018" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_6 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1019"><a href="#cb196-1019" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(45,46,133,130,139,136)</span></span>
<span id="cb196-1020"><a href="#cb196-1020" aria-hidden="true" tabindex="-1"></a><span class="in">fw_noprior_6 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1021"><a href="#cb196-1021" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(45,141,142,129,130,139,136)</span></span>
<span id="cb196-1022"><a href="#cb196-1022" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_7 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1023"><a href="#cb196-1023" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(142,45,46,133,130,139,136)</span></span>
<span id="cb196-1024"><a href="#cb196-1024" aria-hidden="true" tabindex="-1"></a><span class="in">fw_noprior_7 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1025"><a href="#cb196-1025" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(46,135,141,142,129,130,143,136)</span></span>
<span id="cb196-1026"><a href="#cb196-1026" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_8 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1027"><a href="#cb196-1027" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(46,135,141,142,129,130,143,136)</span></span>
<span id="cb196-1028"><a href="#cb196-1028" aria-hidden="true" tabindex="-1"></a><span class="in">fw_noprior_8 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1029"><a href="#cb196-1029" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(1,46,135,141,142,129,130,143,136)</span></span>
<span id="cb196-1030"><a href="#cb196-1030" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_9 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1031"><a href="#cb196-1031" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(1,46,135,141,142,129,130,143,136)</span></span>
<span id="cb196-1032"><a href="#cb196-1032" aria-hidden="true" tabindex="-1"></a><span class="in">fw_noprior_9 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1033"><a href="#cb196-1033" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(1,139,46,135,141,142,129,130,143,136)</span></span>
<span id="cb196-1034"><a href="#cb196-1034" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_10 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1035"><a href="#cb196-1035" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(1,139,46,135,141,142,129,130,143,136)</span></span>
<span id="cb196-1036"><a href="#cb196-1036" aria-hidden="true" tabindex="-1"></a><span class="in">fw_noprior_10 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1037"><a href="#cb196-1037" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1038"><a href="#cb196-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1039"><a href="#cb196-1039" aria-hidden="true" tabindex="-1"></a><span class="fu">## Optimize tg constrain</span></span>
<span id="cb196-1040"><a href="#cb196-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```{r monoprotic-analytes-optimize-tgconstrain, eval=F}</span></span>
<span id="cb196-1041"><a href="#cb196-1041" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(33,34,35,36,129,130,131,132) #init</span></span>
<span id="cb196-1042"><a href="#cb196-1042" aria-hidden="true" tabindex="-1"></a><span class="in">fwtgc_prior_8 = fedorov_wynn_stan_par_tgconstraint(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, tg_constraint = 480, n_iter = 100)</span></span>
<span id="cb196-1043"><a href="#cb196-1043" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(33,34,35,36,129,130,131,132) #init</span></span>
<span id="cb196-1044"><a href="#cb196-1044" aria-hidden="true" tabindex="-1"></a><span class="in">fwtgc_noprior_8 = fedorov_wynn_stan_par_tgconstraint(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, tg_constraint = 480,n_iter = 100)</span></span>
<span id="cb196-1045"><a href="#cb196-1045" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1046"><a href="#cb196-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1047"><a href="#cb196-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">### Read the results and compare</span></span>
<span id="cb196-1048"><a href="#cb196-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```{r monoprotic-analytes-logDet-summary}</span></span>
<span id="cb196-1049"><a href="#cb196-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1050"><a href="#cb196-1050" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(130,139,137) # p=3</span></span>
<span id="cb196-1051"><a href="#cb196-1051" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1052"><a href="#cb196-1052" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(137,130,139,136) # p=4</span></span>
<span id="cb196-1053"><a href="#cb196-1053" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1054"><a href="#cb196-1054" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(142,137,130,139,136) # p=5</span></span>
<span id="cb196-1055"><a href="#cb196-1055" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_5 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1056"><a href="#cb196-1056" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(33,34,35,36,129,130,131,132) # ref </span></span>
<span id="cb196-1057"><a href="#cb196-1057" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior= c(33,34,35,36,129,130,131,132) # ref </span></span>
<span id="cb196-1058"><a href="#cb196-1058" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_ref = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1059"><a href="#cb196-1059" aria-hidden="true" tabindex="-1"></a><span class="in">fw_noprior_ref = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-1060"><a href="#cb196-1060" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(141,142,129,130,139,136) # p=6</span></span>
<span id="cb196-1061"><a href="#cb196-1061" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(45,46,133,130,139,136) # p=6</span></span>
<span id="cb196-1062"><a href="#cb196-1062" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_6 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1063"><a href="#cb196-1063" aria-hidden="true" tabindex="-1"></a><span class="in">fw_noprior_6 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-1064"><a href="#cb196-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1065"><a href="#cb196-1065" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(45,141,142,129,130,139,136) # p=7 </span></span>
<span id="cb196-1066"><a href="#cb196-1066" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(142,45,46,133,130,139,136) # p=7</span></span>
<span id="cb196-1067"><a href="#cb196-1067" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_7 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1068"><a href="#cb196-1068" aria-hidden="true" tabindex="-1"></a><span class="in">fw_noprior_7 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-1069"><a href="#cb196-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1070"><a href="#cb196-1070" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(46,135,141,142,129,130,143,136) # p=8 </span></span>
<span id="cb196-1071"><a href="#cb196-1071" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(46,139,141,142,129,130, 45, 136) # p=8</span></span>
<span id="cb196-1072"><a href="#cb196-1072" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_8 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1073"><a href="#cb196-1073" aria-hidden="true" tabindex="-1"></a><span class="in">fw_noprior_8 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-1074"><a href="#cb196-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1075"><a href="#cb196-1075" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(132, 46, 135, 141, 142, 129, 130, 143, 140) # p=9 </span></span>
<span id="cb196-1076"><a href="#cb196-1076" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior   = c(45, 46, 135, 141, 142, 129, 130, 143, 136) # p=9 </span></span>
<span id="cb196-1077"><a href="#cb196-1077" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_9 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1078"><a href="#cb196-1078" aria-hidden="true" tabindex="-1"></a><span class="in">fw_noprior_9 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-1079"><a href="#cb196-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1080"><a href="#cb196-1080" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(132,45,46,135,141,142,129,130,143,140) # p=10 </span></span>
<span id="cb196-1081"><a href="#cb196-1081" aria-hidden="true" tabindex="-1"></a><span class="in">fw_prior_10 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices, n_iter = 0)</span></span>
<span id="cb196-1082"><a href="#cb196-1082" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(45,132,46,135,141,142,129,130,143,144) # p=10 </span></span>
<span id="cb196-1083"><a href="#cb196-1083" aria-hidden="true" tabindex="-1"></a><span class="in">fw_noprior_10 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices, n_iter = 0)</span></span>
<span id="cb196-1084"><a href="#cb196-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1085"><a href="#cb196-1085" aria-hidden="true" tabindex="-1"></a><span class="in"> chosen_indices_prior   = c(33,30,47,46,141,130,135,136) # p=8 </span></span>
<span id="cb196-1086"><a href="#cb196-1086" aria-hidden="true" tabindex="-1"></a><span class="in"> chosen_indices_noprior = c(29,46,45,30,133,130,139,132) # p=8</span></span>
<span id="cb196-1087"><a href="#cb196-1087" aria-hidden="true" tabindex="-1"></a><span class="in"> fwtgc_prior_8 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_prior_ma_pH, inits_pH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1088"><a href="#cb196-1088" aria-hidden="true" tabindex="-1"></a><span class="in"> fwtgc_noprior_8 = fedorov_wynn_stan_par(mean_log_det_stan_pH, datastruct_noprior_ma_pH, inits_pH, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-1089"><a href="#cb196-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1090"><a href="#cb196-1090" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results = tibble(logP = logP,</span></span>
<span id="cb196-1091"><a href="#cb196-1091" aria-hidden="true" tabindex="-1"></a><span class="in">                         Type = AB,</span></span>
<span id="cb196-1092"><a href="#cb196-1092" aria-hidden="true" tabindex="-1"></a><span class="in">                         prior_ref = fw_prior_ref$log_det_FIM,</span></span>
<span id="cb196-1093"><a href="#cb196-1093" aria-hidden="true" tabindex="-1"></a><span class="in">                        noprior_ref = fw_noprior_ref$log_det_FIM,</span></span>
<span id="cb196-1094"><a href="#cb196-1094" aria-hidden="true" tabindex="-1"></a><span class="in">                         prior_03 = fw_prior_3$log_det_FIM,</span></span>
<span id="cb196-1095"><a href="#cb196-1095" aria-hidden="true" tabindex="-1"></a><span class="in">                         prior_04 = fw_prior_4$log_det_FIM,</span></span>
<span id="cb196-1096"><a href="#cb196-1096" aria-hidden="true" tabindex="-1"></a><span class="in">                         prior_05 = fw_prior_5$log_det_FIM,</span></span>
<span id="cb196-1097"><a href="#cb196-1097" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_06 = fw_prior_6$log_det_FIM,</span></span>
<span id="cb196-1098"><a href="#cb196-1098" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_06 = fw_noprior_6$log_det_FIM,</span></span>
<span id="cb196-1099"><a href="#cb196-1099" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_07 = fw_prior_7$log_det_FIM,</span></span>
<span id="cb196-1100"><a href="#cb196-1100" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_07 = fw_noprior_7$log_det_FIM,</span></span>
<span id="cb196-1101"><a href="#cb196-1101" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_08 = fw_prior_8$log_det_FIM,</span></span>
<span id="cb196-1102"><a href="#cb196-1102" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_08 = fw_noprior_8$log_det_FIM,</span></span>
<span id="cb196-1103"><a href="#cb196-1103" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_09 = fw_prior_9$log_det_FIM,</span></span>
<span id="cb196-1104"><a href="#cb196-1104" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_09 = fw_noprior_9$log_det_FIM,</span></span>
<span id="cb196-1105"><a href="#cb196-1105" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_10 = fw_prior_10$log_det_FIM,</span></span>
<span id="cb196-1106"><a href="#cb196-1106" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_10 = fw_noprior_10$log_det_FIM) %&gt;%</span></span>
<span id="cb196-1107"><a href="#cb196-1107" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(prior_ref:noprior_10, names_to = "method")</span></span>
<span id="cb196-1108"><a href="#cb196-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1109"><a href="#cb196-1109" aria-hidden="true" tabindex="-1"></a><span class="in">p1=ggplot(summary_results, aes(y=method,x=value))+</span></span>
<span id="cb196-1110"><a href="#cb196-1110" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-1111"><a href="#cb196-1111" aria-hidden="true" tabindex="-1"></a><span class="in"> geom_jitter(aes(y=method, x=value, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-1112"><a href="#cb196-1112" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-1113"><a href="#cb196-1113" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="log(|FIM|)", y = "Method")</span></span>
<span id="cb196-1114"><a href="#cb196-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1115"><a href="#cb196-1115" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diff = tibble(logP = logP,</span></span>
<span id="cb196-1116"><a href="#cb196-1116" aria-hidden="true" tabindex="-1"></a><span class="in">                         Type = AB,</span></span>
<span id="cb196-1117"><a href="#cb196-1117" aria-hidden="true" tabindex="-1"></a><span class="in">                         fw_prior_ref = fw_prior_ref$log_det_FIM,</span></span>
<span id="cb196-1118"><a href="#cb196-1118" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_noprior_ref = fw_noprior_ref$log_det_FIM,</span></span>
<span id="cb196-1119"><a href="#cb196-1119" aria-hidden="true" tabindex="-1"></a><span class="in">                         fw_prior_3 = fw_prior_3$log_det_FIM,</span></span>
<span id="cb196-1120"><a href="#cb196-1120" aria-hidden="true" tabindex="-1"></a><span class="in">                         fw_prior_4 = fw_prior_4$log_det_FIM,</span></span>
<span id="cb196-1121"><a href="#cb196-1121" aria-hidden="true" tabindex="-1"></a><span class="in">                         fw_prior_5 = fw_prior_5$log_det_FIM,</span></span>
<span id="cb196-1122"><a href="#cb196-1122" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_prior_6 = fw_prior_6$log_det_FIM,</span></span>
<span id="cb196-1123"><a href="#cb196-1123" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_noprior_6 = fw_noprior_6$log_det_FIM,</span></span>
<span id="cb196-1124"><a href="#cb196-1124" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_prior_7 = fw_prior_7$log_det_FIM,</span></span>
<span id="cb196-1125"><a href="#cb196-1125" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_noprior_7 = fw_noprior_7$log_det_FIM,</span></span>
<span id="cb196-1126"><a href="#cb196-1126" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_prior_8 = fw_prior_8$log_det_FIM,</span></span>
<span id="cb196-1127"><a href="#cb196-1127" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_noprior_8 = fw_noprior_8$log_det_FIM,</span></span>
<span id="cb196-1128"><a href="#cb196-1128" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_prior_9 = fw_prior_9$log_det_FIM,</span></span>
<span id="cb196-1129"><a href="#cb196-1129" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_noprior_9 = fw_noprior_9$log_det_FIM,</span></span>
<span id="cb196-1130"><a href="#cb196-1130" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_prior_10 = fw_prior_10$log_det_FIM,</span></span>
<span id="cb196-1131"><a href="#cb196-1131" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_noprior_10 = fw_noprior_10$log_det_FIM) %&gt;%</span></span>
<span id="cb196-1132"><a href="#cb196-1132" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_prior_03 = (fw_prior_3 - fw_prior_ref)/n_param,</span></span>
<span id="cb196-1133"><a href="#cb196-1133" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_04 = (fw_prior_4 - fw_prior_ref)/n_param,</span></span>
<span id="cb196-1134"><a href="#cb196-1134" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_05 = (fw_prior_5 - fw_prior_ref)/n_param,</span></span>
<span id="cb196-1135"><a href="#cb196-1135" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_06 = (fw_prior_6 - fw_prior_ref)/n_param,</span></span>
<span id="cb196-1136"><a href="#cb196-1136" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_06 = (fw_noprior_6 - fw_noprior_ref)/n_param,</span></span>
<span id="cb196-1137"><a href="#cb196-1137" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_07 = (fw_prior_7 - fw_prior_ref)/n_param,</span></span>
<span id="cb196-1138"><a href="#cb196-1138" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_07 = (fw_noprior_7 - fw_noprior_ref)/n_param,</span></span>
<span id="cb196-1139"><a href="#cb196-1139" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_08 = (fw_prior_8 - fw_prior_ref)/n_param,</span></span>
<span id="cb196-1140"><a href="#cb196-1140" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_08 = (fw_noprior_8 - fw_noprior_ref)/n_param,</span></span>
<span id="cb196-1141"><a href="#cb196-1141" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_09 = (fw_prior_9 - fw_prior_ref)/n_param,</span></span>
<span id="cb196-1142"><a href="#cb196-1142" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_09 = (fw_noprior_9 - fw_noprior_ref)/n_param,</span></span>
<span id="cb196-1143"><a href="#cb196-1143" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_10 = (fw_prior_10 - fw_prior_ref)/n_param,</span></span>
<span id="cb196-1144"><a href="#cb196-1144" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_10 = (fw_noprior_10 - fw_noprior_ref)/n_param)%&gt;%</span></span>
<span id="cb196-1145"><a href="#cb196-1145" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_prior_03:d_noprior_10, names_to = "method")</span></span>
<span id="cb196-1146"><a href="#cb196-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1147"><a href="#cb196-1147" aria-hidden="true" tabindex="-1"></a><span class="in">p2=ggplot(summary_results_diff, aes(y=method,x=exp(value)))+</span></span>
<span id="cb196-1148"><a href="#cb196-1148" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-1149"><a href="#cb196-1149" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-1150"><a href="#cb196-1150" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-1151"><a href="#cb196-1151" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Efficiency relative to the reference design", y = "Method")+</span></span>
<span id="cb196-1152"><a href="#cb196-1152" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")</span></span>
<span id="cb196-1153"><a href="#cb196-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1154"><a href="#cb196-1154" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diffprior = tibble(logP = logP,</span></span>
<span id="cb196-1155"><a href="#cb196-1155" aria-hidden="true" tabindex="-1"></a><span class="in">                         Type = AB,</span></span>
<span id="cb196-1156"><a href="#cb196-1156" aria-hidden="true" tabindex="-1"></a><span class="in">                         fw_prior_ref = fw_prior_ref$log_det_FIM,</span></span>
<span id="cb196-1157"><a href="#cb196-1157" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_noprior_ref = fw_noprior_ref$log_det_FIM,</span></span>
<span id="cb196-1158"><a href="#cb196-1158" aria-hidden="true" tabindex="-1"></a><span class="in">                         fw_prior_3 = fw_prior_3$log_det_FIM,</span></span>
<span id="cb196-1159"><a href="#cb196-1159" aria-hidden="true" tabindex="-1"></a><span class="in">                         fw_prior_4 = fw_prior_4$log_det_FIM,</span></span>
<span id="cb196-1160"><a href="#cb196-1160" aria-hidden="true" tabindex="-1"></a><span class="in">                         fw_prior_5 = fw_prior_5$log_det_FIM,</span></span>
<span id="cb196-1161"><a href="#cb196-1161" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_prior_6 = fw_prior_6$log_det_FIM,</span></span>
<span id="cb196-1162"><a href="#cb196-1162" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_noprior_6 = fw_noprior_6$log_det_FIM,</span></span>
<span id="cb196-1163"><a href="#cb196-1163" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_prior_7 = fw_prior_7$log_det_FIM,</span></span>
<span id="cb196-1164"><a href="#cb196-1164" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_noprior_7 = fw_noprior_7$log_det_FIM,</span></span>
<span id="cb196-1165"><a href="#cb196-1165" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_prior_8 = fw_prior_8$log_det_FIM,</span></span>
<span id="cb196-1166"><a href="#cb196-1166" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_noprior_8 = fw_noprior_8$log_det_FIM,</span></span>
<span id="cb196-1167"><a href="#cb196-1167" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_prior_9 = fw_prior_9$log_det_FIM,</span></span>
<span id="cb196-1168"><a href="#cb196-1168" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_noprior_9 = fw_noprior_9$log_det_FIM,</span></span>
<span id="cb196-1169"><a href="#cb196-1169" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_prior_10 = fw_prior_10$log_det_FIM,</span></span>
<span id="cb196-1170"><a href="#cb196-1170" aria-hidden="true" tabindex="-1"></a><span class="in">                          fw_noprior_10 = fw_noprior_10$log_det_FIM) %&gt;%</span></span>
<span id="cb196-1171"><a href="#cb196-1171" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_ref  = (fw_prior_ref-fw_noprior_ref)/n_param,</span></span>
<span id="cb196-1172"><a href="#cb196-1172" aria-hidden="true" tabindex="-1"></a><span class="in">         d_06 = (fw_prior_6-fw_noprior_6)/n_param,</span></span>
<span id="cb196-1173"><a href="#cb196-1173" aria-hidden="true" tabindex="-1"></a><span class="in">         d_07 = (fw_prior_7-fw_noprior_7)/n_param,</span></span>
<span id="cb196-1174"><a href="#cb196-1174" aria-hidden="true" tabindex="-1"></a><span class="in">         d_08 = (fw_prior_8-fw_noprior_8)/n_param,</span></span>
<span id="cb196-1175"><a href="#cb196-1175" aria-hidden="true" tabindex="-1"></a><span class="in">         d_09 = (fw_prior_9-fw_noprior_9)/n_param,</span></span>
<span id="cb196-1176"><a href="#cb196-1176" aria-hidden="true" tabindex="-1"></a><span class="in">         d_10 = (fw_prior_10-fw_noprior_10)/n_param)%&gt;%</span></span>
<span id="cb196-1177"><a href="#cb196-1177" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_ref:d_10, names_to = "method")</span></span>
<span id="cb196-1178"><a href="#cb196-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1179"><a href="#cb196-1179" aria-hidden="true" tabindex="-1"></a><span class="in">p3=ggplot(summary_results_diffprior, aes(y=method,x=exp(value)))+</span></span>
<span id="cb196-1180"><a href="#cb196-1180" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-1181"><a href="#cb196-1181" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-1182"><a href="#cb196-1182" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-1183"><a href="#cb196-1183" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Effect of prior on design efficiency", y = "Method")+</span></span>
<span id="cb196-1184"><a href="#cb196-1184" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")+</span></span>
<span id="cb196-1185"><a href="#cb196-1185" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0.5,100),</span></span>
<span id="cb196-1186"><a href="#cb196-1186" aria-hidden="true" tabindex="-1"></a><span class="in">                     trans='log10',</span></span>
<span id="cb196-1187"><a href="#cb196-1187" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.01, 100)),</span></span>
<span id="cb196-1188"><a href="#cb196-1188" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-1189"><a href="#cb196-1189" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb196-1190"><a href="#cb196-1190" aria-hidden="true" tabindex="-1"></a><span class="in">p2</span></span>
<span id="cb196-1191"><a href="#cb196-1191" aria-hidden="true" tabindex="-1"></a><span class="in">p3</span></span>
<span id="cb196-1192"><a href="#cb196-1192" aria-hidden="true" tabindex="-1"></a><span class="in">f2_2 = p2</span></span>
<span id="cb196-1193"><a href="#cb196-1193" aria-hidden="true" tabindex="-1"></a><span class="in">f3_2 = p3</span></span>
<span id="cb196-1194"><a href="#cb196-1194" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p1, .filename=paste("monoprotic-analytes-logdFIM-abs.pdf"), .path = figures_dir2)</span></span>
<span id="cb196-1195"><a href="#cb196-1195" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p1, .filename=paste("monoprotic-analytes-logdFIM-abs.png"), .path = figures_dir2)</span></span>
<span id="cb196-1196"><a href="#cb196-1196" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p2, .filename=paste("monoprotic-analytes-logdFIM-rel.pdf"), .path = figures_dir2)</span></span>
<span id="cb196-1197"><a href="#cb196-1197" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p2, .filename=paste("monoprotic-analytes-logdFIM-rel.png"), .path = figures_dir2)</span></span>
<span id="cb196-1198"><a href="#cb196-1198" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p3, .filename=paste("monoprotic-analytes-logdFIM-prioreff.pdf"), .path = figures_dir2)</span></span>
<span id="cb196-1199"><a href="#cb196-1199" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p3, .filename=paste("monoprotic-analytes-logdFIM-prioreff.png"), .path = figures_dir2)</span></span>
<span id="cb196-1200"><a href="#cb196-1200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1201"><a href="#cb196-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1202"><a href="#cb196-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1203"><a href="#cb196-1203" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table</span></span>
<span id="cb196-1204"><a href="#cb196-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1205"><a href="#cb196-1205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r monoprotic-analytes-table}</span></span>
<span id="cb196-1206"><a href="#cb196-1206" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma_pH=hplcparam_candidates_df%&gt;%</span></span>
<span id="cb196-1207"><a href="#cb196-1207" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(line=1:n())</span></span>
<span id="cb196-1208"><a href="#cb196-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1209"><a href="#cb196-1209" aria-hidden="true" tabindex="-1"></a><span class="in">combined_results = list(</span></span>
<span id="cb196-1210"><a href="#cb196-1210" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ref = fw_prior_ref$chosen_indices,</span></span>
<span id="cb196-1211"><a href="#cb196-1211" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ref = fw_noprior_ref$chosen_indices,</span></span>
<span id="cb196-1212"><a href="#cb196-1212" aria-hidden="true" tabindex="-1"></a><span class="in">prior_3 = fw_prior_3$chosen_indices,</span></span>
<span id="cb196-1213"><a href="#cb196-1213" aria-hidden="true" tabindex="-1"></a><span class="in">prior_4 = fw_prior_4$chosen_indices,</span></span>
<span id="cb196-1214"><a href="#cb196-1214" aria-hidden="true" tabindex="-1"></a><span class="in">prior_5 = fw_prior_5$chosen_indices,</span></span>
<span id="cb196-1215"><a href="#cb196-1215" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_3 = 10000+fw_prior_3$chosen_indices,</span></span>
<span id="cb196-1216"><a href="#cb196-1216" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_4 = 10000+fw_prior_4$chosen_indices,</span></span>
<span id="cb196-1217"><a href="#cb196-1217" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_5 = 10000+fw_prior_5$chosen_indices,</span></span>
<span id="cb196-1218"><a href="#cb196-1218" aria-hidden="true" tabindex="-1"></a><span class="in">prior_6 = fw_prior_6$chosen_indices,</span></span>
<span id="cb196-1219"><a href="#cb196-1219" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_6 = fw_noprior_6$chosen_indices,</span></span>
<span id="cb196-1220"><a href="#cb196-1220" aria-hidden="true" tabindex="-1"></a><span class="in">prior_7 = fw_prior_7$chosen_indices,</span></span>
<span id="cb196-1221"><a href="#cb196-1221" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_7 = fw_noprior_7$chosen_indices,</span></span>
<span id="cb196-1222"><a href="#cb196-1222" aria-hidden="true" tabindex="-1"></a><span class="in">prior_8 = fw_prior_8$chosen_indices,</span></span>
<span id="cb196-1223"><a href="#cb196-1223" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_8 = fw_noprior_8$chosen_indices,</span></span>
<span id="cb196-1224"><a href="#cb196-1224" aria-hidden="true" tabindex="-1"></a><span class="in">prior_9 = fw_prior_9$chosen_indices,</span></span>
<span id="cb196-1225"><a href="#cb196-1225" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_9 = fw_noprior_9$chosen_indices,</span></span>
<span id="cb196-1226"><a href="#cb196-1226" aria-hidden="true" tabindex="-1"></a><span class="in">prior_10 = fw_prior_10$chosen_indices,</span></span>
<span id="cb196-1227"><a href="#cb196-1227" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_10 = fw_noprior_10$chosen_indices)</span></span>
<span id="cb196-1228"><a href="#cb196-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1229"><a href="#cb196-1229" aria-hidden="true" tabindex="-1"></a><span class="in">selected_exp = enframe(combined_results)%&gt;%</span></span>
<span id="cb196-1230"><a href="#cb196-1230" aria-hidden="true" tabindex="-1"></a><span class="in">   unnest(value) %&gt;%</span></span>
<span id="cb196-1231"><a href="#cb196-1231" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(line=value, Name = name) %&gt;%</span></span>
<span id="cb196-1232"><a href="#cb196-1232" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(data_ma_pH, by = "line")%&gt;%</span></span>
<span id="cb196-1233"><a href="#cb196-1233" aria-hidden="true" tabindex="-1"></a><span class="in">   arrange(Name,xpH,tg, fio)%&gt;%</span></span>
<span id="cb196-1234"><a href="#cb196-1234" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Modifier = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb196-1235"><a href="#cb196-1235" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(xpH = if_else(xpH==0, "N", "I")) %&gt;%</span></span>
<span id="cb196-1236"><a href="#cb196-1236" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-c(line,m,td,to,te,fif)) %&gt;%</span></span>
<span id="cb196-1237"><a href="#cb196-1237" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(type = if_else(str_detect(Name, 'noprior'), "No prior", "Prior"))%&gt;%</span></span>
<span id="cb196-1238"><a href="#cb196-1238" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(where(is.numeric), ~replace_na(., -1)))</span></span>
<span id="cb196-1239"><a href="#cb196-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1240"><a href="#cb196-1240" aria-hidden="true" tabindex="-1"></a><span class="in">tab1&lt;-selected_exp %&gt;%</span></span>
<span id="cb196-1241"><a href="#cb196-1241" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "Prior") %&gt;%</span></span>
<span id="cb196-1242"><a href="#cb196-1242" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-type)%&gt;%</span></span>
<span id="cb196-1243"><a href="#cb196-1243" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb196-1244"><a href="#cb196-1244" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-1245"><a href="#cb196-1245" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-1246"><a href="#cb196-1246" aria-hidden="true" tabindex="-1"></a><span class="in">tab2&lt;-selected_exp %&gt;%</span></span>
<span id="cb196-1247"><a href="#cb196-1247" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "No prior")%&gt;%</span></span>
<span id="cb196-1248"><a href="#cb196-1248" aria-hidden="true" tabindex="-1"></a><span class="in">    select(-type)%&gt;%</span></span>
<span id="cb196-1249"><a href="#cb196-1249" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb196-1250"><a href="#cb196-1250" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-1251"><a href="#cb196-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1252"><a href="#cb196-1252" aria-hidden="true" tabindex="-1"></a><span class="in">tab2 &lt;- set_formatter(</span></span>
<span id="cb196-1253"><a href="#cb196-1253" aria-hidden="true" tabindex="-1"></a><span class="in">  tab2, </span></span>
<span id="cb196-1254"><a href="#cb196-1254" aria-hidden="true" tabindex="-1"></a><span class="in">  tg = function(x) ifelse(x==-1," ", sprintf("%d", x) ),</span></span>
<span id="cb196-1255"><a href="#cb196-1255" aria-hidden="true" tabindex="-1"></a><span class="in">  fio = function(x) ifelse(x==-1," ", sprintf("%.2f", x) )</span></span>
<span id="cb196-1256"><a href="#cb196-1256" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb196-1257"><a href="#cb196-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1258"><a href="#cb196-1258" aria-hidden="true" tabindex="-1"></a><span class="in">p1 = gen_grob(tab1, fit = "auto", just = "centre")</span></span>
<span id="cb196-1259"><a href="#cb196-1259" aria-hidden="true" tabindex="-1"></a><span class="in">p2 = gen_grob(tab2, fit = "auto", just = "centre") </span></span>
<span id="cb196-1260"><a href="#cb196-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1261"><a href="#cb196-1261" aria-hidden="true" tabindex="-1"></a><span class="in">gg&lt;-ggplot()+</span></span>
<span id="cb196-1262"><a href="#cb196-1262" aria-hidden="true" tabindex="-1"></a><span class="in">       theme(</span></span>
<span id="cb196-1263"><a href="#cb196-1263" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.background = element_rect(fill='transparent'),</span></span>
<span id="cb196-1264"><a href="#cb196-1264" aria-hidden="true" tabindex="-1"></a><span class="in">         plot.background = element_rect(fill='transparent', color=NA),</span></span>
<span id="cb196-1265"><a href="#cb196-1265" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.major = element_blank(),</span></span>
<span id="cb196-1266"><a href="#cb196-1266" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.minor = element_blank(),</span></span>
<span id="cb196-1267"><a href="#cb196-1267" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.background = element_rect(fill='transparent'),</span></span>
<span id="cb196-1268"><a href="#cb196-1268" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.box.background = element_rect(fill='transparent')</span></span>
<span id="cb196-1269"><a href="#cb196-1269" aria-hidden="true" tabindex="-1"></a><span class="in">       )</span></span>
<span id="cb196-1270"><a href="#cb196-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1271"><a href="#cb196-1271" aria-hidden="true" tabindex="-1"></a><span class="in">plot1 &lt;- gg+p1+p2+ plot_layout(ncol = 3, widths = c(1, 20,20))</span></span>
<span id="cb196-1272"><a href="#cb196-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1273"><a href="#cb196-1273" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plot1, .filename=paste("monoprotic-table.pdf"), .path = tables_dir2)</span></span>
<span id="cb196-1274"><a href="#cb196-1274" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plot1, .filename=paste("monoprotic-table.png"), .path = tables_dir2)</span></span>
<span id="cb196-1275"><a href="#cb196-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1276"><a href="#cb196-1276" aria-hidden="true" tabindex="-1"></a><span class="in">tab1</span></span>
<span id="cb196-1277"><a href="#cb196-1277" aria-hidden="true" tabindex="-1"></a><span class="in">tab2</span></span>
<span id="cb196-1278"><a href="#cb196-1278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1279"><a href="#cb196-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1280"><a href="#cb196-1280" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stan simulations</span></span>
<span id="cb196-1281"><a href="#cb196-1281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r monoprotic-analytes-laplace, eval = F}</span></span>
<span id="cb196-1282"><a href="#cb196-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1283"><a href="#cb196-1283" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_prior_ref$chosen_indices</span></span>
<span id="cb196-1284"><a href="#cb196-1284" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_pH_ref = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1285"><a href="#cb196-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1286"><a href="#cb196-1286" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_noprior_ref$chosen_indices</span></span>
<span id="cb196-1287"><a href="#cb196-1287" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_pH_ref = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_noprior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1288"><a href="#cb196-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1289"><a href="#cb196-1289" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_prior_3$chosen_indices # p=3</span></span>
<span id="cb196-1290"><a href="#cb196-1290" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_pH_3 = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1291"><a href="#cb196-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1292"><a href="#cb196-1292" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_prior_4$chosen_indices # p=4</span></span>
<span id="cb196-1293"><a href="#cb196-1293" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_pH_4 = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1294"><a href="#cb196-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1295"><a href="#cb196-1295" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_prior_5$chosen_indices # p=5</span></span>
<span id="cb196-1296"><a href="#cb196-1296" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_pH_5 = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1297"><a href="#cb196-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1298"><a href="#cb196-1298" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_prior_6$chosen_indices # p=6</span></span>
<span id="cb196-1299"><a href="#cb196-1299" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_pH_6 = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1300"><a href="#cb196-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1301"><a href="#cb196-1301" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_noprior_6$chosen_indices  # p=6</span></span>
<span id="cb196-1302"><a href="#cb196-1302" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_pH_6 = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_noprior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1303"><a href="#cb196-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1304"><a href="#cb196-1304" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_prior_7$chosen_indices  # p=7 </span></span>
<span id="cb196-1305"><a href="#cb196-1305" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_pH_7 = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1306"><a href="#cb196-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1307"><a href="#cb196-1307" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_noprior_7$chosen_indices # p=7</span></span>
<span id="cb196-1308"><a href="#cb196-1308" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_pH_7 = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_noprior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1309"><a href="#cb196-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1310"><a href="#cb196-1310" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_prior_8$chosen_indices  # p=8</span></span>
<span id="cb196-1311"><a href="#cb196-1311" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_pH_8 = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1312"><a href="#cb196-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1313"><a href="#cb196-1313" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_noprior_8$chosen_indices  # p=8</span></span>
<span id="cb196-1314"><a href="#cb196-1314" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_pH_8 = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_noprior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1315"><a href="#cb196-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1316"><a href="#cb196-1316" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_prior_9$chosen_indices  # p=9</span></span>
<span id="cb196-1317"><a href="#cb196-1317" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_pH_9 = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1318"><a href="#cb196-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1319"><a href="#cb196-1319" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_noprior_9$chosen_indices  # p=9</span></span>
<span id="cb196-1320"><a href="#cb196-1320" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_pH_9 = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_noprior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1321"><a href="#cb196-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1322"><a href="#cb196-1322" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_prior_10$chosen_indices  # p=10</span></span>
<span id="cb196-1323"><a href="#cb196-1323" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_pH_10 = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_prior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1324"><a href="#cb196-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1325"><a href="#cb196-1325" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices=fw_noprior_10$chosen_indices  # p=10</span></span>
<span id="cb196-1326"><a href="#cb196-1326" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_pH_10 = fun_predict_stan_results_pH(mod_mono_analytes_sim, datastruct_noprior_ma_pH, inits_pH, chosen_indices, 10) </span></span>
<span id="cb196-1327"><a href="#cb196-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1328"><a href="#cb196-1328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1329"><a href="#cb196-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1330"><a href="#cb196-1330" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gradient conditions</span></span>
<span id="cb196-1331"><a href="#cb196-1331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r monoprotic-analytes-gra-summary-v2}</span></span>
<span id="cb196-1332"><a href="#cb196-1332" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = fw_prior_10$chosen_indices# p=10</span></span>
<span id="cb196-1333"><a href="#cb196-1333" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = fw_noprior_10$chosen_indices # p=10</span></span>
<span id="cb196-1334"><a href="#cb196-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1335"><a href="#cb196-1335" aria-hidden="true" tabindex="-1"></a><span class="in">p31=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb196-1336"><a href="#cb196-1336" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb196-1337"><a href="#cb196-1337" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(prior_ma_pH_10$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb196-1338"><a href="#cb196-1338" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices_prior,1,0))) %&gt;%</span></span>
<span id="cb196-1339"><a href="#cb196-1339" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb196-1340"><a href="#cb196-1340" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(pH_f = if_else(xpH==0,"N", "A or B"))%&gt;%</span></span>
<span id="cb196-1341"><a href="#cb196-1341" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot( aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb196-1342"><a href="#cb196-1342" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb196-1343"><a href="#cb196-1343" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb196-1344"><a href="#cb196-1344" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(pH_f~m_f)</span></span>
<span id="cb196-1345"><a href="#cb196-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1346"><a href="#cb196-1346" aria-hidden="true" tabindex="-1"></a><span class="in">p32=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb196-1347"><a href="#cb196-1347" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb196-1348"><a href="#cb196-1348" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(noprior_ma_pH_10$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb196-1349"><a href="#cb196-1349" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices_noprior,1,0))) %&gt;%</span></span>
<span id="cb196-1350"><a href="#cb196-1350" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb196-1351"><a href="#cb196-1351" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(pH_f = if_else(xpH==0,"N", "A or B"))%&gt;%</span></span>
<span id="cb196-1352"><a href="#cb196-1352" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot( aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb196-1353"><a href="#cb196-1353" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb196-1354"><a href="#cb196-1354" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb196-1355"><a href="#cb196-1355" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(pH_f~m_f)</span></span>
<span id="cb196-1356"><a href="#cb196-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1357"><a href="#cb196-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1358"><a href="#cb196-1358" aria-hidden="true" tabindex="-1"></a><span class="in">iresults = rbind(prior_ma_pH_ref$iresults%&gt;%</span></span>
<span id="cb196-1359"><a href="#cb196-1359" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb196-1360"><a href="#cb196-1360" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_pH_ref$iresults%&gt;%</span></span>
<span id="cb196-1361"><a href="#cb196-1361" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb196-1362"><a href="#cb196-1362" aria-hidden="true" tabindex="-1"></a><span class="in">                  prior_ma_pH_3$iresults%&gt;%</span></span>
<span id="cb196-1363"><a href="#cb196-1363" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_03"),</span></span>
<span id="cb196-1364"><a href="#cb196-1364" aria-hidden="true" tabindex="-1"></a><span class="in">                  prior_ma_pH_4$iresults%&gt;%</span></span>
<span id="cb196-1365"><a href="#cb196-1365" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_04"),</span></span>
<span id="cb196-1366"><a href="#cb196-1366" aria-hidden="true" tabindex="-1"></a><span class="in">                   prior_ma_pH_5$iresults%&gt;%</span></span>
<span id="cb196-1367"><a href="#cb196-1367" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_05"),</span></span>
<span id="cb196-1368"><a href="#cb196-1368" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_pH_6$iresults%&gt;%</span></span>
<span id="cb196-1369"><a href="#cb196-1369" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_06"),</span></span>
<span id="cb196-1370"><a href="#cb196-1370" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_pH_6$iresults%&gt;%</span></span>
<span id="cb196-1371"><a href="#cb196-1371" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_06"),</span></span>
<span id="cb196-1372"><a href="#cb196-1372" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_pH_7$iresults%&gt;%</span></span>
<span id="cb196-1373"><a href="#cb196-1373" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_07"),</span></span>
<span id="cb196-1374"><a href="#cb196-1374" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_pH_7$iresults%&gt;%</span></span>
<span id="cb196-1375"><a href="#cb196-1375" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_07"),</span></span>
<span id="cb196-1376"><a href="#cb196-1376" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_pH_8$iresults%&gt;%</span></span>
<span id="cb196-1377"><a href="#cb196-1377" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_08"),</span></span>
<span id="cb196-1378"><a href="#cb196-1378" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_pH_8$iresults%&gt;%</span></span>
<span id="cb196-1379"><a href="#cb196-1379" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_08"),</span></span>
<span id="cb196-1380"><a href="#cb196-1380" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_pH_9$iresults%&gt;%</span></span>
<span id="cb196-1381"><a href="#cb196-1381" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_09"),</span></span>
<span id="cb196-1382"><a href="#cb196-1382" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_pH_9$iresults%&gt;%</span></span>
<span id="cb196-1383"><a href="#cb196-1383" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_09"),</span></span>
<span id="cb196-1384"><a href="#cb196-1384" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_pH_10$iresults%&gt;%</span></span>
<span id="cb196-1385"><a href="#cb196-1385" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_10"),</span></span>
<span id="cb196-1386"><a href="#cb196-1386" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_pH_10$iresults%&gt;%</span></span>
<span id="cb196-1387"><a href="#cb196-1387" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_10"))%&gt;%</span></span>
<span id="cb196-1388"><a href="#cb196-1388" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(ivar = if_else(ivar&gt;1e6,1e6,ivar))%&gt;%</span></span>
<span id="cb196-1389"><a href="#cb196-1389" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.factor(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB))</span></span>
<span id="cb196-1390"><a href="#cb196-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1391"><a href="#cb196-1391" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=iresults %&gt;%</span></span>
<span id="cb196-1392"><a href="#cb196-1392" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb196-1393"><a href="#cb196-1393" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-1394"><a href="#cb196-1394" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-1395"><a href="#cb196-1395" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-1396"><a href="#cb196-1396" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb196-1397"><a href="#cb196-1397" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb196-1398"><a href="#cb196-1398" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(0.1,100))+   </span></span>
<span id="cb196-1399"><a href="#cb196-1399" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-1400"><a href="#cb196-1400" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb196-1401"><a href="#cb196-1401" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-1402"><a href="#cb196-1402" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=iresults %&gt;%</span></span>
<span id="cb196-1403"><a href="#cb196-1403" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb196-1404"><a href="#cb196-1404" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-1405"><a href="#cb196-1405" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-1406"><a href="#cb196-1406" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-1407"><a href="#cb196-1407" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb196-1408"><a href="#cb196-1408" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb196-1409"><a href="#cb196-1409" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,1000000))+    </span></span>
<span id="cb196-1410"><a href="#cb196-1410" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-1411"><a href="#cb196-1411" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb196-1412"><a href="#cb196-1412" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-1413"><a href="#cb196-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1414"><a href="#cb196-1414" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb196-1415"><a href="#cb196-1415" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb196-1416"><a href="#cb196-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1417"><a href="#cb196-1417" aria-hidden="true" tabindex="-1"></a><span class="in">idx_exemple_analytes = iresults %&gt;%</span></span>
<span id="cb196-1418"><a href="#cb196-1418" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(method=="prior_ref") %&gt;%</span></span>
<span id="cb196-1419"><a href="#cb196-1419" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(ivar)%&gt;%</span></span>
<span id="cb196-1420"><a href="#cb196-1420" aria-hidden="true" tabindex="-1"></a><span class="in">  slice(which(row_number() %% 100 == 1)) %&gt;%</span></span>
<span id="cb196-1421"><a href="#cb196-1421" aria-hidden="true" tabindex="-1"></a><span class="in">  select(i)%&gt;%pull</span></span>
<span id="cb196-1422"><a href="#cb196-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1423"><a href="#cb196-1423" aria-hidden="true" tabindex="-1"></a><span class="in">iresults %&gt;%</span></span>
<span id="cb196-1424"><a href="#cb196-1424" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb196-1425"><a href="#cb196-1425" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb196-1426"><a href="#cb196-1426" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb196-1427"><a href="#cb196-1427" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb196-1428"><a href="#cb196-1428" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-1429"><a href="#cb196-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1430"><a href="#cb196-1430" aria-hidden="true" tabindex="-1"></a><span class="in">f55_2=iresults %&gt;%</span></span>
<span id="cb196-1431"><a href="#cb196-1431" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb196-1432"><a href="#cb196-1432" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb196-1433"><a href="#cb196-1433" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb196-1434"><a href="#cb196-1434" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb196-1435"><a href="#cb196-1435" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(`&lt;=1x`:`&lt;=3x`, names_to = "target") %&gt;%</span></span>
<span id="cb196-1436"><a href="#cb196-1436" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=value,color=as.factor(target)))+</span></span>
<span id="cb196-1437"><a href="#cb196-1437" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point()+</span></span>
<span id="cb196-1438"><a href="#cb196-1438" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Probability", y = "Method", color = "target")+</span></span>
<span id="cb196-1439"><a href="#cb196-1439" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 0.9, linetype="dotted")</span></span>
<span id="cb196-1440"><a href="#cb196-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1441"><a href="#cb196-1441" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=f55_2, .filename=paste("monoprotic-analytes-gra-prob.pdf"), .path = figures_dir1)</span></span>
<span id="cb196-1442"><a href="#cb196-1442" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=f55_2, .filename=paste("monoprotic-analytes-gra-prob.png"), .path = figures_dir1)</span></span>
<span id="cb196-1443"><a href="#cb196-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1444"><a href="#cb196-1444" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p31, .filename=paste("monoprotic-analytes-gra-prior-p10.pdf"), .path = figures_dir2)</span></span>
<span id="cb196-1445"><a href="#cb196-1445" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p31, .filename=paste("monoprotic-analytes-gra-prior-p10.png"), .path = figures_dir2)</span></span>
<span id="cb196-1446"><a href="#cb196-1446" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p32, .filename=paste("monoprotic-analytes-gra-noprior-p10.pdf"), .path = figures_dir2)</span></span>
<span id="cb196-1447"><a href="#cb196-1447" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p32, .filename=paste("monoprotic-analytes-gra-noprior-p10.png"), .path = figures_dir2)</span></span>
<span id="cb196-1448"><a href="#cb196-1448" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("monoprotic-analytes-gra-maxvar.pdf"), .path = figures_dir2)</span></span>
<span id="cb196-1449"><a href="#cb196-1449" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("monoprotic-analytes-gra-maxvar.png"), .path = figures_dir2)</span></span>
<span id="cb196-1450"><a href="#cb196-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1451"><a href="#cb196-1451" aria-hidden="true" tabindex="-1"></a><span class="in">p31</span></span>
<span id="cb196-1452"><a href="#cb196-1452" aria-hidden="true" tabindex="-1"></a><span class="in">p32</span></span>
<span id="cb196-1453"><a href="#cb196-1453" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb196-1454"><a href="#cb196-1454" aria-hidden="true" tabindex="-1"></a><span class="in">f33_2=p33</span></span>
<span id="cb196-1455"><a href="#cb196-1455" aria-hidden="true" tabindex="-1"></a><span class="in">f55_2</span></span>
<span id="cb196-1456"><a href="#cb196-1456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1457"><a href="#cb196-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1458"><a href="#cb196-1458" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Izocratic conditions</span></span>
<span id="cb196-1459"><a href="#cb196-1459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r monoprotic-analytes-izo-summary-v2}</span></span>
<span id="cb196-1460"><a href="#cb196-1460" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb196-1461"><a href="#cb196-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1462"><a href="#cb196-1462" aria-hidden="true" tabindex="-1"></a><span class="in">plot_id = function(results) { </span></span>
<span id="cb196-1463"><a href="#cb196-1463" aria-hidden="true" tabindex="-1"></a><span class="in">  results %&gt;%</span></span>
<span id="cb196-1464"><a href="#cb196-1464" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=fi, y=CV/10)) +</span></span>
<span id="cb196-1465"><a href="#cb196-1465" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb196-1466"><a href="#cb196-1466" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(aes(x=fi, ymin = llog10tr, ymax = ulog10tr), alpha = 0.4, col = NA) +</span></span>
<span id="cb196-1467"><a href="#cb196-1467" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x=fi, y=mlog10tr), col = "black", size=0.25) +</span></span>
<span id="cb196-1468"><a href="#cb196-1468" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_y_continuous(</span></span>
<span id="cb196-1469"><a href="#cb196-1469" aria-hidden="true" tabindex="-1"></a><span class="in">    name = "log(tr)",</span></span>
<span id="cb196-1470"><a href="#cb196-1470" aria-hidden="true" tabindex="-1"></a><span class="in">    sec.axis = sec_axis(~.*10, name="%CV")) +</span></span>
<span id="cb196-1471"><a href="#cb196-1471" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_x_continuous(breaks = seq(0,1,by=0.2))+</span></span>
<span id="cb196-1472"><a href="#cb196-1472" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_grid(i~mod+form) +</span></span>
<span id="cb196-1473"><a href="#cb196-1473" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 1, linetype=2)+</span></span>
<span id="cb196-1474"><a href="#cb196-1474" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim=c(0,4))</span></span>
<span id="cb196-1475"><a href="#cb196-1475" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-1476"><a href="#cb196-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1477"><a href="#cb196-1477" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_pH_ref&lt;-prior_ma_pH_ref$izoresults%&gt;%</span></span>
<span id="cb196-1478"><a href="#cb196-1478" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1479"><a href="#cb196-1479" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1480"><a href="#cb196-1480" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1481"><a href="#cb196-1481" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1482"><a href="#cb196-1482" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1483"><a href="#cb196-1483" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1484"><a href="#cb196-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1485"><a href="#cb196-1485" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_pH_ref&lt;-noprior_ma_pH_ref$izoresults%&gt;%</span></span>
<span id="cb196-1486"><a href="#cb196-1486" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1487"><a href="#cb196-1487" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1488"><a href="#cb196-1488" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1489"><a href="#cb196-1489" aria-hidden="true" tabindex="-1"></a><span class="in">      filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1490"><a href="#cb196-1490" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1491"><a href="#cb196-1491" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1492"><a href="#cb196-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1493"><a href="#cb196-1493" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_pH_3&lt;-prior_ma_pH_3$izoresults%&gt;%</span></span>
<span id="cb196-1494"><a href="#cb196-1494" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1495"><a href="#cb196-1495" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1496"><a href="#cb196-1496" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1497"><a href="#cb196-1497" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1498"><a href="#cb196-1498" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1499"><a href="#cb196-1499" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1500"><a href="#cb196-1500" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_pH_4&lt;-prior_ma_pH_4$izoresults%&gt;%</span></span>
<span id="cb196-1501"><a href="#cb196-1501" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1502"><a href="#cb196-1502" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1503"><a href="#cb196-1503" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1504"><a href="#cb196-1504" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1505"><a href="#cb196-1505" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1506"><a href="#cb196-1506" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1507"><a href="#cb196-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1508"><a href="#cb196-1508" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_pH_5&lt;-prior_ma_pH_5$izoresults%&gt;%</span></span>
<span id="cb196-1509"><a href="#cb196-1509" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1510"><a href="#cb196-1510" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1511"><a href="#cb196-1511" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1512"><a href="#cb196-1512" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1513"><a href="#cb196-1513" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1514"><a href="#cb196-1514" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1515"><a href="#cb196-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1516"><a href="#cb196-1516" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_pH_6&lt;-prior_ma_pH_6$izoresults%&gt;%</span></span>
<span id="cb196-1517"><a href="#cb196-1517" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1518"><a href="#cb196-1518" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1519"><a href="#cb196-1519" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1520"><a href="#cb196-1520" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1521"><a href="#cb196-1521" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1522"><a href="#cb196-1522" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1523"><a href="#cb196-1523" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_pH_6&lt;-noprior_ma_pH_6$izoresults%&gt;%</span></span>
<span id="cb196-1524"><a href="#cb196-1524" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1525"><a href="#cb196-1525" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1526"><a href="#cb196-1526" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1527"><a href="#cb196-1527" aria-hidden="true" tabindex="-1"></a><span class="in">      filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1528"><a href="#cb196-1528" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1529"><a href="#cb196-1529" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1530"><a href="#cb196-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1531"><a href="#cb196-1531" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_pH_7&lt;-prior_ma_pH_7$izoresults%&gt;%</span></span>
<span id="cb196-1532"><a href="#cb196-1532" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1533"><a href="#cb196-1533" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1534"><a href="#cb196-1534" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1535"><a href="#cb196-1535" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1536"><a href="#cb196-1536" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1537"><a href="#cb196-1537" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1538"><a href="#cb196-1538" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_pH_7&lt;-noprior_ma_pH_7$izoresults%&gt;%</span></span>
<span id="cb196-1539"><a href="#cb196-1539" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1540"><a href="#cb196-1540" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1541"><a href="#cb196-1541" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1542"><a href="#cb196-1542" aria-hidden="true" tabindex="-1"></a><span class="in">      filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1543"><a href="#cb196-1543" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1544"><a href="#cb196-1544" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1545"><a href="#cb196-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1546"><a href="#cb196-1546" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_pH_8&lt;-prior_ma_pH_8$izoresults%&gt;%</span></span>
<span id="cb196-1547"><a href="#cb196-1547" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1548"><a href="#cb196-1548" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1549"><a href="#cb196-1549" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1550"><a href="#cb196-1550" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1551"><a href="#cb196-1551" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1552"><a href="#cb196-1552" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1553"><a href="#cb196-1553" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_pH_8&lt;-noprior_ma_pH_8$izoresults%&gt;%</span></span>
<span id="cb196-1554"><a href="#cb196-1554" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1555"><a href="#cb196-1555" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1556"><a href="#cb196-1556" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1557"><a href="#cb196-1557" aria-hidden="true" tabindex="-1"></a><span class="in">      filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1558"><a href="#cb196-1558" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1559"><a href="#cb196-1559" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1560"><a href="#cb196-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1561"><a href="#cb196-1561" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_pH_9&lt;-prior_ma_pH_9$izoresults%&gt;%</span></span>
<span id="cb196-1562"><a href="#cb196-1562" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1563"><a href="#cb196-1563" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1564"><a href="#cb196-1564" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1565"><a href="#cb196-1565" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1566"><a href="#cb196-1566" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1567"><a href="#cb196-1567" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1568"><a href="#cb196-1568" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_pH_9&lt;-noprior_ma_pH_9$izoresults%&gt;%</span></span>
<span id="cb196-1569"><a href="#cb196-1569" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1570"><a href="#cb196-1570" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1571"><a href="#cb196-1571" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1572"><a href="#cb196-1572" aria-hidden="true" tabindex="-1"></a><span class="in">      filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1573"><a href="#cb196-1573" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1574"><a href="#cb196-1574" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1575"><a href="#cb196-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1576"><a href="#cb196-1576" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_pH_10&lt;-prior_ma_pH_10$izoresults%&gt;%</span></span>
<span id="cb196-1577"><a href="#cb196-1577" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1578"><a href="#cb196-1578" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1579"><a href="#cb196-1579" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1580"><a href="#cb196-1580" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1581"><a href="#cb196-1581" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1582"><a href="#cb196-1582" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1583"><a href="#cb196-1583" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_pH_10&lt;-noprior_ma_pH_10$izoresults%&gt;%</span></span>
<span id="cb196-1584"><a href="#cb196-1584" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-1585"><a href="#cb196-1585" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1586"><a href="#cb196-1586" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-1587"><a href="#cb196-1587" aria-hidden="true" tabindex="-1"></a><span class="in">      filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-1588"><a href="#cb196-1588" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb196-1589"><a href="#cb196-1589" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-1590"><a href="#cb196-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1591"><a href="#cb196-1591" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_ref = map(results_prior_ma_pH_ref,plot_id) </span></span>
<span id="cb196-1592"><a href="#cb196-1592" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_pH_ref = map(results_noprior_ma_pH_ref,plot_id) </span></span>
<span id="cb196-1593"><a href="#cb196-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1594"><a href="#cb196-1594" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_3 = map(results_prior_ma_pH_3,plot_id) </span></span>
<span id="cb196-1595"><a href="#cb196-1595" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_4 = map(results_prior_ma_pH_4,plot_id) </span></span>
<span id="cb196-1596"><a href="#cb196-1596" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_5 = map(results_prior_ma_pH_5,plot_id) </span></span>
<span id="cb196-1597"><a href="#cb196-1597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1598"><a href="#cb196-1598" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_6 = map(results_prior_ma_pH_6,plot_id) </span></span>
<span id="cb196-1599"><a href="#cb196-1599" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_pH_6 = map(results_noprior_ma_pH_6,plot_id) </span></span>
<span id="cb196-1600"><a href="#cb196-1600" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_7 = map(results_prior_ma_pH_7,plot_id) </span></span>
<span id="cb196-1601"><a href="#cb196-1601" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_pH_7 = map(results_noprior_ma_pH_7,plot_id) </span></span>
<span id="cb196-1602"><a href="#cb196-1602" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_8 = map(results_prior_ma_pH_8,plot_id) </span></span>
<span id="cb196-1603"><a href="#cb196-1603" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_pH_8 = map(results_noprior_ma_pH_8,plot_id) </span></span>
<span id="cb196-1604"><a href="#cb196-1604" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_9 = map(results_prior_ma_pH_9,plot_id) </span></span>
<span id="cb196-1605"><a href="#cb196-1605" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_pH_9 = map(results_noprior_ma_pH_9,plot_id) </span></span>
<span id="cb196-1606"><a href="#cb196-1606" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_10 = map(results_prior_ma_pH_10,plot_id) </span></span>
<span id="cb196-1607"><a href="#cb196-1607" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_pH_10 = map(results_noprior_ma_pH_10,plot_id) </span></span>
<span id="cb196-1608"><a href="#cb196-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1609"><a href="#cb196-1609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1610"><a href="#cb196-1610" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_pH_ref[[1]], .filename=paste("plots-results-prior-ma-pH-ref.pdf"), .path = figures_dir2)</span></span>
<span id="cb196-1611"><a href="#cb196-1611" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_pH_ref[[1]], .filename=paste("plots-results-prior-ma-pH-ref.png"), .path = figures_dir2)</span></span>
<span id="cb196-1612"><a href="#cb196-1612" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_pH_10[[1]], .filename=paste("plots-results-prior-ma-pH-10.pdf"), .path = figures_dir2)</span></span>
<span id="cb196-1613"><a href="#cb196-1613" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_pH_10[[1]], .filename=paste("plots-results-prior-ma-pH-10.png"), .path = figures_dir2)</span></span>
<span id="cb196-1614"><a href="#cb196-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1615"><a href="#cb196-1615" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_ref</span></span>
<span id="cb196-1616"><a href="#cb196-1616" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_pH_ref</span></span>
<span id="cb196-1617"><a href="#cb196-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1618"><a href="#cb196-1618" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_3</span></span>
<span id="cb196-1619"><a href="#cb196-1619" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_4</span></span>
<span id="cb196-1620"><a href="#cb196-1620" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_5</span></span>
<span id="cb196-1621"><a href="#cb196-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1622"><a href="#cb196-1622" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_6</span></span>
<span id="cb196-1623"><a href="#cb196-1623" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_pH_6</span></span>
<span id="cb196-1624"><a href="#cb196-1624" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_7</span></span>
<span id="cb196-1625"><a href="#cb196-1625" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_pH_7</span></span>
<span id="cb196-1626"><a href="#cb196-1626" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_8</span></span>
<span id="cb196-1627"><a href="#cb196-1627" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_pH_8</span></span>
<span id="cb196-1628"><a href="#cb196-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1629"><a href="#cb196-1629" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_9</span></span>
<span id="cb196-1630"><a href="#cb196-1630" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_pH_9</span></span>
<span id="cb196-1631"><a href="#cb196-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1632"><a href="#cb196-1632" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_pH_10</span></span>
<span id="cb196-1633"><a href="#cb196-1633" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_pH_10</span></span>
<span id="cb196-1634"><a href="#cb196-1634" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_pH_ref[[i]])</span></span>
<span id="cb196-1635"><a href="#cb196-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1636"><a href="#cb196-1636" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1637"><a href="#cb196-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1638"><a href="#cb196-1638" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Combined</span></span>
<span id="cb196-1639"><a href="#cb196-1639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-izo-summary-pH-combined}</span></span>
<span id="cb196-1640"><a href="#cb196-1640" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb196-1641"><a href="#cb196-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1642"><a href="#cb196-1642" aria-hidden="true" tabindex="-1"></a><span class="in">izoresults = rbind(</span></span>
<span id="cb196-1643"><a href="#cb196-1643" aria-hidden="true" tabindex="-1"></a><span class="in">                   prior_ma_pH_ref$izoresults%&gt;%</span></span>
<span id="cb196-1644"><a href="#cb196-1644" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb196-1645"><a href="#cb196-1645" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_pH_ref$izoresults%&gt;%</span></span>
<span id="cb196-1646"><a href="#cb196-1646" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb196-1647"><a href="#cb196-1647" aria-hidden="true" tabindex="-1"></a><span class="in">                  prior_ma_pH_3$izoresults%&gt;%</span></span>
<span id="cb196-1648"><a href="#cb196-1648" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_03"),</span></span>
<span id="cb196-1649"><a href="#cb196-1649" aria-hidden="true" tabindex="-1"></a><span class="in">                  prior_ma_pH_4$izoresults%&gt;%</span></span>
<span id="cb196-1650"><a href="#cb196-1650" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_04"),</span></span>
<span id="cb196-1651"><a href="#cb196-1651" aria-hidden="true" tabindex="-1"></a><span class="in">                   prior_ma_pH_5$izoresults%&gt;%</span></span>
<span id="cb196-1652"><a href="#cb196-1652" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_05"),</span></span>
<span id="cb196-1653"><a href="#cb196-1653" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_pH_6$izoresults%&gt;%</span></span>
<span id="cb196-1654"><a href="#cb196-1654" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_06"),</span></span>
<span id="cb196-1655"><a href="#cb196-1655" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_pH_6$izoresults%&gt;%</span></span>
<span id="cb196-1656"><a href="#cb196-1656" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_06"),</span></span>
<span id="cb196-1657"><a href="#cb196-1657" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_pH_7$izoresults%&gt;%</span></span>
<span id="cb196-1658"><a href="#cb196-1658" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_07"),</span></span>
<span id="cb196-1659"><a href="#cb196-1659" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_pH_7$izoresults%&gt;%</span></span>
<span id="cb196-1660"><a href="#cb196-1660" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_07"),</span></span>
<span id="cb196-1661"><a href="#cb196-1661" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_pH_8$izoresults%&gt;%</span></span>
<span id="cb196-1662"><a href="#cb196-1662" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_08"),</span></span>
<span id="cb196-1663"><a href="#cb196-1663" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_pH_8$izoresults%&gt;%</span></span>
<span id="cb196-1664"><a href="#cb196-1664" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_08"),</span></span>
<span id="cb196-1665"><a href="#cb196-1665" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_pH_9$izoresults%&gt;%</span></span>
<span id="cb196-1666"><a href="#cb196-1666" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_09"),</span></span>
<span id="cb196-1667"><a href="#cb196-1667" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_pH_9$izoresults%&gt;%</span></span>
<span id="cb196-1668"><a href="#cb196-1668" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_09"),</span></span>
<span id="cb196-1669"><a href="#cb196-1669" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_pH_10$izoresults%&gt;%</span></span>
<span id="cb196-1670"><a href="#cb196-1670" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_10"),</span></span>
<span id="cb196-1671"><a href="#cb196-1671" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_pH_10$izoresults%&gt;%</span></span>
<span id="cb196-1672"><a href="#cb196-1672" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_10")) %&gt;%</span></span>
<span id="cb196-1673"><a href="#cb196-1673" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&lt;=log10(100))%&gt;%</span></span>
<span id="cb196-1674"><a href="#cb196-1674" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&gt;=log10(5))%&gt;%</span></span>
<span id="cb196-1675"><a href="#cb196-1675" aria-hidden="true" tabindex="-1"></a><span class="in">mutate(c = as.numeric(c),</span></span>
<span id="cb196-1676"><a href="#cb196-1676" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-1677"><a href="#cb196-1677" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(i,method,c)%&gt;%</span></span>
<span id="cb196-1678"><a href="#cb196-1678" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(i,method) %&gt;%</span></span>
<span id="cb196-1679"><a href="#cb196-1679" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(imaxcv = max(CV), imincv = min(CV), aveCV = pracma::trapz(c, CV)/(n()-1)) %&gt;%</span></span>
<span id="cb196-1680"><a href="#cb196-1680" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(imaxcv = if_else(imaxcv&gt;1e4,1e4,imaxcv))%&gt;%</span></span>
<span id="cb196-1681"><a href="#cb196-1681" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.integer(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB))</span></span>
<span id="cb196-1682"><a href="#cb196-1682" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-1683"><a href="#cb196-1683" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb196-1684"><a href="#cb196-1684" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=izoresults %&gt;%</span></span>
<span id="cb196-1685"><a href="#cb196-1685" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb196-1686"><a href="#cb196-1686" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-1687"><a href="#cb196-1687" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-1688"><a href="#cb196-1688" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb196-1689"><a href="#cb196-1689" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-1690"><a href="#cb196-1690" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb196-1691"><a href="#cb196-1691" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-1692"><a href="#cb196-1692" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(1,100))+   </span></span>
<span id="cb196-1693"><a href="#cb196-1693" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-1694"><a href="#cb196-1694" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb196-1695"><a href="#cb196-1695" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-1696"><a href="#cb196-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1697"><a href="#cb196-1697" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=izoresults %&gt;%</span></span>
<span id="cb196-1698"><a href="#cb196-1698" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb196-1699"><a href="#cb196-1699" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-1700"><a href="#cb196-1700" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-1701"><a href="#cb196-1701" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb196-1702"><a href="#cb196-1702" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-1703"><a href="#cb196-1703" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb196-1704"><a href="#cb196-1704" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,10000))+    </span></span>
<span id="cb196-1705"><a href="#cb196-1705" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-1706"><a href="#cb196-1706" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb196-1707"><a href="#cb196-1707" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-1708"><a href="#cb196-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1709"><a href="#cb196-1709" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb196-1710"><a href="#cb196-1710" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb196-1711"><a href="#cb196-1711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1712"><a href="#cb196-1712" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb196-1713"><a href="#cb196-1713" aria-hidden="true" tabindex="-1"></a><span class="in">f44_2 = p33</span></span>
<span id="cb196-1714"><a href="#cb196-1714" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("NI-izo-combined-CV.pdf"), .path = figures_dir2)</span></span>
<span id="cb196-1715"><a href="#cb196-1715" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("NI-izo-combined-CV.png"), .path = figures_dir2)</span></span>
<span id="cb196-1716"><a href="#cb196-1716" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1717"><a href="#cb196-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1718"><a href="#cb196-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1719"><a href="#cb196-1719" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stan multiple analytes. Single form analytes. fi and tg for MeOH as design variables</span></span>
<span id="cb196-1720"><a href="#cb196-1720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1721"><a href="#cb196-1721" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile stan models</span></span>
<span id="cb196-1722"><a href="#cb196-1722" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-MeOH-compilation}</span></span>
<span id="cb196-1723"><a href="#cb196-1723" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_MeOH_gq= cmdstan_model("../stan/hplc-gra-single-form-analytes-MeOH-gq.stan", </span></span>
<span id="cb196-1724"><a href="#cb196-1724" aria-hidden="true" tabindex="-1"></a><span class="in">                                    stanc_options = list("O1"))</span></span>
<span id="cb196-1725"><a href="#cb196-1725" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_MeOH_sim = cmdstan_model("../stan/hplc-gra-single-form-analytes-MeOH-sim.stan",</span></span>
<span id="cb196-1726"><a href="#cb196-1726" aria-hidden="true" tabindex="-1"></a><span class="in">                                      stanc_options = list("O1"))</span></span>
<span id="cb196-1727"><a href="#cb196-1727" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_MeOH = cmdstan_model("../stan/hplc-gra-single-form-analytes-MeOH.stan", </span></span>
<span id="cb196-1728"><a href="#cb196-1728" aria-hidden="true" tabindex="-1"></a><span class="in">                                  stanc_options = list("O1"))</span></span>
<span id="cb196-1729"><a href="#cb196-1729" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_MeOH$compile(compile_model_methods=TRUE,force_recompile=TRUE)</span></span>
<span id="cb196-1730"><a href="#cb196-1730" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1731"><a href="#cb196-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1732"><a href="#cb196-1732" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulate retention times and create datasets</span></span>
<span id="cb196-1733"><a href="#cb196-1733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1734"><a href="#cb196-1734" aria-hidden="true" tabindex="-1"></a>Probability of occurrence 0.4 neutral, 0.3 A, 0.3 B with $log P$ being sampled from 2.2 $\pm$ 2 and constrained between 0.5 and 7.</span>
<span id="cb196-1735"><a href="#cb196-1735" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-1736"><a href="#cb196-1736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-MeOH-simulations}</span></span>
<span id="cb196-1737"><a href="#cb196-1737" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma_MeOH=hplcparam_candidates_df%&gt;%filter(xpH==0, m==0)</span></span>
<span id="cb196-1738"><a href="#cb196-1738" aria-hidden="true" tabindex="-1"></a><span class="in">nObs = nrow(data_ma_MeOH);</span></span>
<span id="cb196-1739"><a href="#cb196-1739" aria-hidden="true" tabindex="-1"></a><span class="in">nAnalytes =50;</span></span>
<span id="cb196-1740"><a href="#cb196-1740" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = 1234;</span></span>
<span id="cb196-1741"><a href="#cb196-1741" aria-hidden="true" tabindex="-1"></a><span class="in">n_param = 3;</span></span>
<span id="cb196-1742"><a href="#cb196-1742" aria-hidden="true" tabindex="-1"></a><span class="in">n_rep = 10;</span></span>
<span id="cb196-1743"><a href="#cb196-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1744"><a href="#cb196-1744" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma_MeOH=list()</span></span>
<span id="cb196-1745"><a href="#cb196-1745" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_MeOH=list()</span></span>
<span id="cb196-1746"><a href="#cb196-1746" aria-hidden="true" tabindex="-1"></a><span class="in">inits_MeOH = list()</span></span>
<span id="cb196-1747"><a href="#cb196-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1748"><a href="#cb196-1748" aria-hidden="true" tabindex="-1"></a><span class="in">for (i in 1:n_rep) {</span></span>
<span id="cb196-1749"><a href="#cb196-1749" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_MeOH[[i]] = list(nObs=nObs,</span></span>
<span id="cb196-1750"><a href="#cb196-1750" aria-hidden="true" tabindex="-1"></a><span class="in">                   nAnalytes=nAnalytes,</span></span>
<span id="cb196-1751"><a href="#cb196-1751" aria-hidden="true" tabindex="-1"></a><span class="in">                   steps = 4 + 6*data_ma_MeOH$m,</span></span>
<span id="cb196-1752"><a href="#cb196-1752" aria-hidden="true" tabindex="-1"></a><span class="in">                   hplcparam=as.matrix(data_ma_MeOH%&gt;%dplyr::select(c(tg,td,to,te,fio,fif,m))),</span></span>
<span id="cb196-1753"><a href="#cb196-1753" aria-hidden="true" tabindex="-1"></a><span class="in">                   include_prior = 1,</span></span>
<span id="cb196-1754"><a href="#cb196-1754" aria-hidden="true" tabindex="-1"></a><span class="in">                   run_estimation=1,</span></span>
<span id="cb196-1755"><a href="#cb196-1755" aria-hidden="true" tabindex="-1"></a><span class="in">                   nSel = nObs,</span></span>
<span id="cb196-1756"><a href="#cb196-1756" aria-hidden="true" tabindex="-1"></a><span class="in">                   selected = 1:nObs)</span></span>
<span id="cb196-1757"><a href="#cb196-1757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1758"><a href="#cb196-1758" aria-hidden="true" tabindex="-1"></a><span class="in">fit_MeOH_gq  = mod_analytes_MeOH_gq$sample(data = datastruct_prior_ma_MeOH[[i]],</span></span>
<span id="cb196-1759"><a href="#cb196-1759" aria-hidden="true" tabindex="-1"></a><span class="in">                                         seed = cseed,</span></span>
<span id="cb196-1760"><a href="#cb196-1760" aria-hidden="true" tabindex="-1"></a><span class="in">                                         fixed_param = TRUE,</span></span>
<span id="cb196-1761"><a href="#cb196-1761" aria-hidden="true" tabindex="-1"></a><span class="in">                                         chains = 1,</span></span>
<span id="cb196-1762"><a href="#cb196-1762" aria-hidden="true" tabindex="-1"></a><span class="in">                                         iter_sampling=1)</span></span>
<span id="cb196-1763"><a href="#cb196-1763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1764"><a href="#cb196-1764" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_MeOH[[i]]$trobs = matrix(fit_MeOH_gq$draws(format = "matrix", variable = "y_hat_sim"),nAnalytes,nObs)</span></span>
<span id="cb196-1765"><a href="#cb196-1765" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_MeOH[[i]]$logPobs = fit_MeOH_gq$draws(format = "matrix", variable = "logPobs")[1:nAnalytes]</span></span>
<span id="cb196-1766"><a href="#cb196-1766" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_MeOH[[i]]$N1A2B3 = fit_MeOH_gq$draws(format = "matrix", variable = "N1A2B3")[1:nAnalytes]</span></span>
<span id="cb196-1767"><a href="#cb196-1767" aria-hidden="true" tabindex="-1"></a><span class="in">param = matrix(fit_MeOH_gq$draws(format = "matrix", variable = "paramsim"),nAnalytes,2)</span></span>
<span id="cb196-1768"><a href="#cb196-1768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1769"><a href="#cb196-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1770"><a href="#cb196-1770" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma_MeOH[[i]]=datastruct_prior_ma_MeOH[[i]];</span></span>
<span id="cb196-1771"><a href="#cb196-1771" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma_MeOH[[i]]$include_prior = 0.01;</span></span>
<span id="cb196-1772"><a href="#cb196-1772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1773"><a href="#cb196-1773" aria-hidden="true" tabindex="-1"></a><span class="in">inits_MeOH[[i]]=param</span></span>
<span id="cb196-1774"><a href="#cb196-1774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1775"><a href="#cb196-1775" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = cseed+1</span></span>
<span id="cb196-1776"><a href="#cb196-1776" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-1777"><a href="#cb196-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1778"><a href="#cb196-1778" aria-hidden="true" tabindex="-1"></a><span class="in">mean_log_det_stan_MeOH = function(data, init, chosen_indices, S){</span></span>
<span id="cb196-1779"><a href="#cb196-1779" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-1780"><a href="#cb196-1780" aria-hidden="true" tabindex="-1"></a><span class="in">init_ma = function(){list(param=init)}</span></span>
<span id="cb196-1781"><a href="#cb196-1781" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-1782"><a href="#cb196-1782" aria-hidden="true" tabindex="-1"></a><span class="in">data$selected = chosen_indices;</span></span>
<span id="cb196-1783"><a href="#cb196-1783" aria-hidden="true" tabindex="-1"></a><span class="in">data$nSel = length(chosen_indices);</span></span>
<span id="cb196-1784"><a href="#cb196-1784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1785"><a href="#cb196-1785" aria-hidden="true" tabindex="-1"></a><span class="in"> fit_MeOH_opt  = mod_analytes_MeOH$optimize(</span></span>
<span id="cb196-1786"><a href="#cb196-1786" aria-hidden="true" tabindex="-1"></a><span class="in">   data = data,</span></span>
<span id="cb196-1787"><a href="#cb196-1787" aria-hidden="true" tabindex="-1"></a><span class="in">   output_dir = here::here("stanfiles"),</span></span>
<span id="cb196-1788"><a href="#cb196-1788" aria-hidden="true" tabindex="-1"></a><span class="in">   output_basename = S,</span></span>
<span id="cb196-1789"><a href="#cb196-1789" aria-hidden="true" tabindex="-1"></a><span class="in">   seed = cseed,</span></span>
<span id="cb196-1790"><a href="#cb196-1790" aria-hidden="true" tabindex="-1"></a><span class="in">   init = init_ma,</span></span>
<span id="cb196-1791"><a href="#cb196-1791" aria-hidden="true" tabindex="-1"></a><span class="in">   jacobian = TRUE,</span></span>
<span id="cb196-1792"><a href="#cb196-1792" aria-hidden="true" tabindex="-1"></a><span class="in">   show_messages = F)</span></span>
<span id="cb196-1793"><a href="#cb196-1793" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb196-1794"><a href="#cb196-1794" aria-hidden="true" tabindex="-1"></a><span class="in"> mode=fit_MeOH_opt$unconstrain_variables(list(param = fit_MeOH_opt$mle("param")))</span></span>
<span id="cb196-1795"><a href="#cb196-1795" aria-hidden="true" tabindex="-1"></a><span class="in"> hessian = fit_MeOH_opt$hessian(unconstrained_variables = mode)$hessian</span></span>
<span id="cb196-1796"><a href="#cb196-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1797"><a href="#cb196-1797" aria-hidden="true" tabindex="-1"></a><span class="in">logdet = unlist(purrr::map(1:data$nAnalytes,\(i) log(det(-hessian[((i-1)*2+1):((i-1)*2+2),((i-1)*2+1):((i-1)*2+2)]))))</span></span>
<span id="cb196-1798"><a href="#cb196-1798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1799"><a href="#cb196-1799" aria-hidden="true" tabindex="-1"></a><span class="in">return(logdet)</span></span>
<span id="cb196-1800"><a href="#cb196-1800" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-1801"><a href="#cb196-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1802"><a href="#cb196-1802" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(9,33)</span></span>
<span id="cb196-1803"><a href="#cb196-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1804"><a href="#cb196-1804" aria-hidden="true" tabindex="-1"></a><span class="in">logP = unlist(purrr::map(1:length(datastruct_prior_ma_MeOH),\(i) datastruct_prior_ma_MeOH[[i]]$logPobs))</span></span>
<span id="cb196-1805"><a href="#cb196-1805" aria-hidden="true" tabindex="-1"></a><span class="in">NAB = unlist(purrr::map(1:length(datastruct_prior_ma_MeOH),\(i) datastruct_prior_ma_MeOH[[i]]$N1A2B3))</span></span>
<span id="cb196-1806"><a href="#cb196-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1807"><a href="#cb196-1807" aria-hidden="true" tabindex="-1"></a><span class="in"># quick test:</span></span>
<span id="cb196-1808"><a href="#cb196-1808" aria-hidden="true" tabindex="-1"></a><span class="in">z_prior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan_MeOH(datastruct_prior_ma_MeOH[[i]], inits_MeOH[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb196-1809"><a href="#cb196-1809" aria-hidden="true" tabindex="-1"></a><span class="in">z_noprior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan_MeOH(datastruct_noprior_ma_MeOH[[i]], inits_MeOH[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb196-1810"><a href="#cb196-1810" aria-hidden="true" tabindex="-1"></a><span class="in">test = c(mean(unlist(z_prior)),mean(unlist(z_noprior)))</span></span>
<span id="cb196-1811"><a href="#cb196-1811" aria-hidden="true" tabindex="-1"></a><span class="in">test</span></span>
<span id="cb196-1812"><a href="#cb196-1812" aria-hidden="true" tabindex="-1"></a><span class="in">c("8.749208 7.684150")</span></span>
<span id="cb196-1813"><a href="#cb196-1813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1814"><a href="#cb196-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1815"><a href="#cb196-1815" aria-hidden="true" tabindex="-1"></a><span class="fu">## Optimization</span></span>
<span id="cb196-1816"><a href="#cb196-1816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-MeOH-optimization, eval=FALSE}</span></span>
<span id="cb196-1817"><a href="#cb196-1817" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(33) # initial values</span></span>
<span id="cb196-1818"><a href="#cb196-1818" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_prior_1 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1819"><a href="#cb196-1819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1820"><a href="#cb196-1820" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(36,33) # initial values</span></span>
<span id="cb196-1821"><a href="#cb196-1821" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1822"><a href="#cb196-1822" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(36,33) # initial values</span></span>
<span id="cb196-1823"><a href="#cb196-1823" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_noprior_2 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1824"><a href="#cb196-1824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1825"><a href="#cb196-1825" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(9,33,36) # initial values</span></span>
<span id="cb196-1826"><a href="#cb196-1826" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1827"><a href="#cb196-1827" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(9,33,36) # initial values</span></span>
<span id="cb196-1828"><a href="#cb196-1828" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1829"><a href="#cb196-1829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1830"><a href="#cb196-1830" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(1,9,33,36) # initial values</span></span>
<span id="cb196-1831"><a href="#cb196-1831" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1832"><a href="#cb196-1832" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(1,9,33,36) # initial values</span></span>
<span id="cb196-1833"><a href="#cb196-1833" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-1834"><a href="#cb196-1834" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1835"><a href="#cb196-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1836"><a href="#cb196-1836" aria-hidden="true" tabindex="-1"></a><span class="fu">### Read the results and compare</span></span>
<span id="cb196-1837"><a href="#cb196-1837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-MeOH-logDet-summary}</span></span>
<span id="cb196-1838"><a href="#cb196-1838" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(9,33) # ref</span></span>
<span id="cb196-1839"><a href="#cb196-1839" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior= c(9,33) # ref</span></span>
<span id="cb196-1840"><a href="#cb196-1840" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_prior_ref = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1841"><a href="#cb196-1841" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_noprior_ref = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-1842"><a href="#cb196-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1843"><a href="#cb196-1843" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(33) # p=1</span></span>
<span id="cb196-1844"><a href="#cb196-1844" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_prior_1 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1845"><a href="#cb196-1845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1846"><a href="#cb196-1846" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(33,36) # p=2</span></span>
<span id="cb196-1847"><a href="#cb196-1847" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(12,33) # p=2</span></span>
<span id="cb196-1848"><a href="#cb196-1848" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1849"><a href="#cb196-1849" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_noprior_2 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-1850"><a href="#cb196-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1851"><a href="#cb196-1851" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(12,33,36) # p=3</span></span>
<span id="cb196-1852"><a href="#cb196-1852" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(12,33,36) # p=3</span></span>
<span id="cb196-1853"><a href="#cb196-1853" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1854"><a href="#cb196-1854" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-1855"><a href="#cb196-1855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1856"><a href="#cb196-1856" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(12,34,33,36) # p=4</span></span>
<span id="cb196-1857"><a href="#cb196-1857" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(12,11,33,36) # p=4</span></span>
<span id="cb196-1858"><a href="#cb196-1858" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-1859"><a href="#cb196-1859" aria-hidden="true" tabindex="-1"></a><span class="in">fws_MeOH_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan_MeOH, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-1860"><a href="#cb196-1860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1861"><a href="#cb196-1861" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results = tibble(logP = logP,</span></span>
<span id="cb196-1862"><a href="#cb196-1862" aria-hidden="true" tabindex="-1"></a><span class="in">                         Type = NAB,</span></span>
<span id="cb196-1863"><a href="#cb196-1863" aria-hidden="true" tabindex="-1"></a><span class="in">                         prior_ref = fws_MeOH_prior_ref$log_det_FIM,</span></span>
<span id="cb196-1864"><a href="#cb196-1864" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_ref = fws_MeOH_noprior_ref$log_det_FIM,</span></span>
<span id="cb196-1865"><a href="#cb196-1865" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_1 = fws_MeOH_prior_1$log_det_FIM,</span></span>
<span id="cb196-1866"><a href="#cb196-1866" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_2 = fws_MeOH_prior_2$log_det_FIM,</span></span>
<span id="cb196-1867"><a href="#cb196-1867" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_2 = fws_MeOH_noprior_2$log_det_FIM,</span></span>
<span id="cb196-1868"><a href="#cb196-1868" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_3 = fws_MeOH_prior_3$log_det_FIM,</span></span>
<span id="cb196-1869"><a href="#cb196-1869" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_3 = fws_MeOH_noprior_3$log_det_FIM,</span></span>
<span id="cb196-1870"><a href="#cb196-1870" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_4 = fws_MeOH_prior_4$log_det_FIM,</span></span>
<span id="cb196-1871"><a href="#cb196-1871" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_4 = fws_MeOH_noprior_4$log_det_FIM) %&gt;%</span></span>
<span id="cb196-1872"><a href="#cb196-1872" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(prior_ref:noprior_4, names_to = "method")</span></span>
<span id="cb196-1873"><a href="#cb196-1873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1874"><a href="#cb196-1874" aria-hidden="true" tabindex="-1"></a><span class="in">p1=ggplot(summary_results, aes(y=method,x=value))+</span></span>
<span id="cb196-1875"><a href="#cb196-1875" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-1876"><a href="#cb196-1876" aria-hidden="true" tabindex="-1"></a><span class="in"> geom_jitter(aes(y=method, x=value, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-1877"><a href="#cb196-1877" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-1878"><a href="#cb196-1878" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="log(|FIM|)", y = "Method")</span></span>
<span id="cb196-1879"><a href="#cb196-1879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1880"><a href="#cb196-1880" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diff = tibble(logP = logP,</span></span>
<span id="cb196-1881"><a href="#cb196-1881" aria-hidden="true" tabindex="-1"></a><span class="in">                         Type = NAB,</span></span>
<span id="cb196-1882"><a href="#cb196-1882" aria-hidden="true" tabindex="-1"></a><span class="in">                         fws_prior_ref = fws_MeOH_prior_ref$log_det_FIM,</span></span>
<span id="cb196-1883"><a href="#cb196-1883" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_MeOH_noprior_ref$log_det_FIM,</span></span>
<span id="cb196-1884"><a href="#cb196-1884" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_1 = fws_MeOH_prior_1$log_det_FIM,</span></span>
<span id="cb196-1885"><a href="#cb196-1885" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_2 = fws_MeOH_prior_2$log_det_FIM,</span></span>
<span id="cb196-1886"><a href="#cb196-1886" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_2 = fws_MeOH_noprior_2$log_det_FIM,</span></span>
<span id="cb196-1887"><a href="#cb196-1887" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_MeOH_prior_3$log_det_FIM,</span></span>
<span id="cb196-1888"><a href="#cb196-1888" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_MeOH_noprior_3$log_det_FIM,</span></span>
<span id="cb196-1889"><a href="#cb196-1889" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_MeOH_prior_4$log_det_FIM,</span></span>
<span id="cb196-1890"><a href="#cb196-1890" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_MeOH_noprior_4$log_det_FIM) %&gt;%</span></span>
<span id="cb196-1891"><a href="#cb196-1891" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_prior_1 = (fws_prior_1 - fws_prior_ref)/n_param,</span></span>
<span id="cb196-1892"><a href="#cb196-1892" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_2 = (fws_prior_2 - fws_prior_ref)/n_param,</span></span>
<span id="cb196-1893"><a href="#cb196-1893" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_2 = (fws_noprior_2 - fws_noprior_ref)/n_param,</span></span>
<span id="cb196-1894"><a href="#cb196-1894" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_3 = (fws_prior_3 - fws_prior_ref)/n_param,</span></span>
<span id="cb196-1895"><a href="#cb196-1895" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_3 = (fws_noprior_3 - fws_noprior_ref)/n_param,</span></span>
<span id="cb196-1896"><a href="#cb196-1896" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_4 = (fws_prior_4 - fws_prior_ref)/n_param,</span></span>
<span id="cb196-1897"><a href="#cb196-1897" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_4 = (fws_noprior_4 - fws_noprior_ref)/n_param)%&gt;%</span></span>
<span id="cb196-1898"><a href="#cb196-1898" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_prior_1:d_noprior_4, names_to = "method")</span></span>
<span id="cb196-1899"><a href="#cb196-1899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1900"><a href="#cb196-1900" aria-hidden="true" tabindex="-1"></a><span class="in">p2=ggplot(summary_results_diff, aes(y=method,x=exp(value)))+</span></span>
<span id="cb196-1901"><a href="#cb196-1901" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-1902"><a href="#cb196-1902" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-1903"><a href="#cb196-1903" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-1904"><a href="#cb196-1904" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Efficiency relative to the reference design", y = "Method")+</span></span>
<span id="cb196-1905"><a href="#cb196-1905" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")</span></span>
<span id="cb196-1906"><a href="#cb196-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1907"><a href="#cb196-1907" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diffprior = tibble(logP = logP,</span></span>
<span id="cb196-1908"><a href="#cb196-1908" aria-hidden="true" tabindex="-1"></a><span class="in">                         Type = NAB,</span></span>
<span id="cb196-1909"><a href="#cb196-1909" aria-hidden="true" tabindex="-1"></a><span class="in">                         fws_prior_ref = fws_MeOH_prior_ref$log_det_FIM,</span></span>
<span id="cb196-1910"><a href="#cb196-1910" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_MeOH_noprior_ref$log_det_FIM,</span></span>
<span id="cb196-1911"><a href="#cb196-1911" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_2 = fws_MeOH_prior_2$log_det_FIM,</span></span>
<span id="cb196-1912"><a href="#cb196-1912" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_2 = fws_MeOH_noprior_2$log_det_FIM,</span></span>
<span id="cb196-1913"><a href="#cb196-1913" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_MeOH_prior_3$log_det_FIM,</span></span>
<span id="cb196-1914"><a href="#cb196-1914" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_MeOH_noprior_3$log_det_FIM,</span></span>
<span id="cb196-1915"><a href="#cb196-1915" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_MeOH_prior_4$log_det_FIM,</span></span>
<span id="cb196-1916"><a href="#cb196-1916" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_MeOH_noprior_4$log_det_FIM) %&gt;%</span></span>
<span id="cb196-1917"><a href="#cb196-1917" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_ref  = (fws_prior_ref-fws_noprior_ref)/n_param,</span></span>
<span id="cb196-1918"><a href="#cb196-1918" aria-hidden="true" tabindex="-1"></a><span class="in">         d_2 = (fws_prior_2-fws_noprior_2)/n_param,</span></span>
<span id="cb196-1919"><a href="#cb196-1919" aria-hidden="true" tabindex="-1"></a><span class="in">         d_3 = (fws_prior_3-fws_noprior_3)/n_param,</span></span>
<span id="cb196-1920"><a href="#cb196-1920" aria-hidden="true" tabindex="-1"></a><span class="in">         d_4 = (fws_prior_4-fws_noprior_4)/n_param)%&gt;%</span></span>
<span id="cb196-1921"><a href="#cb196-1921" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_ref:d_4, names_to = "method")</span></span>
<span id="cb196-1922"><a href="#cb196-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1923"><a href="#cb196-1923" aria-hidden="true" tabindex="-1"></a><span class="in">p3=ggplot(summary_results_diffprior, aes(y=method,x=exp(value)))+</span></span>
<span id="cb196-1924"><a href="#cb196-1924" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-1925"><a href="#cb196-1925" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-1926"><a href="#cb196-1926" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-1927"><a href="#cb196-1927" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Effect of prior on design efficiency", y = "Method")+</span></span>
<span id="cb196-1928"><a href="#cb196-1928" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")+</span></span>
<span id="cb196-1929"><a href="#cb196-1929" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0.5,100),</span></span>
<span id="cb196-1930"><a href="#cb196-1930" aria-hidden="true" tabindex="-1"></a><span class="in">                     trans='log10',</span></span>
<span id="cb196-1931"><a href="#cb196-1931" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.01, 100)),</span></span>
<span id="cb196-1932"><a href="#cb196-1932" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-1933"><a href="#cb196-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1934"><a href="#cb196-1934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1935"><a href="#cb196-1935" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb196-1936"><a href="#cb196-1936" aria-hidden="true" tabindex="-1"></a><span class="in">p2</span></span>
<span id="cb196-1937"><a href="#cb196-1937" aria-hidden="true" tabindex="-1"></a><span class="in">p3</span></span>
<span id="cb196-1938"><a href="#cb196-1938" aria-hidden="true" tabindex="-1"></a><span class="in">f2_3= p2</span></span>
<span id="cb196-1939"><a href="#cb196-1939" aria-hidden="true" tabindex="-1"></a><span class="in">f3_3 = p3</span></span>
<span id="cb196-1940"><a href="#cb196-1940" aria-hidden="true" tabindex="-1"></a><span class="in"> my.ggsave(.plot=p1, .filename=paste("single-form-analytes-MeOH-logdFIM-abs.pdf"), .path = figures_dir3)</span></span>
<span id="cb196-1941"><a href="#cb196-1941" aria-hidden="true" tabindex="-1"></a><span class="in"> my.ggsave.png(.plot=p1, .filename=paste("single-form-analytes-MeOH-logdFIM-abs.png"), .path = figures_dir3)</span></span>
<span id="cb196-1942"><a href="#cb196-1942" aria-hidden="true" tabindex="-1"></a><span class="in"> my.ggsave(.plot=p2, .filename=paste("single-form-analytes-MeOH-logdFIM-rel.pdf"), .path = figures_dir3)</span></span>
<span id="cb196-1943"><a href="#cb196-1943" aria-hidden="true" tabindex="-1"></a><span class="in"> my.ggsave.png(.plot=p2, .filename=paste("single-form-analytes-MeOH-logdFIM-rel.png"), .path = figures_dir3)</span></span>
<span id="cb196-1944"><a href="#cb196-1944" aria-hidden="true" tabindex="-1"></a><span class="in"> my.ggsave(.plot=p3, .filename=paste("single-form-analytes-MeOH-logdFIM-prioreff.pdf"), .path = figures_dir3)</span></span>
<span id="cb196-1945"><a href="#cb196-1945" aria-hidden="true" tabindex="-1"></a><span class="in"> my.ggsave.png(.plot=p3, .filename=paste("single-form-analytes-MeOH-logdFIM-prioreff.png"), .path = figures_dir3)</span></span>
<span id="cb196-1946"><a href="#cb196-1946" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-1947"><a href="#cb196-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1948"><a href="#cb196-1948" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table</span></span>
<span id="cb196-1949"><a href="#cb196-1949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1950"><a href="#cb196-1950" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-MeOH-table}</span></span>
<span id="cb196-1951"><a href="#cb196-1951" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma_MeOH=hplcparam_candidates_df%&gt;%filter(xpH==0, m==0)%&gt;%</span></span>
<span id="cb196-1952"><a href="#cb196-1952" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(line=1:n())</span></span>
<span id="cb196-1953"><a href="#cb196-1953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1954"><a href="#cb196-1954" aria-hidden="true" tabindex="-1"></a><span class="in">combined_results = list(</span></span>
<span id="cb196-1955"><a href="#cb196-1955" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ref = fws_MeOH_prior_ref$chosen_indices,</span></span>
<span id="cb196-1956"><a href="#cb196-1956" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_ref = fws_MeOH_noprior_ref$chosen_indices,</span></span>
<span id="cb196-1957"><a href="#cb196-1957" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_1 = fws_MeOH_prior_1$chosen_indices,</span></span>
<span id="cb196-1958"><a href="#cb196-1958" aria-hidden="true" tabindex="-1"></a><span class="in">prior_1 = 10000+fws_MeOH_prior_1$chosen_indices,</span></span>
<span id="cb196-1959"><a href="#cb196-1959" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_2 = fws_MeOH_prior_2$chosen_indices,</span></span>
<span id="cb196-1960"><a href="#cb196-1960" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_2 = fws_MeOH_noprior_2$chosen_indices,</span></span>
<span id="cb196-1961"><a href="#cb196-1961" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_3 = fws_MeOH_prior_3$chosen_indices,</span></span>
<span id="cb196-1962"><a href="#cb196-1962" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_3 = fws_MeOH_noprior_3$chosen_indices,</span></span>
<span id="cb196-1963"><a href="#cb196-1963" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_4 = fws_MeOH_prior_4$chosen_indices,</span></span>
<span id="cb196-1964"><a href="#cb196-1964" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_4 = fws_MeOH_noprior_4$chosen_indices)</span></span>
<span id="cb196-1965"><a href="#cb196-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1966"><a href="#cb196-1966" aria-hidden="true" tabindex="-1"></a><span class="in">selected_exp = enframe(combined_results)%&gt;%</span></span>
<span id="cb196-1967"><a href="#cb196-1967" aria-hidden="true" tabindex="-1"></a><span class="in">   unnest(value) %&gt;%</span></span>
<span id="cb196-1968"><a href="#cb196-1968" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(line=value, Name = name) %&gt;%</span></span>
<span id="cb196-1969"><a href="#cb196-1969" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(data_ma_MeOH, by = "line")%&gt;%</span></span>
<span id="cb196-1970"><a href="#cb196-1970" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Modifier = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb196-1971"><a href="#cb196-1971" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-c(line,xpH,m,td,to,te,fif)) %&gt;%</span></span>
<span id="cb196-1972"><a href="#cb196-1972" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(type = if_else(str_detect(Name, 'noprior'), "No prior", "Prior"))%&gt;%</span></span>
<span id="cb196-1973"><a href="#cb196-1973" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(where(is.numeric), ~replace_na(., -1)))</span></span>
<span id="cb196-1974"><a href="#cb196-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1975"><a href="#cb196-1975" aria-hidden="true" tabindex="-1"></a><span class="in">tab1&lt;-selected_exp %&gt;%</span></span>
<span id="cb196-1976"><a href="#cb196-1976" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "Prior") %&gt;%</span></span>
<span id="cb196-1977"><a href="#cb196-1977" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-type)%&gt;%</span></span>
<span id="cb196-1978"><a href="#cb196-1978" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb196-1979"><a href="#cb196-1979" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-1980"><a href="#cb196-1980" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-1981"><a href="#cb196-1981" aria-hidden="true" tabindex="-1"></a><span class="in">tab2&lt;-selected_exp %&gt;%</span></span>
<span id="cb196-1982"><a href="#cb196-1982" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "No prior")%&gt;%</span></span>
<span id="cb196-1983"><a href="#cb196-1983" aria-hidden="true" tabindex="-1"></a><span class="in">    select(-type)%&gt;%</span></span>
<span id="cb196-1984"><a href="#cb196-1984" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb196-1985"><a href="#cb196-1985" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-1986"><a href="#cb196-1986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1987"><a href="#cb196-1987" aria-hidden="true" tabindex="-1"></a><span class="in">tab2 &lt;- set_formatter(</span></span>
<span id="cb196-1988"><a href="#cb196-1988" aria-hidden="true" tabindex="-1"></a><span class="in">  tab2, </span></span>
<span id="cb196-1989"><a href="#cb196-1989" aria-hidden="true" tabindex="-1"></a><span class="in">  tg = function(x) ifelse(x==-1," ", sprintf("%d", x) ),</span></span>
<span id="cb196-1990"><a href="#cb196-1990" aria-hidden="true" tabindex="-1"></a><span class="in">  fio = function(x) ifelse(x==-1," ", sprintf("%.2f", x) )</span></span>
<span id="cb196-1991"><a href="#cb196-1991" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb196-1992"><a href="#cb196-1992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1993"><a href="#cb196-1993" aria-hidden="true" tabindex="-1"></a><span class="in">p1 = gen_grob(tab1, fit = "auto", just = "centre")</span></span>
<span id="cb196-1994"><a href="#cb196-1994" aria-hidden="true" tabindex="-1"></a><span class="in">p2 = gen_grob(tab2, fit = "auto", just = "centre") </span></span>
<span id="cb196-1995"><a href="#cb196-1995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-1996"><a href="#cb196-1996" aria-hidden="true" tabindex="-1"></a><span class="in">gg&lt;-ggplot()+</span></span>
<span id="cb196-1997"><a href="#cb196-1997" aria-hidden="true" tabindex="-1"></a><span class="in">       theme(</span></span>
<span id="cb196-1998"><a href="#cb196-1998" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.background = element_rect(fill='transparent'),</span></span>
<span id="cb196-1999"><a href="#cb196-1999" aria-hidden="true" tabindex="-1"></a><span class="in">         plot.background = element_rect(fill='transparent', color=NA),</span></span>
<span id="cb196-2000"><a href="#cb196-2000" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.major = element_blank(),</span></span>
<span id="cb196-2001"><a href="#cb196-2001" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.minor = element_blank(),</span></span>
<span id="cb196-2002"><a href="#cb196-2002" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.background = element_rect(fill='transparent'),</span></span>
<span id="cb196-2003"><a href="#cb196-2003" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.box.background = element_rect(fill='transparent')</span></span>
<span id="cb196-2004"><a href="#cb196-2004" aria-hidden="true" tabindex="-1"></a><span class="in">       )</span></span>
<span id="cb196-2005"><a href="#cb196-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2006"><a href="#cb196-2006" aria-hidden="true" tabindex="-1"></a><span class="in">plot1 &lt;- gg+p1+p2+ plot_layout(ncol = 3, widths = c(1, 20,20))</span></span>
<span id="cb196-2007"><a href="#cb196-2007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2008"><a href="#cb196-2008" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plot1, .filename=paste("single-form-analytes-MeOH-table.pdf"), .path = tables_dir3)</span></span>
<span id="cb196-2009"><a href="#cb196-2009" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plot1, .filename=paste("single-form-analytes-MeOH-table.png"), .path = tables_dir3)</span></span>
<span id="cb196-2010"><a href="#cb196-2010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2011"><a href="#cb196-2011" aria-hidden="true" tabindex="-1"></a><span class="in">tab1</span></span>
<span id="cb196-2012"><a href="#cb196-2012" aria-hidden="true" tabindex="-1"></a><span class="in">tab2</span></span>
<span id="cb196-2013"><a href="#cb196-2013" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2014"><a href="#cb196-2014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2015"><a href="#cb196-2015" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stan simulations</span></span>
<span id="cb196-2016"><a href="#cb196-2016" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-MeOH-laplace, eval=F}</span></span>
<span id="cb196-2017"><a href="#cb196-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2018"><a href="#cb196-2018" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_MeOH_prior_ref$chosen_indices # ref</span></span>
<span id="cb196-2019"><a href="#cb196-2019" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_MeOH_ref = fun_predict_stan_results_MeOH(mod_analytes_MeOH_sim, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, 10)</span></span>
<span id="cb196-2020"><a href="#cb196-2020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2021"><a href="#cb196-2021" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_MeOH_noprior_ref$chosen_indices # ref</span></span>
<span id="cb196-2022"><a href="#cb196-2022" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_MeOH_ref = fun_predict_stan_results_MeOH(mod_analytes_MeOH_sim, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, 10)</span></span>
<span id="cb196-2023"><a href="#cb196-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2024"><a href="#cb196-2024" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_MeOH_prior_1$chosen_indices # p=1</span></span>
<span id="cb196-2025"><a href="#cb196-2025" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_MeOH_1 = fun_predict_stan_results_MeOH(mod_analytes_MeOH_sim, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, 10)</span></span>
<span id="cb196-2026"><a href="#cb196-2026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2027"><a href="#cb196-2027" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_MeOH_prior_2$chosen_indices # p=2</span></span>
<span id="cb196-2028"><a href="#cb196-2028" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_MeOH_2 = fun_predict_stan_results_MeOH(mod_analytes_MeOH_sim, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, 10)</span></span>
<span id="cb196-2029"><a href="#cb196-2029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2030"><a href="#cb196-2030" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_MeOH_noprior_2$chosen_indices # p=2</span></span>
<span id="cb196-2031"><a href="#cb196-2031" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_MeOH_2 = fun_predict_stan_results_MeOH(mod_analytes_MeOH_sim, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, 10)</span></span>
<span id="cb196-2032"><a href="#cb196-2032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2033"><a href="#cb196-2033" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_MeOH_prior_3$chosen_indices # p=3</span></span>
<span id="cb196-2034"><a href="#cb196-2034" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_MeOH_3 = fun_predict_stan_results_MeOH(mod_analytes_MeOH_sim, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, 10)</span></span>
<span id="cb196-2035"><a href="#cb196-2035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2036"><a href="#cb196-2036" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_MeOH_noprior_3$chosen_indices # p=3</span></span>
<span id="cb196-2037"><a href="#cb196-2037" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_MeOH_3 = fun_predict_stan_results_MeOH(mod_analytes_MeOH_sim, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, 10)</span></span>
<span id="cb196-2038"><a href="#cb196-2038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2039"><a href="#cb196-2039" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_MeOH_prior_4$chosen_indices # p=4</span></span>
<span id="cb196-2040"><a href="#cb196-2040" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_MeOH_4 = fun_predict_stan_results_MeOH(mod_analytes_MeOH_sim, datastruct_prior_ma_MeOH, inits_MeOH, chosen_indices, 10)</span></span>
<span id="cb196-2041"><a href="#cb196-2041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2042"><a href="#cb196-2042" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_MeOH_noprior_4$chosen_indices # p=4</span></span>
<span id="cb196-2043"><a href="#cb196-2043" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_MeOH_4 = fun_predict_stan_results_MeOH(mod_analytes_MeOH_sim, datastruct_noprior_ma_MeOH, inits_MeOH, chosen_indices, 10)</span></span>
<span id="cb196-2044"><a href="#cb196-2044" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2045"><a href="#cb196-2045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2046"><a href="#cb196-2046" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gradient conditions</span></span>
<span id="cb196-2047"><a href="#cb196-2047" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-gra-MeOH-summary}</span></span>
<span id="cb196-2048"><a href="#cb196-2048" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_MeOH_prior_3$chosen_indices # p=3</span></span>
<span id="cb196-2049"><a href="#cb196-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2050"><a href="#cb196-2050" aria-hidden="true" tabindex="-1"></a><span class="in">p31=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb196-2051"><a href="#cb196-2051" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0, m==0)%&gt;%</span></span>
<span id="cb196-2052"><a href="#cb196-2052" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb196-2053"><a href="#cb196-2053" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(prior_ma_MeOH_3$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb196-2054"><a href="#cb196-2054" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb196-2055"><a href="#cb196-2055" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb196-2056"><a href="#cb196-2056" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb196-2057"><a href="#cb196-2057" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb196-2058"><a href="#cb196-2058" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb196-2059"><a href="#cb196-2059" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb196-2060"><a href="#cb196-2060" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_MeOH_noprior_3$chosen_indices # p=5</span></span>
<span id="cb196-2061"><a href="#cb196-2061" aria-hidden="true" tabindex="-1"></a><span class="in">p32=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb196-2062"><a href="#cb196-2062" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0, m==0)%&gt;%</span></span>
<span id="cb196-2063"><a href="#cb196-2063" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb196-2064"><a href="#cb196-2064" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(noprior_ma_MeOH_3$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb196-2065"><a href="#cb196-2065" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb196-2066"><a href="#cb196-2066" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb196-2067"><a href="#cb196-2067" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb196-2068"><a href="#cb196-2068" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb196-2069"><a href="#cb196-2069" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb196-2070"><a href="#cb196-2070" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb196-2071"><a href="#cb196-2071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2072"><a href="#cb196-2072" aria-hidden="true" tabindex="-1"></a><span class="in">iresults = rbind(</span></span>
<span id="cb196-2073"><a href="#cb196-2073" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_MeOH_ref$iresults%&gt;%</span></span>
<span id="cb196-2074"><a href="#cb196-2074" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb196-2075"><a href="#cb196-2075" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_MeOH_ref$iresults%&gt;%</span></span>
<span id="cb196-2076"><a href="#cb196-2076" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb196-2077"><a href="#cb196-2077" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_MeOH_1$iresults%&gt;%</span></span>
<span id="cb196-2078"><a href="#cb196-2078" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_1"),</span></span>
<span id="cb196-2079"><a href="#cb196-2079" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_MeOH_2$iresults%&gt;%</span></span>
<span id="cb196-2080"><a href="#cb196-2080" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb196-2081"><a href="#cb196-2081" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_MeOH_2$iresults%&gt;%</span></span>
<span id="cb196-2082"><a href="#cb196-2082" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_2"),</span></span>
<span id="cb196-2083"><a href="#cb196-2083" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_MeOH_3$iresults%&gt;%</span></span>
<span id="cb196-2084"><a href="#cb196-2084" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb196-2085"><a href="#cb196-2085" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_MeOH_3$iresults%&gt;%</span></span>
<span id="cb196-2086"><a href="#cb196-2086" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb196-2087"><a href="#cb196-2087" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_MeOH_4$iresults%&gt;%</span></span>
<span id="cb196-2088"><a href="#cb196-2088" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb196-2089"><a href="#cb196-2089" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_MeOH_4$iresults%&gt;%</span></span>
<span id="cb196-2090"><a href="#cb196-2090" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4")) %&gt;%</span></span>
<span id="cb196-2091"><a href="#cb196-2091" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(ivar = if_else(ivar&gt;1e6,1e6,ivar))%&gt;%</span></span>
<span id="cb196-2092"><a href="#cb196-2092" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.factor(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB))</span></span>
<span id="cb196-2093"><a href="#cb196-2093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2094"><a href="#cb196-2094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2095"><a href="#cb196-2095" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=iresults %&gt;%</span></span>
<span id="cb196-2096"><a href="#cb196-2096" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb196-2097"><a href="#cb196-2097" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-2098"><a href="#cb196-2098" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-2099"><a href="#cb196-2099" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-2100"><a href="#cb196-2100" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb196-2101"><a href="#cb196-2101" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb196-2102"><a href="#cb196-2102" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(0.1,100))+</span></span>
<span id="cb196-2103"><a href="#cb196-2103" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-2104"><a href="#cb196-2104" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb196-2105"><a href="#cb196-2105" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-2106"><a href="#cb196-2106" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=iresults %&gt;%</span></span>
<span id="cb196-2107"><a href="#cb196-2107" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb196-2108"><a href="#cb196-2108" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-2109"><a href="#cb196-2109" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-2110"><a href="#cb196-2110" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-2111"><a href="#cb196-2111" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb196-2112"><a href="#cb196-2112" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb196-2113"><a href="#cb196-2113" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,1000000))+</span></span>
<span id="cb196-2114"><a href="#cb196-2114" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-2115"><a href="#cb196-2115" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb196-2116"><a href="#cb196-2116" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-2117"><a href="#cb196-2117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2118"><a href="#cb196-2118" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb196-2119"><a href="#cb196-2119" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb196-2120"><a href="#cb196-2120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2121"><a href="#cb196-2121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2122"><a href="#cb196-2122" aria-hidden="true" tabindex="-1"></a><span class="in">idx_exemple_analytes = iresults %&gt;%</span></span>
<span id="cb196-2123"><a href="#cb196-2123" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(method=="prior_ref") %&gt;%</span></span>
<span id="cb196-2124"><a href="#cb196-2124" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(ivar)%&gt;%</span></span>
<span id="cb196-2125"><a href="#cb196-2125" aria-hidden="true" tabindex="-1"></a><span class="in">  slice(which(row_number() %% 100 == 1)) %&gt;%</span></span>
<span id="cb196-2126"><a href="#cb196-2126" aria-hidden="true" tabindex="-1"></a><span class="in">  select(i)%&gt;%pull()</span></span>
<span id="cb196-2127"><a href="#cb196-2127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2128"><a href="#cb196-2128" aria-hidden="true" tabindex="-1"></a><span class="in">iresults %&gt;%</span></span>
<span id="cb196-2129"><a href="#cb196-2129" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb196-2130"><a href="#cb196-2130" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb196-2131"><a href="#cb196-2131" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb196-2132"><a href="#cb196-2132" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3))%&gt;%</span></span>
<span id="cb196-2133"><a href="#cb196-2133" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-2134"><a href="#cb196-2134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2135"><a href="#cb196-2135" aria-hidden="true" tabindex="-1"></a><span class="in">f55_3=iresults %&gt;%</span></span>
<span id="cb196-2136"><a href="#cb196-2136" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb196-2137"><a href="#cb196-2137" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb196-2138"><a href="#cb196-2138" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb196-2139"><a href="#cb196-2139" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb196-2140"><a href="#cb196-2140" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(`&lt;=1x`:`&lt;=3x`, names_to = "target") %&gt;%</span></span>
<span id="cb196-2141"><a href="#cb196-2141" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=value,color=as.factor(target)))+</span></span>
<span id="cb196-2142"><a href="#cb196-2142" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point()+</span></span>
<span id="cb196-2143"><a href="#cb196-2143" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Probability", y = "Method", color = "target")+</span></span>
<span id="cb196-2144"><a href="#cb196-2144" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 0.9, linetype="dotted")</span></span>
<span id="cb196-2145"><a href="#cb196-2145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2146"><a href="#cb196-2146" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=f55_3, .filename=paste("single-form-analytes-MeOH-gra-prob.pdf"), .path = figures_dir1)</span></span>
<span id="cb196-2147"><a href="#cb196-2147" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=f55_3, .filename=paste("single-form-analytes-MeOH-gra-prob.png"), .path = figures_dir1)</span></span>
<span id="cb196-2148"><a href="#cb196-2148" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p31, .filename=paste("single-form-analytes-MeOH-gra-prior-p5.pdf"), .path = figures_dir3)</span></span>
<span id="cb196-2149"><a href="#cb196-2149" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p31, .filename=paste("single-form-analytes-MeOH-gra-prior-p5.png"), .path = figures_dir3)</span></span>
<span id="cb196-2150"><a href="#cb196-2150" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p32, .filename=paste("single-form-analytes-MeOH-gra-noprior-p5.pdf"), .path = figures_dir3)</span></span>
<span id="cb196-2151"><a href="#cb196-2151" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p32, .filename=paste("single-form-analytes-MeOH-gra-noprior-p5.png"), .path = figures_dir3)</span></span>
<span id="cb196-2152"><a href="#cb196-2152" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-MeOH-gra-maxvar.pdf"), .path = figures_dir3)</span></span>
<span id="cb196-2153"><a href="#cb196-2153" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-MeOH-gra-maxvar.png"), .path = figures_dir3)</span></span>
<span id="cb196-2154"><a href="#cb196-2154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2155"><a href="#cb196-2155" aria-hidden="true" tabindex="-1"></a><span class="in">p31</span></span>
<span id="cb196-2156"><a href="#cb196-2156" aria-hidden="true" tabindex="-1"></a><span class="in">p32</span></span>
<span id="cb196-2157"><a href="#cb196-2157" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb196-2158"><a href="#cb196-2158" aria-hidden="true" tabindex="-1"></a><span class="in">f33_3=p33</span></span>
<span id="cb196-2159"><a href="#cb196-2159" aria-hidden="true" tabindex="-1"></a><span class="in">f55_3</span></span>
<span id="cb196-2160"><a href="#cb196-2160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2161"><a href="#cb196-2161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2162"><a href="#cb196-2162" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Isocratic conditions</span></span>
<span id="cb196-2163"><a href="#cb196-2163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-MeOH-izo-summary}</span></span>
<span id="cb196-2164"><a href="#cb196-2164" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb196-2165"><a href="#cb196-2165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2166"><a href="#cb196-2166" aria-hidden="true" tabindex="-1"></a><span class="in">plot_id = function(results) {</span></span>
<span id="cb196-2167"><a href="#cb196-2167" aria-hidden="true" tabindex="-1"></a><span class="in">  results %&gt;%</span></span>
<span id="cb196-2168"><a href="#cb196-2168" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=fi, y=CV/10)) +</span></span>
<span id="cb196-2169"><a href="#cb196-2169" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb196-2170"><a href="#cb196-2170" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(aes(x=fi, ymin = llog10tr, ymax = ulog10tr), alpha = 0.4, col = NA) +</span></span>
<span id="cb196-2171"><a href="#cb196-2171" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x=fi, y=mlog10tr), col = "black", size=0.25) +</span></span>
<span id="cb196-2172"><a href="#cb196-2172" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_y_continuous(</span></span>
<span id="cb196-2173"><a href="#cb196-2173" aria-hidden="true" tabindex="-1"></a><span class="in">    name = "log(tr)",</span></span>
<span id="cb196-2174"><a href="#cb196-2174" aria-hidden="true" tabindex="-1"></a><span class="in">    sec.axis = sec_axis(~.*10, name="%CV")) +</span></span>
<span id="cb196-2175"><a href="#cb196-2175" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0,1,by=0.2))+</span></span>
<span id="cb196-2176"><a href="#cb196-2176" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_grid(i~mod) +</span></span>
<span id="cb196-2177"><a href="#cb196-2177" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 1, linetype=2)+</span></span>
<span id="cb196-2178"><a href="#cb196-2178" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim=c(0,4))</span></span>
<span id="cb196-2179"><a href="#cb196-2179" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-2180"><a href="#cb196-2180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2181"><a href="#cb196-2181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2182"><a href="#cb196-2182" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_MeOH_ref&lt;-prior_ma_MeOH_ref$izoresults%&gt;%</span></span>
<span id="cb196-2183"><a href="#cb196-2183" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2184"><a href="#cb196-2184" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2185"><a href="#cb196-2185" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2186"><a href="#cb196-2186" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2187"><a href="#cb196-2187" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2188"><a href="#cb196-2188" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2189"><a href="#cb196-2189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2190"><a href="#cb196-2190" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_MeOH_ref&lt;-noprior_ma_MeOH_ref$izoresults%&gt;%</span></span>
<span id="cb196-2191"><a href="#cb196-2191" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2192"><a href="#cb196-2192" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2193"><a href="#cb196-2193" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2194"><a href="#cb196-2194" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2195"><a href="#cb196-2195" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2196"><a href="#cb196-2196" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2197"><a href="#cb196-2197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2198"><a href="#cb196-2198" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_MeOH_1&lt;-prior_ma_MeOH_1$izoresults%&gt;%</span></span>
<span id="cb196-2199"><a href="#cb196-2199" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2200"><a href="#cb196-2200" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2201"><a href="#cb196-2201" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2202"><a href="#cb196-2202" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2203"><a href="#cb196-2203" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2204"><a href="#cb196-2204" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2205"><a href="#cb196-2205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2206"><a href="#cb196-2206" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_MeOH_2&lt;-prior_ma_MeOH_2$izoresults%&gt;%</span></span>
<span id="cb196-2207"><a href="#cb196-2207" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2208"><a href="#cb196-2208" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2209"><a href="#cb196-2209" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2210"><a href="#cb196-2210" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2211"><a href="#cb196-2211" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = mrgmisc::ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2212"><a href="#cb196-2212" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2213"><a href="#cb196-2213" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_MeOH_2&lt;-noprior_ma_MeOH_2$izoresults%&gt;%</span></span>
<span id="cb196-2214"><a href="#cb196-2214" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2215"><a href="#cb196-2215" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2216"><a href="#cb196-2216" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2217"><a href="#cb196-2217" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2218"><a href="#cb196-2218" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2219"><a href="#cb196-2219" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2220"><a href="#cb196-2220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2221"><a href="#cb196-2221" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_MeOH_3&lt;-prior_ma_MeOH_3$izoresults%&gt;%</span></span>
<span id="cb196-2222"><a href="#cb196-2222" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2223"><a href="#cb196-2223" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2224"><a href="#cb196-2224" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2225"><a href="#cb196-2225" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2226"><a href="#cb196-2226" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2227"><a href="#cb196-2227" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2228"><a href="#cb196-2228" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_MeOH_3&lt;-noprior_ma_MeOH_3$izoresults%&gt;%</span></span>
<span id="cb196-2229"><a href="#cb196-2229" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2230"><a href="#cb196-2230" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2231"><a href="#cb196-2231" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2232"><a href="#cb196-2232" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2233"><a href="#cb196-2233" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2234"><a href="#cb196-2234" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2235"><a href="#cb196-2235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2236"><a href="#cb196-2236" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_MeOH_4&lt;-prior_ma_MeOH_4$izoresults%&gt;%</span></span>
<span id="cb196-2237"><a href="#cb196-2237" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2238"><a href="#cb196-2238" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2239"><a href="#cb196-2239" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2240"><a href="#cb196-2240" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2241"><a href="#cb196-2241" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2242"><a href="#cb196-2242" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2243"><a href="#cb196-2243" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_MeOH_4&lt;-noprior_ma_MeOH_4$izoresults%&gt;%</span></span>
<span id="cb196-2244"><a href="#cb196-2244" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2245"><a href="#cb196-2245" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2246"><a href="#cb196-2246" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2247"><a href="#cb196-2247" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2248"><a href="#cb196-2248" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2249"><a href="#cb196-2249" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2250"><a href="#cb196-2250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2251"><a href="#cb196-2251" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_MeOH_ref = map(results_prior_ma_MeOH_ref,plot_id)</span></span>
<span id="cb196-2252"><a href="#cb196-2252" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_MeOH_ref = map(results_noprior_ma_MeOH_ref,plot_id)</span></span>
<span id="cb196-2253"><a href="#cb196-2253" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_MeOH_1 = map(results_prior_ma_MeOH_1,plot_id)</span></span>
<span id="cb196-2254"><a href="#cb196-2254" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_MeOH_2 = map(results_prior_ma_MeOH_2,plot_id)</span></span>
<span id="cb196-2255"><a href="#cb196-2255" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_MeOH_2 = map(results_noprior_ma_MeOH_2,plot_id)</span></span>
<span id="cb196-2256"><a href="#cb196-2256" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_MeOH_3 = map(results_prior_ma_MeOH_3,plot_id)</span></span>
<span id="cb196-2257"><a href="#cb196-2257" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_MeOH_3 = map(results_noprior_ma_MeOH_3,plot_id)</span></span>
<span id="cb196-2258"><a href="#cb196-2258" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_MeOH_4 = map(results_prior_ma_MeOH_4,plot_id)</span></span>
<span id="cb196-2259"><a href="#cb196-2259" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_MeOH_4 = map(results_noprior_ma_MeOH_4,plot_id)</span></span>
<span id="cb196-2260"><a href="#cb196-2260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2261"><a href="#cb196-2261" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_MeOH_ref[[1]], .filename=paste("plots-results-prior-ma-MeOH-ref.pdf"), .path = figures_dir3)</span></span>
<span id="cb196-2262"><a href="#cb196-2262" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_MeOH_ref[[1]], .filename=paste("plots-results-prior-ma-MeOH-ref.png"), .path = figures_dir3)</span></span>
<span id="cb196-2263"><a href="#cb196-2263" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_MeOH_3[[1]], .filename=paste("plots-results-prior-ma-MeOH-3.pdf"), .path = figures_dir3)</span></span>
<span id="cb196-2264"><a href="#cb196-2264" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_MeOH_3[[1]], .filename=paste("plots-results-prior-ma-MeOH-3.png"), .path = figures_dir3)</span></span>
<span id="cb196-2265"><a href="#cb196-2265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2266"><a href="#cb196-2266" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_MeOH_ref</span></span>
<span id="cb196-2267"><a href="#cb196-2267" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_MeOH_ref</span></span>
<span id="cb196-2268"><a href="#cb196-2268" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_MeOH_1</span></span>
<span id="cb196-2269"><a href="#cb196-2269" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_MeOH_2</span></span>
<span id="cb196-2270"><a href="#cb196-2270" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_MeOH_2</span></span>
<span id="cb196-2271"><a href="#cb196-2271" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_MeOH_3</span></span>
<span id="cb196-2272"><a href="#cb196-2272" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_MeOH_3</span></span>
<span id="cb196-2273"><a href="#cb196-2273" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_MeOH_4</span></span>
<span id="cb196-2274"><a href="#cb196-2274" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_MeOH_4</span></span>
<span id="cb196-2275"><a href="#cb196-2275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2276"><a href="#cb196-2276" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb196-2277"><a href="#cb196-2277" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb196-2278"><a href="#cb196-2278" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb196-2279"><a href="#cb196-2279" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb196-2280"><a href="#cb196-2280" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb196-2281"><a href="#cb196-2281" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span>
<span id="cb196-2282"><a href="#cb196-2282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2283"><a href="#cb196-2283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2284"><a href="#cb196-2284" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Combined</span></span>
<span id="cb196-2285"><a href="#cb196-2285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-izo-summary-MeOH-combined}</span></span>
<span id="cb196-2286"><a href="#cb196-2286" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb196-2287"><a href="#cb196-2287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2288"><a href="#cb196-2288" aria-hidden="true" tabindex="-1"></a><span class="in">izoresults = rbind( prior_ma_MeOH_ref$izoresults%&gt;%</span></span>
<span id="cb196-2289"><a href="#cb196-2289" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb196-2290"><a href="#cb196-2290" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_MeOH_ref$izoresults%&gt;%</span></span>
<span id="cb196-2291"><a href="#cb196-2291" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb196-2292"><a href="#cb196-2292" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_MeOH_1$izoresults%&gt;%</span></span>
<span id="cb196-2293"><a href="#cb196-2293" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_1"),</span></span>
<span id="cb196-2294"><a href="#cb196-2294" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_MeOH_2$izoresults%&gt;%</span></span>
<span id="cb196-2295"><a href="#cb196-2295" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb196-2296"><a href="#cb196-2296" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_MeOH_2$izoresults%&gt;%</span></span>
<span id="cb196-2297"><a href="#cb196-2297" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_2"),</span></span>
<span id="cb196-2298"><a href="#cb196-2298" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_MeOH_3$izoresults%&gt;%</span></span>
<span id="cb196-2299"><a href="#cb196-2299" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb196-2300"><a href="#cb196-2300" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_MeOH_3$izoresults%&gt;%</span></span>
<span id="cb196-2301"><a href="#cb196-2301" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb196-2302"><a href="#cb196-2302" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_MeOH_4$izoresults%&gt;%</span></span>
<span id="cb196-2303"><a href="#cb196-2303" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb196-2304"><a href="#cb196-2304" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_MeOH_4$izoresults%&gt;%</span></span>
<span id="cb196-2305"><a href="#cb196-2305" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4")) %&gt;%</span></span>
<span id="cb196-2306"><a href="#cb196-2306" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&lt;=log10(100))%&gt;%</span></span>
<span id="cb196-2307"><a href="#cb196-2307" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&gt;=log10(5))%&gt;%</span></span>
<span id="cb196-2308"><a href="#cb196-2308" aria-hidden="true" tabindex="-1"></a><span class="in">mutate(c = as.numeric(c),</span></span>
<span id="cb196-2309"><a href="#cb196-2309" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2310"><a href="#cb196-2310" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(i,method,c)%&gt;%</span></span>
<span id="cb196-2311"><a href="#cb196-2311" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(i,method) %&gt;%</span></span>
<span id="cb196-2312"><a href="#cb196-2312" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(imaxcv = max(CV), imincv = min(CV), aveCV = pracma::trapz(c, CV)/(n()-1)) %&gt;%</span></span>
<span id="cb196-2313"><a href="#cb196-2313" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(imaxcv = if_else(imaxcv&gt;1e4,1e4,imaxcv))%&gt;%</span></span>
<span id="cb196-2314"><a href="#cb196-2314" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.integer(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB))</span></span>
<span id="cb196-2315"><a href="#cb196-2315" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb196-2316"><a href="#cb196-2316" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=izoresults %&gt;%</span></span>
<span id="cb196-2317"><a href="#cb196-2317" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb196-2318"><a href="#cb196-2318" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-2319"><a href="#cb196-2319" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-2320"><a href="#cb196-2320" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb196-2321"><a href="#cb196-2321" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-2322"><a href="#cb196-2322" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb196-2323"><a href="#cb196-2323" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-2324"><a href="#cb196-2324" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(1,100))+   </span></span>
<span id="cb196-2325"><a href="#cb196-2325" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-2326"><a href="#cb196-2326" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb196-2327"><a href="#cb196-2327" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-2328"><a href="#cb196-2328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2329"><a href="#cb196-2329" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=izoresults %&gt;%</span></span>
<span id="cb196-2330"><a href="#cb196-2330" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb196-2331"><a href="#cb196-2331" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-2332"><a href="#cb196-2332" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-2333"><a href="#cb196-2333" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb196-2334"><a href="#cb196-2334" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-2335"><a href="#cb196-2335" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb196-2336"><a href="#cb196-2336" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb196-2337"><a href="#cb196-2337" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,10000))+    </span></span>
<span id="cb196-2338"><a href="#cb196-2338" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-2339"><a href="#cb196-2339" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb196-2340"><a href="#cb196-2340" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-2341"><a href="#cb196-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2342"><a href="#cb196-2342" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb196-2343"><a href="#cb196-2343" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb196-2344"><a href="#cb196-2344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2345"><a href="#cb196-2345" aria-hidden="true" tabindex="-1"></a><span class="in">f44_3 = p33</span></span>
<span id="cb196-2346"><a href="#cb196-2346" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-MeOH-izo-combined-CV.pdf"), .path = figures_dir3)</span></span>
<span id="cb196-2347"><a href="#cb196-2347" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-MeOH-izo-combined-CV.png"), .path = figures_dir3)</span></span>
<span id="cb196-2348"><a href="#cb196-2348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2349"><a href="#cb196-2349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2350"><a href="#cb196-2350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2351"><a href="#cb196-2351" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stan multiple analytes. Single form analytes. fi and tg for ACN as design variables</span></span>
<span id="cb196-2352"><a href="#cb196-2352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2353"><a href="#cb196-2353" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile stan models</span></span>
<span id="cb196-2354"><a href="#cb196-2354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-ACN-compilation}</span></span>
<span id="cb196-2355"><a href="#cb196-2355" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_ACN_gq= cmdstan_model("../stan/hplc-gra-single-form-analytes-ACN-gq.stan", </span></span>
<span id="cb196-2356"><a href="#cb196-2356" aria-hidden="true" tabindex="-1"></a><span class="in">                                    stanc_options = list("O1"))</span></span>
<span id="cb196-2357"><a href="#cb196-2357" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_ACN_sim = cmdstan_model("../stan/hplc-gra-single-form-analytes-ACN-sim.stan",</span></span>
<span id="cb196-2358"><a href="#cb196-2358" aria-hidden="true" tabindex="-1"></a><span class="in">                                      stanc_options = list("O1"))</span></span>
<span id="cb196-2359"><a href="#cb196-2359" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_ACN = cmdstan_model("../stan/hplc-gra-single-form-analytes-ACN.stan", </span></span>
<span id="cb196-2360"><a href="#cb196-2360" aria-hidden="true" tabindex="-1"></a><span class="in">                                  stanc_options = list("O1"))</span></span>
<span id="cb196-2361"><a href="#cb196-2361" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_ACN$compile(compile_model_methods=TRUE,force_recompile=TRUE)</span></span>
<span id="cb196-2362"><a href="#cb196-2362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2363"><a href="#cb196-2363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2364"><a href="#cb196-2364" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulate retention times and create datasets</span></span>
<span id="cb196-2365"><a href="#cb196-2365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2366"><a href="#cb196-2366" aria-hidden="true" tabindex="-1"></a>Probability of occurrence 0.4 neutral, 0.3 A, 0.3 B with $log P$ being sampled from 2.2 $\pm$ 2 and constrained between 0.5 and 7.</span>
<span id="cb196-2367"><a href="#cb196-2367" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-2368"><a href="#cb196-2368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-ACN-simulations}</span></span>
<span id="cb196-2369"><a href="#cb196-2369" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma_ACN=hplcparam_candidates_df%&gt;%filter(xpH==0, m==1)</span></span>
<span id="cb196-2370"><a href="#cb196-2370" aria-hidden="true" tabindex="-1"></a><span class="in">nObs = nrow(data_ma_ACN);</span></span>
<span id="cb196-2371"><a href="#cb196-2371" aria-hidden="true" tabindex="-1"></a><span class="in">nAnalytes =50;</span></span>
<span id="cb196-2372"><a href="#cb196-2372" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = 1234;</span></span>
<span id="cb196-2373"><a href="#cb196-2373" aria-hidden="true" tabindex="-1"></a><span class="in">n_param = 3;</span></span>
<span id="cb196-2374"><a href="#cb196-2374" aria-hidden="true" tabindex="-1"></a><span class="in">n_rep = 10;</span></span>
<span id="cb196-2375"><a href="#cb196-2375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2376"><a href="#cb196-2376" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma_ACN=list()</span></span>
<span id="cb196-2377"><a href="#cb196-2377" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_ACN=list()</span></span>
<span id="cb196-2378"><a href="#cb196-2378" aria-hidden="true" tabindex="-1"></a><span class="in">inits_ACN = list()</span></span>
<span id="cb196-2379"><a href="#cb196-2379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2380"><a href="#cb196-2380" aria-hidden="true" tabindex="-1"></a><span class="in">for (i in 1:n_rep) {</span></span>
<span id="cb196-2381"><a href="#cb196-2381" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_ACN[[i]] = list(nObs=nObs,</span></span>
<span id="cb196-2382"><a href="#cb196-2382" aria-hidden="true" tabindex="-1"></a><span class="in">                   nAnalytes=nAnalytes,</span></span>
<span id="cb196-2383"><a href="#cb196-2383" aria-hidden="true" tabindex="-1"></a><span class="in">                   steps = 4 + 6*data_ma_ACN$m,</span></span>
<span id="cb196-2384"><a href="#cb196-2384" aria-hidden="true" tabindex="-1"></a><span class="in">                   hplcparam=as.matrix(data_ma_ACN%&gt;%dplyr::select(c(tg,td,to,te,fio,fif,m))),</span></span>
<span id="cb196-2385"><a href="#cb196-2385" aria-hidden="true" tabindex="-1"></a><span class="in">                   include_prior = 1,</span></span>
<span id="cb196-2386"><a href="#cb196-2386" aria-hidden="true" tabindex="-1"></a><span class="in">                   run_estimation=1,</span></span>
<span id="cb196-2387"><a href="#cb196-2387" aria-hidden="true" tabindex="-1"></a><span class="in">                   nSel = nObs,</span></span>
<span id="cb196-2388"><a href="#cb196-2388" aria-hidden="true" tabindex="-1"></a><span class="in">                   selected = 1:nObs)</span></span>
<span id="cb196-2389"><a href="#cb196-2389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2390"><a href="#cb196-2390" aria-hidden="true" tabindex="-1"></a><span class="in">fit_ACN_gq  = mod_analytes_ACN_gq$sample(data = datastruct_prior_ma_ACN[[i]],</span></span>
<span id="cb196-2391"><a href="#cb196-2391" aria-hidden="true" tabindex="-1"></a><span class="in">                                         seed = cseed,</span></span>
<span id="cb196-2392"><a href="#cb196-2392" aria-hidden="true" tabindex="-1"></a><span class="in">                                         fixed_param = TRUE,</span></span>
<span id="cb196-2393"><a href="#cb196-2393" aria-hidden="true" tabindex="-1"></a><span class="in">                                         chains = 1,</span></span>
<span id="cb196-2394"><a href="#cb196-2394" aria-hidden="true" tabindex="-1"></a><span class="in">                                         iter_sampling=1)</span></span>
<span id="cb196-2395"><a href="#cb196-2395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2396"><a href="#cb196-2396" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_ACN[[i]]$trobs = matrix(fit_ACN_gq$draws(format = "matrix", variable = "y_hat_sim"),nAnalytes,nObs)</span></span>
<span id="cb196-2397"><a href="#cb196-2397" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_ACN[[i]]$logPobs = fit_ACN_gq$draws(format = "matrix", variable = "logPobs")[1:nAnalytes]</span></span>
<span id="cb196-2398"><a href="#cb196-2398" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma_ACN[[i]]$N1A2B3 = fit_ACN_gq$draws(format = "matrix", variable = "N1A2B3")[1:nAnalytes]</span></span>
<span id="cb196-2399"><a href="#cb196-2399" aria-hidden="true" tabindex="-1"></a><span class="in">param = matrix(fit_ACN_gq$draws(format = "matrix", variable = "paramsim"),nAnalytes,2)</span></span>
<span id="cb196-2400"><a href="#cb196-2400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2401"><a href="#cb196-2401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2402"><a href="#cb196-2402" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma_ACN[[i]]=datastruct_prior_ma_ACN[[i]];</span></span>
<span id="cb196-2403"><a href="#cb196-2403" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma_ACN[[i]]$include_prior = 0.01;</span></span>
<span id="cb196-2404"><a href="#cb196-2404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2405"><a href="#cb196-2405" aria-hidden="true" tabindex="-1"></a><span class="in">inits_ACN[[i]]=param</span></span>
<span id="cb196-2406"><a href="#cb196-2406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2407"><a href="#cb196-2407" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = cseed+1</span></span>
<span id="cb196-2408"><a href="#cb196-2408" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-2409"><a href="#cb196-2409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2410"><a href="#cb196-2410" aria-hidden="true" tabindex="-1"></a><span class="in">mean_log_det_stan_ACN = function(data, init, chosen_indices, S){</span></span>
<span id="cb196-2411"><a href="#cb196-2411" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-2412"><a href="#cb196-2412" aria-hidden="true" tabindex="-1"></a><span class="in">init_ma = function(){list(param=init)}</span></span>
<span id="cb196-2413"><a href="#cb196-2413" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-2414"><a href="#cb196-2414" aria-hidden="true" tabindex="-1"></a><span class="in">data$selected = chosen_indices;</span></span>
<span id="cb196-2415"><a href="#cb196-2415" aria-hidden="true" tabindex="-1"></a><span class="in">data$nSel = length(chosen_indices);</span></span>
<span id="cb196-2416"><a href="#cb196-2416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2417"><a href="#cb196-2417" aria-hidden="true" tabindex="-1"></a><span class="in"> fit_ACN_opt  = mod_analytes_ACN$optimize(</span></span>
<span id="cb196-2418"><a href="#cb196-2418" aria-hidden="true" tabindex="-1"></a><span class="in">   data = data,</span></span>
<span id="cb196-2419"><a href="#cb196-2419" aria-hidden="true" tabindex="-1"></a><span class="in">   output_dir = here::here("stanfiles"),</span></span>
<span id="cb196-2420"><a href="#cb196-2420" aria-hidden="true" tabindex="-1"></a><span class="in">   output_basename = S,</span></span>
<span id="cb196-2421"><a href="#cb196-2421" aria-hidden="true" tabindex="-1"></a><span class="in">   seed = cseed,</span></span>
<span id="cb196-2422"><a href="#cb196-2422" aria-hidden="true" tabindex="-1"></a><span class="in">   init = init_ma,</span></span>
<span id="cb196-2423"><a href="#cb196-2423" aria-hidden="true" tabindex="-1"></a><span class="in">   jacobian = TRUE,</span></span>
<span id="cb196-2424"><a href="#cb196-2424" aria-hidden="true" tabindex="-1"></a><span class="in">   show_messages = F)</span></span>
<span id="cb196-2425"><a href="#cb196-2425" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb196-2426"><a href="#cb196-2426" aria-hidden="true" tabindex="-1"></a><span class="in"> mode=fit_ACN_opt$unconstrain_variables(list(param = fit_ACN_opt$mle("param")))</span></span>
<span id="cb196-2427"><a href="#cb196-2427" aria-hidden="true" tabindex="-1"></a><span class="in"> hessian = fit_ACN_opt$hessian(unconstrained_variables = mode)$hessian</span></span>
<span id="cb196-2428"><a href="#cb196-2428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2429"><a href="#cb196-2429" aria-hidden="true" tabindex="-1"></a><span class="in">logdet = unlist(purrr::map(1:data$nAnalytes,\(i) log(det(-hessian[((i-1)*2+1):((i-1)*2+2),((i-1)*2+1):((i-1)*2+2)]))))</span></span>
<span id="cb196-2430"><a href="#cb196-2430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2431"><a href="#cb196-2431" aria-hidden="true" tabindex="-1"></a><span class="in">return(logdet)</span></span>
<span id="cb196-2432"><a href="#cb196-2432" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-2433"><a href="#cb196-2433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2434"><a href="#cb196-2434" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(9,33)</span></span>
<span id="cb196-2435"><a href="#cb196-2435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2436"><a href="#cb196-2436" aria-hidden="true" tabindex="-1"></a><span class="in"># quick test:</span></span>
<span id="cb196-2437"><a href="#cb196-2437" aria-hidden="true" tabindex="-1"></a><span class="in">z_prior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan_ACN(datastruct_prior_ma_ACN[[i]], inits_ACN[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb196-2438"><a href="#cb196-2438" aria-hidden="true" tabindex="-1"></a><span class="in">z_noprior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan_ACN(datastruct_noprior_ma_ACN[[i]], inits_ACN[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb196-2439"><a href="#cb196-2439" aria-hidden="true" tabindex="-1"></a><span class="in">test = c(mean(unlist(z_prior)),mean(unlist(z_noprior)))</span></span>
<span id="cb196-2440"><a href="#cb196-2440" aria-hidden="true" tabindex="-1"></a><span class="in">test</span></span>
<span id="cb196-2441"><a href="#cb196-2441" aria-hidden="true" tabindex="-1"></a><span class="in">c("8.059532 7.116247")</span></span>
<span id="cb196-2442"><a href="#cb196-2442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2443"><a href="#cb196-2443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2444"><a href="#cb196-2444" aria-hidden="true" tabindex="-1"></a><span class="in">logP = unlist(purrr::map(1:length(datastruct_prior_ma_ACN),\(i) datastruct_prior_ma_ACN[[i]]$logPobs))</span></span>
<span id="cb196-2445"><a href="#cb196-2445" aria-hidden="true" tabindex="-1"></a><span class="in">NAB = unlist(purrr::map(1:length(datastruct_prior_ma_ACN),\(i) datastruct_prior_ma_ACN[[i]]$N1A2B3))</span></span>
<span id="cb196-2446"><a href="#cb196-2446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2447"><a href="#cb196-2447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2448"><a href="#cb196-2448" aria-hidden="true" tabindex="-1"></a><span class="fu">## Optimization</span></span>
<span id="cb196-2449"><a href="#cb196-2449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-ACN-optimization, eval=FALSE}</span></span>
<span id="cb196-2450"><a href="#cb196-2450" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(33) # initial values</span></span>
<span id="cb196-2451"><a href="#cb196-2451" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_prior_1 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-2452"><a href="#cb196-2452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2453"><a href="#cb196-2453" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(16,33) # initial values</span></span>
<span id="cb196-2454"><a href="#cb196-2454" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-2455"><a href="#cb196-2455" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(16,33) # initial values</span></span>
<span id="cb196-2456"><a href="#cb196-2456" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_noprior_2 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-2457"><a href="#cb196-2457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2458"><a href="#cb196-2458" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(12,33,16) # initial values</span></span>
<span id="cb196-2459"><a href="#cb196-2459" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-2460"><a href="#cb196-2460" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(12,33,36) # initial values</span></span>
<span id="cb196-2461"><a href="#cb196-2461" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-2462"><a href="#cb196-2462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2463"><a href="#cb196-2463" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(12,34,33,16) # initial values</span></span>
<span id="cb196-2464"><a href="#cb196-2464" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-2465"><a href="#cb196-2465" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(12,34,33,16) # initial values</span></span>
<span id="cb196-2466"><a href="#cb196-2466" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, n_iter = 100)</span></span>
<span id="cb196-2467"><a href="#cb196-2467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2468"><a href="#cb196-2468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2469"><a href="#cb196-2469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2470"><a href="#cb196-2470" aria-hidden="true" tabindex="-1"></a><span class="fu">### Read the results and compare</span></span>
<span id="cb196-2471"><a href="#cb196-2471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-ACN-logDet-summary}</span></span>
<span id="cb196-2472"><a href="#cb196-2472" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(9,33) # ref</span></span>
<span id="cb196-2473"><a href="#cb196-2473" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior= c(9,33) # ref</span></span>
<span id="cb196-2474"><a href="#cb196-2474" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_prior_ref = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-2475"><a href="#cb196-2475" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_noprior_ref = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-2476"><a href="#cb196-2476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2477"><a href="#cb196-2477" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(33) # p=1</span></span>
<span id="cb196-2478"><a href="#cb196-2478" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_prior_1 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-2479"><a href="#cb196-2479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2480"><a href="#cb196-2480" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(16,33) # p=2</span></span>
<span id="cb196-2481"><a href="#cb196-2481" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(12,33) # p=2</span></span>
<span id="cb196-2482"><a href="#cb196-2482" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-2483"><a href="#cb196-2483" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_noprior_2 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-2484"><a href="#cb196-2484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2485"><a href="#cb196-2485" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(12, 33, 36) # p=3</span></span>
<span id="cb196-2486"><a href="#cb196-2486" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(12, 33, 36) # p=3</span></span>
<span id="cb196-2487"><a href="#cb196-2487" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-2488"><a href="#cb196-2488" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-2489"><a href="#cb196-2489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2490"><a href="#cb196-2490" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(12,36, 33, 11) # p=4</span></span>
<span id="cb196-2491"><a href="#cb196-2491" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(12, 34, 33, 36) # p=4</span></span>
<span id="cb196-2492"><a href="#cb196-2492" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_prior_ma_ACN, inits_ACN, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb196-2493"><a href="#cb196-2493" aria-hidden="true" tabindex="-1"></a><span class="in">fws_ACN_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan_ACN, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb196-2494"><a href="#cb196-2494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2495"><a href="#cb196-2495" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results = tibble(logP = logP,</span></span>
<span id="cb196-2496"><a href="#cb196-2496" aria-hidden="true" tabindex="-1"></a><span class="in">                         Type = NAB,</span></span>
<span id="cb196-2497"><a href="#cb196-2497" aria-hidden="true" tabindex="-1"></a><span class="in">                         prior_ref = fws_ACN_prior_ref$log_det_FIM,</span></span>
<span id="cb196-2498"><a href="#cb196-2498" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_ref = fws_ACN_noprior_ref$log_det_FIM,</span></span>
<span id="cb196-2499"><a href="#cb196-2499" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_1 = fws_ACN_prior_1$log_det_FIM,</span></span>
<span id="cb196-2500"><a href="#cb196-2500" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_2 = fws_ACN_prior_2$log_det_FIM,</span></span>
<span id="cb196-2501"><a href="#cb196-2501" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_2 = fws_ACN_noprior_2$log_det_FIM,</span></span>
<span id="cb196-2502"><a href="#cb196-2502" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_3 = fws_ACN_prior_3$log_det_FIM,</span></span>
<span id="cb196-2503"><a href="#cb196-2503" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_3 = fws_ACN_noprior_3$log_det_FIM,</span></span>
<span id="cb196-2504"><a href="#cb196-2504" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_4 = fws_ACN_prior_4$log_det_FIM,</span></span>
<span id="cb196-2505"><a href="#cb196-2505" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_4 = fws_ACN_noprior_4$log_det_FIM) %&gt;%</span></span>
<span id="cb196-2506"><a href="#cb196-2506" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(prior_ref:noprior_4, names_to = "method")</span></span>
<span id="cb196-2507"><a href="#cb196-2507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2508"><a href="#cb196-2508" aria-hidden="true" tabindex="-1"></a><span class="in">p1=ggplot(summary_results, aes(y=method,x=value))+</span></span>
<span id="cb196-2509"><a href="#cb196-2509" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-2510"><a href="#cb196-2510" aria-hidden="true" tabindex="-1"></a><span class="in"> geom_jitter(aes(y=method, x=value, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-2511"><a href="#cb196-2511" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-2512"><a href="#cb196-2512" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="log(|FIM|)", y = "Method")</span></span>
<span id="cb196-2513"><a href="#cb196-2513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2514"><a href="#cb196-2514" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diff = tibble(logP = logP,</span></span>
<span id="cb196-2515"><a href="#cb196-2515" aria-hidden="true" tabindex="-1"></a><span class="in">                         Type = NAB,</span></span>
<span id="cb196-2516"><a href="#cb196-2516" aria-hidden="true" tabindex="-1"></a><span class="in">                         fws_prior_ref = fws_ACN_prior_ref$log_det_FIM,</span></span>
<span id="cb196-2517"><a href="#cb196-2517" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_ACN_noprior_ref$log_det_FIM,</span></span>
<span id="cb196-2518"><a href="#cb196-2518" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_1 = fws_ACN_prior_1$log_det_FIM,</span></span>
<span id="cb196-2519"><a href="#cb196-2519" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_2 = fws_ACN_prior_2$log_det_FIM,</span></span>
<span id="cb196-2520"><a href="#cb196-2520" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_2 = fws_ACN_noprior_2$log_det_FIM,</span></span>
<span id="cb196-2521"><a href="#cb196-2521" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_ACN_prior_3$log_det_FIM,</span></span>
<span id="cb196-2522"><a href="#cb196-2522" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_ACN_noprior_3$log_det_FIM,</span></span>
<span id="cb196-2523"><a href="#cb196-2523" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_ACN_prior_4$log_det_FIM,</span></span>
<span id="cb196-2524"><a href="#cb196-2524" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_ACN_noprior_4$log_det_FIM) %&gt;%</span></span>
<span id="cb196-2525"><a href="#cb196-2525" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_prior_1 = (fws_prior_1 - fws_prior_ref)/n_param,</span></span>
<span id="cb196-2526"><a href="#cb196-2526" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_2 = (fws_prior_2 - fws_prior_ref)/n_param,</span></span>
<span id="cb196-2527"><a href="#cb196-2527" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_2 = (fws_noprior_2 - fws_noprior_ref)/n_param,</span></span>
<span id="cb196-2528"><a href="#cb196-2528" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_3 = (fws_prior_3 - fws_prior_ref)/n_param,</span></span>
<span id="cb196-2529"><a href="#cb196-2529" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_3 = (fws_noprior_3 - fws_noprior_ref)/n_param,</span></span>
<span id="cb196-2530"><a href="#cb196-2530" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_4 = (fws_prior_4 - fws_prior_ref)/n_param,</span></span>
<span id="cb196-2531"><a href="#cb196-2531" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_4 = (fws_noprior_4 - fws_noprior_ref)/n_param)%&gt;%</span></span>
<span id="cb196-2532"><a href="#cb196-2532" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_prior_1:d_noprior_4, names_to = "method")</span></span>
<span id="cb196-2533"><a href="#cb196-2533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2534"><a href="#cb196-2534" aria-hidden="true" tabindex="-1"></a><span class="in">p2=ggplot(summary_results_diff, aes(y=method,x=exp(value)))+</span></span>
<span id="cb196-2535"><a href="#cb196-2535" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-2536"><a href="#cb196-2536" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-2537"><a href="#cb196-2537" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-2538"><a href="#cb196-2538" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Efficiency relative to the reference design", y = "Method")+</span></span>
<span id="cb196-2539"><a href="#cb196-2539" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")</span></span>
<span id="cb196-2540"><a href="#cb196-2540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2541"><a href="#cb196-2541" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diffprior = tibble(logP = logP,</span></span>
<span id="cb196-2542"><a href="#cb196-2542" aria-hidden="true" tabindex="-1"></a><span class="in">                         Type = NAB,</span></span>
<span id="cb196-2543"><a href="#cb196-2543" aria-hidden="true" tabindex="-1"></a><span class="in">                         fws_prior_ref = fws_ACN_prior_ref$log_det_FIM,</span></span>
<span id="cb196-2544"><a href="#cb196-2544" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_ACN_noprior_ref$log_det_FIM,</span></span>
<span id="cb196-2545"><a href="#cb196-2545" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_2 = fws_ACN_prior_2$log_det_FIM,</span></span>
<span id="cb196-2546"><a href="#cb196-2546" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_2 = fws_ACN_noprior_2$log_det_FIM,</span></span>
<span id="cb196-2547"><a href="#cb196-2547" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_ACN_prior_3$log_det_FIM,</span></span>
<span id="cb196-2548"><a href="#cb196-2548" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_ACN_noprior_3$log_det_FIM,</span></span>
<span id="cb196-2549"><a href="#cb196-2549" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_ACN_prior_4$log_det_FIM,</span></span>
<span id="cb196-2550"><a href="#cb196-2550" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_ACN_noprior_4$log_det_FIM) %&gt;%</span></span>
<span id="cb196-2551"><a href="#cb196-2551" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_ref  = (fws_prior_ref-fws_noprior_ref)/n_param,</span></span>
<span id="cb196-2552"><a href="#cb196-2552" aria-hidden="true" tabindex="-1"></a><span class="in">         d_2 = (fws_prior_2-fws_noprior_2)/n_param,</span></span>
<span id="cb196-2553"><a href="#cb196-2553" aria-hidden="true" tabindex="-1"></a><span class="in">         d_3 = (fws_prior_3-fws_noprior_3)/n_param,</span></span>
<span id="cb196-2554"><a href="#cb196-2554" aria-hidden="true" tabindex="-1"></a><span class="in">         d_4 = (fws_prior_4-fws_noprior_4)/n_param)%&gt;%</span></span>
<span id="cb196-2555"><a href="#cb196-2555" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_ref:d_4, names_to = "method")</span></span>
<span id="cb196-2556"><a href="#cb196-2556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2557"><a href="#cb196-2557" aria-hidden="true" tabindex="-1"></a><span class="in">p3=ggplot(summary_results_diffprior, aes(y=method,x=exp(value)))+</span></span>
<span id="cb196-2558"><a href="#cb196-2558" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-2559"><a href="#cb196-2559" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-2560"><a href="#cb196-2560" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-2561"><a href="#cb196-2561" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Effect of prior on design efficiency", y = "Method")+</span></span>
<span id="cb196-2562"><a href="#cb196-2562" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")+</span></span>
<span id="cb196-2563"><a href="#cb196-2563" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0.5,100),</span></span>
<span id="cb196-2564"><a href="#cb196-2564" aria-hidden="true" tabindex="-1"></a><span class="in">                     trans='log10',</span></span>
<span id="cb196-2565"><a href="#cb196-2565" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.01, 100)),</span></span>
<span id="cb196-2566"><a href="#cb196-2566" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-2567"><a href="#cb196-2567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2568"><a href="#cb196-2568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2569"><a href="#cb196-2569" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb196-2570"><a href="#cb196-2570" aria-hidden="true" tabindex="-1"></a><span class="in">p2</span></span>
<span id="cb196-2571"><a href="#cb196-2571" aria-hidden="true" tabindex="-1"></a><span class="in">p3</span></span>
<span id="cb196-2572"><a href="#cb196-2572" aria-hidden="true" tabindex="-1"></a><span class="in">f2_4 = p2</span></span>
<span id="cb196-2573"><a href="#cb196-2573" aria-hidden="true" tabindex="-1"></a><span class="in">f3_4 = p3</span></span>
<span id="cb196-2574"><a href="#cb196-2574" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p1, .filename=paste("single-form-analytes-ACN-logdFIM-abs.pdf"), .path = figures_dir4)</span></span>
<span id="cb196-2575"><a href="#cb196-2575" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p1, .filename=paste("single-form-analytes-ACN-logdFIM-abs.png"), .path = figures_dir4)</span></span>
<span id="cb196-2576"><a href="#cb196-2576" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p2, .filename=paste("single-form-analytes-ACN-logdFIM-rel.pdf"), .path = figures_dir4)</span></span>
<span id="cb196-2577"><a href="#cb196-2577" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p2, .filename=paste("single-form-analytes-ACN-logdFIM-rel.png"), .path = figures_dir4)</span></span>
<span id="cb196-2578"><a href="#cb196-2578" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p3, .filename=paste("single-form-analytes-ACN-logdFIM-prioreff.pdf"), .path = figures_dir4)</span></span>
<span id="cb196-2579"><a href="#cb196-2579" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p3, .filename=paste("single-form-analytes-ACN-logdFIM-prioreff.png"), .path = figures_dir4)</span></span>
<span id="cb196-2580"><a href="#cb196-2580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2581"><a href="#cb196-2581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2582"><a href="#cb196-2582" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table</span></span>
<span id="cb196-2583"><a href="#cb196-2583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2584"><a href="#cb196-2584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-ACN-table}</span></span>
<span id="cb196-2585"><a href="#cb196-2585" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma_ACN=hplcparam_candidates_df%&gt;%filter(xpH==0, m==1)%&gt;%</span></span>
<span id="cb196-2586"><a href="#cb196-2586" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(line=1:n())</span></span>
<span id="cb196-2587"><a href="#cb196-2587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2588"><a href="#cb196-2588" aria-hidden="true" tabindex="-1"></a><span class="in">combined_results = list(</span></span>
<span id="cb196-2589"><a href="#cb196-2589" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ref = fws_MeOH_prior_ref$chosen_indices,</span></span>
<span id="cb196-2590"><a href="#cb196-2590" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_ref = fws_ACN_noprior_ref$chosen_indices,</span></span>
<span id="cb196-2591"><a href="#cb196-2591" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_1 = fws_ACN_prior_1$chosen_indices,</span></span>
<span id="cb196-2592"><a href="#cb196-2592" aria-hidden="true" tabindex="-1"></a><span class="in">prior_1 = 10000+fws_ACN_prior_1$chosen_indices,</span></span>
<span id="cb196-2593"><a href="#cb196-2593" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_2 = fws_ACN_prior_2$chosen_indices,</span></span>
<span id="cb196-2594"><a href="#cb196-2594" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_2 = fws_ACN_noprior_2$chosen_indices,</span></span>
<span id="cb196-2595"><a href="#cb196-2595" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_3 = fws_ACN_prior_3$chosen_indices,</span></span>
<span id="cb196-2596"><a href="#cb196-2596" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_3 = fws_ACN_noprior_3$chosen_indices,</span></span>
<span id="cb196-2597"><a href="#cb196-2597" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_4 = fws_ACN_prior_4$chosen_indices,</span></span>
<span id="cb196-2598"><a href="#cb196-2598" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_4 = fws_ACN_noprior_4$chosen_indices)</span></span>
<span id="cb196-2599"><a href="#cb196-2599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2600"><a href="#cb196-2600" aria-hidden="true" tabindex="-1"></a><span class="in">selected_exp = enframe(combined_results)%&gt;%</span></span>
<span id="cb196-2601"><a href="#cb196-2601" aria-hidden="true" tabindex="-1"></a><span class="in">   unnest(value) %&gt;%</span></span>
<span id="cb196-2602"><a href="#cb196-2602" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(line=value, Name = name) %&gt;%</span></span>
<span id="cb196-2603"><a href="#cb196-2603" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(data_ma_ACN, by = "line")%&gt;%</span></span>
<span id="cb196-2604"><a href="#cb196-2604" aria-hidden="true" tabindex="-1"></a><span class="in">    arrange(Name,tg, fio)%&gt;%</span></span>
<span id="cb196-2605"><a href="#cb196-2605" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Modifier = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb196-2606"><a href="#cb196-2606" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-c(line,xpH,m,td,to,te,fif)) %&gt;%</span></span>
<span id="cb196-2607"><a href="#cb196-2607" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(type = if_else(str_detect(Name, 'noprior'), "No prior", "Prior"))%&gt;%</span></span>
<span id="cb196-2608"><a href="#cb196-2608" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(where(is.numeric), ~replace_na(., -1)))</span></span>
<span id="cb196-2609"><a href="#cb196-2609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2610"><a href="#cb196-2610" aria-hidden="true" tabindex="-1"></a><span class="in">tab1&lt;-selected_exp %&gt;%</span></span>
<span id="cb196-2611"><a href="#cb196-2611" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "Prior") %&gt;%</span></span>
<span id="cb196-2612"><a href="#cb196-2612" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-type)%&gt;%</span></span>
<span id="cb196-2613"><a href="#cb196-2613" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb196-2614"><a href="#cb196-2614" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-2615"><a href="#cb196-2615" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-2616"><a href="#cb196-2616" aria-hidden="true" tabindex="-1"></a><span class="in">tab2&lt;-selected_exp %&gt;%</span></span>
<span id="cb196-2617"><a href="#cb196-2617" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "No prior")%&gt;%</span></span>
<span id="cb196-2618"><a href="#cb196-2618" aria-hidden="true" tabindex="-1"></a><span class="in">    select(-type)%&gt;%</span></span>
<span id="cb196-2619"><a href="#cb196-2619" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb196-2620"><a href="#cb196-2620" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-2621"><a href="#cb196-2621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2622"><a href="#cb196-2622" aria-hidden="true" tabindex="-1"></a><span class="in">tab2 &lt;- set_formatter(</span></span>
<span id="cb196-2623"><a href="#cb196-2623" aria-hidden="true" tabindex="-1"></a><span class="in">  tab2, </span></span>
<span id="cb196-2624"><a href="#cb196-2624" aria-hidden="true" tabindex="-1"></a><span class="in">  tg = function(x) ifelse(x==-1," ", sprintf("%d", x) ),</span></span>
<span id="cb196-2625"><a href="#cb196-2625" aria-hidden="true" tabindex="-1"></a><span class="in">  fio = function(x) ifelse(x==-1," ", sprintf("%.2f", x) )</span></span>
<span id="cb196-2626"><a href="#cb196-2626" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb196-2627"><a href="#cb196-2627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2628"><a href="#cb196-2628" aria-hidden="true" tabindex="-1"></a><span class="in">p1 = gen_grob(tab1, fit = "auto", just = "centre")</span></span>
<span id="cb196-2629"><a href="#cb196-2629" aria-hidden="true" tabindex="-1"></a><span class="in">p2 = gen_grob(tab2, fit = "auto", just = "centre") </span></span>
<span id="cb196-2630"><a href="#cb196-2630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2631"><a href="#cb196-2631" aria-hidden="true" tabindex="-1"></a><span class="in">gg&lt;-ggplot()+</span></span>
<span id="cb196-2632"><a href="#cb196-2632" aria-hidden="true" tabindex="-1"></a><span class="in">       theme(</span></span>
<span id="cb196-2633"><a href="#cb196-2633" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.background = element_rect(fill='transparent'),</span></span>
<span id="cb196-2634"><a href="#cb196-2634" aria-hidden="true" tabindex="-1"></a><span class="in">         plot.background = element_rect(fill='transparent', color=NA),</span></span>
<span id="cb196-2635"><a href="#cb196-2635" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.major = element_blank(),</span></span>
<span id="cb196-2636"><a href="#cb196-2636" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.minor = element_blank(),</span></span>
<span id="cb196-2637"><a href="#cb196-2637" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.background = element_rect(fill='transparent'),</span></span>
<span id="cb196-2638"><a href="#cb196-2638" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.box.background = element_rect(fill='transparent')</span></span>
<span id="cb196-2639"><a href="#cb196-2639" aria-hidden="true" tabindex="-1"></a><span class="in">       )</span></span>
<span id="cb196-2640"><a href="#cb196-2640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2641"><a href="#cb196-2641" aria-hidden="true" tabindex="-1"></a><span class="in">plot1 &lt;- gg+p1+p2+ plot_layout(ncol = 3, widths = c(1, 20,20))</span></span>
<span id="cb196-2642"><a href="#cb196-2642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2643"><a href="#cb196-2643" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plot1, .filename=paste("single-form-analytes-ACN-table.pdf"), .path = tables_dir4)</span></span>
<span id="cb196-2644"><a href="#cb196-2644" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plot1, .filename=paste("single-form-analytes-ACN-table.png"), .path = tables_dir4)</span></span>
<span id="cb196-2645"><a href="#cb196-2645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2646"><a href="#cb196-2646" aria-hidden="true" tabindex="-1"></a><span class="in">tab1</span></span>
<span id="cb196-2647"><a href="#cb196-2647" aria-hidden="true" tabindex="-1"></a><span class="in">tab2</span></span>
<span id="cb196-2648"><a href="#cb196-2648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2649"><a href="#cb196-2649" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stan simulations</span></span>
<span id="cb196-2650"><a href="#cb196-2650" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-ACN-laplace, eval=F}</span></span>
<span id="cb196-2651"><a href="#cb196-2651" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_ACN_prior_ref$chosen_indices # ref</span></span>
<span id="cb196-2652"><a href="#cb196-2652" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_ACN_ref = fun_predict_stan_results_ACN(mod_analytes_ACN_sim, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, 10)</span></span>
<span id="cb196-2653"><a href="#cb196-2653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2654"><a href="#cb196-2654" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_ACN_noprior_ref$chosen_indices # ref</span></span>
<span id="cb196-2655"><a href="#cb196-2655" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_ACN_ref = fun_predict_stan_results_ACN(mod_analytes_ACN_sim, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, 10)</span></span>
<span id="cb196-2656"><a href="#cb196-2656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2657"><a href="#cb196-2657" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_ACN_prior_1$chosen_indices # p=1</span></span>
<span id="cb196-2658"><a href="#cb196-2658" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_ACN_1 = fun_predict_stan_results_ACN(mod_analytes_ACN_sim, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, 10)</span></span>
<span id="cb196-2659"><a href="#cb196-2659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2660"><a href="#cb196-2660" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_ACN_prior_2$chosen_indices # p=2</span></span>
<span id="cb196-2661"><a href="#cb196-2661" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_ACN_2 = fun_predict_stan_results_ACN(mod_analytes_ACN_sim, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, 10)</span></span>
<span id="cb196-2662"><a href="#cb196-2662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2663"><a href="#cb196-2663" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_ACN_noprior_2$chosen_indices # p=2</span></span>
<span id="cb196-2664"><a href="#cb196-2664" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_ACN_2 = fun_predict_stan_results_ACN(mod_analytes_ACN_sim, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, 10)</span></span>
<span id="cb196-2665"><a href="#cb196-2665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2666"><a href="#cb196-2666" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_ACN_prior_3$chosen_indices # p=3</span></span>
<span id="cb196-2667"><a href="#cb196-2667" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_ACN_3 = fun_predict_stan_results_ACN(mod_analytes_ACN_sim, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, 10)</span></span>
<span id="cb196-2668"><a href="#cb196-2668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2669"><a href="#cb196-2669" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_ACN_noprior_3$chosen_indices # p=3</span></span>
<span id="cb196-2670"><a href="#cb196-2670" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_ACN_3 = fun_predict_stan_results_ACN(mod_analytes_ACN_sim, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, 10)</span></span>
<span id="cb196-2671"><a href="#cb196-2671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2672"><a href="#cb196-2672" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_ACN_prior_4$chosen_indices # p=4</span></span>
<span id="cb196-2673"><a href="#cb196-2673" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_ACN_4 = fun_predict_stan_results_ACN(mod_analytes_ACN_sim, datastruct_prior_ma_ACN, inits_ACN, chosen_indices, 10)</span></span>
<span id="cb196-2674"><a href="#cb196-2674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2675"><a href="#cb196-2675" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_ACN_noprior_4$chosen_indices # p=4</span></span>
<span id="cb196-2676"><a href="#cb196-2676" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_ACN_4 = fun_predict_stan_results_ACN(mod_analytes_ACN_sim, datastruct_noprior_ma_ACN, inits_ACN, chosen_indices, 10)</span></span>
<span id="cb196-2677"><a href="#cb196-2677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2678"><a href="#cb196-2678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2679"><a href="#cb196-2679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2680"><a href="#cb196-2680" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gradient conditions</span></span>
<span id="cb196-2681"><a href="#cb196-2681" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-gra-ACN-summary}</span></span>
<span id="cb196-2682"><a href="#cb196-2682" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_ACN_prior_3$chosen_indices # p=3</span></span>
<span id="cb196-2683"><a href="#cb196-2683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2684"><a href="#cb196-2684" aria-hidden="true" tabindex="-1"></a><span class="in">p31=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb196-2685"><a href="#cb196-2685" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0, m==0)%&gt;%</span></span>
<span id="cb196-2686"><a href="#cb196-2686" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb196-2687"><a href="#cb196-2687" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(prior_ma_ACN_3$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb196-2688"><a href="#cb196-2688" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb196-2689"><a href="#cb196-2689" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "ACN", "ACN")) %&gt;%</span></span>
<span id="cb196-2690"><a href="#cb196-2690" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb196-2691"><a href="#cb196-2691" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb196-2692"><a href="#cb196-2692" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb196-2693"><a href="#cb196-2693" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb196-2694"><a href="#cb196-2694" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_ACN_noprior_3$chosen_indices # p=5</span></span>
<span id="cb196-2695"><a href="#cb196-2695" aria-hidden="true" tabindex="-1"></a><span class="in">p32=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb196-2696"><a href="#cb196-2696" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0, m==0)%&gt;%</span></span>
<span id="cb196-2697"><a href="#cb196-2697" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb196-2698"><a href="#cb196-2698" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(noprior_ma_ACN_3$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb196-2699"><a href="#cb196-2699" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb196-2700"><a href="#cb196-2700" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "ACN", "ACN")) %&gt;%</span></span>
<span id="cb196-2701"><a href="#cb196-2701" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb196-2702"><a href="#cb196-2702" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb196-2703"><a href="#cb196-2703" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb196-2704"><a href="#cb196-2704" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb196-2705"><a href="#cb196-2705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2706"><a href="#cb196-2706" aria-hidden="true" tabindex="-1"></a><span class="in">iresults = rbind( prior_ma_ACN_ref$iresults%&gt;%</span></span>
<span id="cb196-2707"><a href="#cb196-2707" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb196-2708"><a href="#cb196-2708" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ACN_ref$iresults%&gt;%</span></span>
<span id="cb196-2709"><a href="#cb196-2709" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb196-2710"><a href="#cb196-2710" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_ACN_1$iresults%&gt;%</span></span>
<span id="cb196-2711"><a href="#cb196-2711" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_1"),</span></span>
<span id="cb196-2712"><a href="#cb196-2712" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_ACN_2$iresults%&gt;%</span></span>
<span id="cb196-2713"><a href="#cb196-2713" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb196-2714"><a href="#cb196-2714" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ACN_2$iresults%&gt;%</span></span>
<span id="cb196-2715"><a href="#cb196-2715" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_2"),</span></span>
<span id="cb196-2716"><a href="#cb196-2716" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_ACN_3$iresults%&gt;%</span></span>
<span id="cb196-2717"><a href="#cb196-2717" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb196-2718"><a href="#cb196-2718" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ACN_3$iresults%&gt;%</span></span>
<span id="cb196-2719"><a href="#cb196-2719" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb196-2720"><a href="#cb196-2720" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_ACN_4$iresults%&gt;%</span></span>
<span id="cb196-2721"><a href="#cb196-2721" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb196-2722"><a href="#cb196-2722" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ACN_4$iresults%&gt;%</span></span>
<span id="cb196-2723"><a href="#cb196-2723" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4")) %&gt;%</span></span>
<span id="cb196-2724"><a href="#cb196-2724" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(ivar = if_else(ivar&gt;1e6,1e6,ivar))%&gt;%</span></span>
<span id="cb196-2725"><a href="#cb196-2725" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.factor(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB))</span></span>
<span id="cb196-2726"><a href="#cb196-2726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2727"><a href="#cb196-2727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2728"><a href="#cb196-2728" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=iresults %&gt;%</span></span>
<span id="cb196-2729"><a href="#cb196-2729" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb196-2730"><a href="#cb196-2730" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-2731"><a href="#cb196-2731" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-2732"><a href="#cb196-2732" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-2733"><a href="#cb196-2733" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb196-2734"><a href="#cb196-2734" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb196-2735"><a href="#cb196-2735" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(0.1,100))+</span></span>
<span id="cb196-2736"><a href="#cb196-2736" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-2737"><a href="#cb196-2737" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb196-2738"><a href="#cb196-2738" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-2739"><a href="#cb196-2739" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=iresults %&gt;%</span></span>
<span id="cb196-2740"><a href="#cb196-2740" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb196-2741"><a href="#cb196-2741" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-2742"><a href="#cb196-2742" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-2743"><a href="#cb196-2743" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-2744"><a href="#cb196-2744" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb196-2745"><a href="#cb196-2745" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb196-2746"><a href="#cb196-2746" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,1000000))+</span></span>
<span id="cb196-2747"><a href="#cb196-2747" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-2748"><a href="#cb196-2748" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb196-2749"><a href="#cb196-2749" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-2750"><a href="#cb196-2750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2751"><a href="#cb196-2751" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb196-2752"><a href="#cb196-2752" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb196-2753"><a href="#cb196-2753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2754"><a href="#cb196-2754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2755"><a href="#cb196-2755" aria-hidden="true" tabindex="-1"></a><span class="in">idx_exemple_analytes = iresults %&gt;%</span></span>
<span id="cb196-2756"><a href="#cb196-2756" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(method=="prior_ref") %&gt;%</span></span>
<span id="cb196-2757"><a href="#cb196-2757" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(ivar)%&gt;%</span></span>
<span id="cb196-2758"><a href="#cb196-2758" aria-hidden="true" tabindex="-1"></a><span class="in">  slice(which(row_number() %% 100 == 1)) %&gt;%</span></span>
<span id="cb196-2759"><a href="#cb196-2759" aria-hidden="true" tabindex="-1"></a><span class="in">  select(i)%&gt;%pull()</span></span>
<span id="cb196-2760"><a href="#cb196-2760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2761"><a href="#cb196-2761" aria-hidden="true" tabindex="-1"></a><span class="in">iresults %&gt;%</span></span>
<span id="cb196-2762"><a href="#cb196-2762" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb196-2763"><a href="#cb196-2763" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb196-2764"><a href="#cb196-2764" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb196-2765"><a href="#cb196-2765" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb196-2766"><a href="#cb196-2766" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb196-2767"><a href="#cb196-2767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2768"><a href="#cb196-2768" aria-hidden="true" tabindex="-1"></a><span class="in">f55_4=iresults %&gt;%</span></span>
<span id="cb196-2769"><a href="#cb196-2769" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb196-2770"><a href="#cb196-2770" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb196-2771"><a href="#cb196-2771" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb196-2772"><a href="#cb196-2772" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb196-2773"><a href="#cb196-2773" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(`&lt;=1x`:`&lt;=3x`, names_to = "target") %&gt;%</span></span>
<span id="cb196-2774"><a href="#cb196-2774" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=value,color=as.factor(target)))+</span></span>
<span id="cb196-2775"><a href="#cb196-2775" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point()+</span></span>
<span id="cb196-2776"><a href="#cb196-2776" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Probability", y = "Method", color = "target")+</span></span>
<span id="cb196-2777"><a href="#cb196-2777" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 0.9, linetype="dotted")</span></span>
<span id="cb196-2778"><a href="#cb196-2778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2779"><a href="#cb196-2779" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=f55_4, .filename=paste("single-form-analytes-ACN-gra-prob.pdf"), .path = figures_dir1)</span></span>
<span id="cb196-2780"><a href="#cb196-2780" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=f55_4, .filename=paste("single-form-analytes-ACN-gra-prob.png"), .path = figures_dir1)</span></span>
<span id="cb196-2781"><a href="#cb196-2781" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p31, .filename=paste("single-form-analytes-ACN-gra-prior-p5.pdf"), .path = figures_dir4)</span></span>
<span id="cb196-2782"><a href="#cb196-2782" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p31, .filename=paste("single-form-analytes-ACN-gra-prior-p5.png"), .path = figures_dir4)</span></span>
<span id="cb196-2783"><a href="#cb196-2783" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p32, .filename=paste("single-form-analytes-gra-ACN-noprior-p5.pdf"), .path = figures_dir4)</span></span>
<span id="cb196-2784"><a href="#cb196-2784" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p32, .filename=paste("single-form-analytes-ACN-gra-noprior-p5.png"), .path = figures_dir4)</span></span>
<span id="cb196-2785"><a href="#cb196-2785" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-gra-ACN-maxvar.pdf"), .path = figures_dir4)</span></span>
<span id="cb196-2786"><a href="#cb196-2786" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-ACN-gra-maxvar.png"), .path = figures_dir4)</span></span>
<span id="cb196-2787"><a href="#cb196-2787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2788"><a href="#cb196-2788" aria-hidden="true" tabindex="-1"></a><span class="in">p31</span></span>
<span id="cb196-2789"><a href="#cb196-2789" aria-hidden="true" tabindex="-1"></a><span class="in">p32</span></span>
<span id="cb196-2790"><a href="#cb196-2790" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb196-2791"><a href="#cb196-2791" aria-hidden="true" tabindex="-1"></a><span class="in">f33_4=p33</span></span>
<span id="cb196-2792"><a href="#cb196-2792" aria-hidden="true" tabindex="-1"></a><span class="in">f55_4</span></span>
<span id="cb196-2793"><a href="#cb196-2793" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2794"><a href="#cb196-2794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2795"><a href="#cb196-2795" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Isocratic conditions</span></span>
<span id="cb196-2796"><a href="#cb196-2796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-ACN-izo-summary}</span></span>
<span id="cb196-2797"><a href="#cb196-2797" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb196-2798"><a href="#cb196-2798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2799"><a href="#cb196-2799" aria-hidden="true" tabindex="-1"></a><span class="in">plot_id = function(results) {</span></span>
<span id="cb196-2800"><a href="#cb196-2800" aria-hidden="true" tabindex="-1"></a><span class="in">  results %&gt;%</span></span>
<span id="cb196-2801"><a href="#cb196-2801" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=fi, y=CV/10)) +</span></span>
<span id="cb196-2802"><a href="#cb196-2802" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb196-2803"><a href="#cb196-2803" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(aes(x=fi, ymin = llog10tr, ymax = ulog10tr), alpha = 0.4, col = NA) +</span></span>
<span id="cb196-2804"><a href="#cb196-2804" aria-hidden="true" tabindex="-1"></a><span class="in">     geom_line(aes(x=fi, y=mlog10tr), col = "black", size=0.25) +</span></span>
<span id="cb196-2805"><a href="#cb196-2805" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_y_continuous(</span></span>
<span id="cb196-2806"><a href="#cb196-2806" aria-hidden="true" tabindex="-1"></a><span class="in">    name = "log(tr)",</span></span>
<span id="cb196-2807"><a href="#cb196-2807" aria-hidden="true" tabindex="-1"></a><span class="in">    sec.axis = sec_axis(~.*10, name="%CV")) +</span></span>
<span id="cb196-2808"><a href="#cb196-2808" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0,1,by=0.2))+</span></span>
<span id="cb196-2809"><a href="#cb196-2809" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_grid(i~mod) +</span></span>
<span id="cb196-2810"><a href="#cb196-2810" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 1, linetype=2)+</span></span>
<span id="cb196-2811"><a href="#cb196-2811" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim=c(0,4))</span></span>
<span id="cb196-2812"><a href="#cb196-2812" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb196-2813"><a href="#cb196-2813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2814"><a href="#cb196-2814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2815"><a href="#cb196-2815" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_ACN_ref&lt;-prior_ma_ACN_ref$izoresults%&gt;%</span></span>
<span id="cb196-2816"><a href="#cb196-2816" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2817"><a href="#cb196-2817" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2818"><a href="#cb196-2818" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2819"><a href="#cb196-2819" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2820"><a href="#cb196-2820" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2821"><a href="#cb196-2821" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2822"><a href="#cb196-2822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2823"><a href="#cb196-2823" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_ACN_ref&lt;-noprior_ma_ACN_ref$izoresults%&gt;%</span></span>
<span id="cb196-2824"><a href="#cb196-2824" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2825"><a href="#cb196-2825" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2826"><a href="#cb196-2826" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2827"><a href="#cb196-2827" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2828"><a href="#cb196-2828" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2829"><a href="#cb196-2829" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2830"><a href="#cb196-2830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2831"><a href="#cb196-2831" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_ACN_1&lt;-prior_ma_ACN_1$izoresults%&gt;%</span></span>
<span id="cb196-2832"><a href="#cb196-2832" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2833"><a href="#cb196-2833" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2834"><a href="#cb196-2834" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2835"><a href="#cb196-2835" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2836"><a href="#cb196-2836" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2837"><a href="#cb196-2837" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2838"><a href="#cb196-2838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2839"><a href="#cb196-2839" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_ACN_2&lt;-prior_ma_ACN_2$izoresults%&gt;%</span></span>
<span id="cb196-2840"><a href="#cb196-2840" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2841"><a href="#cb196-2841" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2842"><a href="#cb196-2842" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2843"><a href="#cb196-2843" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2844"><a href="#cb196-2844" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = mrgmisc::ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2845"><a href="#cb196-2845" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2846"><a href="#cb196-2846" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_ACN_2&lt;-noprior_ma_ACN_2$izoresults%&gt;%</span></span>
<span id="cb196-2847"><a href="#cb196-2847" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2848"><a href="#cb196-2848" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2849"><a href="#cb196-2849" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2850"><a href="#cb196-2850" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2851"><a href="#cb196-2851" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2852"><a href="#cb196-2852" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2853"><a href="#cb196-2853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2854"><a href="#cb196-2854" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_ACN_3&lt;-prior_ma_ACN_3$izoresults%&gt;%</span></span>
<span id="cb196-2855"><a href="#cb196-2855" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2856"><a href="#cb196-2856" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2857"><a href="#cb196-2857" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2858"><a href="#cb196-2858" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2859"><a href="#cb196-2859" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2860"><a href="#cb196-2860" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2861"><a href="#cb196-2861" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_ACN_3&lt;-noprior_ma_ACN_3$izoresults%&gt;%</span></span>
<span id="cb196-2862"><a href="#cb196-2862" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2863"><a href="#cb196-2863" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2864"><a href="#cb196-2864" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2865"><a href="#cb196-2865" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2866"><a href="#cb196-2866" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2867"><a href="#cb196-2867" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2868"><a href="#cb196-2868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2869"><a href="#cb196-2869" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_ACN_4&lt;-prior_ma_ACN_4$izoresults%&gt;%</span></span>
<span id="cb196-2870"><a href="#cb196-2870" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2871"><a href="#cb196-2871" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2872"><a href="#cb196-2872" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2873"><a href="#cb196-2873" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2874"><a href="#cb196-2874" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2875"><a href="#cb196-2875" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2876"><a href="#cb196-2876" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_ACN_4&lt;-noprior_ma_ACN_4$izoresults%&gt;%</span></span>
<span id="cb196-2877"><a href="#cb196-2877" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb196-2878"><a href="#cb196-2878" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2879"><a href="#cb196-2879" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb196-2880"><a href="#cb196-2880" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb196-2881"><a href="#cb196-2881" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;%</span></span>
<span id="cb196-2882"><a href="#cb196-2882" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb196-2883"><a href="#cb196-2883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2884"><a href="#cb196-2884" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ACN_ref = map(results_prior_ma_ACN_ref,plot_id)</span></span>
<span id="cb196-2885"><a href="#cb196-2885" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ACN_ref = map(results_noprior_ma_ACN_ref,plot_id)</span></span>
<span id="cb196-2886"><a href="#cb196-2886" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ACN_1 = map(results_prior_ma_ACN_1,plot_id)</span></span>
<span id="cb196-2887"><a href="#cb196-2887" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ACN_2 = map(results_prior_ma_ACN_2,plot_id)</span></span>
<span id="cb196-2888"><a href="#cb196-2888" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ACN_2 = map(results_noprior_ma_ACN_2,plot_id)</span></span>
<span id="cb196-2889"><a href="#cb196-2889" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ACN_3 = map(results_prior_ma_ACN_3,plot_id)</span></span>
<span id="cb196-2890"><a href="#cb196-2890" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ACN_3 = map(results_noprior_ma_ACN_3,plot_id)</span></span>
<span id="cb196-2891"><a href="#cb196-2891" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ACN_4 = map(results_prior_ma_ACN_4,plot_id)</span></span>
<span id="cb196-2892"><a href="#cb196-2892" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ACN_4 = map(results_noprior_ma_ACN_4,plot_id)</span></span>
<span id="cb196-2893"><a href="#cb196-2893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2894"><a href="#cb196-2894" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_ACN_ref[[1]], .filename=paste("plots-results-prior-ma-ACN-ref.pdf"), .path = figures_dir4)</span></span>
<span id="cb196-2895"><a href="#cb196-2895" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_ACN_ref[[1]], .filename=paste("plots-results-prior-ma-ACN-ref.png"), .path = figures_dir4)</span></span>
<span id="cb196-2896"><a href="#cb196-2896" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_ACN_3[[1]], .filename=paste("plots-results-prior-ma-ACN-3.pdf"), .path = figures_dir4)</span></span>
<span id="cb196-2897"><a href="#cb196-2897" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_ACN_3[[1]], .filename=paste("plots-results-prior-ma-ACN-3.png"), .path = figures_dir4)</span></span>
<span id="cb196-2898"><a href="#cb196-2898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2899"><a href="#cb196-2899" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ACN_ref</span></span>
<span id="cb196-2900"><a href="#cb196-2900" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ACN_ref</span></span>
<span id="cb196-2901"><a href="#cb196-2901" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ACN_1</span></span>
<span id="cb196-2902"><a href="#cb196-2902" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ACN_2</span></span>
<span id="cb196-2903"><a href="#cb196-2903" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ACN_2</span></span>
<span id="cb196-2904"><a href="#cb196-2904" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ACN_3</span></span>
<span id="cb196-2905"><a href="#cb196-2905" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ACN_3</span></span>
<span id="cb196-2906"><a href="#cb196-2906" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ACN_4</span></span>
<span id="cb196-2907"><a href="#cb196-2907" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ACN_4</span></span>
<span id="cb196-2908"><a href="#cb196-2908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2909"><a href="#cb196-2909" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb196-2910"><a href="#cb196-2910" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb196-2911"><a href="#cb196-2911" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb196-2912"><a href="#cb196-2912" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb196-2913"><a href="#cb196-2913" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb196-2914"><a href="#cb196-2914" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span>
<span id="cb196-2915"><a href="#cb196-2915" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2916"><a href="#cb196-2916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2917"><a href="#cb196-2917" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Combined</span></span>
<span id="cb196-2918"><a href="#cb196-2918" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-izo-summary-ACN-combined}</span></span>
<span id="cb196-2919"><a href="#cb196-2919" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb196-2920"><a href="#cb196-2920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2921"><a href="#cb196-2921" aria-hidden="true" tabindex="-1"></a><span class="in">izoresults = rbind(prior_ma_ACN_ref$izoresults%&gt;%</span></span>
<span id="cb196-2922"><a href="#cb196-2922" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb196-2923"><a href="#cb196-2923" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ACN_ref$izoresults%&gt;%</span></span>
<span id="cb196-2924"><a href="#cb196-2924" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb196-2925"><a href="#cb196-2925" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_ACN_1$izoresults%&gt;%</span></span>
<span id="cb196-2926"><a href="#cb196-2926" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_1"),</span></span>
<span id="cb196-2927"><a href="#cb196-2927" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_ACN_2$izoresults%&gt;%</span></span>
<span id="cb196-2928"><a href="#cb196-2928" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb196-2929"><a href="#cb196-2929" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ACN_2$izoresults%&gt;%</span></span>
<span id="cb196-2930"><a href="#cb196-2930" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_2"),</span></span>
<span id="cb196-2931"><a href="#cb196-2931" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_ACN_3$izoresults%&gt;%</span></span>
<span id="cb196-2932"><a href="#cb196-2932" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb196-2933"><a href="#cb196-2933" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ACN_3$izoresults%&gt;%</span></span>
<span id="cb196-2934"><a href="#cb196-2934" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb196-2935"><a href="#cb196-2935" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_ACN_4$izoresults%&gt;%</span></span>
<span id="cb196-2936"><a href="#cb196-2936" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb196-2937"><a href="#cb196-2937" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ACN_4$izoresults%&gt;%</span></span>
<span id="cb196-2938"><a href="#cb196-2938" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4")) %&gt;%</span></span>
<span id="cb196-2939"><a href="#cb196-2939" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&lt;=log10(100))%&gt;%</span></span>
<span id="cb196-2940"><a href="#cb196-2940" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&gt;=log10(5))%&gt;%</span></span>
<span id="cb196-2941"><a href="#cb196-2941" aria-hidden="true" tabindex="-1"></a><span class="in">mutate(c = as.numeric(c),</span></span>
<span id="cb196-2942"><a href="#cb196-2942" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb196-2943"><a href="#cb196-2943" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(i,method,c)%&gt;%</span></span>
<span id="cb196-2944"><a href="#cb196-2944" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(i,method) %&gt;%</span></span>
<span id="cb196-2945"><a href="#cb196-2945" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(imaxcv = max(CV), imincv = min(CV), aveCV = pracma::trapz(c, CV)/(n()-1)) %&gt;%</span></span>
<span id="cb196-2946"><a href="#cb196-2946" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(imaxcv = if_else(imaxcv&gt;1e4,1e4,imaxcv))%&gt;%</span></span>
<span id="cb196-2947"><a href="#cb196-2947" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.integer(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB)) </span></span>
<span id="cb196-2948"><a href="#cb196-2948" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb196-2949"><a href="#cb196-2949" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=izoresults %&gt;%</span></span>
<span id="cb196-2950"><a href="#cb196-2950" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb196-2951"><a href="#cb196-2951" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-2952"><a href="#cb196-2952" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-2953"><a href="#cb196-2953" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb196-2954"><a href="#cb196-2954" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-2955"><a href="#cb196-2955" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb196-2956"><a href="#cb196-2956" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb196-2957"><a href="#cb196-2957" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(1,100))+   </span></span>
<span id="cb196-2958"><a href="#cb196-2958" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-2959"><a href="#cb196-2959" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb196-2960"><a href="#cb196-2960" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-2961"><a href="#cb196-2961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2962"><a href="#cb196-2962" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=izoresults %&gt;%</span></span>
<span id="cb196-2963"><a href="#cb196-2963" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb196-2964"><a href="#cb196-2964" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb196-2965"><a href="#cb196-2965" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb196-2966"><a href="#cb196-2966" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb196-2967"><a href="#cb196-2967" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb196-2968"><a href="#cb196-2968" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb196-2969"><a href="#cb196-2969" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb196-2970"><a href="#cb196-2970" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,10000))+    </span></span>
<span id="cb196-2971"><a href="#cb196-2971" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb196-2972"><a href="#cb196-2972" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb196-2973"><a href="#cb196-2973" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb196-2974"><a href="#cb196-2974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2975"><a href="#cb196-2975" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb196-2976"><a href="#cb196-2976" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb196-2977"><a href="#cb196-2977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2978"><a href="#cb196-2978" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-ACN-izo-combined-CV.pdf"), .path = figures_dir4)</span></span>
<span id="cb196-2979"><a href="#cb196-2979" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-ACN-izo-combined-CV.png"), .path = figures_dir4)</span></span>
<span id="cb196-2980"><a href="#cb196-2980" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb196-2981"><a href="#cb196-2981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2982"><a href="#cb196-2982" aria-hidden="true" tabindex="-1"></a><span class="in">f44_4 = p33</span></span>
<span id="cb196-2983"><a href="#cb196-2983" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-2984"><a href="#cb196-2984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2985"><a href="#cb196-2985" aria-hidden="true" tabindex="-1"></a><span class="fu"># Manuscript plots</span></span>
<span id="cb196-2986"><a href="#cb196-2986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2987"><a href="#cb196-2987" aria-hidden="true" tabindex="-1"></a><span class="in">```{r composite-plots}</span></span>
<span id="cb196-2988"><a href="#cb196-2988" aria-hidden="true" tabindex="-1"></a><span class="in">figure1 &lt;- ((f2_3|f2_4)/(f2_1|f2_2))+</span></span>
<span id="cb196-2989"><a href="#cb196-2989" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(guides = "collect")+</span></span>
<span id="cb196-2990"><a href="#cb196-2990" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_annotation(tag_levels = 'A') &amp;</span></span>
<span id="cb196-2991"><a href="#cb196-2991" aria-hidden="true" tabindex="-1"></a><span class="in">                  theme(legend.position = 'bottom',plot.title = element_text(size = 8),</span></span>
<span id="cb196-2992"><a href="#cb196-2992" aria-hidden="true" tabindex="-1"></a><span class="in">                                axis.title = element_text(size = 8),</span></span>
<span id="cb196-2993"><a href="#cb196-2993" aria-hidden="true" tabindex="-1"></a><span class="in">                                axis.text  = element_text(size = 6))</span></span>
<span id="cb196-2994"><a href="#cb196-2994" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=figure1, .filename=paste("eficiency_relative.pdf"), .path = figures_dir5)</span></span>
<span id="cb196-2995"><a href="#cb196-2995" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=figure1, .filename=paste("eficiency_relative.png"), .path = figures_dir5)</span></span>
<span id="cb196-2996"><a href="#cb196-2996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-2997"><a href="#cb196-2997" aria-hidden="true" tabindex="-1"></a><span class="in">figure2 &lt;- ((f3_3|f3_4)/(f3_1|f3_2))+</span></span>
<span id="cb196-2998"><a href="#cb196-2998" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(guides = "collect")+</span></span>
<span id="cb196-2999"><a href="#cb196-2999" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_annotation(tag_levels = 'A') &amp;</span></span>
<span id="cb196-3000"><a href="#cb196-3000" aria-hidden="true" tabindex="-1"></a><span class="in">                  theme(legend.position = 'bottom',plot.title = element_text(size = 8),</span></span>
<span id="cb196-3001"><a href="#cb196-3001" aria-hidden="true" tabindex="-1"></a><span class="in">                                axis.title = element_text(size = 8),</span></span>
<span id="cb196-3002"><a href="#cb196-3002" aria-hidden="true" tabindex="-1"></a><span class="in">                                axis.text  = element_text(size = 6))</span></span>
<span id="cb196-3003"><a href="#cb196-3003" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=figure2, .filename=paste("eficiency_prior.pdf"), .path = figures_dir5)</span></span>
<span id="cb196-3004"><a href="#cb196-3004" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=figure2, .filename=paste("eficiency_prior.png"), .path = figures_dir5)</span></span>
<span id="cb196-3005"><a href="#cb196-3005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3006"><a href="#cb196-3006" aria-hidden="true" tabindex="-1"></a><span class="in">figure3 &lt;- ((f33_3|f33_4)/(f33_1|f33_2))+</span></span>
<span id="cb196-3007"><a href="#cb196-3007" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(guides = "collect")+</span></span>
<span id="cb196-3008"><a href="#cb196-3008" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_annotation(tag_levels = list(c("A"," ","B"," ","C"," ","D", ""))) &amp;</span></span>
<span id="cb196-3009"><a href="#cb196-3009" aria-hidden="true" tabindex="-1"></a><span class="in">                  theme(legend.position = 'bottom',plot.title = element_text(size = 8),</span></span>
<span id="cb196-3010"><a href="#cb196-3010" aria-hidden="true" tabindex="-1"></a><span class="in">                                axis.title = element_text(size = 8),</span></span>
<span id="cb196-3011"><a href="#cb196-3011" aria-hidden="true" tabindex="-1"></a><span class="in">                                axis.text  = element_text(size = 6))</span></span>
<span id="cb196-3012"><a href="#cb196-3012" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=figure3, .filename=paste("max_standardized_variance.pdf"), .path = figures_dir5)</span></span>
<span id="cb196-3013"><a href="#cb196-3013" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=figure3, .filename=paste("max_standardized_variance.png"), .path = figures_dir5)</span></span>
<span id="cb196-3014"><a href="#cb196-3014" aria-hidden="true" tabindex="-1"></a><span class="in">figure4 &lt;- ((f44_3|f44_4)/(f44_1|f44_2))+</span></span>
<span id="cb196-3015"><a href="#cb196-3015" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(guides = "collect")+</span></span>
<span id="cb196-3016"><a href="#cb196-3016" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_annotation(tag_levels = list(c("A"," ","B"," ","C"," ","D", ""))) &amp;</span></span>
<span id="cb196-3017"><a href="#cb196-3017" aria-hidden="true" tabindex="-1"></a><span class="in">                  theme(legend.position = 'bottom',plot.title = element_text(size = 8),</span></span>
<span id="cb196-3018"><a href="#cb196-3018" aria-hidden="true" tabindex="-1"></a><span class="in">                                axis.title = element_text(size = 8),</span></span>
<span id="cb196-3019"><a href="#cb196-3019" aria-hidden="true" tabindex="-1"></a><span class="in">                                axis.text  = element_text(size = 6))</span></span>
<span id="cb196-3020"><a href="#cb196-3020" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=figure4, .filename=paste("cv_izo.pdf"), .path = figures_dir5)</span></span>
<span id="cb196-3021"><a href="#cb196-3021" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=figure4, .filename=paste("cv_izo.pdf.png"), .path = figures_dir5)</span></span>
<span id="cb196-3022"><a href="#cb196-3022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3023"><a href="#cb196-3023" aria-hidden="true" tabindex="-1"></a><span class="in">figure5 &lt;- ((f55_3|f55_4)/(f55_1|f55_2))+</span></span>
<span id="cb196-3024"><a href="#cb196-3024" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(guides = "collect")+</span></span>
<span id="cb196-3025"><a href="#cb196-3025" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_annotation(tag_levels = 'A') &amp;</span></span>
<span id="cb196-3026"><a href="#cb196-3026" aria-hidden="true" tabindex="-1"></a><span class="in">                  theme(legend.position = 'bottom',plot.title = element_text(size = 8),</span></span>
<span id="cb196-3027"><a href="#cb196-3027" aria-hidden="true" tabindex="-1"></a><span class="in">                                axis.title = element_text(size = 8),</span></span>
<span id="cb196-3028"><a href="#cb196-3028" aria-hidden="true" tabindex="-1"></a><span class="in">                                axis.text  = element_text(size = 6))</span></span>
<span id="cb196-3029"><a href="#cb196-3029" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=figure5, .filename=paste("max_standardized_variance_probability.pdf"), .path = figures_dir5)</span></span>
<span id="cb196-3030"><a href="#cb196-3030" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=figure5, .filename=paste("max_standardized_variance_probability.png"), .path = figures_dir5)</span></span>
<span id="cb196-3031"><a href="#cb196-3031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3032"><a href="#cb196-3032" aria-hidden="true" tabindex="-1"></a><span class="in">figure1</span></span>
<span id="cb196-3033"><a href="#cb196-3033" aria-hidden="true" tabindex="-1"></a><span class="in">figure2</span></span>
<span id="cb196-3034"><a href="#cb196-3034" aria-hidden="true" tabindex="-1"></a><span class="in">figure3</span></span>
<span id="cb196-3035"><a href="#cb196-3035" aria-hidden="true" tabindex="-1"></a><span class="in">figure4</span></span>
<span id="cb196-3036"><a href="#cb196-3036" aria-hidden="true" tabindex="-1"></a><span class="in">figure5</span></span>
<span id="cb196-3037"><a href="#cb196-3037" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-3038"><a href="#cb196-3038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3039"><a href="#cb196-3039" aria-hidden="true" tabindex="-1"></a><span class="in">```{r save-temp, eval=F}</span></span>
<span id="cb196-3040"><a href="#cb196-3040" aria-hidden="true" tabindex="-1"></a><span class="in">save.image("results-mixtures-d2-temp.RData")</span></span>
<span id="cb196-3041"><a href="#cb196-3041" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb196-3042"><a href="#cb196-3042" aria-hidden="true" tabindex="-1"></a><span class="fu"># References {.unnumbered}</span></span>
<span id="cb196-3043"><a href="#cb196-3043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3044"><a href="#cb196-3044" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb196-3045"><a href="#cb196-3045" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb196-3046"><a href="#cb196-3046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3047"><a href="#cb196-3047" aria-hidden="true" tabindex="-1"></a><span class="fu"># Licenses {.unnumbered}</span></span>
<span id="cb196-3048"><a href="#cb196-3048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3049"><a href="#cb196-3049" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Code &amp; copy; 2024, Paweł Wiczling, licensed under BSD-3.</span>
<span id="cb196-3050"><a href="#cb196-3050" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Text &amp; copy; 2024, Paweł Wiczling, licensed under CC-BY-NC 4.0.</span>
<span id="cb196-3051"><a href="#cb196-3051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3052"><a href="#cb196-3052" aria-hidden="true" tabindex="-1"></a><span class="fu"># Original Computing Environment {.unnumbered}</span></span>
<span id="cb196-3053"><a href="#cb196-3053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3054"><a href="#cb196-3054" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sessionInfo}</span></span>
<span id="cb196-3055"><a href="#cb196-3055" aria-hidden="true" tabindex="-1"></a><span class="in">sessionInfo()</span></span>
<span id="cb196-3056"><a href="#cb196-3056" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>
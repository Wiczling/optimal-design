<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Paweł Wiczling*">
<meta name="dcterms.date" content="2024-12-26">

<title>Design2: Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="optimal-design-for-mixtures-design2_files/libs/clipboard/clipboard.min.js"></script>
<script src="optimal-design-for-mixtures-design2_files/libs/quarto-html/quarto.js"></script>
<script src="optimal-design-for-mixtures-design2_files/libs/quarto-html/popper.min.js"></script>
<script src="optimal-design-for-mixtures-design2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="optimal-design-for-mixtures-design2_files/libs/quarto-html/anchor.min.js"></script>
<link href="optimal-design-for-mixtures-design2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="optimal-design-for-mixtures-design2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="optimal-design-for-mixtures-design2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="optimal-design-for-mixtures-design2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="optimal-design-for-mixtures-design2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="optimal-design-for-mixtures-design2_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="optimal-design-for-mixtures-design2_files/libs/tabwid-1.1.3/tabwid.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#priors" id="toc-priors" class="nav-link" data-scroll-target="#priors">Priors</a></li>
  <li><a href="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" id="toc-stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" class="nav-link" data-scroll-target="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables">Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</a>
  <ul class="collapse">
  <li><a href="#compile-stan-models" id="toc-compile-stan-models" class="nav-link" data-scroll-target="#compile-stan-models">Compile stan models</a></li>
  <li><a href="#simulate-retention-times-and-create-datasets" id="toc-simulate-retention-times-and-create-datasets" class="nav-link" data-scroll-target="#simulate-retention-times-and-create-datasets">Simulate retention times and create datasets</a></li>
  <li><a href="#optimization" id="toc-optimization" class="nav-link" data-scroll-target="#optimization">Optimization</a>
  <ul class="collapse">
  <li><a href="#read-the-results-and-compare" id="toc-read-the-results-and-compare" class="nav-link" data-scroll-target="#read-the-results-and-compare">Read the results and compare</a></li>
  <li><a href="#table" id="toc-table" class="nav-link" data-scroll-target="#table">Table</a></li>
  </ul></li>
  <li><a href="#stan-simulations" id="toc-stan-simulations" class="nav-link" data-scroll-target="#stan-simulations">Stan simulations</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#licenses" id="toc-licenses" class="nav-link" data-scroll-target="#licenses">Licenses</a></li>
  <li><a href="#original-computing-environment" id="toc-original-computing-environment" class="nav-link" data-scroll-target="#original-computing-environment">Original Computing Environment</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Design2: Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Paweł Wiczling* </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Department of Biopharmaceutics and Pharmacodynamics, Medical University of Gdańsk, Gen.&nbsp;J. Hallera 107, 80-416 Gdańsk, Poland
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 26, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setup" class="level1">
<h1>Setup</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(numDeriv)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mrgmisc)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>select <span class="ot">=</span> dplyr<span class="sc">::</span>select</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("metrumresearchgroup/mrgmisc")</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># for parallel calculation use linux (mclaplly), i.e. Ubuntu 24.04 on Windows WSL</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># usethis::edit_r_environ(), add PROCESSX_NOTIFY_OLD_SIGCHLD = 1 ????</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#' Helper functions</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"helper_functions.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' folder shortcuts:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>figures_dir1 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"figures"</span>, <span class="st">"design2"</span>,<span class="st">"N"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>tables_dir1  <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"tables"</span>, <span class="st">"design2"</span>,<span class="st">"N"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(figures_dir1)) <span class="fu">dir.create</span>(figures_dir1, <span class="at">recursive =</span> T)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(tables_dir1)) <span class="fu">dir.create</span>(tables_dir1, <span class="at">recursive =</span> T)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>thisScript <span class="ot">&lt;-</span> <span class="st">"optimal-design-for-mixtures-design2"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>my.ggsave <span class="ot">&lt;-</span> <span class="cf">function</span>(.plot, .filename, <span class="at">.path=</span>figures_dir, <span class="at">.height=</span> <span class="dv">7</span>, <span class="at">.width=</span> <span class="dv">6</span>) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot=</span>.plot, <span class="at">filename=</span>.filename, <span class="at">path=</span>.path, <span class="at">height=</span>.height, <span class="at">width=</span>.width)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>my.ggsave.png <span class="ot">&lt;-</span> <span class="cf">function</span>(.plot, .filename, <span class="at">.path=</span>figures_dir, <span class="at">.height=</span><span class="dv">7</span>, <span class="at">.width=</span> <span class="dv">6</span>) {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot=</span>.plot, <span class="at">filename=</span>.filename, <span class="at">path=</span>.path, <span class="at">height=</span>.height, <span class="at">width=</span>.width)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
</section>
<section id="priors" class="level1">
<h1>Priors</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fun_generate_priors defined in helper_functions.R</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>priorsN_MeOH<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N_MeOH"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>priorsN_ACN<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N_ACN"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>priorsN<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>priorsA<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"A"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>priorsB<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"B"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>priorsNB<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"NB"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>priorsNA<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"NA"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>hplcparam_candidates_df <span class="ot">=</span> <span class="fu">expand_grid</span>(<span class="at">tg=</span><span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">270</span>,<span class="at">by=</span><span class="dv">10</span>), </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">td=</span><span class="fl">2.1</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">to=</span><span class="fl">0.532</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">te=</span><span class="fl">0.04</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fio =</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="at">by=</span><span class="fl">0.05</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fif =</span> <span class="fl">0.8</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">m=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">xpH=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>hplcparam_candidates_df<span class="ot">&lt;-</span>hplcparam_candidates_df<span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tg=</span>tg<span class="sc">/</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" class="level1">
<h1>Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</h1>
<section id="compile-stan-models" class="level2">
<h2 class="anchored" data-anchor-id="compile-stan-models">Compile stan models</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mod_analytes_gq<span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-gq.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mod_analytes_sim <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-sim.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>mod_analytes <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>mod_analytes<span class="sc">$</span><span class="fu">compile</span>(<span class="at">compile_model_methods=</span><span class="cn">TRUE</span>,<span class="at">force_recompile=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulate-retention-times-and-create-datasets" class="level2">
<h2 class="anchored" data-anchor-id="simulate-retention-times-and-create-datasets">Simulate retention times and create datasets</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_ma<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>nObs <span class="ot">=</span> <span class="fu">nrow</span>(data_ma);</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>nAnalytes <span class="ot">=</span><span class="dv">50</span>;</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> <span class="dv">1234</span>;</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>n_param <span class="ot">=</span> <span class="dv">3</span>;</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>n_rep <span class="ot">=</span> <span class="dv">10</span>;</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_rep) {</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]] <span class="ot">=</span> <span class="fu">list</span>(<span class="at">nObs=</span>nObs,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nAnalytes=</span>nAnalytes,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">steps =</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>data_ma<span class="sc">$</span>m,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">hplcparam=</span><span class="fu">as.matrix</span>(data_ma<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(tg,td,to,te,fio,fif,m))),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">include_prior =</span> <span class="dv">1</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">run_estimation=</span><span class="dv">1</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nSel =</span> nObs,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="dv">1</span><span class="sc">:</span>nObs)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>fit_gq  <span class="ot">=</span> mod_analytes_gq<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> datastruct_prior_ma[[i]],</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> cseed,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">fixed_param =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">iter_sampling=</span><span class="dv">1</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">matrix</span>(fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"y_hat_sim"</span>),nAnalytes,nObs)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>logPobs <span class="ot">=</span> fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"logPobs"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>N1A2B3 <span class="ot">=</span> fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"N1A2B3"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>param <span class="ot">=</span> <span class="fu">matrix</span>(fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"paramsim"</span>),nAnalytes,<span class="dv">3</span>)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma[[i]]<span class="ot">=</span>datastruct_prior_ma[[i]];</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma[[i]]<span class="sc">$</span>include_prior <span class="ot">=</span> <span class="fl">0.01</span>;</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>inits[[i]]<span class="ot">=</span>param</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> cseed<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mean_log_det_stan <span class="ot">=</span> <span class="cf">function</span>(data, init, chosen_indices, S){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>init_ma <span class="ot">=</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">param=</span>init)}</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>selected <span class="ot">=</span> chosen_indices;</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>nSel <span class="ot">=</span> <span class="fu">length</span>(chosen_indices);</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a> fit_opt  <span class="ot">=</span> mod_analytes<span class="sc">$</span><span class="fu">optimize</span>(</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_dir =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"stanfiles"</span>),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_basename =</span> S,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>   <span class="at">seed =</span> cseed,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>   <span class="at">init =</span> init_ma,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">jacobian =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>   <span class="at">show_messages =</span> F)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a> mode<span class="ot">=</span>fit_opt<span class="sc">$</span><span class="fu">unconstrain_variables</span>(<span class="fu">list</span>(<span class="at">param =</span> fit_opt<span class="sc">$</span><span class="fu">mle</span>(<span class="st">"param"</span>)))</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a> hessian <span class="ot">=</span> fit_opt<span class="sc">$</span><span class="fu">hessian</span>(<span class="at">unconstrained_variables =</span> mode)<span class="sc">$</span>hessian</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>logdet <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span>data<span class="sc">$</span>nAnalytes,\(i) <span class="fu">log</span>(<span class="fu">det</span>(<span class="sc">-</span>hessian[((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">3</span>),((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">3</span>)]))))</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(logdet)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co"># quick test:</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>z_prior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan</span>(datastruct_prior_ma[[i]], inits[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>z_noprior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan</span>(datastruct_noprior_ma[[i]], inits[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(<span class="fu">unlist</span>(z_prior)),<span class="fu">mean</span>(<span class="fu">unlist</span>(z_noprior)))</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.08178 12.96005</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>logP <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]<span class="sc">$</span>logPobs))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>NAB <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]<span class="sc">$</span>N1A2B3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="optimization" class="level2">
<h2 class="anchored" data-anchor-id="optimization">Optimization</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">213</span>,<span class="dv">214</span>) <span class="co"># initial values</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fws_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">214</span>,<span class="dv">209</span>,<span class="dv">215</span>) <span class="co"># initial values</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>fws_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">214</span>,<span class="dv">211</span>,<span class="dv">63</span>) <span class="co"># initial values</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>fws_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">210</span>,<span class="dv">215</span>,<span class="dv">79</span>) <span class="co"># initial values</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>fws_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">210</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># initial values</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>fws_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">210</span>,<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">79</span>) <span class="co"># initial values</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>fws_prior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">210</span>,<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># initial values</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>fws_noprior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="read-the-results-and-compare" class="level3">
<h3 class="anchored" data-anchor-id="read-the-results-and-compare">Read the results and compare</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>) <span class="co"># ref</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>) <span class="co"># ref</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>fws_prior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>fws_noprior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">212</span>) <span class="co"># p=2</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>fws_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">212</span>,<span class="dv">209</span>,<span class="dv">215</span>) <span class="co"># p=3</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">212</span>,<span class="dv">209</span>,<span class="dv">71</span>) <span class="co"># p=3</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>fws_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>fws_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># p=4</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># p=4</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>fws_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>fws_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">210</span>,<span class="dv">209</span>,<span class="dv">214</span>,<span class="dv">215</span>,<span class="dv">79</span>) <span class="co"># p=5</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">210</span>,<span class="dv">209</span>,<span class="dv">216</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># p=5</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>fws_prior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>fws_noprior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>summary_results <span class="ot">=</span> <span class="fu">tibble</span>( <span class="at">logP =</span> logP,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_2 =</span> fws_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(prior_ref<span class="sc">:</span>noprior_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(summary_results, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value))<span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>value, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"log(|FIM|)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-logDet-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>summary_results_diff <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_2 =</span> fws_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_prior_2 =</span> (fws_prior_2 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_3 =</span> (fws_prior_3 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_3 =</span> (fws_noprior_3 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_4 =</span> (fws_prior_4 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_4 =</span> (fws_noprior_4 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_5 =</span> (fws_prior_5 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_5 =</span> (fws_noprior_5 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_prior_2<span class="sc">:</span>d_noprior_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diff, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Efficiency relative to the reference design"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>summary_results_diffprior <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_ref  =</span> (fws_prior_ref<span class="sc">-</span>fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_3 =</span> (fws_prior_3<span class="sc">-</span>fws_noprior_3)<span class="sc">/</span>n_param,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_4 =</span> (fws_prior_4<span class="sc">-</span>fws_noprior_4)<span class="sc">/</span>n_param,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_5 =</span> (fws_prior_5<span class="sc">-</span>fws_noprior_5)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_ref<span class="sc">:</span>d_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diffprior, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Effect of prior on design efficiency"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">100</span>),</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">100</span>)),</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-logDet-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-logDet-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-logDet-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>f2_1 <span class="ot">=</span> p2</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>f3_1 <span class="ot">=</span> p3</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-abs.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-abs.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-rel.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-rel.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-prioreff.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-prioreff.png"</span>), <span class="at">.path =</span> figures_dir1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="table" class="level3">
<h3 class="anchored" data-anchor-id="table">Table</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data_ma<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">line=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>combined_results <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="at">prior_ref =</span> fws_prior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="at">prior_2 =</span> fws_prior_2<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_2 =</span> <span class="dv">10000</span><span class="sc">+</span>fws_prior_2<span class="sc">$</span>chosen_indices, <span class="co"># dummy</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="at">prior_3 =</span> fws_prior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_3 =</span> fws_noprior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="at">prior_4 =</span> fws_prior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_4 =</span> fws_noprior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="at">prior_5 =</span> fws_prior_5<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_5 =</span> fws_noprior_5<span class="sc">$</span>chosen_indices)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>selected_exp <span class="ot">=</span> <span class="fu">enframe</span>(combined_results)<span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">line=</span>value, <span class="at">Name =</span> name) <span class="sc">%&gt;%</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_ma, <span class="at">by =</span> <span class="st">"line"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">arrange</span>(Name,tg, fio)<span class="sc">%&gt;%</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(line,xpH,m,td,to,te,fif)) <span class="sc">%&gt;%</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Name, <span class="st">'noprior'</span>), <span class="st">"No prior"</span>, <span class="st">"Prior"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>tab1<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Prior"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>tab2<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"No prior"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">set_formatter</span>(</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  tab2, </span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">tg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%.0f"</span>, x) ),</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">fio =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, x) )</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab1, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab2, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>) </span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>, <span class="at">color=</span><span class="cn">NA</span>),</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>)</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> gg<span class="sc">+</span>p1<span class="sc">+</span>p2<span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-table.pdf"</span>), <span class="at">.path =</span> tables_dir1)</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-table.png"</span>), <span class="at">.path =</span> tables_dir1)</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>tab1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-0cd6dc38{}.cl-0ccc44a8{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-0cd09512{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-0cd09526{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-0cd0cac8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0cd0cadc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0cd0cae6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0cd0cae7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0cd0caf0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0cd0caf1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-0cd6dc38"><thead><tr style="overflow-wrap:break-word;"><th class="cl-0cd0cac8"><p class="cl-0cd09512"><span class="cl-0ccc44a8">Name</span></p></th><th class="cl-0cd0cadc"><p class="cl-0cd09526"><span class="cl-0ccc44a8">tg</span></p></th><th class="cl-0cd0cadc"><p class="cl-0cd09526"><span class="cl-0ccc44a8">fio</span></p></th><th class="cl-0cd0cac8"><p class="cl-0cd09512"><span class="cl-0ccc44a8">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">prior_2</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.05</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.10</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">prior_3</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.05</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.10</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.20</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">prior_4</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">30.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.20</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.05</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.10</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.20</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">prior_5</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">33.33333</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.20</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.05</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.05</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.15</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.20</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">prior_ref</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">30.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.05</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">30.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.05</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0cae7"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.05</span></p></td><td class="cl-0cd0cae6"><p class="cl-0cd09512"><span class="cl-0ccc44a8">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0cd0caf0"><p class="cl-0cd09512"><span class="cl-0ccc44a8"></span></p></td><td class="cl-0cd0caf1"><p class="cl-0cd09526"><span class="cl-0ccc44a8">90.00000</span></p></td><td class="cl-0cd0caf1"><p class="cl-0cd09526"><span class="cl-0ccc44a8">0.05</span></p></td><td class="cl-0cd0caf0"><p class="cl-0cd09512"><span class="cl-0ccc44a8">ACN</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-0ced5490{}.cl-0cdf6ba0{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-0ce591e2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-0ce591f6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-0ce5bc3a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0ce5bc44{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0ce5bc4e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0ce5bc58{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0ce5bc59{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0ce5bc62{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-0ced5490"><thead><tr style="overflow-wrap:break-word;"><th class="cl-0ce5bc3a"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">Name</span></p></th><th class="cl-0ce5bc44"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">tg</span></p></th><th class="cl-0ce5bc44"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">fio</span></p></th><th class="cl-0ce5bc3a"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">noprior_2</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"> </span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"> </span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"> </span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"> </span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">noprior_3</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">30</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.20</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">90</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.05</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">90</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.10</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">noprior_4</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">30</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.20</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">90</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.05</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">90</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.10</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">90</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.20</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">noprior_5</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">30</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.20</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">90</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.05</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">90</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.05</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">90</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.20</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">90</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.20</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">noprior_ref</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">30</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.05</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">30</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.05</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">90</span></p></td><td class="cl-0ce5bc58"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.05</span></p></td><td class="cl-0ce5bc4e"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0ce5bc59"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0"></span></p></td><td class="cl-0ce5bc62"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">90</span></p></td><td class="cl-0ce5bc62"><p class="cl-0ce591f6"><span class="cl-0cdf6ba0">0.05</span></p></td><td class="cl-0ce5bc59"><p class="cl-0ce591e2"><span class="cl-0cdf6ba0">ACN</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
</section>
<section id="stan-simulations" class="level2">
<h2 class="anchored" data-anchor-id="stan-simulations">Stan simulations</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>prior_ma_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -55.1203     0.0248582       26.7965           1           1      112    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -52.6601   0.000301249       5.49743        0.72        0.72      221    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -52.3964   0.000271428        2.7672      0.4659      0.4659      327    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -52.3376    0.00011808       1.83589      0.4747      0.4747      438    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -52.3296    0.00109492      0.599451           1           1      549    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -52.3292   9.98435e-05      0.139131      0.2977           1      664    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      626      -52.3292   1.56178e-05     0.0343932           1           1      693    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.4 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  13.4 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -59.6721     0.0201907       15.1937           1           1      104    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199       -58.352    0.00176661       5.84878      0.2657      0.2657      210    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -58.2903    0.00155221       2.09817           1           1      316    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -58.2848   0.000105978      0.244416      0.7443      0.7443      423    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -58.2845   1.80296e-05     0.0750299      0.1773      0.1773      532    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      528      -58.2845   2.97559e-05     0.0303722      0.3046           1      564    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.3 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  15.9 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -63.4694     0.0447808       18.3253           1           1      106    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -62.2146    0.00321723       2.17425           1           1      210    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -62.1717   0.000427616      0.415543           1           1      316    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399      -62.1698   7.31509e-05      0.109214           1           1      425    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      476      -62.1698   3.16183e-05     0.0209481           1           1      507    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.4 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  15.9 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -73.7009    0.00711292       33.8985      0.4691      0.4691      109    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -70.9319     0.0152663       28.1861           1           1      217    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -70.3281    0.00719157       5.62202           1           1      323    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -70.1798     0.0044848       5.14383        2.07       0.207      434    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -70.1447    0.00187989       1.30955           1           1      543    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -70.1372   0.000266001      0.434608           1           1      659    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -70.1356    0.00090106      0.954082           1           1      768    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -70.1338   0.000113179      0.174104           1           1      875    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      896      -70.1337   1.56331e-05     0.0466148           1           1      980    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.6 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  14.4 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -55.5853    0.00685897       9.21698           1           1      108    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199       -54.923       0.00179       1.93997           1           1      211    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -54.8954   0.000933273       1.02539           1           1      315    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399      -54.8944   0.000530823      0.233941           1           1      421    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      486      -54.8943   2.82223e-05     0.0180685           1           1      512    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.4 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  14.0 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -85.4781     0.0162312       105.426           1           1      138    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -79.7852     0.0136117       43.3898           1           1      276    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -77.5713    0.00335234       69.8622      0.6913     0.06913      437    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -75.2876     0.0180708        146.79           1           1      586    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -74.5847     0.0128903       192.283           1           1      711    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -73.9722    0.00045032       35.5533      0.9092      0.9092      836    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -73.1554    0.00684767       21.3529       1.841     0.01841      969    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -72.8781    0.00159238       26.1384           1           1     1099    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -72.5333    0.00737591       144.953           1           1     1236    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -72.3906    0.00158563       34.8853      0.6328    0.006328     1367    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -72.2325   0.000252558       9.23247           1           1     1511    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -72.1428   0.000361249       39.0201           1           1     1638    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299       -72.023    0.00195912       9.63673           1           1     1805    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -71.9067   0.000904123       3.42881           1           1     1943    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -71.8728    0.00197218        39.489      0.2475           1     2083    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -71.8256    0.00196512       2.90736           1           1     2211    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -71.8057    0.00105912       2.17927           1           1     2347    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -71.7948   0.000160398         3.103           1           1     2481    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -71.7745    0.00305492        8.0013           1           1     2617    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -71.7522   0.000533859       21.1887           1           1     2758    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -71.7518   0.000337688       9.29117           1           1     2759    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.5 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  16.2 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -56.7405     0.0324315       23.4115           1           1      105    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -54.9631     0.0073734       6.52521        0.88        0.88      211    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -54.7804   0.000846648       1.46517           1           1      317    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -54.7602   0.000918821       0.53774           1           1      423    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -54.7587   0.000133705      0.257673           1           1      528    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -54.7586   7.84861e-05     0.0384651           1           1      632    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      631      -54.7586   2.46522e-05     0.0402689      0.9479      0.9479      665    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.4 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.8 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -65.1616     0.0264574       14.0804           1           1      103    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -64.1889     0.0117298       5.12074           1           1      207    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -64.1379      0.003113      0.971517           1           1      313    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399      -64.1337   0.000239523      0.178153           1           1      425    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      495      -64.1335   4.35362e-05     0.0223679           1           1      526    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.3 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  15.9 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -69.6875      0.019558       23.8977      0.4033           1      110    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -68.0617    0.00352165       8.14632           1           1      222    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299       -67.842    0.00557131       4.29851           1           1      332    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -67.7937    0.00065052       1.17999           1           1      439    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499       -67.782   0.000803502       1.24004           1           1      547    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599      -67.7801   0.000165486      0.289535           1           1      652    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699      -67.7798   7.22414e-05      0.066583           1           1      757    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      709      -67.7798   5.50393e-05     0.0270328           1           1      768    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.4 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.5 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -67.4931     0.0253848       8.77936           1           1      102    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -67.2793   0.000767464      0.684281           1           1      209    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -67.2749   0.000423195       0.24755           1           1      317    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399      -67.2745   3.11126e-05     0.0215392           1           1      421    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      401      -67.2745   3.00063e-05     0.0169928      0.9637      0.9637      423    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.3 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.6 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691242 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.688057   0.000131735      0.639688           1           1      108    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.685947    0.00217896      0.374134           1           1      216    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.682863   0.000449711       0.69429           1           1      320    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.677955   0.000943411      0.672797           1           1      429    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.674909   0.000199186      0.336654           1           1      536    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.673265   0.000999857      0.574222           1           1      643    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699     -0.671035    0.00358225      0.796826           1           1      746    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.666907    0.00215387       1.24831      0.3384           1      853    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899      -0.66177    0.00554806      0.660932           1           1      964    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.653493    0.00504129       1.66233      0.3135      0.3135     1069    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.649354    0.00451994      0.543002           1           1     1180    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.647636   0.000144818      0.199135           1           1     1284    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.646381   0.000634823      0.431629      0.4146      0.4146     1394    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399     -0.645295   0.000215744      0.222707           1           1     1499    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.644673   0.000667161      0.274199           1           1     1607    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599      -0.64393   0.000201201       0.24746           1           1     1715    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.643418   5.72162e-05      0.188587           1           1     1818    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799     -0.643098   3.22403e-05      0.161458      0.7093      0.7093     1928    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899     -0.642963   0.000126887     0.0985565           1           1     2038    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.642908   2.17208e-05     0.0440095           1           1     2149    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.642908   1.32082e-05     0.0514264           1           1     2150    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  1.4 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  14.9 seconds.
0/2: Initial log joint probability = -0.733884 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.730933   0.000100067      0.281492           1           1      104    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199     -0.728932   0.000441033      0.326145           1           1      211    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -0.72717   0.000329728      0.215274           1           1      315    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.726395    0.00404164       0.75556           1           1      419    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.724672   0.000348557      0.335057           1           1      525    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.723883    0.00066631      0.141289           1           1      634    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.723034   0.000734884      0.255024           1           1      736    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.721806   0.000183375       0.15447           1           1      847    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899     -0.721008   0.000169506      0.227965      0.2837      0.2837      953    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.720745    8.2811e-05      0.107687      0.2648      0.2648     1055    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.720474   0.000246875      0.130225           1           1     1159    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.720036   0.000857324      0.144356           1           1     1268    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299     -0.719616   4.68324e-05     0.0984235           1           1     1371    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399      -0.71948   9.57478e-05     0.0553848           1           1     1476    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499      -0.71941   0.000198441      0.130784           1           1     1585    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599      -0.71919   0.000855211       0.13713           1           1     1692    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.718975   0.000657145      0.109824           1           1     1798    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799     -0.718798   0.000193791     0.0584729           1           1     1906    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899     -0.718623   3.51785e-05     0.0636925           1           1     2012    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1999     -0.718515   6.44184e-06      0.056037       0.777       0.777     2120    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     2000     -0.718514   0.000116169     0.0468402           1           1     2121    
0/2: Optimization terminated normally:  
0/2:   Maximum number of iterations hit, may not be at an optima 
0/2: Finished in  1.3 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  16.7 seconds.
0/3: Initial log joint probability = -0.799594 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.794522    0.00021881      0.579522      0.5773      0.5773      107    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199       -0.7914   0.000605586      0.244749           1           1      212    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.790099   0.000230061      0.158689      0.9997      0.9997      315    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399      -0.78922   0.000731577      0.306345           1           1      420    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.788493   0.000202951      0.124797      0.7605      0.7605      525    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.788197   0.000274774      0.136959           1           1      631    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.788041   0.000148278     0.0462728           1           1      734    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799       -0.7879   0.000318417      0.132053           1           1      838    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      899     -0.787841   2.19018e-05     0.0502683      0.6694      0.6694      942    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      999     -0.787791   7.51199e-05     0.0404025           1           1     1047    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1099     -0.787723   0.000136308      0.108241      0.7426      0.7426     1153    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1199      -0.78766   0.000328318     0.0544214           1           1     1256    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1299     -0.787614   7.54123e-05     0.0257264           1           1     1359    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1399     -0.787597   9.36786e-05     0.0546954           1           1     1464    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1499     -0.787584   6.85317e-05     0.0232237           1           1     1567    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1599     -0.787543   0.000163929     0.0452873      0.4244      0.4244     1673    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1699     -0.787523   3.98884e-06     0.0169289      0.9554      0.9554     1777    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1799     -0.787516   3.73239e-06     0.0166073      0.6461      0.6461     1883    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1899     -0.787508   4.20711e-05      0.022294           1           1     1991    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1999     -0.787496   0.000358671     0.0505636      0.4568           1     2098    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     2000     -0.787496   0.000161582     0.0310217      0.4613      0.4613     2099    
0/3: Optimization terminated normally:  
0/3:   Maximum number of iterations hit, may not be at an optima 
0/3: Finished in  1.4 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  16.8 seconds.
0/4: Initial log joint probability = -0.871316 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99     -0.868207    0.00125287      0.684833           1           1      110    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.865366    0.00075427       1.55349      0.3773           1      219    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299     -0.860936    0.00140146       1.32066           1           1      328    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -0.85467    0.00103401       2.19688      0.7124      0.7124      430    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499     -0.847119    0.00426807       2.44597           1           1      542    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.843114   0.000871128       1.57971      0.1465           1      652    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699     -0.841204   0.000109889       0.32249           1           1      761    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -0.84044   0.000325577      0.373684      0.9808      0.9808      868    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.837175    0.00337372       1.13943           1           1      982    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.833616   0.000141312      0.756192           1           1     1090    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.829427   0.000135821      0.563623           1           1     1195    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.824009   0.000384779      0.926205           1           1     1304    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299      -0.82147   0.000505377      0.464521           1           1     1408    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.820536   0.000419292      0.497459           1           1     1516    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.819927   0.000169818      0.585057           1           1     1628    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599      -0.81951   4.09357e-05      0.186829           1           1     1742    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.818928    0.00121797      0.601545           1           1     1847    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799      -0.81761   6.92424e-05      0.238039           1           1     1959    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.817179   0.000311124      0.204758           1           1     2074    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.816292   0.000572824      0.326995           1           1     2188    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000      -0.81629   0.000133651      0.365729           1           1     2189    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  1.2 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  17.1 seconds.
0/5: Initial log joint probability = -0.729813 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.725199    0.00145245        0.3558           1           1      102    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.724249    0.00015702      0.160959      0.8745      0.8745      207    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.723691    0.00025981      0.386263      0.5578      0.5578      317    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.722707   0.000466015      0.219064           1           1      422    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499     -0.722296   0.000177775      0.172039      0.4592      0.4592      529    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.721497    0.00211632      0.269278           1           1      635    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.720496    0.00157629       0.20004           1           1      741    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.719469   0.000930009      0.240452           1           1      852    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.718624    0.00170736      0.267468           1           1      957    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      999     -0.717911    0.00065317      0.134618           1           1     1062    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1099     -0.717741   0.000381737     0.0896992           1           1     1166    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1199     -0.717686   1.26178e-05     0.0576493      0.6702      0.6702     1274    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1299     -0.717645   5.86561e-05     0.0437605      0.6085      0.6085     1383    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1399     -0.717631   9.12035e-05     0.0263231           1           1     1493    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1499     -0.717609    0.00031283     0.0454519           1           1     1602    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1599     -0.717585   0.000174805     0.0483182      0.5068           1     1710    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1699      -0.71757   3.70698e-05     0.0223099      0.4907      0.4907     1817    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1799     -0.717561   2.04147e-05     0.0286906       0.426       0.426     1927    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1899     -0.717539   0.000436164     0.0260491           1           1     2034    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1999     -0.717521    1.5952e-05     0.0144451           1           1     2145    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     2000      -0.71752   9.88694e-05     0.0290022           1           1     2146    
0/5: Optimization terminated normally:  
0/5:   Maximum number of iterations hit, may not be at an optima 
0/5: Finished in  1.1 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  14.5 seconds.
0/6: Initial log joint probability = -0.917087 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916367   0.000229085      0.881636           1           1      155    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.915518   9.95093e-05       1.40839      0.7614     0.07614      282    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.915199    8.6231e-05       3.30542           1           1      414    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.915085   6.00793e-06      0.364677      0.1917     0.01917      621    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.915056   5.57743e-06      0.487225      0.1427     0.01427      878    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.914971   0.000126638       2.77252           1           1     1096    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -0.91451    0.00144754       8.46789           1           1     1235    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.913835   0.000459555       1.34136      0.7519      0.7519     1367    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.913125   1.21744e-05       3.42196           1           1     1498    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999     -0.912656    0.00025926      0.819097           1           1     1626    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.912517   2.72542e-05      0.313307           1           1     1749    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.912306    0.00017259       4.90432           1           1     1874    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.912192   3.76846e-05      0.839413      0.5518      0.5518     2007    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.912131   1.35878e-05       0.26958        1.01      0.0101     2205    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.912003   4.49764e-05       1.02054      0.2203      0.2203     2371    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.911734   0.000358839      0.765898      0.3883    0.003883     2598    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -0.91135   0.000391089       3.14463           1           1     2799    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.911253   8.94051e-05       2.00065           1           1     2936    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.911188   0.000113847      0.237554           1           1     3063    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.911138   0.000104556       1.97108           1           1     3199    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000     -0.911136   0.000188306       1.14243           1           1     3200    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.8 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  17.0 seconds.
0/7: Initial log joint probability = -0.679174 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.677197    0.00193539       0.99161           1           1      107    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.675544    0.00260316      0.904832           1           1      214    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.673456    0.00260367      0.572327           1           1      318    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.671352   0.000429339        0.6301           1           1      425    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.670685   0.000391063      0.675044           1           1      534    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.669901    0.00180505      0.613857           1           1      642    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.668796    0.00309895      0.358783           1           1      753    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.667178    0.00204459      0.451816           1           1      864    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.666146   2.71822e-05      0.100081           1           1      969    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999      -0.66547   0.000230435       0.16762           1           1     1077    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099      -0.66533   3.35704e-05     0.0817872           1           1     1182    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.665166   0.000191173      0.123899      0.7228      0.7228     1288    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299     -0.664956   0.000316908      0.108563           1           1     1393    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.664828    0.00018396      0.113647           1           1     1500    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.664681   9.28911e-05     0.0733864           1           1     1608    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.664642   1.82084e-05     0.0767035       0.426           1     1714    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.664625   7.88095e-05     0.0439112           1           1     1821    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.664534     0.0017858      0.366738           1           1     1928    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899     -0.664389   7.32697e-05     0.0432668           1           1     2035    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1999     -0.664348   8.04136e-05     0.0431164           1           1     2140    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     2000     -0.664347   6.81642e-05     0.0495584           1           1     2141    
0/7: Optimization terminated normally:  
0/7:   Maximum number of iterations hit, may not be at an optima 
0/7: Finished in  1.2 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.4 seconds.
0/8: Initial log joint probability = -0.801846 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.798048    0.00029769      0.387526      0.5043      0.5043      105    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.797009   0.000290035      0.117573           1           1      213    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.796062   0.000215641      0.192379      0.4096      0.4096      317    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.794235    0.00035426      0.440892      0.1393           1      425    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.793231    0.00283296      0.394652           1           1      535    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.790718   0.000334214      0.231089           1           1      640    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699     -0.788978    0.00174617      0.340063           1           1      747    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799     -0.788403   0.000450914      0.130209           1           1      852    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899      -0.78797    7.3084e-05     0.0985921           1           1      957    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999     -0.786825   0.000250296      0.084459           1           1     1065    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.786603   0.000102881      0.137336       0.354           1     1170    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199     -0.786424   0.000882155      0.154161           1           1     1278    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.785675   0.000458828      0.144958           1           1     1379    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.784997   0.000220582       0.23978      0.2613      0.2613     1485    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499     -0.784631   0.000103664     0.0789576           1           1     1590    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.784553   0.000139247     0.0437728           1           1     1700    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1699     -0.784482   0.000154078     0.0491223           1           1     1806    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1799     -0.784392   0.000219573     0.0853234           1           1     1911    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1899       -0.7842    0.00134605     0.0635491           1           1     2016    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1999     -0.783834   0.000807727     0.0889435           1           1     2120    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     2000     -0.783832    0.00180868      0.121115           1           1     2121    
0/8: Optimization terminated normally:  
0/8:   Maximum number of iterations hit, may not be at an optima 
0/8: Finished in  1.2 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  15.1 seconds.
0/9: Initial log joint probability = -0.809754 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.807363   9.91732e-05      0.550567      0.7922      0.7922      106    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.806924   0.000683704      0.699948           1           1      217    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299     -0.806218    0.00269256      0.833283           1           1      327    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.804861    0.00473691       1.73147           1           1      436    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.801308    0.00631643      0.824529           1           1      545    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.797795    0.00101785       0.40301           1           1      656    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.796509   0.000349554      0.198574           1           1      770    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.795964   7.17036e-05      0.219719      0.7846      0.7846      876    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.795786   0.000100168     0.0950869           1           1      984    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.795326     0.0024719      0.323078           1           1     1090    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.794637    0.00126046      0.194969           1           1     1195    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199     -0.794191   0.000305135      0.210057           1           1     1300    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.793926   0.000403882      0.190058           1           1     1412    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.793598    0.00131457      0.481336           1           1     1522    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.793272   0.000511074      0.194397           1           1     1626    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.792985   0.000478047       0.20426           1           1     1737    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.792842   3.86217e-05      0.076355           1           1     1847    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799      -0.79278   1.94299e-05     0.0901661           1           1     1958    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899     -0.792702   7.62562e-05      0.101343      0.4562      0.4562     2073    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1999       -0.7926   0.000371222      0.198517           1           1     2180    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     2000     -0.792599    6.7521e-05     0.0824634      0.6777      0.6777     2181    
0/9: Optimization terminated normally:  
0/9:   Maximum number of iterations hit, may not be at an optima 
0/9: Finished in  1.2 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  15.8 seconds.
0/10: Initial log joint probability = -0.752983 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.751605   0.000544563       0.10316           1           1      104    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.751445   0.000216898     0.0632178           1           1      208    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299     -0.751401   7.23926e-05      0.049146      0.5043      0.5043      313    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.751383   0.000133679      0.017496           1           1      420    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499     -0.751372   1.05218e-05     0.0145632           1           1      522    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599      -0.75137   4.20992e-05    0.00452697           1           1      630    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      699     -0.751368   8.42837e-06    0.00736876      0.5013      0.5013      736    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      799     -0.751366   5.01058e-05     0.0190078           1           1      842    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      899     -0.751365   7.52678e-06    0.00575423           1           1      945    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      906     -0.751364   3.08812e-06    0.00249686           1           1      952    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.6 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  17.4 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_2<span class="sc">$</span>chosen_indices <span class="co"># p=2</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>prior_ma_2 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -45.8025     0.0691347       29.8165           1           1      106    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -42.0243    0.00109678       6.91503       0.653       0.653      210    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -41.7435    0.00167699       2.88094           1           1      313    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -41.7208     0.0030509       0.94808           1           1      419    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -41.7168    0.00122706      0.496243           1           1      524    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -41.7164   7.43081e-05      0.096037           1           1      633    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699      -41.7163   2.76049e-05     0.0145558           1           1      738    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      706      -41.7163     6.865e-05     0.0164627           1           1      746    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.5 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  15.2 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -45.8833     0.0177088       12.5762           1           1      106    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -43.1077     0.0045962        7.4621      0.2594      0.2594      211    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -42.9082     0.0106939       4.15317           1           1      317    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399       -42.896   0.000201532      0.219257           1           1      421    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -42.8953   0.000137377     0.0746721           1           1      525    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      575      -42.8953   1.30509e-05     0.0153186           1           1      603    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.4 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  14.1 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -52.8324      0.092124       54.7775           1           1      104    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -49.0476     0.0406707       6.79633           1           1      210    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -48.6482    0.00210141       2.85745       0.234           1      318    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399      -48.6254    0.00297682      0.365539           1           1      423    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499      -48.6225   6.01477e-05      0.115213           1           1      527    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599      -48.6222   0.000254278     0.0872062           1           1      634    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699      -48.6221   2.11187e-05     0.0471853      0.2906      0.2906      745    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      700      -48.6221   9.29933e-05     0.0170649           1           1      746    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.3 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  15.4 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -66.0265     0.0425948       68.1818           1           1      106    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -60.8828     0.0211333       20.9717           1           1      212    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -59.4942    0.00721317       6.65852           1           1      322    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -59.0793    0.00595296        3.6728           1           1      431    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -59.0202    0.00147075       3.36916      0.2784           1      536    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -59.0008   0.000619068      0.913097       0.399           1      645    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -58.9986   0.000547548      0.583699           1           1      754    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -58.9971   0.000246211      0.289471           1           1      859    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899      -58.9968   0.000168409      0.156036           1           1      966    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999      -58.9967   8.63815e-05     0.0652476           1           1     1067    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1049      -58.9967   9.48884e-06     0.0326289           1           1     1119    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.4 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  15.0 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -40.0693     0.0401844       17.1423      0.9601      0.9601      105    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -37.1252     0.0279419       10.5749           1           1      209    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -36.8665    0.00212778         1.169      0.6967      0.6967      314    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399        -36.84    0.00102887      0.468928           1           1      417    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499      -36.8382   0.000461215      0.164511           1           1      521    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599      -36.8381   8.66087e-05     0.0510885      0.2757           1      628    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      640      -36.8381   1.32849e-05     0.0207511      0.8403      0.8403      671    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.5 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.2 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -80.7789     0.0128917       87.3908      0.6413      0.6413      140    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -72.8632      0.044472       109.083     0.03797           1      268    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -66.0081     0.0025551       89.4238      0.5889     0.05889      406    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -63.7455    0.00618319       29.3281           1           1      531    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -62.4649    0.00412941       37.0859           1           1      655    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -61.0952    0.00443979       67.8812           1           1      775    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -60.1217     0.0051428       8.73812           1           1      906    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -59.4809    0.00119104       87.5255      0.6765      0.6765     1036    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -59.0109    0.00508515       18.8791           1           1     1174    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -58.7022    0.00141791       43.5722           1           1     1300    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -58.5539    0.00183643       4.69446           1           1     1445    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -58.0747    0.00349962       29.4673           1           1     1592    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -57.8056    0.00486127       30.0233     0.09279           1     1717    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -57.6379    0.00387111       13.6251      0.3194      0.3194     1852    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499       -57.583    0.00251058       14.6823           1           1     1986    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -57.4918   0.000556627       3.87337           1           1     2119    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -57.4789    0.00047304       15.6445      0.6033      0.6033     2251    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -57.4658     0.0011259       3.16365      0.6512      0.6512     2380    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899       -57.458    0.00151813       1.86672           1           1     2503    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -57.4459   0.000351587       3.67459     0.03069           1     2635    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -57.4459   0.000113717       3.88404        0.31       0.031     2637    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  0.8 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  15.8 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99           -44     0.0416168       55.3955           1           1      106    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -40.1681    0.00764029       8.53566           1           1      214    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -39.7872    0.00296462       2.34425           1           1      324    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399        -39.74   0.000813668      0.940797      0.3526           1      433    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -39.7364   0.000129657      0.175799      0.8046      0.8046      543    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599       -39.736   2.30314e-05      0.111259      0.5728      0.5728      652    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      681      -39.7359   6.42698e-05      0.017708           1           1      743    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.4 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.4 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -51.5333     0.0775784       42.4404           1           1      107    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -47.8452    0.00936899        4.4054           1           1      213    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -47.5745    0.00783643       1.96305           1           1      316    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399      -47.5542   0.000192888      0.348406           1           1      421    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499      -47.5527   0.000249297      0.150276           1           1      525    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      597      -47.5526    3.3562e-05     0.0151419           1           1      628    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.3 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.5 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -58.7666    0.00455092       13.6927           1           1      108    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -54.3199    0.00326962       10.4247           1           1      215    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -53.5791    0.00300104       12.7062           1           1      322    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -53.3983     0.0108513       4.11583           1           1      431    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -53.3463   0.000650122         1.601           1           1      546    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599      -53.3296    0.00230183       2.22567      0.4734           1      651    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699      -53.3269    0.00109853      0.398668           1           1      759    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799      -53.3259   8.22471e-05       0.13456           1           1      866    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899      -53.3257   8.85669e-05      0.154994           1           1      976    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      905      -53.3257   8.48581e-06     0.0413921           1           1      982    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.4 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.8 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -56.0557     0.0249526       8.49359           1           1      106    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -53.5145    0.00470553       2.91041           1           1      214    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -53.3923   0.000902265      0.812952           1           1      318    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399      -53.3823   0.000529653      0.206337           1           1      426    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499      -53.3817   0.000205044     0.0777027      0.8924      0.8924      531    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599      -53.3817   4.33632e-05     0.0594669           1           1      637    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      624      -53.3817    2.5337e-05     0.0167915           1           1      664    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.3 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  16.0 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>prior_ma_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99       -57.313    0.00421196       44.0112      0.5516      0.5516      104    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -52.7261    0.00225323       6.95562           1           1      210    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -52.3071    0.00152575       6.97877      0.2129      0.2129      314    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399        -52.19    0.00092091       1.39589           1           1      424    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -52.1779   0.000292189      0.519747           1           1      527    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -52.1772   0.000114616       0.19281      0.3268      0.3268      633    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699       -52.177   0.000421001     0.0867137           1           1      741    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      768       -52.177    4.1563e-05     0.0333898           1           1      817    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.4 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  13.3 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -55.1312    0.00838425       16.4017           1           1      104    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -52.0978     0.0102296       8.28914           1           1      211    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -51.3739   0.000952264       2.43028           1           1      313    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -51.3059   0.000634253      0.875344           1           1      417    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -51.2982   0.000375822      0.262081           1           1      525    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599      -51.2976   7.18352e-05      0.132349           1           1      629    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699      -51.2974   0.000164762     0.0332693           1           1      735    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      737      -51.2974   1.07619e-05     0.0237978           1           1      774    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.4 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  14.6 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -60.2685     0.0499825       36.7289           1           1      104    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199       -57.581    0.00953555       8.06168           1           1      211    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -57.0481    0.00391987       3.92092           1           1      313    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399      -56.9765    0.00248058       1.98352           1           1      420    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499      -56.9715    0.00046619      0.352082           1           1      528    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599      -56.9709    7.8564e-05     0.0620829           1           1      633    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      687      -56.9708   8.08342e-06     0.0273139           1           1      726    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.4 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  15.9 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -69.2803     0.0763817       72.4329      0.3157           1      105    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199       -65.245     0.0188147       13.7987           1           1      210    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -63.9977     0.0279082       12.5001           1           1      326    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -63.6999     0.0105468       8.39189           1           1      434    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -63.6501    0.00329307       5.18894           1           1      541    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -63.6418    0.00148445       1.23843           1           1      648    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -63.6393   6.24821e-05      0.586587      0.3537      0.3537      751    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -63.6386   0.000129135      0.192233      0.7195      0.7195      861    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899      -63.6385   0.000133444      0.123999           1           1      969    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      950      -63.6385   7.72884e-06     0.0330214           1           1     1026    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.5 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  15.2 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -51.9031    0.00694364       31.5829      0.2554      0.2554      108    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -48.7266     0.0131441        5.9333           1           1      218    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -48.1825    0.00136377       1.67307           1           1      324    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399      -48.1119    0.00176356      0.989673           1           1      427    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499      -48.1045   0.000297366      0.363994           1           1      531    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599      -48.1036   8.11673e-05      0.130429           1           1      637    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699      -48.1035   8.14036e-05     0.0760344      0.8491      0.8491      741    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      743      -48.1035   6.28326e-06     0.0202037           1           1      785    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.4 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.9 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -83.2966    0.00491805       116.324      0.8393      0.8393      137    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -78.7034    0.00607303       199.982           1           1      271    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -76.5916   0.000858065       66.7773           1           1      400    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399       -76.009    0.00168946       104.671      0.1125           1      522    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -71.2934     0.0131749       114.274           1           1      643    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -67.4065   0.000451682       55.0153           1           1      767    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -66.4296   0.000697996       19.9355       2.816      0.2816      887    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -66.0293    0.00194943       27.2482           1           1     1020    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899       -65.571    0.00232564       25.9176      0.8249      0.8249     1160    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -65.4077    0.00013393       10.2695      0.5347      0.5347     1293    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -65.2851    0.00306355       49.4335           1           1     1424    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -65.2118   0.000874086       11.8029      0.7533     0.07533     1583    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -65.1191   0.000818947       8.66716           1           1     1713    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -65.0228     0.0209046       23.2867           1           1     1838    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -64.8716   0.000752664       9.12168           1           1     1970    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -64.8191   0.000506198       5.07791           1           1     2096    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699       -64.799     0.0013433       5.17756           1           1     2236    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -64.7815   0.000254659       5.65963           1           1     2361    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -64.7642   0.000125006       8.81592      0.2449     0.02449     2497    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -64.7302   0.000887685       2.72496       1.067      0.1067     2627    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -64.7302   7.53505e-05       3.68688           1           1     2628    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.0 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  15.0 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -52.0361     0.0238868       25.9537           1           1      106    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -49.0933    0.00252591       8.07394      0.7133      0.7133      212    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299       -48.487    0.00377948       6.77294      0.7139      0.7139      317    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -48.3858    0.00296891       1.29643           1           1      424    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -48.3744   0.000382392      0.590966           1           1      530    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -48.3723   0.000313262      0.257322           1           1      634    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699      -48.3719   5.73195e-05      0.181618      0.6317      0.6317      742    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799      -48.3718   9.27004e-05     0.0418032           1           1      844    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      861      -48.3718   0.000111986     0.0217208           1           1      912    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.4 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  15.6 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99       -60.059     0.0101009       26.3148           1           1      104    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -56.4788     0.0173628       16.2637           1           1      210    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -55.8735    0.00587551       6.72257      0.4749      0.4749      314    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399      -55.7373    0.00243165        1.8108           1           1      423    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499      -55.7234     0.0011108      0.512828           1           1      527    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599      -55.7222   0.000181091       0.13228           1           1      633    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699      -55.7221   4.89125e-05     0.0637885           1           1      736    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      750      -55.7221   2.11651e-05     0.0444553           1           1      790    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.3 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.7 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -65.0554     0.0122632       28.8745      0.7889      0.7889      106    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -61.1205     0.0590912       27.3081           1           1      212    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -60.3527     0.0078311       9.51577           1           1      319    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -60.1982    0.00257136       2.09176       3.088      0.3088      425    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -60.1596    0.00176987       1.50086           1           1      534    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599       -60.154   0.000573967      0.565513           1           1      639    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699      -60.1524   8.04082e-05      0.181529      0.9506      0.9506      743    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799      -60.1521   6.76037e-05     0.0817089           1           1      852    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899       -60.152   0.000112892     0.0821776           1           1      956    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      958       -60.152   4.20616e-05     0.0440158           1           1     1017    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.5 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.6 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99       -61.448     0.0148961         17.01           1           1      103    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -59.2807     0.0168709       6.93402           1           1      211    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299       -58.889     0.0159865       1.89695           1           1      318    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399      -58.7939   0.000818964      0.997433      0.4821      0.4821      425    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499      -58.7822    0.00366648       1.56733      0.4783           1      536    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599      -58.7789   5.78585e-05      0.390421      0.5558      0.5558      639    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      699      -58.7782   4.35677e-05     0.0545793           1           1      743    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      787      -58.7782   2.36531e-05     0.0255078           1           1      837    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.5 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  16.1 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691242 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.689174     0.0001366      0.484017      0.3709      0.3709      109    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.687576   0.000304701      0.248615           1           1      219    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.686245   0.000511652      0.332524           1           1      323    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.681644    0.00962773      0.813939           1           1      434    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.677781    0.00118281      0.762964           1           1      541    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.675692    0.00135068      0.387623           1           1      652    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699     -0.674414   0.000383268      0.185981           1           1      759    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.673829    0.00148313      0.260501           1           1      874    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.673369   0.000122721      0.319008      0.3674      0.3674      981    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.673063    0.00028138      0.485335      0.5544      0.5544     1090    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.672478    0.00276741        0.5313           1           1     1196    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.671736     0.0001204       0.20542           1           1     1301    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.671413   0.000102221      0.104994           1           1     1410    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399      -0.67126    0.00034416      0.114819           1           1     1516    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.671027   0.000118139      0.175983           1           1     1621    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.670951    4.0429e-05     0.0718112           1           1     1732    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.670887    0.00025507      0.128872           1           1     1841    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799      -0.67065   0.000278614      0.245569      0.6829      0.6829     1950    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899     -0.670413   7.25348e-05     0.0991486           1           1     2054    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.669989    0.00147953      0.255702      0.8664      0.8664     2159    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.669988   7.83399e-05      0.181642      0.6888      0.6888     2160    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  0.8 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  13.3 seconds.
0/2: Initial log joint probability = -0.733884 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.730386    0.00177869       0.82282      0.5097           1      108    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199     -0.728287   0.000197411      0.238638           1           1      211    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299     -0.726961   0.000462528      0.296188      0.8178      0.8178      317    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.725705   0.000366407      0.187126      0.9694      0.9694      421    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.725092   0.000944588      0.316507           1           1      527    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.724683   0.000362215      0.103354           1           1      630    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.724377   9.33771e-05      0.137077      0.6346      0.6346      736    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.724258   5.60935e-05     0.0733069           1           1      840    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899     -0.724139   7.26371e-05     0.0839288      0.9381      0.9381      947    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.723965   6.85199e-05      0.140402      0.7059      0.7059     1052    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.723801   0.000145347     0.0755342           1           1     1159    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.723771   0.000201261     0.0400921           1           1     1268    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299     -0.723711   0.000639976     0.0659097           1           1     1376    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399     -0.723649   0.000165019      0.055147           1           1     1486    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.723619    2.2836e-05     0.0227614           1           1     1588    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.723603   1.66194e-05     0.0232233      0.6287      0.6287     1695    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.723593   4.37419e-05     0.0253939      0.7025      0.7025     1800    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799      -0.72358   0.000133529     0.0563887      0.5342      0.5342     1908    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899     -0.723567    2.9203e-05     0.0330526       0.882       0.882     2014    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1999     -0.723559   0.000127774      0.021449           1           1     2121    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     2000     -0.723559   0.000258991     0.0204527           1           1     2122    
0/2: Optimization terminated normally:  
0/2:   Maximum number of iterations hit, may not be at an optima 
0/2: Finished in  0.8 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  13.7 seconds.
0/3: Initial log joint probability = -0.799594 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.795484   0.000776929      0.640629       0.388           1      103    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.793116    0.00122436      0.308144      0.8444      0.8444      207    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.791502    0.00138383      0.510331           1           1      312    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.790762    3.9176e-05      0.102844           1           1      417    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.790547   5.00791e-05     0.0946283           1           1      522    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.790473   4.07523e-05     0.0204428           1           1      628    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.790461   1.29723e-05     0.0105111           1           1      734    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799     -0.790458   8.05366e-05     0.0306808           1           1      836    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      899     -0.790456   4.84026e-05    0.00980433           1           1      940    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      999     -0.790455    1.3052e-05    0.00579018           1           1     1046    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1050     -0.790455   2.57141e-05    0.00262572           1           1     1101    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.5 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  15.8 seconds.
0/4: Initial log joint probability = -0.871316 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99     -0.866134     0.0013227       0.66153           1           1      109    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.860945   0.000111366      0.640508      0.3075      0.3075      224    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -0.85151   0.000565813      0.892432           1           1      331    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399     -0.841565    0.00262075      0.768903           1           1      437    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499     -0.836685    0.00178493       1.57699      0.5159           1      548    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.833412    0.00287356      0.631196           1           1      657    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699     -0.831157    0.00114332      0.600328        3.29       0.329      766    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799     -0.829665   0.000230375      0.328001      0.9066      0.9066      872    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.828151     0.0021352        1.2398           1           1      980    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.825596    0.00336219       0.39008           1           1     1085    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.823041    0.00169315       1.34743           1           1     1187    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.821224    0.00016702      0.459567      0.6826      0.6826     1291    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299       -0.8202   0.000235793      0.532062      0.4653           1     1399    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.819174   0.000254096      0.296692           1           1     1501    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.818517   0.000296677      0.299913           1           1     1610    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599     -0.818191    0.00144848      0.307442           1           1     1714    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.817793   0.000308405     0.0888586           1           1     1826    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799     -0.817505    0.00149514      0.204778           1           1     1932    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.816076    0.00409347      0.717276       0.443           1     2037    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.813142    0.00400678       0.50378           1           1     2148    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000     -0.813078     0.0079957      0.779817           1           1     2149    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  0.8 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  17.1 seconds.
0/5: Initial log joint probability = -0.729813 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.725761   0.000841606      0.331836           1           1      106    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -0.72457   0.000818362      0.175949           1           1      209    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.724211   0.000422096       0.30862           1           1      317    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399       -0.7239    0.00063215     0.0646965           1           1      422    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499     -0.723709   0.000152163     0.0928351           1           1      525    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.723624   0.000947783      0.160668           1           1      628    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.723588   2.70715e-05     0.0383534      0.4615      0.4615      731    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.723577   4.97962e-05     0.0250668           1           1      837    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.723567     0.0001125     0.0483699      0.4497      0.4497      940    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      999     -0.723545   0.000185902     0.0324579           1           1     1043    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1099     -0.723535   6.28337e-05     0.0191466           1           1     1148    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1199     -0.723526   0.000455161     0.0175508           1           1     1260    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1299     -0.723523   3.54161e-05     0.0179863           1           1     1363    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1328     -0.723523   8.96078e-07    0.00340224           1           1     1393    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.6 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  15.2 seconds.
0/6: Initial log joint probability = -0.917063 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.915998   7.88716e-05      0.754856           1           1      136    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.915127   0.000143197      0.424941           1           1      265    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.914013   0.000180702      0.898232      0.2385           1      390    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.913603   7.37686e-05       1.77906           1           1      525    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.913306   0.000174409      0.352982       1.209      0.1209      654    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.913202   1.02926e-05      0.637568           1           1      782    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -0.91298   1.35393e-05      0.316226           1           1      927    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.912785   8.62208e-05      0.562122      0.7684      0.7684     1063    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.912702   2.03073e-06      0.308477      0.0243           1     1213    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999     -0.912667   7.10031e-05      0.570237           1           1     1353    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.912524   0.000186641       2.45198           1           1     1488    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.911848   0.000373756      0.888937      0.2251     0.02251     1666    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.911557   0.000159827      0.617925           1           1     1869    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.911457    0.00122621      0.450854           1           1     1996    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.911393   0.000109902      0.450615           1           1     2121    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.911361   0.000105662      0.221342      0.5049      0.5049     2253    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.911328   6.04423e-06      0.309738           1           1     2386    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.911321    8.6717e-06     0.0695097      0.2877     0.02877     2515    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.911313   1.69241e-05     0.0490228      0.8299      0.8299     2647    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.911305   2.19969e-05      0.119013           1           1     2778    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000     -0.911305    1.6155e-05       0.13141           1           1     2779    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.0 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  14.8 seconds.
0/7: Initial log joint probability = -0.679174 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.676775   0.000146227      0.518593      0.4183      0.4183      108    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.675955   0.000640094      0.235277           1           1      214    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.674658      3.33e-05      0.125946           1           1      321    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.673751    0.00214127      0.338859           1           1      429    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.672567   0.000577323      0.204634           1           1      537    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.672134   0.000125375      0.131853           1           1      643    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.671954   0.000317673        0.1064           1           1      751    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.671762   0.000100326     0.0989186           1           1      858    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.671609   0.000201828      0.213209      0.5761      0.5761      963    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.671457    0.00191922      0.160562           1           1     1068    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099     -0.671283   1.51027e-05      0.120192      0.8091      0.8091     1176    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.671227   0.000127529     0.0647515           1           1     1283    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299      -0.67121   5.19224e-05     0.0344714      0.8749      0.8749     1387    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399       -0.6712   2.25829e-06     0.0504586      0.5523      0.5523     1499    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499      -0.67119   0.000105746      0.044807           1           1     1610    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.671183    6.6404e-05     0.0201559           1           1     1718    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.671179   4.05633e-05       0.03111      0.3361           1     1826    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.671177   5.17519e-06     0.0126422      0.4558      0.4558     1933    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899     -0.671176   6.07531e-06    0.00854175           1           1     2040    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1999     -0.671172   2.23863e-05     0.0130723      0.9811      0.9811     2146    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     2000     -0.671172   2.84895e-05     0.0123618           1           1     2147    
0/7: Optimization terminated normally:  
0/7:   Maximum number of iterations hit, may not be at an optima 
0/7: Finished in  0.8 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.8 seconds.
0/8: Initial log joint probability = -0.801846 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.798071    0.00148582      0.302796           1           1      105    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.795944   0.000587578      0.181919           1           1      210    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.795208   0.000391864      0.174206           1           1      319    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399      -0.79458   0.000393111      0.153827           1           1      422    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.793623   0.000667288      0.411411        0.38        0.38      530    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.792713   0.000795091      0.163849           1           1      637    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699     -0.792302   0.000515339      0.104189           1           1      742    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799     -0.792067   0.000159961      0.115059      0.4618           1      849    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899     -0.791838     0.0013606       0.19443           1           1      952    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999     -0.791447    0.00166919      0.425104           1           1     1063    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.791062   8.66612e-05     0.0445583           1           1     1173    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199        -0.791   0.000233323     0.0413838           1           1     1283    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.790886   0.000174352      0.106931      0.3053      0.3053     1386    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.790638   0.000771824      0.122196           1           1     1491    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499     -0.790528    0.00030237      0.101228           1           1     1595    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.790302   0.000311311     0.0660609           1           1     1699    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1699     -0.790181    0.00046475     0.0991422           1           1     1806    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1799     -0.790094   3.90901e-05     0.0539085           1           1     1911    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1899     -0.790041   0.000151723     0.0400898           1           1     2017    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1999     -0.790018   8.88088e-05     0.0382495           1           1     2122    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     2000     -0.790017   0.000135384     0.0604049           1           1     2123    
0/8: Optimization terminated normally:  
0/8:   Maximum number of iterations hit, may not be at an optima 
0/8: Finished in  0.9 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  13.9 seconds.
0/9: Initial log joint probability = -0.809754 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -0.80739   0.000119952      0.567047      0.6823      0.6823      106    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.806634   1.73977e-05      0.153824           1           1      215    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299     -0.806399    0.00117217      0.140218           1           1      322    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.806022   0.000931261      0.320504           1           1      427    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.805287   0.000706901      0.370735           1           1      534    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.804562    3.6937e-05      0.418767      0.7527      0.7527      645    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.802867    0.00294026      0.249655           1           1      753    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.802375   5.17128e-05     0.0939697           1           1      866    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899      -0.80194    0.00107484      0.286717           1           1      973    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.801716    6.3116e-05      0.122946      0.5148           1     1078    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.801631    3.7725e-05      0.166755      0.6902      0.6902     1182    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199     -0.801544    4.8423e-05      0.084707           1           1     1292    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.801523   2.46115e-05     0.0552619       0.343           1     1403    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.801498   0.000162887     0.0602934           1           1     1511    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.801439   3.10642e-05     0.0482741           1           1     1616    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.801414   0.000209556      0.133151           1           1     1726    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.801396   4.12692e-05     0.0340708           1           1     1833    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799      -0.80138   0.000107698     0.0383597           1           1     1942    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899     -0.801342   4.65049e-05     0.0482931           1           1     2051    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1999      -0.80133   5.89614e-06     0.0295899      0.2496      0.2496     2160    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     2000      -0.80133   3.11875e-05     0.0154391           1           1     2161    
0/9: Optimization terminated normally:  
0/9:   Maximum number of iterations hit, may not be at an optima 
0/9: Finished in  0.9 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  13.9 seconds.
0/10: Initial log joint probability = -0.752983 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.751296   0.000592346       0.14122           1           1      104    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.750902   0.000262869     0.0928512           1           1      210    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299     -0.750843   8.19036e-06     0.0134963           1           1      314    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.750838   1.28324e-06     0.0087739      0.6565      0.6565      417    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      472     -0.750837   9.46706e-06    0.00277884           1           1      494    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.3 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.3 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>prior_ma_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -59.6652    0.00258519       29.6712      0.6348      0.6348      105    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -57.9109     0.0161943       10.3675           1           1      213    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -57.4244     0.0029847       3.19251           1           1      324    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -57.3353    0.00342621       2.70799           1           1      429    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -57.3209   0.000117436      0.719843           1           1      538    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -57.3159   0.000451533       1.36515      0.3862      0.3862      648    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699       -57.315   9.10268e-05      0.200982      0.3307      0.3307      755    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      754      -57.3149   2.13051e-05     0.0492113           1           1      815    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.5 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  13.6 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -61.0463     0.0219478       18.2938           1           1      106    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -59.3859     0.0317724       15.9421           1           1      209    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -59.2377    0.00513392       1.44992           1           1      317    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -59.2233    0.00190134       1.07752           1           1      427    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -59.2216   0.000257951       0.25981           1           1      532    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599      -59.2214   2.90375e-05      0.099378      0.2878      0.2878      639    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      666      -59.2214   8.87405e-06     0.0242069      0.8345      0.8345      707    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.3 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  14.9 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -66.7797      0.016726       16.3124           1           1      104    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -65.5586    0.00344095       2.42916           1           1      210    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -65.4994   0.000339945      0.632382           1           1      316    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399      -65.4965   4.35947e-05      0.221928      0.6891      0.6891      421    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499      -65.4963   4.41656e-05     0.0507877           1           1      526    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      516      -65.4963   3.01383e-05     0.0324401           1           1      543    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.3 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  14.8 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -73.8193      0.016299       30.1594           1           1      105    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -70.0465    0.00256564       15.6009           1           1      214    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299        -69.55    0.00846263       9.10309           1           1      319    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -69.4268    0.00227821       1.59955           1           1      424    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -69.4126    0.00310744      0.785162           1           1      531    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -69.4065   0.000150884      0.562516           1           1      639    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699       -69.405   0.000272941      0.341395           1           1      748    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -69.4048   1.29034e-05      0.119513       0.678       0.678      855    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      833      -69.4048   6.54117e-06     0.0417608           1           1      893    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.5 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  14.5 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -58.7598    0.00127067       11.3705           1           1      104    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -57.6996    0.00220821       3.08291           1           1      211    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299       -57.632     0.0029264      0.972105           1           1      322    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399      -57.6222   0.000434293       0.29142           1           1      426    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499      -57.6214   0.000208811      0.147446           1           1      534    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      596      -57.6213   2.01644e-05     0.0266437           1           1      638    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.4 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.5 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -85.7285     0.0013167       428.449      0.6629      0.6629      124    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -82.3033    0.00803674       49.9696      0.6536      0.6536      246    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299       -79.036     0.0283828       217.142           1           1      376    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -77.2477       0.00162       20.1196           1           1      504    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -75.9963   0.000638342       41.3033           1           1      630    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -75.6707    0.00961784        28.779      0.1218           1      758    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -75.1888   0.000926025       12.8442      0.3884     0.03884      894    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -74.9308    0.00649992       142.195           1           1     1027    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -74.8096   0.000875112       33.9592      0.2368     0.02368     1155    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -74.7571     0.0105184       7.40681           1           1     1280    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -74.6478    0.00673078       16.4242           1           1     1407    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -74.5587   0.000205815        29.315      0.4646     0.04646     1538    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -74.5231    0.00149435       16.8667           1           1     1660    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -74.5029   0.000621251       3.77582           1           1     1794    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -74.4842    0.00111243       7.41589      0.6253      0.6253     1924    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -74.4764   1.28111e-05       2.34634      0.7156      0.7156     2043    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699       -74.473   0.000388974       6.57764           1           1     2164    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -74.4692   5.05471e-05       3.16833      0.2688      0.2688     2296    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -74.4663   0.000215706       2.27424       2.655      0.2655     2424    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -74.4623    0.00020838       4.31284      0.2347           1     2560    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -74.4623   0.000232432       3.66944       2.371      0.2371     2562    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.2 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  15.8 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -57.6017     0.0284697       24.6461           1           1      109    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -56.3809     0.0193553       14.4603           1           1      217    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -56.2599    0.00243703       2.54348           1           1      324    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -56.2506   0.000344782      0.455551           1           1      431    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499        -56.25   8.70273e-05      0.139007           1           1      538    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      593        -56.25   4.54998e-05     0.0274854           1           1      639    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.6 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  16.4 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -67.4744    0.00368297       28.7305      0.4551      0.4551      108    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -65.7952    0.00604727       6.91408           1           1      214    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -65.6399   0.000197035       2.96964      0.6888      0.6888      319    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399       -65.623   0.000137245      0.444065      0.8437      0.8437      426    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499      -65.6196   0.000147651      0.238385           1           1      532    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599      -65.6192   9.93014e-05      0.167163       0.237           1      639    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      633      -65.6192   1.78665e-05     0.0436252      0.5162           1      678    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.6 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.5 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -70.4071    0.00445931       11.0571           1           1      108    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -69.4772    0.00492844       6.23268           1           1      213    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -69.3304    0.00365497       6.05516           1           1      319    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -69.3005   6.58145e-05       1.05346      0.6893      0.6893      424    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -69.2943   0.000672783      0.520071           1           1      526    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599      -69.2932   0.000151983       0.18088           1           1      633    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699      -69.2931   1.84766e-05     0.0636146      0.9394      0.9394      738    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      716      -69.2931   8.69614e-06     0.0404994           1           1      755    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.4 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  16.2 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -68.1428    0.00143956       11.8669      0.7259      0.7259      106    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -67.6376     0.0024905       1.65469           1           1      210    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -67.6222   0.000783965      0.666077      0.9965      0.9965      317    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399      -67.6215   7.99548e-05     0.0660503           1           1      420    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      445      -67.6215   3.63863e-05     0.0267076           1           1      469    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.2 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.4 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691242 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.689915   0.000543579      0.395037           1           1      107    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.689144   0.000161143      0.218511      0.8859      0.8859      216    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -0.68793   0.000341851      0.546594      0.7549      0.7549      323    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.684952   0.000259685      0.419909           1           1      434    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.682129   0.000204298      0.776482           1           1      539    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.678538   0.000968887      0.675549           1           1      642    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699     -0.676787   0.000275111      0.274449           1           1      750    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.675899   0.000382022      0.241721           1           1      859    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.675626   0.000129989      0.134703           1           1      968    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.675418   0.000271833      0.181244      0.7512      0.7512     1080    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.675315    4.3129e-05     0.0912041           1           1     1186    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.675216   3.79928e-05       0.14997      0.3949      0.3949     1293    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.674993   9.02349e-05      0.100152           1           1     1401    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399     -0.674817   6.67078e-05     0.0761147           1           1     1505    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.674674   0.000214902      0.213101           1           1     1615    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.674395   5.45002e-05      0.179658      0.3693      0.3693     1724    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.674147   0.000443622      0.227463           1           1     1842    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799     -0.674036   8.12259e-05       0.07234           1           1     1946    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899     -0.673921   0.000106862      0.176563      0.6985      0.6985     2056    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.673724   0.000414755       0.21916           1           1     2163    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.673724   0.000764802       0.32721           1           1     2164    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  0.9 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  16.3 seconds.
0/2: Initial log joint probability = -0.733885 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.731606   0.000546298      0.462321      0.8536      0.8536      108    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199     -0.729893   0.000979088      0.260321           1           1      212    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299     -0.728453   0.000435381      0.248219           1           1      318    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.727572   0.000564013      0.280428           1           1      423    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.726801   0.000532194      0.192011           1           1      531    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599      -0.72611   3.60301e-05      0.208716      0.6989      0.6989      639    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.725767   0.000337658      0.126904           1           1      745    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.725608   5.45687e-05      0.104496           1           1      851    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899      -0.72553   0.000264484      0.184495      0.4145           1      959    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.725454    0.00035826      0.051639           1           1     1068    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.725413   5.05739e-05     0.0378354           1           1     1170    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.725378   0.000214101     0.0849369           1           1     1278    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299     -0.725347   0.000102379     0.0297734           1           1     1381    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399     -0.725337   3.12963e-05      0.022966           1           1     1483    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.725323   6.13712e-06     0.0231835      0.5266      0.5266     1590    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.725318   1.54779e-05     0.0297772      0.2538           1     1697    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.725309    0.00024694     0.0344167           1           1     1802    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799     -0.725293   0.000528751     0.0504353           1           1     1908    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899     -0.725268    0.00047433       0.06346           1           1     2014    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1999     -0.725258   3.21773e-05     0.0208827           1           1     2119    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     2000     -0.725258   3.79573e-05      0.020699           1           1     2120    
0/2: Optimization terminated normally:  
0/2:   Maximum number of iterations hit, may not be at an optima 
0/2: Finished in  1.0 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  15.6 seconds.
0/3: Initial log joint probability = -0.799595 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.797147    0.00136758       1.06304           1           1      103    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.795316    0.00234618      0.732791           1           1      208    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.793981   0.000117417      0.327984      0.6927      0.6927      311    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.793217    0.00101997      0.393018           1           1      418    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.792833   0.000269994      0.101713           1           1      521    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.792683   7.91805e-05     0.0669633           1           1      626    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.792604   0.000238959      0.147563      0.5106           1      733    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799     -0.792553   0.000141517     0.0542902           1           1      840    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      899     -0.792531   1.73603e-05     0.0199306           1           1      945    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      999     -0.792519   8.05865e-05     0.0453124           1           1     1051    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1099     -0.792514   2.45035e-05     0.0174531           1           1     1154    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1199     -0.792511   1.80252e-05     0.0195824      0.6878      0.6878     1258    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1299      -0.79251   8.67025e-06      0.007042           1           1     1362    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1326     -0.792509   6.03921e-06    0.00819112      0.9448      0.9448     1389    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.7 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  15.2 seconds.
0/4: Initial log joint probability = -0.871316 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -0.86714    0.00411465       1.83821           1           1      110    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -0.86297    0.00186538       1.00758           1           1      214    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299     -0.858287    0.00452127       2.04701           1           1      320    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399     -0.852755   0.000634107       1.18938      0.3445           1      430    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499     -0.849228   0.000403022      0.586443      0.7475      0.7475      536    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.844062    0.00950904        2.1276           1           1      642    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699     -0.837424    0.00222104       1.10996           1           1      743    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799       -0.8332    0.00104277      0.677584           1           1      851    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.829952    0.00287432      0.803998           1           1      956    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.828466   0.000269564      0.272706           1           1     1061    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.827317   0.000518485      0.353727           1           1     1173    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.826061   0.000263018      0.352797       0.954       0.954     1283    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.825098   0.000150954      0.231263           1           1     1388    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.824423   0.000122535      0.565393           1           1     1498    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.824121   0.000214353      0.163946           1           1     1604    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599       -0.8235   0.000441935       0.20104           1           1     1712    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.822889   0.000119362      0.318002           1           1     1819    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799     -0.822161    0.00180944      0.605584      0.9634      0.9634     1928    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.820825   0.000133617      0.444114      0.4981           1     2036    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.820518   0.000735245      0.205045           1           1     2144    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000      -0.82051   0.000968303      0.212712           1           1     2145    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  1.0 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  16.3 seconds.
0/5: Initial log joint probability = -0.729814 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.727231    0.00034319      0.547215      0.5123      0.5123      105    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.726504   0.000157777      0.138354           1           1      212    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.726192   2.67984e-05     0.0784506           1           1      317    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.726039   1.54326e-05     0.0619943           1           1      420    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499     -0.725946   0.000497402     0.0668556           1           1      527    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.725872   0.000167471     0.0800071      0.5239      0.5239      634    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.725844   5.88665e-05     0.0552776      0.2961           1      740    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.725833   1.39156e-05     0.0134904           1           1      846    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.725822   0.000264893     0.0565047           1           1      950    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      999     -0.725803   0.000109569     0.0540312      0.4229           1     1055    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1099     -0.725793   0.000172002     0.0641837           1           1     1160    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1199     -0.725785   5.83228e-06     0.0162887           1           1     1266    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1299     -0.725783   6.45823e-05    0.00863767           1           1     1372    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1399     -0.725781     2.971e-05     0.0214231           1           1     1476    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1499     -0.725779   4.75482e-05     0.0196078           1           1     1582    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1599     -0.725778   1.83533e-05    0.00727614           1           1     1690    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1665     -0.725778    1.2454e-06    0.00388234           1           1     1758    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.8 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  14.8 seconds.
0/6: Initial log joint probability = -0.917064 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916457   2.61168e-05      0.742067           1           1      131    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.915943    7.7028e-05      0.372469           1           1      268    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.915139   4.99516e-05       2.43336      0.3814      0.3814      390    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.914645   0.000165875      0.725195           1           1      516    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.913952    0.00031293       1.00713           1           1      654    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -0.91365   7.93356e-05      0.231666           1           1      782    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.913517   0.000153398      0.359604           1           1      907    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.913351   0.000121511      0.681146           1           1     1035    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.913265    2.1675e-05      0.438525      0.5874      0.5874     1163    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999     -0.913218   4.28101e-05      0.542229           1           1     1295    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.913151   0.000111995      0.237236      0.0581           1     1425    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.913053   0.000161846       1.60577           1           1     1557    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.912875   0.000580537      0.315889      0.6837      0.6837     1713    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.912832   2.32195e-06       1.14737     0.00718           1     1832    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.912799   5.45099e-05      0.245851      0.1874           1     1962    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.912769   2.33923e-05      0.151309           1           1     2096    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.912757   3.30595e-05      0.108901           1           1     2227    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.912727   7.97405e-05      0.336293      0.8432      0.8432     2346    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.912702   6.13874e-05      0.231435      0.2093     0.02093     2475    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -0.91264    6.6186e-05      0.130842           1           1     2612    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -0.91264    4.9798e-05      0.179677           1           1     2613    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.2 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  16.1 seconds.
0/7: Initial log joint probability = -0.679175 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.677326   0.000571169      0.450548           1           1      103    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199       -0.6764    9.3445e-05      0.354867      0.6212      0.6212      207    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.675536   0.000874287      0.681773           1           1      310    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.674916    0.00074949      0.193528           1           1      416    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.674329    0.00140212      0.186748           1           1      520    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.673955   0.000135609      0.149634           1           1      628    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.673703   0.000566081      0.180397           1           1      730    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.673537   0.000204275     0.0936974           1           1      833    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.673385   0.000254113       0.10885           1           1      938    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.673064   0.000437057      0.142903           1           1     1041    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099     -0.672899   0.000516813      0.168574           1           1     1146    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199      -0.67283   0.000244133      0.118237           1           1     1250    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299      -0.67275   4.21809e-05     0.0629056      0.8827      0.8827     1356    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.672699    4.0871e-05     0.0795317      0.5889      0.5889     1460    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.672671   2.80912e-05      0.057508      0.3448      0.3448     1568    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.672657   4.90634e-05     0.0575035      0.8064      0.8064     1672    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.672646   5.46871e-05     0.0322489           1           1     1776    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.672605   4.32113e-05     0.0536368           1           1     1879    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899     -0.672593    7.6868e-06     0.0261672      0.3984      0.3984     1986    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1999      -0.67259   8.48687e-05     0.0267552           1           1     2088    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     2000      -0.67259   6.85108e-05     0.0391609      0.3651           1     2090    
0/7: Optimization terminated normally:  
0/7:   Maximum number of iterations hit, may not be at an optima 
0/7: Finished in  1.0 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  15.5 seconds.
0/8: Initial log joint probability = -0.801846 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.799276     0.0010763      0.430542           1           1      104    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.797865   0.000416396      0.316722      0.3527           1      207    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -0.79685    0.00110544      0.339897           1           1      311    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.796398   0.000351374      0.153331           1           1      414    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.795882   0.000969331      0.268783           1           1      520    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.795453   9.11698e-05      0.187293           1           1      626    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699      -0.79525   4.54609e-05      0.156065      0.5344      0.5344      730    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799     -0.795079   5.00227e-05      0.114181      0.4753      0.4753      833    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899     -0.794901   0.000326364      0.229922      0.5245           1      941    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999     -0.794541   0.000515258      0.128219           1           1     1047    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.794311   0.000172849      0.108299           1           1     1150    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199     -0.794133   0.000169524      0.188637      0.8434      0.8434     1257    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.793881   6.47067e-05      0.126834           1           1     1364    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.793797   0.000226553     0.0895058           1           1     1469    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499     -0.793602   2.34373e-05      0.117483       0.916       0.916     1577    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.792922   0.000824515      0.174941           1           1     1685    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1699     -0.792399   0.000442624      0.252438      0.8349      0.8349     1789    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1799      -0.79228     6.345e-05     0.0776228           1           1     1895    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1899     -0.792219   5.72852e-05     0.0575687           1           1     2001    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1999     -0.792188   5.61296e-05     0.0315167           1           1     2107    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     2000     -0.792188   9.01253e-05     0.0509857           1           1     2108    
0/8: Optimization terminated normally:  
0/8:   Maximum number of iterations hit, may not be at an optima 
0/8: Finished in  1.0 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  17.1 seconds.
0/9: Initial log joint probability = -0.809754 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.807908   0.000671888      0.433926           1           1      104    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.807307   0.000257432      0.302866           1           1      212    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -0.80708   0.000233566      0.115971           1           1      322    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.806809   0.000119018      0.149407           1           1      425    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.806328    0.00045736      0.196738           1           1      534    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.805869   9.66033e-05      0.125782      0.7481      0.7481      639    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.805408    0.00192874      0.571854      0.4495           1      745    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.804954   0.000238936      0.168021           1           1      853    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.804545   4.91702e-05      0.132531           1           1      960    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.804467    0.00014013      0.102787           1           1     1066    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099      -0.80442   5.15699e-06      0.128273      0.5934      0.5934     1178    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199     -0.804267   0.000391611      0.192119       0.899       0.899     1286    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.803906   0.000699475      0.232938           1           1     1394    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.803408   0.000389707      0.326698           1           1     1500    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.803233   0.000138621      0.116572           1           1     1607    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.803079   5.90718e-05     0.0712222           1           1     1711    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.803066   2.12243e-05     0.0279058           1           1     1815    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799     -0.803049   9.15644e-05     0.0634398           1           1     1922    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899     -0.803017   8.65611e-05     0.0521057           1           1     2031    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1999     -0.802979   0.000111176     0.0977162           1           1     2134    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     2000     -0.802978   0.000185103     0.0653384           1           1     2135    
0/9: Optimization terminated normally:  
0/9:   Maximum number of iterations hit, may not be at an optima 
0/9: Finished in  1.0 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  17.1 seconds.
0/10: Initial log joint probability = -0.752984 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.751781   0.000189632      0.160077           1           1      104    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.751545   0.000333581     0.0978117           1           1      207    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299     -0.751514    7.3082e-05     0.0336547           1           1      313    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.751508   3.11296e-06    0.00979385      0.4178      0.4178      417    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      405     -0.751508   2.00713e-06    0.00391598           1           1      423    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.4 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  16.6 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>prior_ma_5 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -60.7868     0.0242142        26.885           1           1      106    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -59.0454    0.00456655       8.86303           1           1      213    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -58.4653   0.000606583       3.80753           1           1      318    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -58.2914   0.000810316       1.96412           1           1      423    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -58.2565    0.00124864       2.15845           1           1      529    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -58.2537   0.000162277      0.328452           1           1      637    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699       -58.253   6.03575e-05      0.292828      0.9421      0.9421      742    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799      -58.2529   0.000174368     0.0913411           1           1      856    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      874      -58.2528   2.88475e-05     0.0301278           1           1      936    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.7 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  14.4 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -62.5712     0.0195568       18.3421           1           1      107    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -60.2853    0.00723652       15.1108           1           1      213    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -59.9632    0.00168703       1.87497           1           1      318    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -59.9298   0.000898016       1.84552      0.3502      0.3502      425    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -59.9252   0.000787178      0.564301      0.9049      0.9049      531    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599      -59.9245   5.79313e-05     0.0993425           1           1      637    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699      -59.9244   4.13583e-05      0.070064           1           1      744    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      744      -59.9244   7.31261e-06     0.0262853           1           1      791    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.5 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  14.6 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -67.9474     0.0170471       23.6243           1           1      103    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -66.4419     0.0152461       18.7381           1           1      205    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -66.2853    0.00183914       1.88848      0.8871      0.8871      311    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399      -66.2711   0.000513194      0.525131           1           1      414    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499      -66.2701   0.000102769      0.142732           1           1      518    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      581        -66.27   6.63584e-06     0.0331407           1           1      603    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.4 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  16.6 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -75.5329     0.0200645       59.2681           1           1      107    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -71.5204     0.0053396       11.5714           1           1      216    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -70.8448    0.00166493       8.85156      0.8459      0.8459      321    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -70.4678    0.00347508       9.08493           1           1      427    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -70.3877    0.00256103       3.48945           1           1      535    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -70.3257    0.00259188       3.97708           1           1      641    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -70.3157    0.00096787      0.827488           1           1      748    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -70.3138   0.000172155      0.956238           1           1      851    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899      -70.3131   0.000103112      0.555106           1           1      957    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999      -70.3127    1.3607e-05        0.1394      0.5738      0.5738     1067    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1029      -70.3127   5.39455e-05     0.0537931           1           1     1101    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.7 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  15.9 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -60.6154     0.0216695       27.3811           1           1      104    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -58.7525    0.00355083       6.06998           1           1      208    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -58.5906    0.00129801       2.08735           1           1      317    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399      -58.5707   0.000863455      0.788936           1           1      420    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499      -58.5685   6.69279e-05      0.222176           1           1      527    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599      -58.5683   3.10618e-05      0.076275           1           1      632    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      641      -58.5683   8.93411e-05     0.0289496           1           1      676    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.5 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  14.0 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -87.0062    0.00365212        92.491      0.4659    0.004659      147    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -84.0609    0.00436219       244.424           1           1      266    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -81.5984    0.00171667       62.8493     0.07993      0.5393      404    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -80.1119    0.00212267        148.19           1           1      533    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -78.2955    0.00164887       26.8647      0.7323     0.07323      675    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -77.5173    0.00340562       123.412      0.2831           1      809    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -76.7838   0.000405365       15.5853           1           1      934    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -76.4703    0.00242581       49.8589           1           1     1060    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -76.3299    0.00108008       58.3958      0.0302      0.2182     1226    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -76.1073     0.0144332        151.39           1           1     1354    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099       -75.959    0.00212478       11.2058           1           1     1477    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -75.9179   0.000810569       32.1911      0.6995      0.6995     1610    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -75.8569    0.00130467       77.9838           1           1     1738    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -75.8051   0.000141709        3.8975      0.2049      0.8397     1860    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -75.7739    0.00132958       11.7175           1           1     2003    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -75.7318     0.0014298       10.3525       0.764       0.764     2131    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -75.7001     0.0014485       11.9354     0.06605           1     2270    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -75.6876   0.000553325       17.7078           1           1     2411    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -75.6656    0.00125277       5.57556      0.1282           1     2543    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -75.6569   0.000328046       6.54911      0.7834     0.07834     2667    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -75.6564    0.00194079       3.97271       0.525           1     2669    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.5 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  15.5 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -58.7883     0.0124115       40.7992      0.4607      0.4607      107    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -57.3412     0.0164795       29.2113           1           1      212    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299       -57.044   0.000818588       2.74206      0.2982           1      316    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -57.0134   0.000939279       1.01004           1           1      422    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499       -57.009   4.57774e-05      0.254948           1           1      530    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -57.0088   6.63773e-05      0.126681      0.9591      0.9591      640    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      654      -57.0087   1.12926e-05     0.0307352           1           1      698    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.4 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  15.4 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -68.0623    0.00314559       16.7405      0.8625      0.8625      106    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -66.3028    0.00262049       7.10205           1           1      211    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -66.0821   0.000503966        1.6717      0.7563      0.7563      317    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399      -66.0459    0.00116582       1.10632           1           1      421    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499      -66.0405   5.17884e-05      0.272587           1           1      524    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599      -66.0399   0.000355953      0.135048           1           1      636    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699      -66.0398   6.79012e-05     0.0830832      0.9143      0.9143      742    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      715      -66.0398   1.48974e-05       0.03151           1           1      759    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.5 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  15.2 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -71.5602     0.0160494        56.592           1           1      106    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -70.2175     0.0159855       19.4741       0.469           1      216    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -69.9238    0.00635772        4.3335           1           1      323    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -69.8599   0.000144424       3.33161      0.7569      0.7569      433    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -69.8443   0.000169082       1.07127           1           1      546    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599      -69.8413     0.0003447      0.722854           1           1      651    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699        -69.84   2.18739e-05      0.273403       0.719       0.719      764    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      781      -69.8399    5.0469e-05     0.0735715      0.3278           1      854    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.5 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  15.7 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -68.7607      0.028331       13.6746      0.9787      0.9787      103    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -68.1329   0.000636935       3.78035      0.2443      0.2443      209    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -68.1073   0.000915066       1.07696      0.4975      0.4975      312    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399      -68.1062    0.00033196      0.255635           1           1      418    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      465      -68.1062   3.83429e-06     0.0301439      0.7544      0.7544      486    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.3 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  16.6 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_5 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691243 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.690181   0.000182521      0.247012           1           1      106    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.689277   7.08972e-05      0.364001           1           1      209    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.688167   0.000157619      0.573452      0.5916      0.5916      319    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.686022    0.00314077       1.08315      0.9458      0.9458      427    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.682633    0.00107247      0.929005           1           1      533    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.679143     0.0147734       2.48081           1           1      643    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699     -0.676697    0.00095485      0.563212           1           1      754    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.675857   0.000560634      0.428644           1           1      861    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.675605   2.52902e-05      0.193497           1           1      968    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.675494   0.000236718      0.113029           1           1     1070    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.675411   0.000382862      0.284073           1           1     1177    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199      -0.67522    0.00182632      0.193794           1           1     1288    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.674856   0.000162328      0.328406      0.6725      0.6725     1394    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399     -0.674436    0.00350602      0.978549           1           1     1496    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.674152    1.7692e-05       0.12342           1           1     1605    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.674078   1.34232e-05     0.0420437           1           1     1724    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.674043   7.41438e-06     0.0615937      0.9125      0.9125     1831    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799      -0.67402   2.67207e-05     0.0340673           1           1     1936    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899      -0.67401   5.61012e-06     0.0161948      0.7781      0.7781     2045    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.674004   0.000125133     0.0854348           1           1     2150    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.674003   0.000157386     0.0453023           1           1     2151    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  1.2 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  16.3 seconds.
0/2: Initial log joint probability = -0.733885 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.732171   0.000496589      0.397253           1           1      106    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199     -0.730715   0.000210318      0.377309           1           1      217    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -0.72949    0.00196838      0.971969           1           1      321    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.728422   0.000299779      0.325125           1           1      428    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.727833   0.000101787      0.121457           1           1      538    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.727458   0.000648934      0.221212           1           1      643    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.727079   5.75498e-05       0.16518           1           1      755    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.726905   0.000119515     0.0749641           1           1      862    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899     -0.726842   7.03373e-05     0.0508689           1           1      967    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.726805   5.51138e-05     0.0448699           1           1     1073    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099      -0.72677   1.23236e-05     0.0673325           1           1     1183    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.726756   0.000171738     0.0860502           1           1     1292    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299     -0.726723    0.00034302     0.0642529           1           1     1395    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399     -0.726682   0.000225519     0.0580145           1           1     1501    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.726615   2.66519e-05     0.0493104      0.9064      0.9064     1609    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.726587   1.46758e-05     0.0875154      0.5514      0.5514     1716    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.726576   3.70602e-05     0.0286306      0.9349      0.9349     1822    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799     -0.726569   4.90527e-05     0.0226997           1           1     1926    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899     -0.726559   4.04963e-05     0.0321899           1           1     2030    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1999     -0.726552   0.000138286     0.0344256           1           1     2134    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     2000     -0.726552   0.000162911     0.0360539           1           1     2135    
0/2: Optimization terminated normally:  
0/2:   Maximum number of iterations hit, may not be at an optima 
0/2: Finished in  1.2 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  14.5 seconds.
0/3: Initial log joint probability = -0.799596 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.797626   0.000380318      0.533324           1           1      105    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.796362   0.000518624      0.326236           1           1      209    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.795925   0.000255501      0.331286           1           1      313    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.795759   7.80947e-05      0.105308           1           1      420    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.795679   0.000219662      0.150738           1           1      523    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.795658   2.65115e-05     0.0310908           1           1      623    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.795653   5.94871e-06     0.0098271           1           1      727    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799     -0.795651   1.87021e-05    0.00927687           1           1      835    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      882     -0.795651   6.51829e-06    0.00423194           1           1      921    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.6 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  15.9 seconds.
0/4: Initial log joint probability = -0.871317 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99     -0.868625    0.00140941      0.720476           1           1      109    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.865822   0.000313503       1.02086      0.3314      0.3314      217    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -0.86308    0.00102059      0.755215           1           1      324    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399     -0.857719    0.00129925      0.820655           1           1      431    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499     -0.851653    0.00174083       2.17451           1           1      537    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.847928    0.00081037      0.471782           1           1      650    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699     -0.846405   2.07262e-05      0.674487      0.5577      0.5577      759    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799     -0.845044   0.000144923       0.50619           1           1      864    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.843708   0.000755623       1.85887           1           1      969    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.841436   1.22233e-05      0.859473      0.7989      0.7989     1072    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.837848    0.00109906      0.635625           1           1     1179    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.836098   0.000546874       0.48758           1           1     1291    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.835271   0.000658294      0.530041       5.117      0.5117     1401    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.834427   9.91038e-05      0.257863           1           1     1508    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.834099   0.000226168      0.197514           1           1     1616    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599     -0.833263    0.00152105      0.557854      0.3748           1     1728    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.832082   4.98827e-05      0.715137      0.8022      0.8022     1838    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799     -0.830682   3.57183e-05      0.433539           1           1     1946    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.830164    0.00115432       1.07437           1           1     2047    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.829581   0.000625805       0.35019      0.9318      0.9318     2153    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000     -0.829574   0.000333689      0.452926           1           1     2154    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  1.4 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  17.1 seconds.
0/5: Initial log joint probability = -0.729815 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.727804   0.000259901      0.272671           1           1      103    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.726995   0.000291234      0.493506           1           1      207    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -0.72683   5.12177e-05      0.117331      0.3309      0.3309      310    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.726762   3.10692e-05     0.0494807           1           1      417    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499     -0.726709   0.000196667     0.0976579           1           1      522    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.726663   4.82789e-05     0.0346107           1           1      626    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.726649   3.18627e-06     0.0564173      0.5827      0.5827      731    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799      -0.72664   5.95326e-05     0.0556876           1           1      838    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.726633   6.20653e-05      0.031359      0.4783           1      944    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      999     -0.726625   0.000104768     0.0214844           1           1     1048    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1099      -0.72662   4.81251e-05     0.0337848           1           1     1150    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1199     -0.726618   9.40415e-05      0.018389           1           1     1254    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1299     -0.726617   6.54963e-06    0.00771643      0.5125      0.5125     1361    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1316     -0.726617   5.27763e-06    0.00350039           1           1     1378    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.8 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  14.9 seconds.
0/6: Initial log joint probability = -0.91709 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916619   4.00698e-05       1.48226    0.007882           1      131    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.916135   2.53777e-05      0.364633           1           1      264    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.915849   2.79465e-05      0.676609           1           1      399    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.915741   1.80478e-05      0.838099           1           1      517    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.915568    3.9792e-05      0.713369           1           1      647    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.915364   5.48455e-05       0.82145     0.01286           1      825    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.915149   0.000139287        1.3303      0.5488      0.5488      985    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.914815   2.60782e-06       1.45005           1           1     1113    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.914392   0.000175653      0.358032           1           1     1250    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999     -0.914328   6.65627e-06      0.947356      0.5482     0.05482     1394    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.914294   3.17839e-05      0.469961     0.08032           1     1519    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.914257   5.91285e-05      0.214702           1           1     1645    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.914224   3.53863e-05      0.481912      0.2135           1     1768    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399       -0.9142   4.02374e-05      0.647429           1           1     1951    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.914139   0.000132259       2.90537           1           1     2080    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.914077   9.39093e-06      0.419669      0.1907      0.1907     2217    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.913933   0.000356713      0.306583           1           1     2338    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.913897   4.97617e-06      0.522041      0.5779      0.5779     2477    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.913886   1.40661e-06       0.29877      0.3277     0.03277     2610    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.913869   1.04331e-05      0.150708           1           1     2745    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000     -0.913869   3.76848e-05      0.121496           1           1     2746    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.7 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  15.5 seconds.
0/7: Initial log joint probability = -0.679176 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.677661   0.000192378      0.287415           1           1      104    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.677014     0.0004326      0.813892           1           1      208    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.676336   0.000520038      0.196964           1           1      314    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.675909   0.000188328      0.160275           1           1      422    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.675586   9.85444e-05      0.198415           1           1      527    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.675213   0.000624947       0.30803           1           1      631    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.674711   0.000727111      0.317183      0.4181           1      739    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.674494    2.2912e-05      0.114093       0.498       0.498      848    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.674398   0.000675941      0.213899           1           1      954    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.674204   9.19142e-05      0.204166       0.588       0.588     1060    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099     -0.674048   0.000180858      0.121497           1           1     1167    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.673846   6.36774e-05      0.170847      0.4233           1     1274    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299     -0.673786   5.55014e-05     0.0803759           1           1     1379    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.673707   1.30692e-05     0.0678557           1           1     1487    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.673635   0.000132575      0.148439           1           1     1590    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.673599   2.44692e-06      0.102106      0.5583      0.5583     1696    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.673528   0.000159518      0.172984      0.5277      0.5277     1803    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.673491   9.30784e-05       0.10152       0.361       0.361     1907    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899     -0.673441   2.92277e-05      0.066444           1           1     2015    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1999     -0.673413   4.91887e-06     0.0188231           1           1     2123    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     2000     -0.673413   2.16614e-06     0.0231242           1           1     2124    
0/7: Optimization terminated normally:  
0/7:   Maximum number of iterations hit, may not be at an optima 
0/7: Finished in  1.3 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  16.0 seconds.
0/8: Initial log joint probability = -0.801847 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.799587    0.00013907        0.4883       0.948       0.948      105    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.798374   0.000328913      0.323732      0.8326      0.8326      212    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.797655   9.49071e-05      0.252864           1           1      317    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.797343   0.000153761      0.187418           1           1      421    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.797059   0.000134175      0.185389           1           1      527    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599      -0.79688   0.000400147       0.18897           1           1      633    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699     -0.796397   0.000388832      0.245207           1           1      739    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799      -0.79593   0.000765015      0.138885           1           1      846    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899     -0.795762   0.000445182      0.115519           1           1      956    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999      -0.79553   0.000273882       0.14949           1           1     1060    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.795005   0.000468185      0.369711      0.6889      0.6889     1165    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199     -0.794549    0.00217651      0.380811      0.4901           1     1274    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.794036    0.00136696      0.309035           1           1     1379    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.793789   0.000242772      0.145691           1           1     1483    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499      -0.79369   4.85326e-05     0.0729107      0.4627      0.4627     1590    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.793635   9.65218e-05     0.0665393      0.8593      0.8593     1700    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1699     -0.793598   0.000356018     0.0852645           1           1     1808    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1799     -0.793569   0.000155068      0.120384           1           1     1915    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1899     -0.793539   0.000207833     0.0959777        0.86        0.86     2019    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1999     -0.793487   3.35835e-05     0.0598199      0.7145      0.7145     2128    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     2000     -0.793486   1.97764e-05     0.0497773           1           1     2129    
0/8: Optimization terminated normally:  
0/8:   Maximum number of iterations hit, may not be at an optima 
0/8: Finished in  1.3 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  16.6 seconds.
0/9: Initial log joint probability = -0.809755 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.808376   0.000120705      0.492197      0.2706           1      109    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.807853   2.54783e-05      0.189679      0.8001      0.8001      214    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299     -0.807663   0.000203208      0.273551           1           1      322    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.807449   0.000175586      0.354518           1           1      427    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.807239   0.000206395      0.426237      0.4563           1      536    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.806789    0.00213282      0.431368           1           1      641    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.806022   0.000753096       0.40929           1           1      746    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.805231   0.000572235      0.403351      0.4732      0.4732      855    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.804902     0.0003682      0.328626           1           1      963    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999      -0.80476   0.000174831     0.0967764           1           1     1072    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.804615   0.000204193      0.188192           1           1     1184    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199      -0.80452   0.000137678      0.120089           1           1     1289    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.804366   0.000199507      0.191659           1           1     1396    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399      -0.80418   8.79925e-05      0.170029           1           1     1502    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499      -0.80396   6.02028e-05      0.120594           1           1     1609    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.803878   7.43834e-05     0.0449255           1           1     1712    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.803858   3.30573e-06       0.14446      0.6513      0.6513     1815    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799     -0.803811   0.000173799      0.124567           1           1     1923    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899     -0.803783   2.26719e-05     0.0515237           1           1     2031    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1999     -0.803742   0.000784556      0.376292           1           1     2138    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     2000     -0.803741   4.64196e-05      0.151669      0.5413      0.5413     2139    
0/9: Optimization terminated normally:  
0/9:   Maximum number of iterations hit, may not be at an optima 
0/9: Finished in  1.2 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  15.7 seconds.
0/10: Initial log joint probability = -0.752984 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -0.75212   0.000130309      0.278179           1           1      107    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.751863     6.416e-05      0.100699           1           1      211    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299     -0.751813   3.11436e-05     0.0497401      0.4676           1      315    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.751808   7.08158e-06     0.0139598           1           1      421    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499     -0.751807   9.40631e-06    0.00455752           1           1      527    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      507     -0.751807    6.5521e-06    0.00687783           1           1      535    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.3 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  16.0 seconds.</code></pre>
</div>
</div>
<section id="gradient-conditions" class="level4">
<h4 class="anchored" data-anchor-id="gradient-conditions">Gradient conditions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>p31<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(prior_ma_5<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>p32<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(noprior_ma_5<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>iresults <span class="ot">=</span> <span class="fu">rbind</span>(prior_ma_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>                prior_ma_2<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>                 prior_ma_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>                 prior_ma_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>),</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>                 prior_ma_5<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_5"</span>),</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_5<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_5"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ivar =</span> <span class="fu">if_else</span>(ivar<span class="sc">&gt;</span><span class="fl">1e6</span>,<span class="fl">1e6</span>,ivar)) <span class="sc">%&gt;%</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.factor</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB))</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">1000000</span>))<span class="sc">+</span>    </span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>idx_exemple_analytes <span class="ot">=</span> iresults <span class="sc">%&gt;%</span></span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">==</span><span class="st">"prior_ref"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ivar)<span class="sc">%&gt;%</span></span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which</span>(<span class="fu">row_number</span>() <span class="sc">%%</span> <span class="dv">100</span> <span class="sc">==</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(i)<span class="sc">%&gt;%</span><span class="fu">pull</span>()</span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>iresults <span class="sc">%&gt;%</span></span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-8e31984a{}.cl-8e22e34a{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8e28dbec{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8e28dc3c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8e291e86{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e291e9a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e291e9b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e291ea4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e291ea5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8e291eae{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-8e31984a"><thead><tr style="overflow-wrap:break-word;"><th class="cl-8e291e86"><p class="cl-8e28dbec"><span class="cl-8e22e34a">method</span></p></th><th class="cl-8e291e9a"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">&lt;=1x</span></p></th><th class="cl-8e291e9a"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">&lt;=2x</span></p></th><th class="cl-8e291e9a"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">&lt;=3x</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8e291e9b"><p class="cl-8e28dbec"><span class="cl-8e22e34a">noprior_3</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.000</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.450</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.692</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e291e9b"><p class="cl-8e28dbec"><span class="cl-8e22e34a">noprior_4</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.008</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.844</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.924</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e291e9b"><p class="cl-8e28dbec"><span class="cl-8e22e34a">noprior_5</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.692</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.908</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.944</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e291e9b"><p class="cl-8e28dbec"><span class="cl-8e22e34a">noprior_ref</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.000</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.424</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.742</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e291e9b"><p class="cl-8e28dbec"><span class="cl-8e22e34a">prior_2</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.022</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.192</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.488</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e291e9b"><p class="cl-8e28dbec"><span class="cl-8e22e34a">prior_3</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.082</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.668</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.842</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e291e9b"><p class="cl-8e28dbec"><span class="cl-8e22e34a">prior_4</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.114</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.970</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.986</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e291e9b"><p class="cl-8e28dbec"><span class="cl-8e22e34a">prior_5</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.890</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.968</span></p></td><td class="cl-8e291ea4"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.986</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8e291ea5"><p class="cl-8e28dbec"><span class="cl-8e22e34a">prior_ref</span></p></td><td class="cl-8e291eae"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.076</span></p></td><td class="cl-8e291eae"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.832</span></p></td><td class="cl-8e291eae"><p class="cl-8e28dc3c"><span class="cl-8e22e34a">0.992</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>f55_1<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">"target"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value,<span class="at">color=</span><span class="fu">as.factor</span>(target)))<span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Probability"</span>, <span class="at">y =</span> <span class="st">"Method"</span>, <span class="at">color =</span> <span class="st">"target"</span>)<span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.9</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>f55_1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prob.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>f55_1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prob.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prior-p5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-noprior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-noprior-p5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-maxvar.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-maxvar.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>p31</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-gra-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>p32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-gra-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-gra-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>f33_1<span class="ot">=</span>p33</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>f55_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-gra-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="isocratic-conditions" class="level4">
<h4 class="anchored" data-anchor-id="isocratic-conditions">Isocratic conditions</h4>
<section id="individual-plots" class="level5">
<h5 class="anchored" data-anchor-id="individual-plots">Individual plots</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>plot_id <span class="ot">=</span> <span class="cf">function</span>(results) { </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  results <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>CV<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">ymin =</span> llog10tr, <span class="at">ymax =</span> ulog10tr), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>mlog10tr), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"log(tr)"</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">10</span>, <span class="at">name=</span><span class="st">"%CV"</span>)) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(i<span class="sc">~</span>mod) <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>results_prior_ma_ref<span class="ot">&lt;-</span>prior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_ref<span class="ot">&lt;-</span>noprior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>results_prior_ma_2<span class="ot">&lt;-</span>prior_ma_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>results_prior_ma_3<span class="ot">&lt;-</span>prior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> mrgmisc<span class="sc">::</span><span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_3<span class="ot">&lt;-</span>noprior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>results_prior_ma_4<span class="ot">&lt;-</span>prior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_4<span class="ot">&lt;-</span>noprior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a>results_prior_ma_5<span class="ot">&lt;-</span>prior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_5<span class="ot">&lt;-</span>noprior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ref <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_ref,plot_id) </span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ref <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_ref,plot_id) </span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_2 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_2,plot_id) </span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_3 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_3,plot_id) </span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_3 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_3,plot_id) </span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_4 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_4,plot_id) </span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_4 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_4,plot_id) </span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_5 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_5,plot_id) </span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_5 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_5,plot_id) </span>
<span id="cb44-96"><a href="#cb44-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-97"><a href="#cb44-97" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ref.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ref.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_5[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_5[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ref </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ref </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_3 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-5.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-6.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-7.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_5  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-8.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_5 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-9.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combined" class="level5">
<h5 class="anchored" data-anchor-id="combined">Combined</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>plot_id <span class="ot">=</span> <span class="cf">function</span>(results) { </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  results <span class="sc">%&gt;%</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>CV)) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">ymin =</span> llog10tr, <span class="at">ymax =</span> ulog10tr), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>mlog10tr), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"log(tr)"</span>,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">1</span>, <span class="at">name=</span><span class="st">"%CV"</span>)) <span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(i<span class="sc">~</span>mod) <span class="sc">+</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>izoresults <span class="ot">=</span> <span class="fu">rbind</span>( prior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>                prior_ma_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>                 prior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>                 prior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>),</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>                 prior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_5"</span>),</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_5"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&lt;=</span><span class="fu">log10</span>(<span class="dv">100</span>))<span class="sc">%&gt;%</span></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&gt;=</span><span class="fu">log10</span>(<span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.numeric</span>(c),</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(i,method,c)<span class="sc">%&gt;%</span></span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(i,method) <span class="sc">%&gt;%</span></span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">imaxcv =</span> <span class="fu">max</span>(CV), <span class="at">imincv =</span> <span class="fu">min</span>(CV), <span class="at">aveCV =</span> pracma<span class="sc">::</span><span class="fu">trapz</span>(c, CV)<span class="sc">/</span>(<span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">imaxcv =</span> <span class="fu">if_else</span>(imaxcv<span class="sc">&gt;</span><span class="fl">1e4</span>,<span class="fl">1e4</span>,imaxcv))<span class="sc">%&gt;%</span></span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.integer</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB)) </span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">10000</span>))<span class="sc">+</span>    </span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-izo-combined-CV.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-izo-combined-CV.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-combined-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>f44_1 <span class="ot">=</span> p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" role="list">

</div>
</section>
<section id="licenses" class="level1 unnumbered">
<h1 class="unnumbered">Licenses</h1>
<ul>
<li>Code &amp; copy; 2024, Paweł Wiczling, licensed under BSD-3.</li>
<li>Text &amp; copy; 2024, Paweł Wiczling, licensed under CC-BY-NC 4.0.</li>
</ul>
</section>
<section id="original-computing-environment" class="level1 unnumbered">
<h1 class="unnumbered">Original Computing Environment</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.3 (2024-02-29)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 24.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: Europe/Warsaw
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] flextable_0.9.7     tibble_3.2.1        here_1.0.1         
 [4] reshape2_1.4.4      stringr_1.5.1       patchwork_1.3.0    
 [7] mrgmisc_0.2.1       purrr_1.0.2         tidyr_1.3.1        
[10] mvtnorm_1.3-1       ggplot2_3.5.1       dplyr_1.1.4        
[13] numDeriv_2016.8-1.1 pracma_2.4.4        cmdstanr_0.8.1     

loaded via a namespace (and not attached):
 [1] gtable_0.3.5            tensorA_0.36.2.1        xfun_0.48              
 [4] htmlwidgets_1.6.4       processx_3.8.4          vctrs_0.6.5            
 [7] tools_4.3.3             ps_1.8.0                generics_0.1.3         
[10] parallel_4.3.3          fansi_1.0.6             pkgconfig_2.0.3        
[13] data.table_1.16.2       checkmate_2.3.2         uuid_1.2-1             
[16] distributional_0.5.0    lifecycle_1.0.4         compiler_4.3.3         
[19] farver_2.1.2            textshaping_0.4.0       munsell_0.5.1          
[22] codetools_0.2-19        fontquiver_0.2.1        fontLiberation_0.1.0   
[25] htmltools_0.5.8.1       yaml_2.3.10             pillar_1.9.0           
[28] openssl_2.2.2           bettermc_1.2.2          abind_1.4-8            
[31] fontBitstreamVera_0.1.1 posterior_1.6.0         zip_2.3.1              
[34] tidyselect_1.2.1        digest_0.6.37           stringi_1.8.4          
[37] labeling_0.4.3          rprojroot_2.0.4         fastmap_1.2.0          
[40] grid_4.3.3              colorspace_2.1-1        cli_3.6.3              
[43] magrittr_2.0.3          utf8_1.2.4              withr_3.0.1            
[46] gdtools_0.4.0           scales_1.3.0            backports_1.5.0        
[49] rmarkdown_2.28          officer_0.6.7           askpass_1.2.1          
[52] ragg_1.3.3              evaluate_1.0.1          knitr_1.48             
[55] viridisLite_0.4.2       rlang_1.1.4             isoband_0.2.7          
[58] Rcpp_1.0.13             glue_1.8.0              xml2_1.3.6             
[61] rstudioapi_0.17.0       jsonlite_1.8.9          R6_2.5.1               
[64] plyr_1.8.9              systemfonts_1.1.0      </code></pre>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb67" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Design2: Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC"</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Paweł Wiczling*"</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co">      - name: "Department of Biopharmaceutics and Pharmacodynamics, Medical University of Gdańsk, Gen. J. Hallera 107, 80-416 Gdańsk, Poland"</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.Date())`"</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true  </span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 7</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 7</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setuphtml, include=FALSE}</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(cache=TRUE, message=FALSE, error=FALSE, warning=FALSE, comment=NA, out.width='95%')</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="in">#usethis::create_github_token()</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a><span class="in">library(cmdstanr)</span></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a><span class="in">library(pracma)</span></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a><span class="in">library(numDeriv)</span></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a><span class="in">library(mvtnorm)</span></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr)</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a><span class="in">library(purrr)</span></span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a><span class="in">library(mrgmisc)</span></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a><span class="in">library(patchwork)</span></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a><span class="in">library(stringr)</span></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a><span class="in">library(reshape2)</span></span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a><span class="in">library(here)</span></span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a><span class="in">library(tibble)</span></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a><span class="in">library(flextable)</span></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a><span class="in">select = dplyr::select</span></span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a><span class="in"># remotes::install_github("metrumresearchgroup/mrgmisc")</span></span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a><span class="in"># for parallel calculation use linux (mclaplly), i.e. Ubuntu 24.04 on Windows WSL</span></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a><span class="in"># usethis::edit_r_environ(), add PROCESSX_NOTIFY_OLD_SIGCHLD = 1 ????</span></span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a><span class="in">#' Helper functions</span></span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a><span class="in">source("helper_functions.R")</span></span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a><span class="in">```{r paths}</span></span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a><span class="in">#' folder shortcuts:</span></span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a><span class="in">figures_dir1 &lt;- here("deliv", "figures", "design2","N")</span></span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a><span class="in">tables_dir1  &lt;- here("deliv", "tables", "design2","N")</span></span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(figures_dir1)) dir.create(figures_dir1, recursive = T)</span></span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(tables_dir1)) dir.create(tables_dir1, recursive = T)</span></span>
<span id="cb67-55"><a href="#cb67-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-56"><a href="#cb67-56" aria-hidden="true" tabindex="-1"></a><span class="in">thisScript &lt;- "optimal-design-for-mixtures-design2"</span></span>
<span id="cb67-57"><a href="#cb67-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-58"><a href="#cb67-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-59"><a href="#cb67-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r helper-save-functions}</span></span>
<span id="cb67-60"><a href="#cb67-60" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave &lt;- function(.plot, .filename, .path=figures_dir, .height= 7, .width= 6) {</span></span>
<span id="cb67-61"><a href="#cb67-61" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(plot=.plot, filename=.filename, path=.path, height=.height, width=.width)</span></span>
<span id="cb67-62"><a href="#cb67-62" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb67-63"><a href="#cb67-63" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png &lt;- function(.plot, .filename, .path=figures_dir, .height=7, .width= 6) {</span></span>
<span id="cb67-64"><a href="#cb67-64" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(plot=.plot, filename=.filename, path=.path, height=.height, width=.width)</span></span>
<span id="cb67-65"><a href="#cb67-65" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb67-66"><a href="#cb67-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-67"><a href="#cb67-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-68"><a href="#cb67-68" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb67-69"><a href="#cb67-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-70"><a href="#cb67-70" aria-hidden="true" tabindex="-1"></a><span class="fu"># Priors</span></span>
<span id="cb67-71"><a href="#cb67-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-72"><a href="#cb67-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r literature-priors}</span></span>
<span id="cb67-73"><a href="#cb67-73" aria-hidden="true" tabindex="-1"></a><span class="in"># fun_generate_priors defined in helper_functions.R</span></span>
<span id="cb67-74"><a href="#cb67-74" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN_MeOH=fun_generate_priors("N_MeOH", logP=2.2)</span></span>
<span id="cb67-75"><a href="#cb67-75" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN_ACN=fun_generate_priors("N_ACN", logP=2.2)</span></span>
<span id="cb67-76"><a href="#cb67-76" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN=fun_generate_priors("N", logP=2.2)</span></span>
<span id="cb67-77"><a href="#cb67-77" aria-hidden="true" tabindex="-1"></a><span class="in">priorsA=fun_generate_priors("A", logP=2.2)</span></span>
<span id="cb67-78"><a href="#cb67-78" aria-hidden="true" tabindex="-1"></a><span class="in">priorsB=fun_generate_priors("B", logP=2.2)</span></span>
<span id="cb67-79"><a href="#cb67-79" aria-hidden="true" tabindex="-1"></a><span class="in">priorsNB=fun_generate_priors("NB", logP=2.2)</span></span>
<span id="cb67-80"><a href="#cb67-80" aria-hidden="true" tabindex="-1"></a><span class="in">priorsNA=fun_generate_priors("NA", logP=2.2)</span></span>
<span id="cb67-81"><a href="#cb67-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-82"><a href="#cb67-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-83"><a href="#cb67-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r design-space}</span></span>
<span id="cb67-84"><a href="#cb67-84" aria-hidden="true" tabindex="-1"></a><span class="in">hplcparam_candidates_df = expand_grid(tg=seq(10,270,by=10), </span></span>
<span id="cb67-85"><a href="#cb67-85" aria-hidden="true" tabindex="-1"></a><span class="in">                                          td=2.1, </span></span>
<span id="cb67-86"><a href="#cb67-86" aria-hidden="true" tabindex="-1"></a><span class="in">                                          to=0.532,</span></span>
<span id="cb67-87"><a href="#cb67-87" aria-hidden="true" tabindex="-1"></a><span class="in">                                          te=0.04, </span></span>
<span id="cb67-88"><a href="#cb67-88" aria-hidden="true" tabindex="-1"></a><span class="in">                                          fio = seq(0.05, 0.2, by=0.05),</span></span>
<span id="cb67-89"><a href="#cb67-89" aria-hidden="true" tabindex="-1"></a><span class="in">                                          fif = 0.8,</span></span>
<span id="cb67-90"><a href="#cb67-90" aria-hidden="true" tabindex="-1"></a><span class="in">                                          m=c(0,1),</span></span>
<span id="cb67-91"><a href="#cb67-91" aria-hidden="true" tabindex="-1"></a><span class="in">                                          xpH=c(0,1))</span></span>
<span id="cb67-92"><a href="#cb67-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-93"><a href="#cb67-93" aria-hidden="true" tabindex="-1"></a><span class="in">hplcparam_candidates_df&lt;-hplcparam_candidates_df%&gt;%</span></span>
<span id="cb67-94"><a href="#cb67-94" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(tg=tg/3)</span></span>
<span id="cb67-95"><a href="#cb67-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-96"><a href="#cb67-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-97"><a href="#cb67-97" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</span></span>
<span id="cb67-98"><a href="#cb67-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-99"><a href="#cb67-99" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile stan models</span></span>
<span id="cb67-100"><a href="#cb67-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-compilation}</span></span>
<span id="cb67-101"><a href="#cb67-101" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_gq= cmdstan_model("../stan/hplc-gra-single-form-analytes-gq.stan", stanc_options = list("O1"))</span></span>
<span id="cb67-102"><a href="#cb67-102" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_sim = cmdstan_model("../stan/hplc-gra-single-form-analytes-sim.stan", stanc_options = list("O1"))</span></span>
<span id="cb67-103"><a href="#cb67-103" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes = cmdstan_model("../stan/hplc-gra-single-form-analytes.stan", stanc_options = list("O1"))</span></span>
<span id="cb67-104"><a href="#cb67-104" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes$compile(compile_model_methods=TRUE,force_recompile=TRUE)</span></span>
<span id="cb67-105"><a href="#cb67-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-106"><a href="#cb67-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-107"><a href="#cb67-107" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulate retention times and create datasets</span></span>
<span id="cb67-108"><a href="#cb67-108" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-109"><a href="#cb67-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-simulations}</span></span>
<span id="cb67-110"><a href="#cb67-110" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma=hplcparam_candidates_df%&gt;%filter(xpH==0)</span></span>
<span id="cb67-111"><a href="#cb67-111" aria-hidden="true" tabindex="-1"></a><span class="in">nObs = nrow(data_ma);</span></span>
<span id="cb67-112"><a href="#cb67-112" aria-hidden="true" tabindex="-1"></a><span class="in">nAnalytes =50;</span></span>
<span id="cb67-113"><a href="#cb67-113" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = 1234;</span></span>
<span id="cb67-114"><a href="#cb67-114" aria-hidden="true" tabindex="-1"></a><span class="in">n_param = 3;</span></span>
<span id="cb67-115"><a href="#cb67-115" aria-hidden="true" tabindex="-1"></a><span class="in">n_rep = 10;</span></span>
<span id="cb67-116"><a href="#cb67-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-117"><a href="#cb67-117" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma=list()</span></span>
<span id="cb67-118"><a href="#cb67-118" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma=list()</span></span>
<span id="cb67-119"><a href="#cb67-119" aria-hidden="true" tabindex="-1"></a><span class="in">inits = list()</span></span>
<span id="cb67-120"><a href="#cb67-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-121"><a href="#cb67-121" aria-hidden="true" tabindex="-1"></a><span class="in">for (i in 1:n_rep) {</span></span>
<span id="cb67-122"><a href="#cb67-122" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]] = list(nObs=nObs,</span></span>
<span id="cb67-123"><a href="#cb67-123" aria-hidden="true" tabindex="-1"></a><span class="in">                   nAnalytes=nAnalytes,</span></span>
<span id="cb67-124"><a href="#cb67-124" aria-hidden="true" tabindex="-1"></a><span class="in">                   steps = 4 + 6*data_ma$m,</span></span>
<span id="cb67-125"><a href="#cb67-125" aria-hidden="true" tabindex="-1"></a><span class="in">                   hplcparam=as.matrix(data_ma%&gt;%dplyr::select(c(tg,td,to,te,fio,fif,m))),</span></span>
<span id="cb67-126"><a href="#cb67-126" aria-hidden="true" tabindex="-1"></a><span class="in">                   include_prior = 1,</span></span>
<span id="cb67-127"><a href="#cb67-127" aria-hidden="true" tabindex="-1"></a><span class="in">                   run_estimation=1,</span></span>
<span id="cb67-128"><a href="#cb67-128" aria-hidden="true" tabindex="-1"></a><span class="in">                   nSel = nObs,</span></span>
<span id="cb67-129"><a href="#cb67-129" aria-hidden="true" tabindex="-1"></a><span class="in">                   selected = 1:nObs)</span></span>
<span id="cb67-130"><a href="#cb67-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-131"><a href="#cb67-131" aria-hidden="true" tabindex="-1"></a><span class="in">fit_gq  = mod_analytes_gq$sample(data = datastruct_prior_ma[[i]],</span></span>
<span id="cb67-132"><a href="#cb67-132" aria-hidden="true" tabindex="-1"></a><span class="in">                                         seed = cseed,</span></span>
<span id="cb67-133"><a href="#cb67-133" aria-hidden="true" tabindex="-1"></a><span class="in">                                         fixed_param = TRUE,</span></span>
<span id="cb67-134"><a href="#cb67-134" aria-hidden="true" tabindex="-1"></a><span class="in">                                         chains = 1,</span></span>
<span id="cb67-135"><a href="#cb67-135" aria-hidden="true" tabindex="-1"></a><span class="in">                                         iter_sampling=1)</span></span>
<span id="cb67-136"><a href="#cb67-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-137"><a href="#cb67-137" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$trobs = matrix(fit_gq$draws(format = "matrix", variable = "y_hat_sim"),nAnalytes,nObs)</span></span>
<span id="cb67-138"><a href="#cb67-138" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$logPobs = fit_gq$draws(format = "matrix", variable = "logPobs")[1:nAnalytes]</span></span>
<span id="cb67-139"><a href="#cb67-139" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$N1A2B3 = fit_gq$draws(format = "matrix", variable = "N1A2B3")[1:nAnalytes]</span></span>
<span id="cb67-140"><a href="#cb67-140" aria-hidden="true" tabindex="-1"></a><span class="in">param = matrix(fit_gq$draws(format = "matrix", variable = "paramsim"),nAnalytes,3)</span></span>
<span id="cb67-141"><a href="#cb67-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-142"><a href="#cb67-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-143"><a href="#cb67-143" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma[[i]]=datastruct_prior_ma[[i]];</span></span>
<span id="cb67-144"><a href="#cb67-144" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma[[i]]$include_prior = 0.01;</span></span>
<span id="cb67-145"><a href="#cb67-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-146"><a href="#cb67-146" aria-hidden="true" tabindex="-1"></a><span class="in">inits[[i]]=param</span></span>
<span id="cb67-147"><a href="#cb67-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-148"><a href="#cb67-148" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = cseed+1</span></span>
<span id="cb67-149"><a href="#cb67-149" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb67-150"><a href="#cb67-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-151"><a href="#cb67-151" aria-hidden="true" tabindex="-1"></a><span class="in">mean_log_det_stan = function(data, init, chosen_indices, S){</span></span>
<span id="cb67-152"><a href="#cb67-152" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb67-153"><a href="#cb67-153" aria-hidden="true" tabindex="-1"></a><span class="in">init_ma = function(){list(param=init)}</span></span>
<span id="cb67-154"><a href="#cb67-154" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb67-155"><a href="#cb67-155" aria-hidden="true" tabindex="-1"></a><span class="in">data$selected = chosen_indices;</span></span>
<span id="cb67-156"><a href="#cb67-156" aria-hidden="true" tabindex="-1"></a><span class="in">data$nSel = length(chosen_indices);</span></span>
<span id="cb67-157"><a href="#cb67-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-158"><a href="#cb67-158" aria-hidden="true" tabindex="-1"></a><span class="in"> fit_opt  = mod_analytes$optimize(</span></span>
<span id="cb67-159"><a href="#cb67-159" aria-hidden="true" tabindex="-1"></a><span class="in">   data = data,</span></span>
<span id="cb67-160"><a href="#cb67-160" aria-hidden="true" tabindex="-1"></a><span class="in">   output_dir = here::here("stanfiles"),</span></span>
<span id="cb67-161"><a href="#cb67-161" aria-hidden="true" tabindex="-1"></a><span class="in">   output_basename = S,</span></span>
<span id="cb67-162"><a href="#cb67-162" aria-hidden="true" tabindex="-1"></a><span class="in">   seed = cseed,</span></span>
<span id="cb67-163"><a href="#cb67-163" aria-hidden="true" tabindex="-1"></a><span class="in">   init = init_ma,</span></span>
<span id="cb67-164"><a href="#cb67-164" aria-hidden="true" tabindex="-1"></a><span class="in">   jacobian = TRUE,</span></span>
<span id="cb67-165"><a href="#cb67-165" aria-hidden="true" tabindex="-1"></a><span class="in">   show_messages = F)</span></span>
<span id="cb67-166"><a href="#cb67-166" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb67-167"><a href="#cb67-167" aria-hidden="true" tabindex="-1"></a><span class="in"> mode=fit_opt$unconstrain_variables(list(param = fit_opt$mle("param")))</span></span>
<span id="cb67-168"><a href="#cb67-168" aria-hidden="true" tabindex="-1"></a><span class="in"> hessian = fit_opt$hessian(unconstrained_variables = mode)$hessian</span></span>
<span id="cb67-169"><a href="#cb67-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-170"><a href="#cb67-170" aria-hidden="true" tabindex="-1"></a><span class="in">logdet = unlist(purrr::map(1:data$nAnalytes,\(i) log(det(-hessian[((i-1)*3+1):((i-1)*3+3),((i-1)*3+1):((i-1)*3+3)]))))</span></span>
<span id="cb67-171"><a href="#cb67-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-172"><a href="#cb67-172" aria-hidden="true" tabindex="-1"></a><span class="in">return(logdet)</span></span>
<span id="cb67-173"><a href="#cb67-173" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb67-174"><a href="#cb67-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-175"><a href="#cb67-175" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(65,66,209,210)</span></span>
<span id="cb67-176"><a href="#cb67-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-177"><a href="#cb67-177" aria-hidden="true" tabindex="-1"></a><span class="in"># quick test:</span></span>
<span id="cb67-178"><a href="#cb67-178" aria-hidden="true" tabindex="-1"></a><span class="in">z_prior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan(datastruct_prior_ma[[i]], inits[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb67-179"><a href="#cb67-179" aria-hidden="true" tabindex="-1"></a><span class="in">z_noprior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan(datastruct_noprior_ma[[i]], inits[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb67-180"><a href="#cb67-180" aria-hidden="true" tabindex="-1"></a><span class="in">test = c(mean(unlist(z_prior)),mean(unlist(z_noprior)))</span></span>
<span id="cb67-181"><a href="#cb67-181" aria-hidden="true" tabindex="-1"></a><span class="in">test</span></span>
<span id="cb67-182"><a href="#cb67-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-183"><a href="#cb67-183" aria-hidden="true" tabindex="-1"></a><span class="in">logP = unlist(purrr::map(1:length(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]$logPobs))</span></span>
<span id="cb67-184"><a href="#cb67-184" aria-hidden="true" tabindex="-1"></a><span class="in">NAB = unlist(purrr::map(1:length(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]$N1A2B3))</span></span>
<span id="cb67-185"><a href="#cb67-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-186"><a href="#cb67-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-187"><a href="#cb67-187" aria-hidden="true" tabindex="-1"></a><span class="fu">## Optimization</span></span>
<span id="cb67-188"><a href="#cb67-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-optimization, eval=F}</span></span>
<span id="cb67-189"><a href="#cb67-189" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(213,214) # initial values</span></span>
<span id="cb67-190"><a href="#cb67-190" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-191"><a href="#cb67-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-192"><a href="#cb67-192" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(214,209,215) # initial values</span></span>
<span id="cb67-193"><a href="#cb67-193" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-194"><a href="#cb67-194" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(214,211,63) # initial values</span></span>
<span id="cb67-195"><a href="#cb67-195" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-196"><a href="#cb67-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-197"><a href="#cb67-197" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(209,210,215,79) # initial values</span></span>
<span id="cb67-198"><a href="#cb67-198" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-199"><a href="#cb67-199" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(209,210,215,71) # initial values</span></span>
<span id="cb67-200"><a href="#cb67-200" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-201"><a href="#cb67-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-202"><a href="#cb67-202" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(210,209,212,215,79) # initial values</span></span>
<span id="cb67-203"><a href="#cb67-203" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-204"><a href="#cb67-204" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(210,209,212,215,71) # initial values</span></span>
<span id="cb67-205"><a href="#cb67-205" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-206"><a href="#cb67-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-207"><a href="#cb67-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-208"><a href="#cb67-208" aria-hidden="true" tabindex="-1"></a><span class="fu">### Read the results and compare</span></span>
<span id="cb67-209"><a href="#cb67-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-logDet-read, eval=T}</span></span>
<span id="cb67-210"><a href="#cb67-210" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(65,66,209,210) # ref</span></span>
<span id="cb67-211"><a href="#cb67-211" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior= c(65,66,209,210) # ref</span></span>
<span id="cb67-212"><a href="#cb67-212" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb67-213"><a href="#cb67-213" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb67-214"><a href="#cb67-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-215"><a href="#cb67-215" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(209,212) # p=2</span></span>
<span id="cb67-216"><a href="#cb67-216" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb67-217"><a href="#cb67-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-218"><a href="#cb67-218" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(212,209,215) # p=3</span></span>
<span id="cb67-219"><a href="#cb67-219" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(212,209,71) # p=3</span></span>
<span id="cb67-220"><a href="#cb67-220" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb67-221"><a href="#cb67-221" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb67-222"><a href="#cb67-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-223"><a href="#cb67-223" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(209,212,215,71) # p=4</span></span>
<span id="cb67-224"><a href="#cb67-224" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(209,212,215,71) # p=4</span></span>
<span id="cb67-225"><a href="#cb67-225" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb67-226"><a href="#cb67-226" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb67-227"><a href="#cb67-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-228"><a href="#cb67-228" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(210,209,214,215,79) # p=5</span></span>
<span id="cb67-229"><a href="#cb67-229" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(210,209,216,215,71) # p=5</span></span>
<span id="cb67-230"><a href="#cb67-230" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb67-231"><a href="#cb67-231" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb67-232"><a href="#cb67-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-233"><a href="#cb67-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-234"><a href="#cb67-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-logDet-summary}</span></span>
<span id="cb67-235"><a href="#cb67-235" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results = tibble( logP = logP,</span></span>
<span id="cb67-236"><a href="#cb67-236" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb67-237"><a href="#cb67-237" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb67-238"><a href="#cb67-238" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb67-239"><a href="#cb67-239" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_2 = fws_prior_2$log_det_FIM,</span></span>
<span id="cb67-240"><a href="#cb67-240" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb67-241"><a href="#cb67-241" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb67-242"><a href="#cb67-242" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb67-243"><a href="#cb67-243" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb67-244"><a href="#cb67-244" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb67-245"><a href="#cb67-245" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb67-246"><a href="#cb67-246" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(prior_ref:noprior_5, names_to = "method")</span></span>
<span id="cb67-247"><a href="#cb67-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-248"><a href="#cb67-248" aria-hidden="true" tabindex="-1"></a><span class="in">p1&lt;-ggplot(summary_results, aes(y=method,x=value))+</span></span>
<span id="cb67-249"><a href="#cb67-249" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-250"><a href="#cb67-250" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=value, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-251"><a href="#cb67-251" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-252"><a href="#cb67-252" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="log(|FIM|)", y = "Method")</span></span>
<span id="cb67-253"><a href="#cb67-253" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb67-254"><a href="#cb67-254" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diff = tibble(logP = logP,</span></span>
<span id="cb67-255"><a href="#cb67-255" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb67-256"><a href="#cb67-256" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb67-257"><a href="#cb67-257" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb67-258"><a href="#cb67-258" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_2 = fws_prior_2$log_det_FIM,</span></span>
<span id="cb67-259"><a href="#cb67-259" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb67-260"><a href="#cb67-260" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb67-261"><a href="#cb67-261" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb67-262"><a href="#cb67-262" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb67-263"><a href="#cb67-263" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb67-264"><a href="#cb67-264" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb67-265"><a href="#cb67-265" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_prior_2 = (fws_prior_2 - fws_prior_ref)/n_param,</span></span>
<span id="cb67-266"><a href="#cb67-266" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_3 = (fws_prior_3 - fws_prior_ref)/n_param,</span></span>
<span id="cb67-267"><a href="#cb67-267" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_3 = (fws_noprior_3 - fws_noprior_ref)/n_param,</span></span>
<span id="cb67-268"><a href="#cb67-268" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_4 = (fws_prior_4 - fws_prior_ref)/n_param,</span></span>
<span id="cb67-269"><a href="#cb67-269" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_4 = (fws_noprior_4 - fws_noprior_ref)/n_param,</span></span>
<span id="cb67-270"><a href="#cb67-270" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_5 = (fws_prior_5 - fws_prior_ref)/n_param,</span></span>
<span id="cb67-271"><a href="#cb67-271" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_5 = (fws_noprior_5 - fws_noprior_ref)/n_param)%&gt;%</span></span>
<span id="cb67-272"><a href="#cb67-272" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_prior_2:d_noprior_5, names_to = "method")</span></span>
<span id="cb67-273"><a href="#cb67-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-274"><a href="#cb67-274" aria-hidden="true" tabindex="-1"></a><span class="in">p2=ggplot(summary_results_diff, aes(y=method,x=exp(value)))+</span></span>
<span id="cb67-275"><a href="#cb67-275" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-276"><a href="#cb67-276" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-277"><a href="#cb67-277" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-278"><a href="#cb67-278" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Efficiency relative to the reference design", y = "Method")+</span></span>
<span id="cb67-279"><a href="#cb67-279" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")</span></span>
<span id="cb67-280"><a href="#cb67-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-281"><a href="#cb67-281" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diffprior = tibble(logP = logP,</span></span>
<span id="cb67-282"><a href="#cb67-282" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb67-283"><a href="#cb67-283" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb67-284"><a href="#cb67-284" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb67-285"><a href="#cb67-285" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb67-286"><a href="#cb67-286" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb67-287"><a href="#cb67-287" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb67-288"><a href="#cb67-288" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb67-289"><a href="#cb67-289" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb67-290"><a href="#cb67-290" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb67-291"><a href="#cb67-291" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_ref  = (fws_prior_ref-fws_noprior_ref)/n_param,</span></span>
<span id="cb67-292"><a href="#cb67-292" aria-hidden="true" tabindex="-1"></a><span class="in">         d_3 = (fws_prior_3-fws_noprior_3)/n_param,</span></span>
<span id="cb67-293"><a href="#cb67-293" aria-hidden="true" tabindex="-1"></a><span class="in">         d_4 = (fws_prior_4-fws_noprior_4)/n_param,</span></span>
<span id="cb67-294"><a href="#cb67-294" aria-hidden="true" tabindex="-1"></a><span class="in">         d_5 = (fws_prior_5-fws_noprior_5)/n_param)%&gt;%</span></span>
<span id="cb67-295"><a href="#cb67-295" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_ref:d_5, names_to = "method")</span></span>
<span id="cb67-296"><a href="#cb67-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-297"><a href="#cb67-297" aria-hidden="true" tabindex="-1"></a><span class="in">p3=ggplot(summary_results_diffprior, aes(y=method,x=exp(value)))+</span></span>
<span id="cb67-298"><a href="#cb67-298" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-299"><a href="#cb67-299" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-300"><a href="#cb67-300" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-301"><a href="#cb67-301" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Effect of prior on design efficiency", y = "Method")+</span></span>
<span id="cb67-302"><a href="#cb67-302" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")+</span></span>
<span id="cb67-303"><a href="#cb67-303" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0.5,100),</span></span>
<span id="cb67-304"><a href="#cb67-304" aria-hidden="true" tabindex="-1"></a><span class="in">                     trans='log10',</span></span>
<span id="cb67-305"><a href="#cb67-305" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.01, 100)),</span></span>
<span id="cb67-306"><a href="#cb67-306" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb67-307"><a href="#cb67-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-308"><a href="#cb67-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-309"><a href="#cb67-309" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb67-310"><a href="#cb67-310" aria-hidden="true" tabindex="-1"></a><span class="in">p2</span></span>
<span id="cb67-311"><a href="#cb67-311" aria-hidden="true" tabindex="-1"></a><span class="in">p3</span></span>
<span id="cb67-312"><a href="#cb67-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-313"><a href="#cb67-313" aria-hidden="true" tabindex="-1"></a><span class="in">f2_1 = p2</span></span>
<span id="cb67-314"><a href="#cb67-314" aria-hidden="true" tabindex="-1"></a><span class="in">f3_1 = p3</span></span>
<span id="cb67-315"><a href="#cb67-315" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p1, .filename=paste("single-form-analytes-logdFIM-abs.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-316"><a href="#cb67-316" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p1, .filename=paste("single-form-analytes-logdFIM-abs.png"), .path = figures_dir1)</span></span>
<span id="cb67-317"><a href="#cb67-317" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p2, .filename=paste("single-form-analytes-logdFIM-rel.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-318"><a href="#cb67-318" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p2, .filename=paste("single-form-analytes-logdFIM-rel.png"), .path = figures_dir1)</span></span>
<span id="cb67-319"><a href="#cb67-319" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p3, .filename=paste("single-form-analytes-logdFIM-prioreff.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-320"><a href="#cb67-320" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p3, .filename=paste("single-form-analytes-logdFIM-prioreff.png"), .path = figures_dir1)</span></span>
<span id="cb67-321"><a href="#cb67-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-322"><a href="#cb67-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-323"><a href="#cb67-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-324"><a href="#cb67-324" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table</span></span>
<span id="cb67-325"><a href="#cb67-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-table}</span></span>
<span id="cb67-326"><a href="#cb67-326" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma=hplcparam_candidates_df%&gt;%filter(xpH==0)%&gt;%</span></span>
<span id="cb67-327"><a href="#cb67-327" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(line=1:n())</span></span>
<span id="cb67-328"><a href="#cb67-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-329"><a href="#cb67-329" aria-hidden="true" tabindex="-1"></a><span class="in">combined_results = list(</span></span>
<span id="cb67-330"><a href="#cb67-330" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ref = fws_prior_ref$chosen_indices,</span></span>
<span id="cb67-331"><a href="#cb67-331" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ref = fws_noprior_ref$chosen_indices,</span></span>
<span id="cb67-332"><a href="#cb67-332" aria-hidden="true" tabindex="-1"></a><span class="in">prior_2 = fws_prior_2$chosen_indices,</span></span>
<span id="cb67-333"><a href="#cb67-333" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_2 = 10000+fws_prior_2$chosen_indices, # dummy</span></span>
<span id="cb67-334"><a href="#cb67-334" aria-hidden="true" tabindex="-1"></a><span class="in">prior_3 = fws_prior_3$chosen_indices,</span></span>
<span id="cb67-335"><a href="#cb67-335" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_3 = fws_noprior_3$chosen_indices,</span></span>
<span id="cb67-336"><a href="#cb67-336" aria-hidden="true" tabindex="-1"></a><span class="in">prior_4 = fws_prior_4$chosen_indices,</span></span>
<span id="cb67-337"><a href="#cb67-337" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_4 = fws_noprior_4$chosen_indices,</span></span>
<span id="cb67-338"><a href="#cb67-338" aria-hidden="true" tabindex="-1"></a><span class="in">prior_5 = fws_prior_5$chosen_indices,</span></span>
<span id="cb67-339"><a href="#cb67-339" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_5 = fws_noprior_5$chosen_indices)</span></span>
<span id="cb67-340"><a href="#cb67-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-341"><a href="#cb67-341" aria-hidden="true" tabindex="-1"></a><span class="in">selected_exp = enframe(combined_results)%&gt;%</span></span>
<span id="cb67-342"><a href="#cb67-342" aria-hidden="true" tabindex="-1"></a><span class="in">   unnest(value) %&gt;%</span></span>
<span id="cb67-343"><a href="#cb67-343" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(line=value, Name = name) %&gt;%</span></span>
<span id="cb67-344"><a href="#cb67-344" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(data_ma, by = "line")%&gt;%</span></span>
<span id="cb67-345"><a href="#cb67-345" aria-hidden="true" tabindex="-1"></a><span class="in">   arrange(Name,tg, fio)%&gt;%</span></span>
<span id="cb67-346"><a href="#cb67-346" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Modifier = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb67-347"><a href="#cb67-347" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-c(line,xpH,m,td,to,te,fif)) %&gt;%</span></span>
<span id="cb67-348"><a href="#cb67-348" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(type = if_else(str_detect(Name, 'noprior'), "No prior", "Prior"))%&gt;%</span></span>
<span id="cb67-349"><a href="#cb67-349" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(where(is.numeric), ~replace_na(., -1)))</span></span>
<span id="cb67-350"><a href="#cb67-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-351"><a href="#cb67-351" aria-hidden="true" tabindex="-1"></a><span class="in">tab1&lt;-selected_exp %&gt;%</span></span>
<span id="cb67-352"><a href="#cb67-352" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "Prior") %&gt;%</span></span>
<span id="cb67-353"><a href="#cb67-353" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-type)%&gt;%</span></span>
<span id="cb67-354"><a href="#cb67-354" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb67-355"><a href="#cb67-355" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb67-356"><a href="#cb67-356" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb67-357"><a href="#cb67-357" aria-hidden="true" tabindex="-1"></a><span class="in">tab2&lt;-selected_exp %&gt;%</span></span>
<span id="cb67-358"><a href="#cb67-358" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "No prior")%&gt;%</span></span>
<span id="cb67-359"><a href="#cb67-359" aria-hidden="true" tabindex="-1"></a><span class="in">    select(-type)%&gt;%</span></span>
<span id="cb67-360"><a href="#cb67-360" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb67-361"><a href="#cb67-361" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb67-362"><a href="#cb67-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-363"><a href="#cb67-363" aria-hidden="true" tabindex="-1"></a><span class="in">tab2 &lt;- set_formatter(</span></span>
<span id="cb67-364"><a href="#cb67-364" aria-hidden="true" tabindex="-1"></a><span class="in">  tab2, </span></span>
<span id="cb67-365"><a href="#cb67-365" aria-hidden="true" tabindex="-1"></a><span class="in">  tg = function(x) ifelse(x==-1," ", sprintf("%.0f", x) ),</span></span>
<span id="cb67-366"><a href="#cb67-366" aria-hidden="true" tabindex="-1"></a><span class="in">  fio = function(x) ifelse(x==-1," ", sprintf("%.2f", x) )</span></span>
<span id="cb67-367"><a href="#cb67-367" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb67-368"><a href="#cb67-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-369"><a href="#cb67-369" aria-hidden="true" tabindex="-1"></a><span class="in">p1 = gen_grob(tab1, fit = "auto", just = "centre")</span></span>
<span id="cb67-370"><a href="#cb67-370" aria-hidden="true" tabindex="-1"></a><span class="in">p2 = gen_grob(tab2, fit = "auto", just = "centre") </span></span>
<span id="cb67-371"><a href="#cb67-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-372"><a href="#cb67-372" aria-hidden="true" tabindex="-1"></a><span class="in">gg&lt;-ggplot()+</span></span>
<span id="cb67-373"><a href="#cb67-373" aria-hidden="true" tabindex="-1"></a><span class="in">       theme(</span></span>
<span id="cb67-374"><a href="#cb67-374" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.background = element_rect(fill='transparent'),</span></span>
<span id="cb67-375"><a href="#cb67-375" aria-hidden="true" tabindex="-1"></a><span class="in">         plot.background = element_rect(fill='transparent', color=NA),</span></span>
<span id="cb67-376"><a href="#cb67-376" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.major = element_blank(),</span></span>
<span id="cb67-377"><a href="#cb67-377" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.minor = element_blank(),</span></span>
<span id="cb67-378"><a href="#cb67-378" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.background = element_rect(fill='transparent'),</span></span>
<span id="cb67-379"><a href="#cb67-379" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.box.background = element_rect(fill='transparent')</span></span>
<span id="cb67-380"><a href="#cb67-380" aria-hidden="true" tabindex="-1"></a><span class="in">       )</span></span>
<span id="cb67-381"><a href="#cb67-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-382"><a href="#cb67-382" aria-hidden="true" tabindex="-1"></a><span class="in">plot1 &lt;- gg+p1+p2+ plot_layout(ncol = 3, widths = c(1, 20,20))</span></span>
<span id="cb67-383"><a href="#cb67-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-384"><a href="#cb67-384" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plot1, .filename=paste("single-form-analytes-table.pdf"), .path = tables_dir1)</span></span>
<span id="cb67-385"><a href="#cb67-385" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plot1, .filename=paste("single-form-analytes-table.png"), .path = tables_dir1)</span></span>
<span id="cb67-386"><a href="#cb67-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-387"><a href="#cb67-387" aria-hidden="true" tabindex="-1"></a><span class="in">tab1</span></span>
<span id="cb67-388"><a href="#cb67-388" aria-hidden="true" tabindex="-1"></a><span class="in">tab2</span></span>
<span id="cb67-389"><a href="#cb67-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-390"><a href="#cb67-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-391"><a href="#cb67-391" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stan simulations</span></span>
<span id="cb67-392"><a href="#cb67-392" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-laplace, eval=T}</span></span>
<span id="cb67-393"><a href="#cb67-393" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_ref$chosen_indices # ref</span></span>
<span id="cb67-394"><a href="#cb67-394" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_ref = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-395"><a href="#cb67-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-396"><a href="#cb67-396" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_ref$chosen_indices # ref</span></span>
<span id="cb67-397"><a href="#cb67-397" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_ref = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-398"><a href="#cb67-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-399"><a href="#cb67-399" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_2$chosen_indices # p=2</span></span>
<span id="cb67-400"><a href="#cb67-400" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_2 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-401"><a href="#cb67-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-402"><a href="#cb67-402" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_3$chosen_indices # p=3</span></span>
<span id="cb67-403"><a href="#cb67-403" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_3 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-404"><a href="#cb67-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-405"><a href="#cb67-405" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_3$chosen_indices # p=3</span></span>
<span id="cb67-406"><a href="#cb67-406" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_3 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-407"><a href="#cb67-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-408"><a href="#cb67-408" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_4$chosen_indices # p=4</span></span>
<span id="cb67-409"><a href="#cb67-409" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_4 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-410"><a href="#cb67-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-411"><a href="#cb67-411" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_4$chosen_indices # p=4</span></span>
<span id="cb67-412"><a href="#cb67-412" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_4 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-413"><a href="#cb67-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-414"><a href="#cb67-414" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_5$chosen_indices # p=5</span></span>
<span id="cb67-415"><a href="#cb67-415" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_5 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-416"><a href="#cb67-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-417"><a href="#cb67-417" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_5$chosen_indices # p=5</span></span>
<span id="cb67-418"><a href="#cb67-418" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_5 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-419"><a href="#cb67-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-420"><a href="#cb67-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-421"><a href="#cb67-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-422"><a href="#cb67-422" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gradient conditions</span></span>
<span id="cb67-423"><a href="#cb67-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-gra-summary}</span></span>
<span id="cb67-424"><a href="#cb67-424" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_5$chosen_indices # p=5</span></span>
<span id="cb67-425"><a href="#cb67-425" aria-hidden="true" tabindex="-1"></a><span class="in">p31=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb67-426"><a href="#cb67-426" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0)%&gt;%</span></span>
<span id="cb67-427"><a href="#cb67-427" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb67-428"><a href="#cb67-428" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(prior_ma_5$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb67-429"><a href="#cb67-429" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb67-430"><a href="#cb67-430" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb67-431"><a href="#cb67-431" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb67-432"><a href="#cb67-432" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb67-433"><a href="#cb67-433" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb67-434"><a href="#cb67-434" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb67-435"><a href="#cb67-435" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_5$chosen_indices # p=5</span></span>
<span id="cb67-436"><a href="#cb67-436" aria-hidden="true" tabindex="-1"></a><span class="in">p32=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb67-437"><a href="#cb67-437" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0)%&gt;%</span></span>
<span id="cb67-438"><a href="#cb67-438" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb67-439"><a href="#cb67-439" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(noprior_ma_5$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb67-440"><a href="#cb67-440" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb67-441"><a href="#cb67-441" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb67-442"><a href="#cb67-442" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb67-443"><a href="#cb67-443" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb67-444"><a href="#cb67-444" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb67-445"><a href="#cb67-445" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb67-446"><a href="#cb67-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-447"><a href="#cb67-447" aria-hidden="true" tabindex="-1"></a><span class="in">iresults = rbind(prior_ma_ref$iresults%&gt;%</span></span>
<span id="cb67-448"><a href="#cb67-448" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb67-449"><a href="#cb67-449" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ref$iresults%&gt;%</span></span>
<span id="cb67-450"><a href="#cb67-450" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb67-451"><a href="#cb67-451" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_2$iresults%&gt;%</span></span>
<span id="cb67-452"><a href="#cb67-452" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb67-453"><a href="#cb67-453" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_3$iresults%&gt;%</span></span>
<span id="cb67-454"><a href="#cb67-454" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb67-455"><a href="#cb67-455" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_3$iresults%&gt;%</span></span>
<span id="cb67-456"><a href="#cb67-456" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb67-457"><a href="#cb67-457" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_4$iresults%&gt;%</span></span>
<span id="cb67-458"><a href="#cb67-458" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb67-459"><a href="#cb67-459" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_4$iresults%&gt;%</span></span>
<span id="cb67-460"><a href="#cb67-460" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4"),</span></span>
<span id="cb67-461"><a href="#cb67-461" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_5$iresults%&gt;%</span></span>
<span id="cb67-462"><a href="#cb67-462" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_5"),</span></span>
<span id="cb67-463"><a href="#cb67-463" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_5$iresults%&gt;%</span></span>
<span id="cb67-464"><a href="#cb67-464" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_5"))%&gt;%</span></span>
<span id="cb67-465"><a href="#cb67-465" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(ivar = if_else(ivar&gt;1e6,1e6,ivar)) %&gt;%</span></span>
<span id="cb67-466"><a href="#cb67-466" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.factor(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB))</span></span>
<span id="cb67-467"><a href="#cb67-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-468"><a href="#cb67-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-469"><a href="#cb67-469" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=iresults %&gt;%</span></span>
<span id="cb67-470"><a href="#cb67-470" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb67-471"><a href="#cb67-471" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-472"><a href="#cb67-472" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-473"><a href="#cb67-473" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-474"><a href="#cb67-474" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb67-475"><a href="#cb67-475" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb67-476"><a href="#cb67-476" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(0.1,100))+   </span></span>
<span id="cb67-477"><a href="#cb67-477" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb67-478"><a href="#cb67-478" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb67-479"><a href="#cb67-479" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb67-480"><a href="#cb67-480" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=iresults %&gt;%</span></span>
<span id="cb67-481"><a href="#cb67-481" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb67-482"><a href="#cb67-482" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-483"><a href="#cb67-483" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-484"><a href="#cb67-484" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-485"><a href="#cb67-485" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb67-486"><a href="#cb67-486" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb67-487"><a href="#cb67-487" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,1000000))+    </span></span>
<span id="cb67-488"><a href="#cb67-488" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb67-489"><a href="#cb67-489" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb67-490"><a href="#cb67-490" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb67-491"><a href="#cb67-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-492"><a href="#cb67-492" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb67-493"><a href="#cb67-493" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb67-494"><a href="#cb67-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-495"><a href="#cb67-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-496"><a href="#cb67-496" aria-hidden="true" tabindex="-1"></a><span class="in">idx_exemple_analytes = iresults %&gt;%</span></span>
<span id="cb67-497"><a href="#cb67-497" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(method=="prior_ref") %&gt;%</span></span>
<span id="cb67-498"><a href="#cb67-498" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(ivar)%&gt;%</span></span>
<span id="cb67-499"><a href="#cb67-499" aria-hidden="true" tabindex="-1"></a><span class="in">  slice(which(row_number() %% 100 == 1)) %&gt;%</span></span>
<span id="cb67-500"><a href="#cb67-500" aria-hidden="true" tabindex="-1"></a><span class="in">  select(i)%&gt;%pull()</span></span>
<span id="cb67-501"><a href="#cb67-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-502"><a href="#cb67-502" aria-hidden="true" tabindex="-1"></a><span class="in">iresults %&gt;%</span></span>
<span id="cb67-503"><a href="#cb67-503" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb67-504"><a href="#cb67-504" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb67-505"><a href="#cb67-505" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb67-506"><a href="#cb67-506" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb67-507"><a href="#cb67-507" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb67-508"><a href="#cb67-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-509"><a href="#cb67-509" aria-hidden="true" tabindex="-1"></a><span class="in">f55_1=iresults %&gt;%</span></span>
<span id="cb67-510"><a href="#cb67-510" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb67-511"><a href="#cb67-511" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb67-512"><a href="#cb67-512" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb67-513"><a href="#cb67-513" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb67-514"><a href="#cb67-514" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(`&lt;=1x`:`&lt;=3x`, names_to = "target") %&gt;%</span></span>
<span id="cb67-515"><a href="#cb67-515" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=value,color=as.factor(target)))+</span></span>
<span id="cb67-516"><a href="#cb67-516" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point()+</span></span>
<span id="cb67-517"><a href="#cb67-517" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Probability", y = "Method", color = "target")+</span></span>
<span id="cb67-518"><a href="#cb67-518" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 0.9, linetype="dotted")</span></span>
<span id="cb67-519"><a href="#cb67-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-520"><a href="#cb67-520" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=f55_1, .filename=paste("single-form-analytes-gra-prob.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-521"><a href="#cb67-521" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=f55_1, .filename=paste("single-form-analytes-gra-prob.png"), .path = figures_dir1)</span></span>
<span id="cb67-522"><a href="#cb67-522" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p31, .filename=paste("single-form-analytes-gra-prior-p5.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-523"><a href="#cb67-523" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p31, .filename=paste("single-form-analytes-gra-prior-p5.png"), .path = figures_dir1)</span></span>
<span id="cb67-524"><a href="#cb67-524" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p32, .filename=paste("single-form-analytes-gra-noprior-p5.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-525"><a href="#cb67-525" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p32, .filename=paste("single-form-analytes-gra-noprior-p5.png"), .path = figures_dir1)</span></span>
<span id="cb67-526"><a href="#cb67-526" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-gra-maxvar.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-527"><a href="#cb67-527" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-gra-maxvar.png"), .path = figures_dir1)</span></span>
<span id="cb67-528"><a href="#cb67-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-529"><a href="#cb67-529" aria-hidden="true" tabindex="-1"></a><span class="in">p31</span></span>
<span id="cb67-530"><a href="#cb67-530" aria-hidden="true" tabindex="-1"></a><span class="in">p32</span></span>
<span id="cb67-531"><a href="#cb67-531" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb67-532"><a href="#cb67-532" aria-hidden="true" tabindex="-1"></a><span class="in">f33_1=p33</span></span>
<span id="cb67-533"><a href="#cb67-533" aria-hidden="true" tabindex="-1"></a><span class="in">f55_1</span></span>
<span id="cb67-534"><a href="#cb67-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-535"><a href="#cb67-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-536"><a href="#cb67-536" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Isocratic conditions</span></span>
<span id="cb67-537"><a href="#cb67-537" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Individual plots</span></span>
<span id="cb67-538"><a href="#cb67-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-izo-summary}</span></span>
<span id="cb67-539"><a href="#cb67-539" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb67-540"><a href="#cb67-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-541"><a href="#cb67-541" aria-hidden="true" tabindex="-1"></a><span class="in">plot_id = function(results) { </span></span>
<span id="cb67-542"><a href="#cb67-542" aria-hidden="true" tabindex="-1"></a><span class="in">  results %&gt;%</span></span>
<span id="cb67-543"><a href="#cb67-543" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=fi, y=CV/10)) +</span></span>
<span id="cb67-544"><a href="#cb67-544" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb67-545"><a href="#cb67-545" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(aes(x=fi, ymin = llog10tr, ymax = ulog10tr), alpha = 0.4, col = NA) +</span></span>
<span id="cb67-546"><a href="#cb67-546" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x=fi, y=mlog10tr), col = "black", size=0.25) +</span></span>
<span id="cb67-547"><a href="#cb67-547" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_y_continuous(</span></span>
<span id="cb67-548"><a href="#cb67-548" aria-hidden="true" tabindex="-1"></a><span class="in">    name = "log(tr)",</span></span>
<span id="cb67-549"><a href="#cb67-549" aria-hidden="true" tabindex="-1"></a><span class="in">    sec.axis = sec_axis(~.*10, name="%CV")) +</span></span>
<span id="cb67-550"><a href="#cb67-550" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0,1,by=0.2))+</span></span>
<span id="cb67-551"><a href="#cb67-551" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_grid(i~mod) +</span></span>
<span id="cb67-552"><a href="#cb67-552" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 1, linetype=2)+</span></span>
<span id="cb67-553"><a href="#cb67-553" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim=c(0,4))</span></span>
<span id="cb67-554"><a href="#cb67-554" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb67-555"><a href="#cb67-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-556"><a href="#cb67-556" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_ref&lt;-prior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb67-557"><a href="#cb67-557" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-558"><a href="#cb67-558" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-559"><a href="#cb67-559" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-560"><a href="#cb67-560" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-561"><a href="#cb67-561" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-562"><a href="#cb67-562" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-563"><a href="#cb67-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-564"><a href="#cb67-564" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_ref&lt;-noprior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb67-565"><a href="#cb67-565" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-566"><a href="#cb67-566" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-567"><a href="#cb67-567" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-568"><a href="#cb67-568" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-569"><a href="#cb67-569" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-570"><a href="#cb67-570" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-571"><a href="#cb67-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-572"><a href="#cb67-572" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_2&lt;-prior_ma_2$izoresults%&gt;%</span></span>
<span id="cb67-573"><a href="#cb67-573" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-574"><a href="#cb67-574" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-575"><a href="#cb67-575" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-576"><a href="#cb67-576" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-577"><a href="#cb67-577" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-578"><a href="#cb67-578" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-579"><a href="#cb67-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-580"><a href="#cb67-580" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_3&lt;-prior_ma_3$izoresults%&gt;%</span></span>
<span id="cb67-581"><a href="#cb67-581" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-582"><a href="#cb67-582" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-583"><a href="#cb67-583" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-584"><a href="#cb67-584" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-585"><a href="#cb67-585" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = mrgmisc::ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-586"><a href="#cb67-586" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-587"><a href="#cb67-587" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_3&lt;-noprior_ma_3$izoresults%&gt;%</span></span>
<span id="cb67-588"><a href="#cb67-588" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-589"><a href="#cb67-589" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-590"><a href="#cb67-590" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-591"><a href="#cb67-591" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-592"><a href="#cb67-592" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-593"><a href="#cb67-593" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-594"><a href="#cb67-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-595"><a href="#cb67-595" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_4&lt;-prior_ma_4$izoresults%&gt;%</span></span>
<span id="cb67-596"><a href="#cb67-596" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-597"><a href="#cb67-597" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-598"><a href="#cb67-598" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-599"><a href="#cb67-599" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-600"><a href="#cb67-600" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-601"><a href="#cb67-601" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-602"><a href="#cb67-602" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_4&lt;-noprior_ma_4$izoresults%&gt;%</span></span>
<span id="cb67-603"><a href="#cb67-603" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-604"><a href="#cb67-604" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-605"><a href="#cb67-605" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-606"><a href="#cb67-606" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-607"><a href="#cb67-607" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-608"><a href="#cb67-608" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-609"><a href="#cb67-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-610"><a href="#cb67-610" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_5&lt;-prior_ma_5$izoresults%&gt;%</span></span>
<span id="cb67-611"><a href="#cb67-611" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-612"><a href="#cb67-612" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-613"><a href="#cb67-613" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-614"><a href="#cb67-614" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-615"><a href="#cb67-615" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-616"><a href="#cb67-616" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-617"><a href="#cb67-617" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_5&lt;-noprior_ma_5$izoresults%&gt;%</span></span>
<span id="cb67-618"><a href="#cb67-618" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-619"><a href="#cb67-619" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-620"><a href="#cb67-620" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-621"><a href="#cb67-621" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-622"><a href="#cb67-622" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-623"><a href="#cb67-623" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-624"><a href="#cb67-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-625"><a href="#cb67-625" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ref = map(results_prior_ma_ref,plot_id) </span></span>
<span id="cb67-626"><a href="#cb67-626" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ref = map(results_noprior_ma_ref,plot_id) </span></span>
<span id="cb67-627"><a href="#cb67-627" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_2 = map(results_prior_ma_2,plot_id) </span></span>
<span id="cb67-628"><a href="#cb67-628" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_3 = map(results_prior_ma_3,plot_id) </span></span>
<span id="cb67-629"><a href="#cb67-629" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_3 = map(results_noprior_ma_3,plot_id) </span></span>
<span id="cb67-630"><a href="#cb67-630" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_4 = map(results_prior_ma_4,plot_id) </span></span>
<span id="cb67-631"><a href="#cb67-631" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_4 = map(results_noprior_ma_4,plot_id) </span></span>
<span id="cb67-632"><a href="#cb67-632" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_5 = map(results_prior_ma_5,plot_id) </span></span>
<span id="cb67-633"><a href="#cb67-633" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_5 = map(results_noprior_ma_5,plot_id) </span></span>
<span id="cb67-634"><a href="#cb67-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-635"><a href="#cb67-635" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_ref[[1]], .filename=paste("plots-results-prior-ma-ref.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-636"><a href="#cb67-636" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_ref[[1]], .filename=paste("plots-results-prior-ma-ref.png"), .path = figures_dir1)</span></span>
<span id="cb67-637"><a href="#cb67-637" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_5[[1]], .filename=paste("plots-results-prior-ma-5.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-638"><a href="#cb67-638" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_5[[1]], .filename=paste("plots-results-prior-ma-5.png"), .path = figures_dir1)</span></span>
<span id="cb67-639"><a href="#cb67-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-640"><a href="#cb67-640" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ref </span></span>
<span id="cb67-641"><a href="#cb67-641" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ref </span></span>
<span id="cb67-642"><a href="#cb67-642" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_2</span></span>
<span id="cb67-643"><a href="#cb67-643" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_3</span></span>
<span id="cb67-644"><a href="#cb67-644" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_3 </span></span>
<span id="cb67-645"><a href="#cb67-645" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_4 </span></span>
<span id="cb67-646"><a href="#cb67-646" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_4 </span></span>
<span id="cb67-647"><a href="#cb67-647" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_5  </span></span>
<span id="cb67-648"><a href="#cb67-648" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_5 </span></span>
<span id="cb67-649"><a href="#cb67-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-650"><a href="#cb67-650" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb67-651"><a href="#cb67-651" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb67-652"><a href="#cb67-652" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb67-653"><a href="#cb67-653" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb67-654"><a href="#cb67-654" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb67-655"><a href="#cb67-655" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span>
<span id="cb67-656"><a href="#cb67-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-657"><a href="#cb67-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-658"><a href="#cb67-658" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Combined</span></span>
<span id="cb67-659"><a href="#cb67-659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-izo-summary-combined}</span></span>
<span id="cb67-660"><a href="#cb67-660" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb67-661"><a href="#cb67-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-662"><a href="#cb67-662" aria-hidden="true" tabindex="-1"></a><span class="in">plot_id = function(results) { </span></span>
<span id="cb67-663"><a href="#cb67-663" aria-hidden="true" tabindex="-1"></a><span class="in">  results %&gt;%</span></span>
<span id="cb67-664"><a href="#cb67-664" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=fi, y=CV)) +</span></span>
<span id="cb67-665"><a href="#cb67-665" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb67-666"><a href="#cb67-666" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(aes(x=fi, ymin = llog10tr, ymax = ulog10tr), alpha = 0.4, col = NA) +</span></span>
<span id="cb67-667"><a href="#cb67-667" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x=fi, y=mlog10tr), col = "black", size=0.25) +</span></span>
<span id="cb67-668"><a href="#cb67-668" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_y_continuous(</span></span>
<span id="cb67-669"><a href="#cb67-669" aria-hidden="true" tabindex="-1"></a><span class="in">    name = "log(tr)",</span></span>
<span id="cb67-670"><a href="#cb67-670" aria-hidden="true" tabindex="-1"></a><span class="in">    sec.axis = sec_axis(~.*1, name="%CV")) +</span></span>
<span id="cb67-671"><a href="#cb67-671" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0,1,by=0.2))+</span></span>
<span id="cb67-672"><a href="#cb67-672" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_grid(i~mod) +</span></span>
<span id="cb67-673"><a href="#cb67-673" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 1, linetype=2)+</span></span>
<span id="cb67-674"><a href="#cb67-674" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim=c(0,4))</span></span>
<span id="cb67-675"><a href="#cb67-675" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb67-676"><a href="#cb67-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-677"><a href="#cb67-677" aria-hidden="true" tabindex="-1"></a><span class="in">izoresults = rbind( prior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb67-678"><a href="#cb67-678" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb67-679"><a href="#cb67-679" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb67-680"><a href="#cb67-680" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb67-681"><a href="#cb67-681" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_2$izoresults%&gt;%</span></span>
<span id="cb67-682"><a href="#cb67-682" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb67-683"><a href="#cb67-683" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_3$izoresults%&gt;%</span></span>
<span id="cb67-684"><a href="#cb67-684" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb67-685"><a href="#cb67-685" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_3$izoresults%&gt;%</span></span>
<span id="cb67-686"><a href="#cb67-686" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb67-687"><a href="#cb67-687" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_4$izoresults%&gt;%</span></span>
<span id="cb67-688"><a href="#cb67-688" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb67-689"><a href="#cb67-689" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_4$izoresults%&gt;%</span></span>
<span id="cb67-690"><a href="#cb67-690" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4"),</span></span>
<span id="cb67-691"><a href="#cb67-691" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_5$izoresults%&gt;%</span></span>
<span id="cb67-692"><a href="#cb67-692" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_5"),</span></span>
<span id="cb67-693"><a href="#cb67-693" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_5$izoresults%&gt;%</span></span>
<span id="cb67-694"><a href="#cb67-694" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_5")) %&gt;%</span></span>
<span id="cb67-695"><a href="#cb67-695" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&lt;=log10(100))%&gt;%</span></span>
<span id="cb67-696"><a href="#cb67-696" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&gt;=log10(5))%&gt;%</span></span>
<span id="cb67-697"><a href="#cb67-697" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c = as.numeric(c),</span></span>
<span id="cb67-698"><a href="#cb67-698" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-699"><a href="#cb67-699" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(i,method,c)%&gt;%</span></span>
<span id="cb67-700"><a href="#cb67-700" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(i,method) %&gt;%</span></span>
<span id="cb67-701"><a href="#cb67-701" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(imaxcv = max(CV), imincv = min(CV), aveCV = pracma::trapz(c, CV)/(n()-1)) %&gt;%</span></span>
<span id="cb67-702"><a href="#cb67-702" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(imaxcv = if_else(imaxcv&gt;1e4,1e4,imaxcv))%&gt;%</span></span>
<span id="cb67-703"><a href="#cb67-703" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.integer(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB)) </span></span>
<span id="cb67-704"><a href="#cb67-704" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb67-705"><a href="#cb67-705" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=izoresults %&gt;%</span></span>
<span id="cb67-706"><a href="#cb67-706" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb67-707"><a href="#cb67-707" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-708"><a href="#cb67-708" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-709"><a href="#cb67-709" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb67-710"><a href="#cb67-710" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-711"><a href="#cb67-711" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb67-712"><a href="#cb67-712" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb67-713"><a href="#cb67-713" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(1,100))+   </span></span>
<span id="cb67-714"><a href="#cb67-714" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb67-715"><a href="#cb67-715" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb67-716"><a href="#cb67-716" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb67-717"><a href="#cb67-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-718"><a href="#cb67-718" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=izoresults %&gt;%</span></span>
<span id="cb67-719"><a href="#cb67-719" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb67-720"><a href="#cb67-720" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-721"><a href="#cb67-721" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-722"><a href="#cb67-722" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb67-723"><a href="#cb67-723" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-724"><a href="#cb67-724" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb67-725"><a href="#cb67-725" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb67-726"><a href="#cb67-726" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,10000))+    </span></span>
<span id="cb67-727"><a href="#cb67-727" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb67-728"><a href="#cb67-728" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb67-729"><a href="#cb67-729" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb67-730"><a href="#cb67-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-731"><a href="#cb67-731" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb67-732"><a href="#cb67-732" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb67-733"><a href="#cb67-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-734"><a href="#cb67-734" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-izo-combined-CV.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-735"><a href="#cb67-735" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-izo-combined-CV.png"), .path = figures_dir1)</span></span>
<span id="cb67-736"><a href="#cb67-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-737"><a href="#cb67-737" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb67-738"><a href="#cb67-738" aria-hidden="true" tabindex="-1"></a><span class="in">f44_1 = p33</span></span>
<span id="cb67-739"><a href="#cb67-739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-740"><a href="#cb67-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-741"><a href="#cb67-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-742"><a href="#cb67-742" aria-hidden="true" tabindex="-1"></a><span class="fu"># References {.unnumbered}</span></span>
<span id="cb67-743"><a href="#cb67-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-744"><a href="#cb67-744" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb67-745"><a href="#cb67-745" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-746"><a href="#cb67-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-747"><a href="#cb67-747" aria-hidden="true" tabindex="-1"></a><span class="fu"># Licenses {.unnumbered}</span></span>
<span id="cb67-748"><a href="#cb67-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-749"><a href="#cb67-749" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Code &amp; copy; 2024, Paweł Wiczling, licensed under BSD-3.</span>
<span id="cb67-750"><a href="#cb67-750" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Text &amp; copy; 2024, Paweł Wiczling, licensed under CC-BY-NC 4.0.</span>
<span id="cb67-751"><a href="#cb67-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-752"><a href="#cb67-752" aria-hidden="true" tabindex="-1"></a><span class="fu"># Original Computing Environment {.unnumbered}</span></span>
<span id="cb67-753"><a href="#cb67-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-754"><a href="#cb67-754" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sessionInfo}</span></span>
<span id="cb67-755"><a href="#cb67-755" aria-hidden="true" tabindex="-1"></a><span class="in">sessionInfo()</span></span>
<span id="cb67-756"><a href="#cb67-756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Paweł Wiczling*">
<meta name="dcterms.date" content="2024-12-22">

<title>Design2: Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="optimal-design-for-mixtures-design2_files/libs/clipboard/clipboard.min.js"></script>
<script src="optimal-design-for-mixtures-design2_files/libs/quarto-html/quarto.js"></script>
<script src="optimal-design-for-mixtures-design2_files/libs/quarto-html/popper.min.js"></script>
<script src="optimal-design-for-mixtures-design2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="optimal-design-for-mixtures-design2_files/libs/quarto-html/anchor.min.js"></script>
<link href="optimal-design-for-mixtures-design2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="optimal-design-for-mixtures-design2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="optimal-design-for-mixtures-design2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="optimal-design-for-mixtures-design2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="optimal-design-for-mixtures-design2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="optimal-design-for-mixtures-design2_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="optimal-design-for-mixtures-design2_files/libs/tabwid-1.1.3/tabwid.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#priors" id="toc-priors" class="nav-link" data-scroll-target="#priors">Priors</a></li>
  <li><a href="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" id="toc-stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" class="nav-link" data-scroll-target="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables">Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</a>
  <ul class="collapse">
  <li><a href="#compile-stan-models" id="toc-compile-stan-models" class="nav-link" data-scroll-target="#compile-stan-models">Compile stan models</a></li>
  <li><a href="#simulate-retention-times-and-create-datasets" id="toc-simulate-retention-times-and-create-datasets" class="nav-link" data-scroll-target="#simulate-retention-times-and-create-datasets">Simulate retention times and create datasets</a></li>
  <li><a href="#optimization" id="toc-optimization" class="nav-link" data-scroll-target="#optimization">Optimization</a>
  <ul class="collapse">
  <li><a href="#read-the-results-and-compare" id="toc-read-the-results-and-compare" class="nav-link" data-scroll-target="#read-the-results-and-compare">Read the results and compare</a></li>
  <li><a href="#table" id="toc-table" class="nav-link" data-scroll-target="#table">Table</a></li>
  </ul></li>
  <li><a href="#stan-simulations" id="toc-stan-simulations" class="nav-link" data-scroll-target="#stan-simulations">Stan simulations</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#licenses" id="toc-licenses" class="nav-link" data-scroll-target="#licenses">Licenses</a></li>
  <li><a href="#original-computing-environment" id="toc-original-computing-environment" class="nav-link" data-scroll-target="#original-computing-environment">Original Computing Environment</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Design2: Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Paweł Wiczling* </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Department of Biopharmaceutics and Pharmacodynamics, Medical University of Gdańsk, Gen.&nbsp;J. Hallera 107, 80-416 Gdańsk, Poland
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 22, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setup" class="level1">
<h1>Setup</h1>
<p>The packages we will use are listed below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(numDeriv)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mrgmisc)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>select <span class="ot">=</span> dplyr<span class="sc">::</span>select</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("metrumresearchgroup/mrgmisc")</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># for parallel calculation use linux (mclaplly), i.e. Ubuntu 24.04 on Windows WSL</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># usethis::edit_r_environ(), add PROCESSX_NOTIFY_OLD_SIGCHLD = 1 ????</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#' Helper functions</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"helper_functions.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' folder shortcuts:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>figures_dir1 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"figures"</span>, <span class="st">"design2"</span>,<span class="st">"N"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>tables_dir1  <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"tables"</span>, <span class="st">"design2"</span>,<span class="st">"N"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(figures_dir1)) <span class="fu">dir.create</span>(figures_dir1, <span class="at">recursive =</span> T)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(tables_dir1)) <span class="fu">dir.create</span>(tables_dir1, <span class="at">recursive =</span> T)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>thisScript <span class="ot">&lt;-</span> <span class="st">"optimal-design-for-mixtures-design2"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>my.ggsave <span class="ot">&lt;-</span> <span class="cf">function</span>(.plot, .filename, <span class="at">.path=</span>figures_dir, <span class="at">.height=</span> <span class="dv">7</span>, <span class="at">.width=</span> <span class="dv">6</span>) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot=</span>.plot, <span class="at">filename=</span>.filename, <span class="at">path=</span>.path, <span class="at">height=</span>.height, <span class="at">width=</span>.width)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>my.ggsave.png <span class="ot">&lt;-</span> <span class="cf">function</span>(.plot, .filename, <span class="at">.path=</span>figures_dir, <span class="at">.height=</span><span class="dv">7</span>, <span class="at">.width=</span> <span class="dv">6</span>) {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot=</span>.plot, <span class="at">filename=</span>.filename, <span class="at">path=</span>.path, <span class="at">height=</span>.height, <span class="at">width=</span>.width)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
</section>
<section id="priors" class="level1">
<h1>Priors</h1>
<p>Priors are based on the follwoing article “Comparison of Chromatographic Stationary Phases Using a Bayesian-Based Multilevel Model” by Paweł Wiczling and Agnieszka Kamedulska published in Analytical Chemistry 2024 96 (3), 1310-1319.</p>
<p>In this work a simplified approach is taken with the focus on the neutral, acidic and basic forms of an analytes and single chromatographic stationary phase - assuming the pKa and changes of pKa with organic modifier are known.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fun_generate_priors defined in helper_functions.R</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>priorsN_MeOH<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N_MeOH"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>priorsN_ACN<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N_ACN"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>priorsN<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>priorsA<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"A"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>priorsB<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"B"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>priorsNB<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"NB"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>priorsNA<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"NA"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here I consider a design space that consist of linear organic modifier gradients ranging from 9 to 270 min and organic modifier content ranging from 0.05 to 0.2 for MeOH and ACN.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>hplcparam_candidates_df <span class="ot">=</span> <span class="fu">expand_grid</span>(<span class="at">tg=</span><span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">270</span>,<span class="at">by=</span><span class="dv">10</span>), </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">td=</span><span class="fl">2.1</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">to=</span><span class="fl">0.532</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">te=</span><span class="fl">0.04</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fio =</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="at">by=</span><span class="fl">0.05</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fif =</span> <span class="fl">0.8</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">m=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">xpH=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>hplcparam_candidates_df<span class="ot">&lt;-</span>hplcparam_candidates_df<span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tg=</span>tg<span class="sc">/</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" class="level1">
<h1>Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</h1>
<section id="compile-stan-models" class="level2">
<h2 class="anchored" data-anchor-id="compile-stan-models">Compile stan models</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mod_analytes_gq<span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-gq.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mod_analytes_sim <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-sim.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>mod_analytes <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>mod_analytes<span class="sc">$</span><span class="fu">compile</span>(<span class="at">compile_model_methods=</span><span class="cn">TRUE</span>,<span class="at">force_recompile=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulate-retention-times-and-create-datasets" class="level2">
<h2 class="anchored" data-anchor-id="simulate-retention-times-and-create-datasets">Simulate retention times and create datasets</h2>
<p>Probability of occurrence 0.4 neutral, 0.3 A, 0.3 B with logP being sampled from 2.2+-2 and constrained between 0.5 and 7.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_ma<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>nObs <span class="ot">=</span> <span class="fu">nrow</span>(data_ma);</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>nAnalytes <span class="ot">=</span><span class="dv">50</span>;</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> <span class="dv">1234</span>;</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>n_param <span class="ot">=</span> <span class="dv">3</span>;</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>n_rep <span class="ot">=</span> <span class="dv">10</span>;</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_rep) {</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]] <span class="ot">=</span> <span class="fu">list</span>(<span class="at">nObs=</span>nObs,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nAnalytes=</span>nAnalytes,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">steps =</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>data_ma<span class="sc">$</span>m,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">hplcparam=</span><span class="fu">as.matrix</span>(data_ma<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(tg,td,to,te,fio,fif,m))),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">include_prior =</span> <span class="dv">1</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">run_estimation=</span><span class="dv">1</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nSel =</span> nObs,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="dv">1</span><span class="sc">:</span>nObs)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>fit_gq  <span class="ot">=</span> mod_analytes_gq<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> datastruct_prior_ma[[i]],</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> cseed,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">fixed_param =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">iter_sampling=</span><span class="dv">1</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">matrix</span>(fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"y_hat_sim"</span>),nAnalytes,nObs)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>logPobs <span class="ot">=</span> fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"logPobs"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>N1A2B3 <span class="ot">=</span> fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"N1A2B3"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>param <span class="ot">=</span> <span class="fu">matrix</span>(fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"paramsim"</span>),nAnalytes,<span class="dv">3</span>)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma[[i]]<span class="ot">=</span>datastruct_prior_ma[[i]];</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma[[i]]<span class="sc">$</span>include_prior <span class="ot">=</span> <span class="fl">0.01</span>;</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>inits[[i]]<span class="ot">=</span>param</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> cseed<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mean_log_det_stan <span class="ot">=</span> <span class="cf">function</span>(data, init, chosen_indices, S){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>init_ma <span class="ot">=</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">param=</span>init)}</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>selected <span class="ot">=</span> chosen_indices;</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>nSel <span class="ot">=</span> <span class="fu">length</span>(chosen_indices);</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a> fit_opt  <span class="ot">=</span> mod_analytes<span class="sc">$</span><span class="fu">optimize</span>(</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_dir =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"stanfiles"</span>),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_basename =</span> S,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>   <span class="at">seed =</span> cseed,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>   <span class="at">init =</span> init_ma,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">jacobian =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>   <span class="at">show_messages =</span> F)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a> mode<span class="ot">=</span>fit_opt<span class="sc">$</span><span class="fu">unconstrain_variables</span>(<span class="fu">list</span>(<span class="at">param =</span> fit_opt<span class="sc">$</span><span class="fu">mle</span>(<span class="st">"param"</span>)))</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a> hessian <span class="ot">=</span> fit_opt<span class="sc">$</span><span class="fu">hessian</span>(<span class="at">unconstrained_variables =</span> mode)<span class="sc">$</span>hessian</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>logdet <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span>data<span class="sc">$</span>nAnalytes,\(i) <span class="fu">log</span>(<span class="fu">det</span>(<span class="sc">-</span>hessian[((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">3</span>),((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">3</span>)]))))</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(logdet)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co"># quick test:</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>z_prior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan</span>(datastruct_prior_ma[[i]], inits[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>z_noprior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan</span>(datastruct_noprior_ma[[i]], inits[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(<span class="fu">unlist</span>(z_prior)),<span class="fu">mean</span>(<span class="fu">unlist</span>(z_noprior)))</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.06578 12.94333</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>logP <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]<span class="sc">$</span>logPobs))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>NAB <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]<span class="sc">$</span>N1A2B3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="optimization" class="level2">
<h2 class="anchored" data-anchor-id="optimization">Optimization</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">213</span>,<span class="dv">214</span>) <span class="co"># initial values</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fws_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">214</span>,<span class="dv">209</span>,<span class="dv">215</span>) <span class="co"># initial values</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>fws_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">214</span>,<span class="dv">211</span>,<span class="dv">63</span>) <span class="co"># initial values</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>fws_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">210</span>,<span class="dv">215</span>,<span class="dv">79</span>) <span class="co"># initial values</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>fws_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">210</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># initial values</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>fws_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">210</span>,<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">79</span>) <span class="co"># initial values</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>fws_prior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">210</span>,<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># initial values</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>fws_noprior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="read-the-results-and-compare" class="level3">
<h3 class="anchored" data-anchor-id="read-the-results-and-compare">Read the results and compare</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>) <span class="co"># ref</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>) <span class="co"># ref</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>fws_prior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>fws_noprior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">212</span>) <span class="co"># p=2</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>fws_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">212</span>,<span class="dv">209</span>,<span class="dv">215</span>) <span class="co"># p=3</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">212</span>,<span class="dv">209</span>,<span class="dv">71</span>) <span class="co"># p=3</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>fws_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>fws_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># p=4</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># p=4</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>fws_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>fws_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">210</span>,<span class="dv">209</span>,<span class="dv">214</span>,<span class="dv">215</span>,<span class="dv">79</span>) <span class="co"># p=5</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">210</span>,<span class="dv">209</span>,<span class="dv">216</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># p=5</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>fws_prior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>fws_noprior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>summary_results <span class="ot">=</span> <span class="fu">tibble</span>( <span class="at">logP =</span> logP,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_2 =</span> fws_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(prior_ref<span class="sc">:</span>noprior_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(summary_results, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value))<span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>value, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"log(|FIM|)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-logDet-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>summary_results_diff <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_2 =</span> fws_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_prior_2 =</span> (fws_prior_2 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_3 =</span> (fws_prior_3 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_3 =</span> (fws_noprior_3 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_4 =</span> (fws_prior_4 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_4 =</span> (fws_noprior_4 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_5 =</span> (fws_prior_5 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_5 =</span> (fws_noprior_5 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_prior_2<span class="sc">:</span>d_noprior_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diff, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Efficiency relative to the reference design"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>summary_results_diffprior <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_ref  =</span> (fws_prior_ref<span class="sc">-</span>fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_3 =</span> (fws_prior_3<span class="sc">-</span>fws_noprior_3)<span class="sc">/</span>n_param,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_4 =</span> (fws_prior_4<span class="sc">-</span>fws_noprior_4)<span class="sc">/</span>n_param,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_5 =</span> (fws_prior_5<span class="sc">-</span>fws_noprior_5)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_ref<span class="sc">:</span>d_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diffprior, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Effect of prior on design efficiency"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">100</span>),</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">100</span>)),</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-logDet-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-logDet-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-logDet-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>f2_1 <span class="ot">=</span> p2</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>f3_1 <span class="ot">=</span> p3</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-abs.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-abs.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-rel.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-rel.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-prioreff.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-prioreff.png"</span>), <span class="at">.path =</span> figures_dir1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="table" class="level3">
<h3 class="anchored" data-anchor-id="table">Table</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data_ma<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">line=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>combined_results <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="at">prior_ref =</span> fws_prior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="at">prior_2 =</span> fws_prior_2<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_2 =</span> <span class="dv">10000</span><span class="sc">+</span>fws_prior_2<span class="sc">$</span>chosen_indices, <span class="co"># dummy</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="at">prior_3 =</span> fws_prior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_3 =</span> fws_noprior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="at">prior_4 =</span> fws_prior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_4 =</span> fws_noprior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="at">prior_5 =</span> fws_prior_5<span class="sc">$</span>chosen_indices,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_5 =</span> fws_noprior_5<span class="sc">$</span>chosen_indices)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>selected_exp <span class="ot">=</span> <span class="fu">enframe</span>(combined_results)<span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">line=</span>value, <span class="at">Name =</span> name) <span class="sc">%&gt;%</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_ma, <span class="at">by =</span> <span class="st">"line"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">arrange</span>(Name,tg, fio)<span class="sc">%&gt;%</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(line,xpH,m,td,to,te,fif)) <span class="sc">%&gt;%</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Name, <span class="st">'noprior'</span>), <span class="st">"No prior"</span>, <span class="st">"Prior"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>tab1<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Prior"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>tab2<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"No prior"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">set_formatter</span>(</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  tab2, </span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">tg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%.0f"</span>, x) ),</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">fio =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, x) )</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab1, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab2, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>) </span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>, <span class="at">color=</span><span class="cn">NA</span>),</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>)</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> gg<span class="sc">+</span>p1<span class="sc">+</span>p2<span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-table.pdf"</span>), <span class="at">.path =</span> tables_dir1)</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-table.png"</span>), <span class="at">.path =</span> tables_dir1)</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>tab1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-2869d79e{}.cl-28603a40{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-28640a58{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-28640a6c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-28643834{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2864383e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2864383f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-28643848{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-28643849{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2864384a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-2869d79e"><thead><tr style="overflow-wrap:break-word;"><th class="cl-28643834"><p class="cl-28640a58"><span class="cl-28603a40">Name</span></p></th><th class="cl-2864383e"><p class="cl-28640a6c"><span class="cl-28603a40">tg</span></p></th><th class="cl-2864383e"><p class="cl-28640a6c"><span class="cl-28603a40">fio</span></p></th><th class="cl-28643834"><p class="cl-28640a58"><span class="cl-28603a40">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">prior_2</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40"></span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.05</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.10</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">prior_3</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40"></span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.05</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.10</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.20</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">prior_4</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40"></span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">29.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.20</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.05</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.10</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.20</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">prior_5</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40"></span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">33.00000</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.20</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.05</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.05</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.15</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.20</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">prior_ref</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40"></span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">29.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.05</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">29.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.05</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-28643848"><p class="cl-28640a6c"><span class="cl-28603a40">0.05</span></p></td><td class="cl-2864383f"><p class="cl-28640a58"><span class="cl-28603a40">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28643849"><p class="cl-28640a58"><span class="cl-28603a40"></span></p></td><td class="cl-2864384a"><p class="cl-28640a6c"><span class="cl-28603a40">89.66667</span></p></td><td class="cl-2864384a"><p class="cl-28640a6c"><span class="cl-28603a40">0.05</span></p></td><td class="cl-28643849"><p class="cl-28640a58"><span class="cl-28603a40">ACN</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-287d36b8{}.cl-2871e254{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2875deae{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2875deb8{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-28760820{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2876082a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-28760834{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-28760835{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2876083e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2876083f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-287d36b8"><thead><tr style="overflow-wrap:break-word;"><th class="cl-28760820"><p class="cl-2875deae"><span class="cl-2871e254">Name</span></p></th><th class="cl-2876082a"><p class="cl-2875deb8"><span class="cl-2871e254">tg</span></p></th><th class="cl-2876082a"><p class="cl-2875deb8"><span class="cl-2871e254">fio</span></p></th><th class="cl-28760820"><p class="cl-2875deae"><span class="cl-2871e254">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">noprior_2</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"></span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"> </span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"> </span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"> </span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"> </span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">noprior_3</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"></span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">30</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.20</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">90</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.05</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">90</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.10</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">noprior_4</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"></span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">30</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.20</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">90</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.05</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">90</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.10</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">90</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.20</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">noprior_5</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"></span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">30</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.20</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">90</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.05</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">90</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.05</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">90</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.20</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">90</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.20</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">noprior_ref</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254"></span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">30</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.05</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">30</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.05</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">90</span></p></td><td class="cl-28760835"><p class="cl-2875deb8"><span class="cl-2871e254">0.05</span></p></td><td class="cl-28760834"><p class="cl-2875deae"><span class="cl-2871e254">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2876083e"><p class="cl-2875deae"><span class="cl-2871e254"></span></p></td><td class="cl-2876083f"><p class="cl-2875deb8"><span class="cl-2871e254">90</span></p></td><td class="cl-2876083f"><p class="cl-2875deb8"><span class="cl-2871e254">0.05</span></p></td><td class="cl-2876083e"><p class="cl-2875deae"><span class="cl-2871e254">ACN</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
</section>
<section id="stan-simulations" class="level2">
<h2 class="anchored" data-anchor-id="stan-simulations">Stan simulations</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>prior_ma_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -55.1986     0.0207644       29.0122           1           1      111    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -52.6157    0.00705359        5.6937           1           1      219    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -52.3624    0.00449908        3.5244      0.4365           1      326    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -52.3317    0.00191967       1.30826           1           1      433    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -52.3206   0.000296174      0.253412           1           1      545    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -52.3203   0.000332973      0.136996           1           1      656    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      649      -52.3202   3.59661e-05     0.0325875           1           1      709    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.4 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  14.2 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99       -59.695    0.00633837       13.3036           1           1      108    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -58.3331    0.00267985       2.38167           1           1      210    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -58.2669    0.00380303       1.90241           1           1      315    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399       -58.261    0.00049692      0.331778           1           1      419    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -58.2607   9.08247e-05     0.0637155      0.9548      0.9548      531    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      540      -58.2606   1.95882e-05     0.0240999           1           1      575    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.4 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  14.0 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -63.4167     0.0171276       21.4853      0.4754      0.4754      104    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -62.1942    0.00196998       3.16348           1           1      208    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -62.1493    0.00025329      0.579037           1           1      314    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399      -62.1476   2.11413e-05     0.0550685           1           1      419    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      472      -62.1476   2.69311e-05     0.0370401           1           1      495    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.5 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  15.1 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -74.6935     0.0865685         48.94           1           1      111    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -71.1892     0.0220197       23.9147           1           1      218    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -70.3853    0.00345436       7.99886           1           1      327    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399       -70.179    0.00475604       3.09501           1           1      446    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -70.1351   0.000934566       2.88616           1           1      560    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -70.1244    0.00271002       2.71035           1           1      667    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -70.1188    0.00118372       1.02337           1           1      774    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -70.1174    0.00019278      0.303438       0.425           1      889    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      883      -70.1173   3.03773e-05     0.0793248           1           1      977    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.8 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  15.8 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -55.6403     0.0248083       13.2115           1           1      106    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -54.8952    0.00916906       1.58596           1           1      208    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -54.8702   0.000274354      0.334521           1           1      311    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399      -54.8694    2.4771e-05      0.102746      0.6232      0.6232      416    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      464      -54.8693   1.47898e-05     0.0173369           1           1      487    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.4 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.6 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -83.8665     0.0201275       701.765      0.1949           1      146    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199       -80.556    0.00559563       353.744           1           1      277    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299       -79.237    0.00140963       24.9607      0.6886      0.6886      416    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -78.4021    0.00188046         41.59           1           1      544    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -77.6367    0.00249748       100.493      0.3529           1      753    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -75.9858      0.016481       129.646           1           1      889    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -75.4599    0.00478218       127.736           1           1     1016    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799       -75.042   0.000731039       14.3038           1           1     1143    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -74.4631    0.00332966       66.7723      0.4701           1     1269    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -74.1801    0.00133218       114.802      0.3951           1     1404    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -73.9142    0.00153349       35.7335       0.735      0.0735     1546    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -73.4685     0.0185989        64.864        1.05       0.105     1683    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -72.3092       0.04719       19.4115      0.4373           1     1820    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -72.0844    0.00815644       10.4743       1.006      0.1006     2006    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -71.9763   0.000401341        11.283      0.3843      0.3843     2228    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -71.9346   0.000531161       5.18007       4.082      0.4082     2367    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -71.9008   0.000833827       29.1087      0.1027           1     2495    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799       -71.881    0.00110514       20.6678           1           1     2634    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -71.8136    0.00256838        5.5175           1           1     2761    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -71.7816    0.00111755       20.9917      0.3101           1     2894    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -71.7813   0.000205386       15.7735      0.3132      0.3132     2895    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.5 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  14.3 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -56.7437     0.0642913       24.7103           1           1      107    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -54.9147    0.00291028       7.34875      0.4013           1      216    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -54.7618    0.00467177       3.79492           1           1      321    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -54.7438   0.000566817      0.797726           1           1      427    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -54.7415   0.000201832      0.308041      0.3133           1      535    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -54.7414   7.03857e-05     0.0593546           1           1      639    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      623      -54.7414   1.82217e-05     0.0244075           1           1      665    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.4 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  13.9 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -65.0865     0.0214684       12.3943           1           1      105    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -64.1542     0.0116671       1.98524           1           1      213    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -64.1104   0.000575846      0.449954           1           1      321    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399      -64.1074   0.000399669      0.134227           1           1      430    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      487      -64.1073   3.63378e-05     0.0377633           1           1      524    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.4 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  17.1 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -69.3376    0.00373896       11.2214      0.9605      0.9605      109    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199       -68.012    0.00587445       4.64788           1           1      217    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -67.7892    0.00714139       7.64203           1           1      329    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -67.7576   0.000838544       2.08824           1           1      436    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -67.7536   0.000335914      0.483797       0.499           1      548    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599      -67.7532   0.000225926      0.130897           1           1      663    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      653      -67.7532   4.73522e-05     0.0440325           1           1      723    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.5 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  17.1 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -67.4525     0.0129135       6.58361           1           1      104    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -67.2552   0.000972185       1.13393       0.286           1      207    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -67.2519   0.000101146      0.111218           1           1      310    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      376      -67.2518   1.99093e-05       0.04016           1           1      391    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.3 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  15.2 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691242 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.688081    0.00055226      0.348172           1           1      108    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.686115   0.000506849      0.640458           1           1      212    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.683702   0.000955581      0.339361      0.8782      0.8782      319    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.679682    0.00189528      0.510169           1           1      429    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.672883   0.000370891       1.52075      0.2162      0.2162      537    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599       -0.6672   0.000527929      0.436448           1           1      645    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699     -0.665399   9.75605e-05      0.358131           1           1      753    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.664389   0.000326878      0.560998           1           1      867    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.663732   0.000624324      0.214694           1           1      975    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.661948    0.00194354      0.319453           1           1     1086    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.657253   0.000198864      0.525183           1           1     1191    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.653246   0.000291552      0.625276           1           1     1307    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.652404   4.19165e-05      0.110185           1           1     1416    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399     -0.651937   0.000370939      0.256475           1           1     1522    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.651539   0.000458555      0.203599           1           1     1625    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.650647    0.00113717      0.442279      0.9832      0.9832     1734    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.649836   0.000627751       0.23251           1           1     1842    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799     -0.648116    0.00289314      0.243515           1           1     1949    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899     -0.646628     0.0014396      0.496849      0.3507      0.3507     2053    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.645512   0.000208891      0.432097      0.1905      0.1905     2160    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000       -0.6455    0.00131681      0.280928           1           1     2161    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  1.1 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  16.8 seconds.
0/2: Initial log joint probability = -0.733885 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.731014   0.000110923      0.299271           1           1      104    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199     -0.728496   0.000401003      0.497141      0.3742      0.3742      208    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299     -0.726559   0.000818291      0.325887      0.4919      0.4919      320    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.725157    0.00583851       1.04063           1           1      426    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.723525   0.000242102      0.310906      0.7325      0.7325      532    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.722436   0.000397028      0.205568           1           1      638    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.721979   0.000362421      0.121923           1           1      744    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.721707   0.000180544     0.0879751           1           1      851    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899     -0.721492    0.00126297       0.14087           1           1      959    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.720824   5.19836e-05      0.183186           1           1     1063    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.720474   0.000560381      0.131576           1           1     1173    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.720003   0.000236368      0.221172      0.7398      0.7398     1277    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299      -0.71956   0.000747754      0.115916           1           1     1384    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399     -0.719184   0.000175146      0.150787           1           1     1495    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.718836   0.000496205      0.108376           1           1     1599    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.718691   0.000123784     0.0679625           1           1     1705    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.718641   0.000109367     0.0400595           1           1     1815    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799     -0.718609   0.000124235      0.057339           1           1     1919    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899     -0.718535   0.000249262      0.103845      0.2966           1     2026    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1999     -0.718476    0.00054935      0.132733           1           1     2130    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     2000     -0.718475   2.47939e-05     0.0809811      0.6662      0.6662     2131    
0/2: Optimization terminated normally:  
0/2:   Maximum number of iterations hit, may not be at an optima 
0/2: Finished in  1.5 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  14.0 seconds.
0/3: Initial log joint probability = -0.799594 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.794633    0.00200288      0.315104           1           1      105    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.791586    0.00105242      0.256551           1           1      211    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.790089     0.0018062      0.426789           1           1      318    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.789196   0.000179653      0.259974      0.6224      0.6224      422    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.788292   0.000824761      0.150553           1           1      524    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.787982   0.000221879     0.0523212           1           1      629    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.787909   8.10256e-05     0.0421733           1           1      732    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799     -0.787875   2.36453e-05     0.0267826           1           1      835    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      899     -0.787831   0.000912593     0.0845038           1           1      939    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      999     -0.787715   0.000191815     0.0847762           1           1     1042    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1099     -0.787667   0.000108329     0.0465237      0.4114           1     1147    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1199     -0.787649   8.87193e-05     0.0277504           1           1     1250    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1299     -0.787635   0.000404765     0.0544738      0.4815           1     1356    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1399     -0.787588    0.00131005      0.169692           1           1     1460    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1499     -0.787537   0.000554732      0.126308           1           1     1563    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1599     -0.787503   9.13247e-05     0.0323746      0.4501      0.4501     1668    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1699     -0.787495   7.74943e-05     0.0140421           1           1     1771    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1799     -0.787492   3.65095e-05    0.00941785           1           1     1874    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1899      -0.78749   3.42209e-05    0.00855706           1           1     1977    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1999     -0.787489   7.40282e-05     0.0175942           1           1     2082    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     2000     -0.787489   6.86438e-05    0.00973135           1           1     2083    
0/3: Optimization terminated normally:  
0/3:   Maximum number of iterations hit, may not be at an optima 
0/3: Finished in  1.5 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  14.8 seconds.
0/4: Initial log joint probability = -0.871316 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -0.86853    0.00276104      0.761961           1           1      109    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.865943   0.000207974       1.07355      0.6505      0.6505      217    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299     -0.861889    0.00276871       1.11975           1           1      325    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399     -0.855258   0.000264936       2.01976        0.43        0.43      430    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499     -0.849415    0.00100732       1.49424           1           1      534    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.847005   0.000925561       1.81506           1           1      646    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699     -0.845756    9.1258e-05      0.333756           1           1      758    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799     -0.844504   0.000216799      0.485936           1           1      865    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.842791    0.00199635       2.89113           1           1      970    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999      -0.83773     0.0005903       1.04726           1           1     1079    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.836129   0.000852425       1.28257           1           1     1189    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199      -0.83393    0.00162681      0.712753           1           1     1300    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.831657   0.000969364       0.78479      0.1792           1     1410    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.829682   0.000298386      0.499277      0.7512     0.07512     1522    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.828394   3.55741e-05      0.604741           1           1     1628    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599     -0.827149   0.000385219      0.397913           1           1     1737    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.826488    0.00130178       1.07894      0.3956           1     1845    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799     -0.825507   0.000529983      0.231695           1           1     1954    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.825027   0.000350409      0.234709           1           1     2063    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.823497    0.00251926      0.535715           1           1     2180    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000     -0.823465    0.00319295       1.36299           1           1     2181    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  1.2 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  15.9 seconds.
0/5: Initial log joint probability = -0.729813 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.725198   0.000712909      0.267672      0.8039      0.8039      107    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.724211   0.000464105      0.254281      0.8479      0.8479      217    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.723621   0.000409932      0.187835           1           1      324    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.722698    0.00138962      0.205684           1           1      429    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499     -0.722346    4.5241e-05      0.145259      0.6776      0.6776      533    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.721856     0.0010829      0.290389      0.4289           1      640    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.721266    0.00261332      0.666999           1           1      745    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.720718   6.98331e-05      0.157879      0.7662      0.7662      851    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899      -0.72028   3.66357e-05     0.0676887           1           1      955    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      999     -0.720117   0.000785863      0.140304           1           1     1060    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1099      -0.71993    0.00011015      0.120921       0.378       0.378     1166    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1199     -0.719575   0.000601494       0.14319           1           1     1271    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1299     -0.719132   0.000592195      0.259091           1           1     1375    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1399     -0.719038   0.000388103      0.102469           1           1     1483    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1499     -0.718883   0.000400865     0.0910377           1           1     1588    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1599     -0.718655   0.000139381      0.126739           1           1     1696    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1699     -0.718421    0.00105633      0.180712           1           1     1800    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1799     -0.718045   0.000108017     0.0639877      0.9373      0.9373     1905    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1899     -0.717883   0.000669996     0.0537641           1           1     2012    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1999     -0.717804   0.000152405     0.0665225           1           1     2123    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     2000     -0.717804   0.000177749      0.090059      0.4881           1     2125    
0/5: Optimization terminated normally:  
0/5:   Maximum number of iterations hit, may not be at an optima 
0/5: Finished in  1.1 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.9 seconds.
0/6: Initial log joint probability = -0.917079 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916319   0.000421171       4.92806      0.2941      0.2941      132    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.915806   0.000306816        10.835           1           1      269    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.915375   5.37328e-05       1.22318           1           1      396    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.914954   3.48763e-05      0.473401           1           1      523    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.914325   1.60813e-05      0.480749      0.4028     0.04028      689    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.914104   0.000133495       1.18528      0.2637    0.002637      944    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.913706   1.94443e-05      0.506166      0.7859      0.7859     1179    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.913566   7.72647e-06      0.996455     0.03588           1     1316    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.913507    3.1338e-05      0.451822     0.08152           1     1531    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999     -0.913298   1.24849e-05      0.549145           1           1     1679    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.913035   6.11401e-05      0.358444           1           1     1817    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.912266   0.000896295      0.880172           1           1     1975    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.911844   9.40095e-05       1.09052      0.3215     0.03215     2167    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.911551   0.000172147       3.06407      0.9144      0.9144     2319    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.911233   0.000218959        1.1885           1           1     2457    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.911041   0.000158412         1.051      0.6532      0.6532     2586    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.910551    0.00245065       2.04586           1           1     2712    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -0.91031    1.2666e-05      0.356332     0.08247           1     2840    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.910239   7.00143e-05       1.01203           1           1     2968    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.910162   1.04683e-05      0.322189      0.1315     0.01315     3256    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000     -0.910162   8.68204e-06      0.316344    0.001913           1     3261    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  2.0 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  14.5 seconds.
0/7: Initial log joint probability = -0.679174 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.677271   0.000947385        1.0698           1           1      105    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.675256    0.00154951      0.969448      0.2576           1      215    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.672979     0.0036415      0.323884           1           1      324    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.670727    0.00287946      0.789933      0.2193           1      436    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.668249    0.00224109      0.545719           1           1      541    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.666993   8.16863e-05      0.162586           1           1      644    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.666244   0.000234429      0.419479      0.5345      0.5345      749    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.665755    0.00033272      0.216842           1           1      857    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.665461   0.000351334      0.174114      0.5169           1      961    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.665257   0.000191398      0.158176      0.6581      0.6581     1066    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099      -0.66506   0.000152697      0.103687           1           1     1174    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.664959   0.000703392      0.138163           1           1     1279    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299     -0.664858   0.000358074       0.10068           1           1     1386    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.664683   0.000514418     0.0894108           1           1     1494    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.664509   0.000386539       0.09935           1           1     1599    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.664443   9.50748e-05     0.0678376           1           1     1702    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.664415   0.000290466     0.0996277           1           1     1803    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.664392   8.12557e-05     0.0246295           1           1     1910    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899     -0.664369   4.56273e-05     0.0387884           1           1     2013    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1999     -0.664342   0.000408779     0.0974058           1           1     2120    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     2000     -0.664342   0.000525331     0.0837069           1           1     2121    
0/7: Optimization terminated normally:  
0/7:   Maximum number of iterations hit, may not be at an optima 
0/7: Finished in  1.1 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.6 seconds.
0/8: Initial log joint probability = -0.801846 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.798024   0.000425056      0.328618           1           1      108    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.796719    0.00171429      0.269883           1           1      213    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.795419   7.71921e-05      0.232152      0.6573      0.6573      315    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.794087   0.000205233      0.296074      0.7159      0.7159      421    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499      -0.79263    0.00308557      0.276376           1           1      529    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.791296    0.00270326      0.377994           1           1      634    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699     -0.790165   5.79657e-05     0.0716757      0.9571      0.9571      743    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799     -0.789751   0.000141347     0.0622176           1           1      858    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899     -0.789268   0.000349692      0.270754      0.6502      0.6502      963    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999     -0.786915       0.00495      0.578855      0.4609      0.4609     1070    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.784771   0.000780256      0.223407           1           1     1176    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199     -0.784456   3.20734e-05     0.0628659           1           1     1285    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.784372   0.000349521     0.0607561           1           1     1391    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.784301    0.00017337      0.102395      0.5227           1     1497    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499     -0.784236   0.000800068     0.0619594           1           1     1606    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.784055   0.000757965      0.261184           1           1     1707    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1699     -0.783919   5.41228e-05     0.0704034      0.6317      0.6317     1811    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1799     -0.783875   7.40185e-05     0.0509111           1           1     1918    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1899     -0.783808   0.000200227     0.0431605      0.9953      0.9953     2023    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1999     -0.783741    0.00106638      0.057463           1           1     2132    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     2000      -0.78374   0.000437604     0.0718053           1           1     2133    
0/8: Optimization terminated normally:  
0/8:   Maximum number of iterations hit, may not be at an optima 
0/8: Finished in  1.1 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.6 seconds.
0/9: Initial log joint probability = -0.809754 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.807387   0.000211663       0.26846           1           1      106    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.806745   0.000371854       0.18912           1           1      212    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299     -0.805778    0.00450024      0.853886           1           1      318    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.803936   0.000587656      0.308235           1           1      426    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.802226   0.000263846      0.336054      0.3916           1      537    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.801174   5.54886e-05      0.200761           1           1      648    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.800936   0.000191121      0.204917           1           1      756    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.800259   0.000275393      0.234525           1           1      866    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.797107     0.0169163       1.47792           1           1      975    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.794384   0.000484488      0.583636           1           1     1086    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.793736   9.02579e-05      0.199897      0.8179      0.8179     1196    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199     -0.793621   0.000191267      0.173691           1           1     1303    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.793436   0.000831665      0.266755           1           1     1410    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.793359   0.000383048      0.119558           1           1     1520    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499      -0.79316   0.000324104      0.110001           1           1     1627    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.792919   0.000603268      0.189051           1           1     1729    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699      -0.79284   5.01643e-05     0.0572761           1           1     1836    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799     -0.792716    0.00031341      0.131792           1           1     1946    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899     -0.792335    0.00212313      0.249851           1           1     2054    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1999     -0.791644     0.0112344      0.441092           1           1     2162    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     2000     -0.791628    0.00290027      0.482524           1           1     2163    
0/9: Optimization terminated normally:  
0/9:   Maximum number of iterations hit, may not be at an optima 
0/9: Finished in  1.4 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  17.6 seconds.
0/10: Initial log joint probability = -0.752983 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.751594   0.000270083     0.0936388           1           1      104    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.751444   8.80704e-05     0.0632886           1           1      211    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299     -0.751403   9.04237e-05     0.0465968           1           1      319    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.751384   2.61707e-05     0.0246355           1           1      430    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499     -0.751372   4.41056e-05     0.0258884           1           1      534    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599     -0.751367   2.07034e-06    0.00477153      0.9776      0.9776      639    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      699     -0.751366   9.26511e-05      0.014671           1           1      747    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      799     -0.751362   1.70213e-05     0.0147846      0.5605      0.5605      852    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      860     -0.751362   1.49081e-06    0.00330589      0.9681      0.9681      917    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.9 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  16.4 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_2<span class="sc">$</span>chosen_indices <span class="co"># p=2</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>prior_ma_2 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99       -45.123     0.0578015       48.8893           1           1      105    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -41.9641   0.000328479       4.36158      0.7304      0.7304      211    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -41.7354    0.00863844       2.24684           1           1      317    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -41.7134    0.00127008       1.01916      0.6973      0.6973      425    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -41.7106    0.00316379       1.13341           1           1      529    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -41.7098   8.03084e-05     0.0563962           1           1      637    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      680      -41.7098   1.68884e-05     0.0177652           1           1      726    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.3 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  14.3 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -45.5272     0.0564793       19.3128      0.9709      0.9709      105    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -43.0751    0.00222322        3.0538           1           1      211    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -42.9064     0.0019943       2.18375      0.6688      0.6688      316    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399       -42.896   0.000238121      0.177718      0.9178      0.9178      419    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -42.8954   0.000130513     0.0529581           1           1      525    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      564      -42.8953   2.60177e-05      0.016046           1           1      593    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.2 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  13.6 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -52.9759     0.0383566       16.3816           1           1      103    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -48.9438     0.0041777       3.82367           1           1      210    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -48.6409    0.00114474       1.16023           1           1      317    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399      -48.6199   0.000542557       0.39249           1           1      421    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499      -48.6174   0.000313992       0.16703           1           1      528    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599      -48.6171   0.000295854     0.0783665      0.9817      0.9817      635    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      677       -48.617   2.74628e-05     0.0228356           1           1      718    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.3 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  13.2 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -67.1899    0.00667993       27.9071           1           1      106    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -61.5814      0.089779       19.0814           1           1      210    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -59.7074    0.00839593       6.19973           1           1      316    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -59.2567   0.000522933       3.26017           1           1      432    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -59.0432    0.00482981       4.78866           1           1      537    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -59.0116   0.000586456       1.13587       0.829       0.829      644    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -58.9986   0.000492775       1.28188           1           1      748    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -58.9934   0.000126623      0.431708           1           1      853    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899      -58.9925   0.000382348      0.217739       4.216      0.4216      968    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999       -58.992    0.00016024      0.301817      0.6637      0.6637     1075    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099      -58.9919   0.000150783      0.107219           1           1     1179    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1117      -58.9919    2.2723e-05     0.0896803      0.9473      0.9473     1198    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.4 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  14.1 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -40.0393     0.0708466       35.8009           1           1      106    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -37.1118     0.0226855       5.85399           1           1      211    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -36.8668   0.000546582      0.868747           1           1      315    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399      -36.8443    0.00127958      0.224943           1           1      417    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499      -36.8424   0.000206949      0.114445      0.5093      0.5093      521    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599      -36.8423   5.41071e-05     0.0472717      0.2863           1      626    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      641      -36.8423   5.72157e-05     0.0123001           1           1      670    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.2 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  12.9 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -81.8348     0.0688916       636.502      0.3381           1      144    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -72.5279    0.00289049       195.401      0.7252      0.7252      271    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -66.8287    0.00457904       76.3598           1           1      399    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -64.7589    0.00219607       31.7065           1           1      530    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -62.9131   0.000558948       44.2225         2.1       0.021      660    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -61.8625    0.00875561       74.4565      0.6335      0.6335      785    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -60.8966    0.00594057       29.7929       2.164      0.2164      908    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -60.0563    0.00187875       37.4977       1.471      0.1471     1030    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -59.4119    0.00185913       77.2036      0.0334           1     1157    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -58.9222   0.000840774       11.9275           1           1     1285    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -58.7039   0.000304665       27.2606           1           1     1421    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199       -58.414     0.0118792       171.368           1           1     1550    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -58.2085    0.00275511       19.3958      0.2207           1     1687    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -58.0629    0.00454725       33.3051           1           1     1803    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -57.8963   0.000957397       7.65947           1           1     1966    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -57.8259    0.00050192        25.548      0.5672      0.5672     2096    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -57.7637    0.00381468       82.6867       0.159           1     2225    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -57.7105   0.000560583       4.37881           1           1     2360    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -57.6808    0.00101275       5.85055           1           1     2483    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -57.6386   0.000547888       61.2632      0.2759           1     2613    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -57.6382   0.000200808       51.5024      0.2786      0.2786     2614    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  0.8 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  14.4 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -44.3862    0.00587858       22.3563      0.5927      0.5927      107    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -40.2407     0.0069056       7.22375           1           1      216    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -39.8371    0.00964202       4.70356      0.3044           1      322    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -39.7503   0.000997297      0.544028           1           1      431    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -39.7379   0.000348396      0.372665           1           1      535    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -39.7365   5.12289e-05     0.0897564           1           1      644    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      677      -39.7364   2.75223e-05     0.0194915           1           1      727    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.4 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  15.1 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99       -52.965      0.324095       97.6992           1           1      105    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -47.9318    0.00422177       5.52393           1           1      209    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -47.5757    0.00810166       4.07573           1           1      314    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399      -47.5509   0.000741642      0.744782           1           1      418    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499      -47.5496   0.000279353      0.223413      0.6108      0.6108      525    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599      -47.5494   0.000176726     0.0384802           1           1      632    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      629      -47.5494   2.04579e-05     0.0148625           1           1      663    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.3 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  13.0 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -58.9748     0.0996878       55.1241           1           1      106    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -54.4078     0.0423553       10.2027           1           1      215    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -53.5484     0.0044431       5.63827           1           1      321    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -53.3781     0.0144996       9.18224           1           1      432    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -53.3327    0.00239067       1.24894           1           1      541    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599      -53.3275   0.000114888      0.263941           1           1      646    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699      -53.3263   0.000494712      0.541292      0.3189           1      753    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799       -53.326   6.30119e-05      0.143815           1           1      862    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      868      -53.3259   2.36651e-05      0.031528           1           1      936    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.3 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.2 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -55.3696     0.0286376       29.4977      0.4395           1      109    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -53.5253    0.00346335       4.52083      0.4498      0.4498      214    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -53.3886    0.00116875      0.945847           1           1      318    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399      -53.3765    0.00105193      0.363092      0.3249           1      425    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499      -53.3758   0.000142552      0.114872      0.2806           1      530    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599      -53.3758   1.41828e-05     0.0302699           1           1      638    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      612      -53.3758   2.42894e-05     0.0185931           1           1      652    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.3 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  13.2 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>prior_ma_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -56.0241     0.0375228       57.6135           1           1      102    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199        -52.69     0.0100685       11.4608      0.9973      0.9973      206    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -52.2411    0.00683497       3.35874           1           1      311    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -52.1597    0.00188009       1.23829           1           1      419    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -52.1516   0.000152839      0.915776      0.5835      0.5835      523    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -52.1494   0.000326014      0.278335           1           1      632    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699      -52.1488   6.59035e-05      0.104448      0.5176           1      741    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      743      -52.1488   2.43715e-05     0.0685939      0.4944      0.9863      791    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.4 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  13.1 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -55.2211     0.0040635       25.2008      0.6164      0.6164      104    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -51.9848    0.00157419       8.35189      0.5073      0.5073      209    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -51.3717    0.00586045       4.39017           1           1      314    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -51.2915   0.000162867      0.660395       0.793       0.793      418    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -51.2814   0.000718217      0.500569           1           1      520    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599       -51.279   0.000291961      0.143921           1           1      626    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699      -51.2787   0.000167637      0.139654           1           1      731    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      760      -51.2787   3.52194e-05      0.023048           1           1      794    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.4 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  15.9 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -60.4618    0.00167598       16.9374      0.7059      0.7059      102    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199       -57.498     0.0187024       11.4966           1           1      207    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -57.0176    0.00181176       3.53985           1           1      314    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399      -56.9586    0.00465161        1.4473           1           1      418    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499      -56.9482    0.00102694      0.606197           1           1      523    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599      -56.9465   8.38043e-05      0.108929           1           1      627    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      685      -56.9465   1.58842e-05     0.0262066           1           1      714    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.4 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  13.3 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -68.1287    0.00423121       30.4117           1           1      103    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -64.7423      0.025769       20.7546           1           1      213    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -63.8616    0.00309224        7.4117           1           1      320    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -63.6628    0.00131902       2.33055           1           1      433    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -63.6339    0.00328095       5.51331           1           1      540    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -63.6177   0.000465365       1.32703           1           1      648    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -63.6149     0.0017024      0.858918           1           1      753    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -63.6136    0.00118385      0.272734           1           1      859    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899      -63.6133   0.000180576      0.192021           1           1      967    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      915      -63.6133    9.9781e-06     0.0276497           1           1      984    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.4 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  13.4 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -52.0856    0.00989585       20.8321      0.9341      0.9341      106    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -49.2067    0.00846293       11.9952           1           1      211    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -48.1643   0.000742683       1.64853           1           1      315    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399      -48.0839    0.00878249       2.03624           1           1      422    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499      -48.0755    0.00167985      0.338605           1           1      528    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599      -48.0747   0.000463849      0.372148           1           1      632    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699      -48.0746   0.000194486     0.0975939           1           1      737    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      731      -48.0746   4.05251e-06     0.0303001      0.9404      0.9404      771    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.4 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  16.6 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -84.4506    0.00424191       642.421      0.1403           1      144    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -76.6589     0.0047713       82.4356      0.2196     0.02196      283    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299       -72.742     0.0158167       130.706      0.5223           1      420    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -70.3379    0.00771397       46.6881      0.7744      0.7744      546    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499       -68.182    0.00176011       120.083      0.3763      0.3763      670    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -66.7119     0.0121629       292.182           1           1      807    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -65.9882    0.00113717       13.3919           1           1      929    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -65.7805    0.00109165       17.1264      0.9722      0.9722     1105    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -65.3726    0.00114996       14.1402           1           1     1231    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -65.2915   0.000420586        42.981      0.7416      0.7416     1355    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -65.1507   0.000442173       19.0431           1           1     1487    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -65.0616   0.000760186       50.8813           1           1     1615    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -64.9998    0.00141861       12.8253           1           1     1750    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -64.9249   0.000579686       15.3643     0.01304           1     1877    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499        -64.89    0.00139036        25.268      0.3794           1     1999    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -64.8574   0.000367772       3.32147           1           1     2124    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -64.8233    0.00996574       27.1451           1           1     2255    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799       -64.791    0.00365645       6.42044           1           1     2375    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -64.7363     0.0016179       2.67386           1           1     2516    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -64.7272   0.000353591       5.15307           1           1     2659    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -64.7272   0.000713731       17.0102           1           1     2660    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.0 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  13.2 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -52.5609     0.0421176       30.2687      0.9901      0.9901      107    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -49.0545    0.00428541       5.13695           1           1      211    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -48.4514    0.00182656       4.19899       0.987       0.987      316    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -48.3518    0.00364534       1.18443           1           1      422    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499       -48.341   0.000811823      0.819109           1           1      529    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -48.3399   0.000134513      0.349613      0.2411           1      635    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699      -48.3398   4.49592e-05      0.050678           1           1      737    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      790      -48.3397   2.25389e-05     0.0187287           1           1      834    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.4 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  13.5 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -59.7487     0.0100568       15.7095           1           1      106    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -56.2898     0.0247356       14.6869           1           1      211    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -55.7739   0.000864323       2.23274           1           1      316    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399      -55.7049    0.00035302      0.928155           1           1      421    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499      -55.6962   0.000201302      0.458875      0.8147      0.8147      525    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599      -55.6953    3.3679e-05     0.0800866      0.8352      0.8352      629    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699      -55.6953   0.000115582     0.0269266           1           1      734    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      704      -55.6953   5.26397e-05     0.0271248      0.9837      0.9837      739    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.4 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  13.6 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99       -66.145      0.114982       52.6269           1           1      108    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -61.1174      0.011924       8.91498           1           1      210    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -60.3064    0.00741977       8.93703           1           1      321    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -60.1622     0.0004465       1.91393           1           1      430    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -60.1367    0.00154007        0.9091           1           1      536    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599      -60.1322   0.000144583      0.249248           1           1      651    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699      -60.1313   0.000193252      0.153019      0.9888      0.9888      755    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799      -60.1311   0.000279027     0.0945496           1           1      861    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      867      -60.1311   8.61685e-05     0.0346833           1           1      934    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.5 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  13.1 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -61.0452     0.0421467       17.3355           1           1      103    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -59.1365    0.00159173       9.41577      0.5924      0.5924      208    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -58.7793    0.00457087       2.46407      0.9315      0.9315      314    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399      -58.7506    0.00243441      0.822051      0.8973      0.8973      417    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499      -58.7457   0.000339173      0.402728      0.8631      0.8631      523    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599      -58.7439   0.000539648      0.150024           1           1      628    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      699      -58.7437   7.84895e-05       0.13314           1           1      735    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      783      -58.7436   2.54321e-05     0.0273371      0.9324      0.9324      822    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.5 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  13.4 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691242 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.689202   0.000110842      0.309035           1           1      107    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.687434   0.000796735      0.637961           1           1      215    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.685675   0.000680791      0.473443      0.8726      0.8726      326    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.682599    0.00226115      0.646337           1           1      432    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.679811    0.00148658       0.45991           1           1      541    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.678534     0.0001285      0.319605           1           1      646    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699      -0.67782    0.00117162       0.29631           1           1      755    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.676839    0.00045295      0.313044      0.2059           1      864    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.675297     0.0015319      0.513647      0.2087           1      976    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.673983   0.000337977      0.350083      0.3616           1     1084    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.673296   6.33411e-05      0.174325           1           1     1195    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.672787   0.000547539      0.144771           1           1     1299    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.672424   0.000535637      0.146949       1.982      0.1982     1407    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399     -0.672232   2.80947e-05     0.0979393           1           1     1515    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.672012   0.000112356       0.16965           1           1     1624    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.671876   0.000146784      0.175725      0.3109      0.3109     1737    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699      -0.67168   0.000110857      0.145743           1           1     1843    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799     -0.670905   0.000247817      0.402533           1           1     1953    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899     -0.670471   0.000534907      0.113397           1           1     2060    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.670369   1.03807e-05     0.0348833           1           1     2167    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.670368   4.22305e-05      0.109262           1           1     2168    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  0.8 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  12.3 seconds.
0/2: Initial log joint probability = -0.733884 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.730618    0.00161445      0.432918           1           1      106    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -0.72872   0.000671902      0.274881           1           1      209    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299     -0.726747    0.00034212      0.220129      0.6932      0.6932      315    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.725847    0.00106332       0.52561           1           1      420    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.725368   0.000187405      0.122551           1           1      529    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.724704    0.00088297      0.250961           1           1      635    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.724253    0.00118337      0.120144           1           1      743    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799      -0.72391   0.000237242     0.0933425      0.8541      0.8541      850    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899     -0.723814   0.000244597     0.0538996           1           1      956    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.723751   3.47574e-05     0.0398967           1           1     1059    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.723715   5.09453e-05     0.0287545           1           1     1166    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.723675    0.00047108      0.106733           1           1     1275    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299      -0.72364   0.000126136     0.0762847           1           1     1381    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399     -0.723617   6.47513e-05     0.0715648      0.2397      0.2397     1488    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.723602   4.94331e-05     0.0252224           1           1     1593    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.723586   9.18211e-05     0.0204805           1           1     1706    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.723575    2.3692e-05     0.0373795      0.6417      0.6417     1809    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799     -0.723569   3.23674e-05     0.0206719           1           1     1915    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899     -0.723556   0.000251444     0.0426767      0.9845      0.9845     2023    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1999     -0.723547   0.000182313     0.0565381           1           1     2133    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     2000     -0.723547     7.825e-06     0.0323417      0.6076      0.6076     2134    
0/2: Optimization terminated normally:  
0/2:   Maximum number of iterations hit, may not be at an optima 
0/2: Finished in  0.8 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  13.1 seconds.
0/3: Initial log joint probability = -0.799594 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.795492   0.000140062      0.366275      0.4844      0.4844      106    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.793378   0.000155258      0.548275        0.56        0.56      211    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.791449   0.000530809      0.416317           1           1      316    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.790843   0.000185842     0.0968305           1           1      421    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.790616   0.000295293     0.0665193           1           1      526    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.790503   0.000351775     0.0829573           1           1      629    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.790455   0.000226716     0.0257688           1           1      734    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799      -0.79044   4.22376e-05     0.0251264           1           1      837    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      899     -0.790432   2.09474e-05    0.00978761           1           1      943    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      997     -0.790431   9.11853e-06    0.00322518           1           1     1044    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.5 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  13.4 seconds.
0/4: Initial log joint probability = -0.871316 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99     -0.866102   0.000833902      0.651919           1           1      109    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.861284    0.00188278      0.470493           1           1      215    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299     -0.855752   0.000545546      0.561236      0.8762      0.8762      320    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399     -0.850922    0.00141846        0.4994           1           1      425    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499     -0.843325    0.00180806       1.45838           1           1      527    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -0.83745   0.000111772      0.368529           1           1      635    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699     -0.835406     0.0015004      0.524719           1           1      740    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799     -0.832465   0.000549049      0.233419           1           1      846    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.829673    0.00274226      0.435965           1           1      958    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.823376   0.000161033      0.522752      0.7985      0.7985     1074    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.819236    0.00150715       0.50118           1           1     1180    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.817493   0.000287639       0.22494           1           1     1282    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.816725   0.000728974      0.456563           1           1     1386    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.815821   0.000478571      0.447039           1           1     1495    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.815376   5.29394e-05       0.18997      0.4373      0.4373     1605    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599     -0.814944   5.03003e-05       0.18748           1           1     1711    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699      -0.81456   0.000148673      0.114673           1           1     1820    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799     -0.814188   0.000122728      0.204969           1           1     1932    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.813779   0.000134398     0.0842371           1           1     2040    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.813661   4.79638e-05     0.0612121           1           1     2148    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000     -0.813661   2.06992e-05     0.0737322           1           1     2149    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  0.9 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  14.6 seconds.
0/5: Initial log joint probability = -0.729813 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.725817    0.00168748      0.273073           1           1      105    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199       -0.7246   9.39474e-05      0.174143           1           1      210    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.724185   0.000406655      0.111891           1           1      314    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399      -0.72388   0.000216256       0.09988           1           1      417    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499      -0.72373   0.000307632     0.0505865           1           1      522    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.723644   0.000142303     0.0483702           1           1      626    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.723599   1.14159e-05     0.0206075           1           1      731    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.723581   0.000314249     0.0627075           1           1      838    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.723556   3.47058e-05     0.0269751      0.8399      0.8399      943    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      999     -0.723541   3.55019e-05     0.0263484      0.5115           1     1047    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1099     -0.723536   6.06363e-06    0.00987141           1           1     1155    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1199     -0.723531   2.14962e-05     0.0107892           1           1     1261    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1299     -0.723524   6.64004e-05     0.0157892           1           1     1370    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1399     -0.723521   1.63226e-05    0.00843493           1           1     1476    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1499      -0.72352    8.5219e-06    0.00393108           1           1     1580    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1585     -0.723519   4.05405e-06     0.0027463           1           1     1671    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.6 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  12.7 seconds.
0/6: Initial log joint probability = -0.917066 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916109   0.000437954       1.56156           1           1      146    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.914916   0.000355302       1.43601           1           1      278    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.914145   0.000342774      0.632148           1           1      400    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.913601   0.000107487       1.61638      0.3722     0.03722      529    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.912968   8.84889e-05       2.33303     0.06811           1      663    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.912458    0.00010929      0.515171           1           1      780    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.912066   2.97835e-05       2.36066      0.5364      0.5364      908    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.911876   3.01468e-05      0.303509           1           1     1047    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.911833   5.36838e-05      0.293952           1           1     1167    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999     -0.911735    3.5705e-05      0.910508      0.7135      0.7135     1293    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.911671   1.62415e-05       1.59221           1           1     1428    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.911621   0.000173995       0.24265           1           1     1558    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.911576    5.4441e-06       1.02201      0.4194     0.04194     1685    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.911533   5.49513e-05      0.131706           1           1     1816    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.911459   1.69838e-05      0.277576           1           1     1959    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -0.91144    0.00018484      0.275423           1           1     2086    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.911385   0.000157219      0.234572           1           1     2227    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -0.91135   4.53183e-05      0.991886           1           1     2384    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.911332   8.46831e-06      0.280762           1           1     2508    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.911315   4.09064e-06     0.0925159           1           1     2631    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000     -0.911315   7.82612e-06      0.102215           1           1     2632    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.0 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  14.0 seconds.
0/7: Initial log joint probability = -0.679174 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.676773   0.000282433      0.360646           1           1      106    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.675449    0.00111842       0.42485           1           1      209    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.674288    0.00049989      0.259449           1           1      314    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.673165   0.000933309      0.537161           1           1      421    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.672715   0.000828231      0.197339           1           1      524    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.672279   0.000325358      0.139257           1           1      632    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.671895   0.000307706      0.135826           1           1      737    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.671748   0.000151831      0.101697           1           1      848    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.671586   6.43819e-05      0.146444      0.4436      0.4436      955    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.671516   0.000173676     0.0975607           1           1     1060    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099     -0.671383   0.000345979      0.108392           1           1     1164    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.671254   3.12022e-05     0.0483609           1           1     1272    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299     -0.671223   9.58442e-05     0.0273906           1           1     1384    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.671208   0.000213272     0.0653968           1           1     1493    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.671194   6.79695e-05     0.0365143           1           1     1603    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.671178   2.55661e-05     0.0438191      0.5613      0.5613     1712    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.671165   0.000199454     0.0385781           1           1     1822    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.671159    2.0232e-05    0.00998548           1           1     1926    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1896     -0.671158   1.96183e-06    0.00324235           1           1     2026    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.8 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  13.0 seconds.
0/8: Initial log joint probability = -0.801846 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.797901    0.00195634      0.505187           1           1      102    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.795892   0.000824223       0.26559           1           1      214    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.794858    0.00148614       0.25973           1           1      322    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.794153   0.000410327      0.200919           1           1      430    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.792949     0.0015932      0.171664           1           1      535    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.792545   0.000321518      0.147434      0.8396      0.8396      640    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699      -0.79227   0.000543805      0.131186           1           1      746    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799      -0.79202   5.01995e-05      0.105061           1           1      853    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899     -0.791488   0.000869056      0.168879           1           1      959    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999      -0.79098   0.000910965      0.234098           1           1     1066    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.790667   0.000340394      0.114722      0.9823      0.9823     1178    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199      -0.79049   0.000126611     0.0642643           1           1     1282    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299       -0.7904   1.09886e-05     0.0897082      0.5749      0.5749     1392    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.790272   4.55815e-05     0.0402751           1           1     1499    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499     -0.790218     0.0001471     0.0538774           1           1     1605    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.790197   0.000511824     0.0618004           1           1     1711    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1699     -0.790149    0.00101721     0.0588688           1           1     1817    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1799     -0.790052   4.91753e-05     0.0384682           1           1     1922    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1899     -0.790019   4.77515e-06     0.0154051           1           1     2030    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1999     -0.790003   5.13218e-05     0.0257379           1           1     2135    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     2000     -0.790003   1.27546e-05     0.0181115      0.9401      0.9401     2136    
0/8: Optimization terminated normally:  
0/8:   Maximum number of iterations hit, may not be at an optima 
0/8: Finished in  0.8 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  13.6 seconds.
0/9: Initial log joint probability = -0.809754 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.807266   6.69103e-05      0.351369      0.5882      0.5882      110    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.806507   0.000277735      0.163765           1           1      214    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -0.80614    0.00197372      0.230362           1           1      319    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.805854   0.000311094      0.111909           1           1      424    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.805682   0.000722303      0.522294           1           1      527    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.805129   0.000340202      0.207379      0.4827           1      634    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.804809   0.000354051      0.199714           1           1      746    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.804625   0.000379087      0.252071           1           1      858    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.804185   0.000523157      0.195621           1           1      970    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.803792    2.5751e-05     0.0895017           1           1     1078    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.803645   0.000108827      0.122402           1           1     1190    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199      -0.80341    0.00181104      0.548372           1           1     1295    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.802688   0.000404301      0.359619      0.8665      0.8665     1402    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.801884    0.00107012      0.249612      0.3663           1     1509    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.801517   8.65043e-05     0.0477117           1           1     1616    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.801473   2.48446e-05     0.0409242           1           1     1726    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.801434   4.54193e-05     0.0833173      0.4978           1     1839    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799     -0.801413   3.70116e-05     0.0376851       3.838      0.3838     1950    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899      -0.80138   0.000158833     0.0621942           1           1     2056    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1999     -0.801323   0.000422543     0.0635087           1           1     2164    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     2000     -0.801323   4.10159e-05     0.0823625      0.1843           1     2166    
0/9: Optimization terminated normally:  
0/9:   Maximum number of iterations hit, may not be at an optima 
0/9: Finished in  0.8 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.2 seconds.
0/10: Initial log joint probability = -0.752983 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.751339   0.000110477     0.0950765           1           1      106    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.750909   0.000136409     0.0578177           1           1      211    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299     -0.750841   6.37139e-05     0.0318088      0.8661      0.8661      314    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.750835   2.15001e-05     0.0145626           1           1      419    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      490     -0.750834   1.83803e-06    0.00264233           1           1      517    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.3 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.2 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>prior_ma_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -59.8283     0.0514537        25.808           1           1      108    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -57.8398    0.00515703       13.5907      0.6955      0.6955      216    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -57.4439    0.00241499       9.32645           1           1      332    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -57.3486    0.00354278       3.71456       2.946      0.2946      439    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -57.2974   0.000312216      0.628228      0.6826      0.6826      548    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -57.2942   0.000113205      0.495127           1           1      658    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699      -57.2933   0.000244196      0.535015      0.5101           1      767    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799      -57.2932   8.57354e-05      0.113345           1           1      870    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      803      -57.2932   3.62084e-05     0.0467967      0.4716           1      875    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.5 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  16.7 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -61.0272     0.0315662       23.2622           1           1      106    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -59.3874    0.00175688        7.5965      0.7613      0.7613      212    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -59.2068   0.000656624       1.53595           1           1      318    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -59.1965   0.000422598       0.58257           1           1      422    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -59.1953   0.000451436      0.265412           1           1      526    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599      -59.1952   0.000102404     0.0718538           1           1      629    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      617      -59.1952   1.40777e-05     0.0246717           1           1      648    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.4 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  12.9 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -66.5847     0.0552451       35.9491           1           1      107    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199       -65.559    0.00206954       7.60172      0.2749      0.2749      215    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -65.4711    0.00385301       1.02581           1           1      319    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399       -65.466    0.00018594      0.229601           1           1      428    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499      -65.4657   7.49378e-05     0.0826104           1           1      535    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      543      -65.4657   2.49696e-05     0.0233909           1           1      581    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.6 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  14.5 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -73.6065     0.0171454       41.7041      0.2169           1      109    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -69.9923     0.0121514       14.1364           1           1      213    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -69.5222    0.00161436       5.00575           1           1      322    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -69.4226    0.00264032        3.1137           1           1      426    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -69.3919    0.00197196       1.55102           1           1      532    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -69.3855   0.000117811      0.305562           1           1      639    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -69.3849   4.85718e-05      0.163538           1           1      745    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -69.3848   4.33284e-05     0.0545618           1           1      850    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      847      -69.3848   2.86973e-05     0.0347796           1           1      903    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.5 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  14.3 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -58.8444    0.00937181       12.8205           1           1      105    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -57.6998    0.00115148       5.85263      0.2049      0.2049      210    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -57.5944   0.000780707      0.811257           1           1      317    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399      -57.5868    0.00152966      0.805079           1           1      423    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499      -57.5862   0.000202238      0.249585           1           1      530    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      557      -57.5862   8.04678e-06     0.0329137       0.964       0.964      590    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.5 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  12.5 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99       -84.511     0.0329182       35.9292           1           1      135    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -79.8378     0.0022885       66.8262      0.0825      0.7482      279    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -77.3464     0.0184722       165.872      0.6832     0.06832      408    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -75.7937    0.00135309       27.0477           1           1      541    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499       -75.334     0.0025199       35.7363       1.629     0.01629      665    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -75.0148    0.00592959       18.2843           1           1      793    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -74.8531    0.00305655       97.4946           1           1      936    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -74.6795   0.000298079       14.4441           1           1     1057    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -74.6233    0.00465709         24.16      0.2461           1     1179    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -74.5429    0.00130494         4.869      0.1294           1     1316    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -74.5022    0.00197947       13.8859           1           1     1447    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -74.4787     0.0002244       19.4308      0.1169           1     1569    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -74.4529    0.00045991       4.44897           1           1     1701    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -74.4468   0.000145989       3.03775      0.4724      0.4724     1834    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -74.4386    0.00210601       6.35725           1           1     1958    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599       -74.431   0.000309541       2.29899           1           1     2094    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -74.4283   9.38437e-05       3.18689           1           1     2224    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -74.4267   6.58544e-05       1.80796           1           1     2344    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -74.4253   0.000202126       5.42647           1           1     2477    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -74.4237   0.000191781       1.66288           1           1     2603    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -74.4237   0.000576512      0.784946           1           1     2604    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.1 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  15.0 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -58.0179     0.0317779       22.1732           1           1      106    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -56.3675     0.0133514       8.61414           1           1      210    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -56.2435    0.00170412       4.27832           1           1      315    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -56.2306    0.00076285      0.897888      0.5188           1      419    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -56.2301   8.42223e-05     0.0571266      0.9444      0.9444      523    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      561      -56.2301   3.92759e-05     0.0301275           1           1      588    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.5 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.7 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -67.3516    0.00936915        18.385           1           1      107    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -65.8253    0.00330723       7.65591      0.8676      0.8676      216    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -65.6153    0.00318251        1.2225           1           1      322    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399      -65.5893   0.000512605      0.992326           1           1      426    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499      -65.5868   0.000229239      0.206183           1           1      535    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599      -65.5864   7.49989e-05     0.0581768           1           1      641    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      647      -65.5864   9.17106e-06     0.0326545           1           1      693    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.6 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  13.8 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -71.2257     0.0515058       52.3263           1           1      104    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199       -69.488     0.0138939       10.7084           1           1      211    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -69.3141     0.0017163       2.03543           1           1      315    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -69.2725   0.000779358       1.16249      0.2206           1      420    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -69.2661    0.00017421      0.606863      0.3843      0.3843      531    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599      -69.2653   0.000267316      0.394413           1           1      641    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699      -69.2651   0.000104508     0.0814446           1           1      748    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      733      -69.2651   3.62156e-05     0.0338191           1           1      782    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.5 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.3 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -68.1283    0.00135241       13.5472      0.7094      0.7094      104    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -67.6124    0.00215123       2.11439      0.7509      0.7509      211    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -67.5955   0.000633111      0.581693      0.4814           1      318    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399      -67.5948     8.829e-05      0.061122           1           1      422    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      454      -67.5948   2.34581e-05     0.0252955           1           1      479    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.4 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.3 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691243 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.689938   0.000385232      0.310315           1           1      108    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.688774   0.000395049      0.759288           1           1      214    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.687561   0.000388658      0.372917           1           1      319    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.685044   0.000991646      0.591568           1           1      428    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.680997    0.00886311       1.45324           1           1      535    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.677301    0.00106708       1.03587      0.8901      0.8901      638    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699     -0.675654    0.00112685      0.401269           1           1      744    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.674952   0.000294503      0.215317           1           1      860    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.674504   0.000139057      0.202007           1           1      967    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.674274    0.00014687      0.176554           1           1     1074    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.674155   8.35313e-05      0.120524      0.8794      0.8794     1184    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.674047   0.000241628      0.177048           1           1     1292    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.673987    8.1078e-05       0.13928           1           1     1404    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399     -0.673916   0.000102475      0.129977      0.1894      0.1894     1515    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.673813   1.05073e-05     0.0769713      0.7946      0.7946     1624    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.673754    1.9378e-05     0.0736749           1           1     1731    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.673722   0.000141709      0.051981           1           1     1842    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799      -0.67363   0.000625116      0.187289           1           1     1948    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899     -0.673496   0.000624807      0.180228           1           1     2060    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999      -0.67344   5.32864e-05      0.131236           1           1     2166    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.673439   5.59254e-05     0.0865089           1           1     2167    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  1.6 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  12.6 seconds.
0/2: Initial log joint probability = -0.733885 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.731654   7.62751e-05      0.360663           1           1      104    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199     -0.729996   0.000405006      0.307461           1           1      209    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299     -0.728381   5.02411e-05      0.215833           1           1      314    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.727444   0.000456319      0.236844           1           1      421    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.726844   0.000203387      0.134236           1           1      529    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.726581   0.000210802      0.133916           1           1      633    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.726286   0.000659207      0.307498           1           1      739    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.725992   0.000402774      0.188877           1           1      846    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899     -0.725843   2.45138e-05     0.0987321      0.4449      0.4449      949    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.725683   0.000327929      0.140054           1           1     1055    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.725586   0.000131173     0.0547578           1           1     1159    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.725517   2.80973e-05     0.0687797           1           1     1266    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299     -0.725448   0.000306485     0.0829828           1           1     1372    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399     -0.725373   0.000249868     0.0668078           1           1     1482    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.725332   0.000144934      0.113568           1           1     1589    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.725314   2.87948e-05     0.0240644           1           1     1693    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.725305   9.56678e-06      0.076088      0.5877      0.5877     1797    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799      -0.72529   0.000114587     0.0349599           1           1     1904    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899     -0.725275   1.17021e-05     0.0243464      0.7778      0.7778     2009    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1999     -0.725264   3.53527e-05     0.0624291      0.5843      0.5843     2112    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     2000     -0.725264   0.000129058     0.0253505           1           1     2113    
0/2: Optimization terminated normally:  
0/2:   Maximum number of iterations hit, may not be at an optima 
0/2: Finished in  1.0 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  13.4 seconds.
0/3: Initial log joint probability = -0.799595 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.796994   0.000996918      0.448624           1           1      105    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.795377   0.000296783      0.429848           1           1      210    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.794396    0.00133884      0.259942           1           1      317    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.793019    0.00158732      0.311529      0.9455      0.9455      421    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.792715   0.000108642     0.0813337           1           1      527    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.792621   0.000202726     0.0589639           1           1      633    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.792562   7.05191e-05      0.122772           1           1      739    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799     -0.792536   0.000270376     0.0708914           1           1      845    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      899     -0.792515    0.00023736     0.0551224           1           1      951    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      999     -0.792497   1.88299e-05     0.0228782      0.9496      0.9496     1058    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1099     -0.792495   1.31303e-05     0.0115022           1           1     1162    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1199     -0.792494   4.37306e-05     0.0104565           1           1     1267    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1200     -0.792494   1.33848e-05    0.00449505      0.8904      0.8904     1268    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.7 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  13.1 seconds.
0/4: Initial log joint probability = -0.871316 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99     -0.867379    0.00104783      0.594907           1           1      105    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.863887   0.000341712      0.542751      0.7931      0.7931      211    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299     -0.859378   0.000297039      0.753925      0.9093      0.9093      318    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399     -0.855047    0.00114171      0.915738      0.4649      0.4649      426    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499     -0.844561   0.000387092      0.723011           1           1      529    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.841485   0.000305403       1.09128      0.2701           1      636    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699     -0.840457   4.28853e-05      0.443703      0.6167      0.6167      739    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799     -0.838686   0.000573186      0.487378           1           1      845    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.835944      0.002435       1.42063           1           1      949    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.831405    0.00319848      0.828655           1           1     1056    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.828511   3.83621e-05      0.788707      0.6844      0.6844     1160    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.825683   0.000563308      0.630913      0.4765      0.4765     1267    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.822754    0.00557389       1.69369           1           1     1375    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.820283   0.000414928      0.402983           1           1     1479    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.819475   0.000446843      0.236479           1           1     1584    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599     -0.818764    0.00023974      0.300302           1           1     1694    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.818081   0.000284891      0.223262           1           1     1801    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799     -0.817535   0.000722778      0.206138           1           1     1906    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.817123   3.54097e-05      0.153382           1           1     2011    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.816956   0.000137697      0.247035           1           1     2120    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000     -0.816956   0.000202805      0.328731           1           1     2121    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  1.0 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  14.0 seconds.
0/5: Initial log joint probability = -0.729814 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.727339   5.09558e-05      0.205387           1           1      107    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.726573   0.000513244      0.406848           1           1      213    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.726226   0.000126491      0.143358      0.4981      0.4981      320    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.726035   9.83178e-05     0.0494035           1           1      425    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499     -0.725957    9.5583e-05      0.101998      0.3341      0.3341      533    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.725875   8.02496e-05     0.0423783           1           1      641    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.725846   7.79386e-05     0.0536161      0.4465           1      747    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.725828   3.77185e-05     0.0366646           1           1      854    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.725816   6.41807e-05     0.0535556           1           1      957    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      999     -0.725804    0.00029159     0.0291877           1           1     1062    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1099     -0.725789   2.48168e-05     0.0275811           1           1     1168    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1199     -0.725783   6.38231e-05     0.0506123           1           1     1274    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1299     -0.725779   9.95003e-05     0.0231538           1           1     1378    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1399     -0.725775   3.50267e-05     0.0294957           1           1     1482    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1499     -0.725773   2.67408e-05     0.0107915           1           1     1588    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1557     -0.725773    4.1259e-06    0.00265402           1           1     1649    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.8 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  12.3 seconds.
0/6: Initial log joint probability = -0.917067 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916058   0.000100941       0.71978      0.8068      0.8068      140    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.915466   2.85047e-05      0.839011    0.004008           1      272    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.915229   2.99585e-05       1.15025      0.4243           1      398    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.914956   2.94733e-05       2.49228           1           1      519    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.914642   1.29412e-05      0.545302           1           1      650    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.914266   1.20855e-05      0.466458      0.2168      0.2168      774    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.913954   0.000170214      0.949093       1.863      0.1863      910    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -0.91366   1.83652e-05      0.642616       3.369      0.3369     1041    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.913299    2.2964e-05       1.64439      0.3636      0.3636     1166    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999     -0.913095   6.34013e-05       1.34348           1           1     1304    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.912904   9.19012e-05       1.00649           1           1     1436    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.912879   1.74072e-05      0.145773           1           1     1567    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.912837   1.42883e-05      0.766557      0.4264           1     1700    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.912809   4.08661e-05      0.278206           1           1     1827    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.912782   0.000147981      0.554207           1           1     1947    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.912715   6.86582e-06      0.204828      0.3728           1     2065    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.912643   7.77921e-05      0.183137      0.6768      0.6768     2189    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.912596   1.69758e-05      0.261832           1           1     2318    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.912591   7.75462e-06     0.0408776           1           1     2453    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.912587   1.85293e-05      0.139576           1           1     2569    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000     -0.912587   2.22099e-05     0.0397195      0.1255           1     2571    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.2 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  13.6 seconds.
0/7: Initial log joint probability = -0.679175 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.677317   0.000335509      0.696672           1           1      107    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -0.67641   0.000123265      0.371735      0.5527      0.5527      208    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.675571   0.000513485      0.318749           1           1      312    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.674959   0.000302387      0.273485           1           1      416    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.674368   1.91101e-05      0.273328        0.61        0.61      522    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.674031   9.55406e-05      0.233749      0.5038      0.5038      627    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.673661   0.000758922      0.128949           1           1      732    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.673251   0.000376063       0.17167           1           1      836    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.672987   0.000568758      0.224597           1           1      942    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.672802   2.43336e-05      0.071813      0.8821      0.8821     1048    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099     -0.672748   2.67029e-05     0.0869408      0.7573      0.7573     1154    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.672715   0.000146008     0.0711985           1           1     1258    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299     -0.672667   7.60929e-05     0.0789306           1           1     1364    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.672643   0.000332258      0.232561           1           1     1467    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.672614   0.000140639     0.0513018           1           1     1569    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.672599   3.74758e-05     0.0248226           1           1     1678    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.672593   5.48466e-05     0.0167133      0.2883      0.9724     1785    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.672586   1.41684e-05     0.0297462      0.8029      0.8029     1890    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899     -0.672578   0.000167177     0.0444016           1           1     1997    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1999     -0.672564   0.000162067      0.055202           1           1     2100    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     2000     -0.672564   1.33198e-05     0.0303291      0.8348      0.8348     2101    
0/7: Optimization terminated normally:  
0/7:   Maximum number of iterations hit, may not be at an optima 
0/7: Finished in  1.0 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  13.4 seconds.
0/8: Initial log joint probability = -0.801846 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.799291    0.00167745      0.583517           1           1      104    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.797816   0.000393217       0.20004           1           1      208    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.796858   9.73366e-05      0.172715           1           1      312    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399      -0.79638   0.000167581      0.302929      0.4003           1      420    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.795863   0.000387919       0.20788           1           1      527    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.795261    0.00032544       0.20247           1           1      631    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699     -0.794886   0.000188692      0.122863           1           1      735    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799       -0.7946   0.000801843      0.116987           1           1      842    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899     -0.794303   0.000188724      0.117198           1           1      949    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999     -0.793929    0.00110677      0.141324           1           1     1056    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.793529    0.00060719      0.154941           1           1     1165    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199      -0.79298   0.000821084       0.34924           1           1     1271    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.792626   0.000538092      0.354209           1           1     1373    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.792481   7.23949e-05     0.0699483           1           1     1478    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499     -0.792416   1.54752e-05      0.105062      0.7064      0.7064     1589    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.792346    7.3609e-05     0.0593498           1           1     1696    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1699     -0.792254   8.71644e-05     0.0795024           1           1     1805    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1799     -0.792156   3.45932e-05     0.0658751           1           1     1912    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1899     -0.792118   0.000215243     0.0435331           1           1     2019    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1999     -0.792081   1.82092e-05     0.0311546           1           1     2126    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     2000     -0.792081   6.17464e-05     0.0687896           1           1     2127    
0/8: Optimization terminated normally:  
0/8:   Maximum number of iterations hit, may not be at an optima 
0/8: Finished in  1.6 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  17.0 seconds.
0/9: Initial log joint probability = -0.809755 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.807853   0.000339699      0.299462           1           1      107    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.807327   8.60726e-05      0.198962      0.8395      0.8395      209    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299     -0.807065   0.000125605       0.11188      0.5055      0.5055      316    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.806794   0.000162975      0.142852           1           1      424    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.806322    0.00048968       0.53553      0.4991           1      527    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.805867   0.000742082      0.163512           1           1      633    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.805354   0.000159583      0.278854           1           1      739    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.804972   0.000104078      0.136324           1           1      847    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.804556   0.000223212      0.323557       0.471           1      956    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.804371   0.000933846      0.324843           1           1     1062    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.804171   0.000613412      0.338245           1           1     1171    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199     -0.804094   0.000190375      0.178391           1           1     1277    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.803977   0.000177306      0.239257      0.6523      0.6523     1388    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.803576    0.00407203      0.258408           1           1     1494    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.803111    0.00041019      0.348715      0.1662           1     1600    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.802943   0.000150396     0.0891229       4.305      0.4305     1713    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.802874   0.000121043     0.0646867           1           1     1822    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799     -0.802861   4.16588e-05     0.0220629           1           1     1931    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899     -0.802856   1.87696e-05     0.0288403           1           1     2035    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1999     -0.802854   7.67012e-06     0.0168471           1           1     2142    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     2000     -0.802854   2.27077e-05      0.022555           1           1     2143    
0/9: Optimization terminated normally:  
0/9:   Maximum number of iterations hit, may not be at an optima 
0/9: Finished in  1.0 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  13.1 seconds.
0/10: Initial log joint probability = -0.752984 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.751804   0.000491045       0.21716           1           1      109    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -0.75156   1.86388e-05      0.139593      0.6747      0.6747      214    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299     -0.751513   5.73699e-05      0.063224      0.5232           1      319    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.751501   6.39016e-06     0.0181802      0.3416      0.3416      425    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499     -0.751499   1.06969e-06    0.00475173      0.7651      0.7651      528    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      505     -0.751499   2.19227e-06    0.00286974           1           1      534    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.3 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  13.3 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>prior_ma_5 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -60.7595    0.00635601       18.0075           1           1      108    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -59.0985     0.0230014       15.0972           1           1      213    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299        -58.49     0.0038035       5.05002           1           1      320    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -58.3017     0.0008504       3.16316           1           1      428    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -58.2444    0.00158144       3.81039           1           1      535    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -58.2367   6.99167e-05      0.506819           1           1      642    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699      -58.2364   7.91559e-05      0.110914           1           1      747    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      785      -58.2363   1.03112e-05      0.080804      0.4677           1      838    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.5 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  13.0 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -62.3792     0.0137912       19.0939           1           1      104    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -60.3604     0.0138629       8.32547           1           1      215    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -59.9367    0.00501919       4.80653      0.5145      0.5145      322    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -59.9075    0.00137813       1.61781           1           1      429    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -59.9035   3.31819e-05      0.381635       0.348       0.348      533    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599       -59.903   0.000339308      0.369014           1           1      638    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699      -59.9029   4.06001e-05     0.0505865           1           1      742    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      726      -59.9028   9.55388e-06     0.0259738           1           1      771    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.5 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  13.2 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99       -67.762     0.0483946       49.0322           1           1      104    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -66.4055    0.00323295       4.75101           1           1      210    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299       -66.262    0.00248303       1.17886           1           1      317    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399      -66.2453   0.000234811      0.606445           1           1      421    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499      -66.2437    0.00031789      0.308687      0.3822           1      523    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599      -66.2435   3.03773e-05     0.0672976           1           1      627    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      626      -66.2435   3.74846e-05     0.0490313      0.7456      0.7456      654    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.5 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  18.7 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -75.9523      0.013039       60.0799      0.4589      0.4589      104    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -71.4854     0.0127468       15.4304           1           1      216    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -70.6379     0.0214997       11.9656           1           1      328    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -70.3873   0.000968078       4.91442           1           1      435    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -70.3213   0.000303488       3.13859      0.9552      0.9552      540    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -70.3003   0.000755355       1.19994      0.8378      0.8378      651    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -70.2963   0.000604017      0.523702           1           1      756    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -70.2951   0.000135024      0.363379           1           1      863    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899      -70.2948   0.000289331      0.245916           1           1      968    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999      -70.2947   4.61917e-05     0.0920716           1           1     1073    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1007      -70.2947   1.94114e-05      0.056957           1           1     1082    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.7 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  15.5 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -60.2147    0.00205011       15.6749      0.5195      0.5195      108    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -58.7841    0.00683157       6.99479           1           1      213    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -58.5594    0.00351176       2.33975      0.9969      0.9969      320    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399      -58.5418    0.00199864       1.29532           1           1      425    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499      -58.5384   0.000136557      0.230536           1           1      529    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599      -58.5381   4.88515e-05     0.0516082           1           1      634    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      612      -58.5381   5.30194e-05     0.0284555           1           1      649    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.4 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  12.6 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -87.5509    0.00948552       128.056           1           1      130    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -84.1343      0.005602       92.1992       1.757      0.1757      261    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -80.4997    0.00429032       56.9403           1           1      400    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -79.1154     0.0129997          39.5           1           1      521    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -78.1258    0.00760432       49.3302           1           1      654    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -77.4597     0.0108623       354.064           1           1      796    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -76.8447    0.00187949       41.0299           1           1      924    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -76.5862    0.00211221       60.0145          10           1     1053    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -76.2016    0.00579656       22.8443           1           1     1175    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -75.9348    0.00107032       33.4585           1           1     1300    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -75.8698   0.000154822       18.5488           1           1     1422    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -75.8319   0.000373804       16.2652       0.693       0.693     1548    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -75.8004    0.00312872       17.1615           1           1     1673    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -75.7237   0.000932054       17.5578           1           1     1804    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -75.6861    0.00556498       52.2353           1           1     1934    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -75.6644    0.00042029       3.58662       3.918     0.03918     2095    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -75.6555   0.000319937       19.1951           1           1     2267    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -75.6389    0.00092988       5.01835           1           1     2388    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899       -75.629   5.36415e-05       3.29327           1           1     2515    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -75.6227   2.06506e-05       5.62989           1           1     2642    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -75.6227    9.8208e-05       9.70423           1           1     2643    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.7 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  14.6 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -58.3517     0.0264662       28.9839           1           1      105    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -57.1524     0.0066292       5.86421           1           1      209    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -57.0196    0.00132142       3.31455           1           1      315    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -56.9924   0.000166675       1.39422      0.3658      0.3658      419    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -56.9903   7.66809e-05      0.307489           1           1      526    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599        -56.99   0.000105994     0.0986483           1           1      633    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      638        -56.99   6.87098e-06     0.0318202           1           1      674    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.5 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.3 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -68.1811    0.00229092       27.2186      0.6692      0.6692      106    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -66.3282     0.0111541       10.5457           1           1      210    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299       -66.054    0.00104832       1.50904           1           1      314    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399      -66.0207    0.00081824         1.192           1           1      418    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499      -66.0143   0.000970037      0.863529      0.4838           1      529    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599       -66.013   6.75629e-05      0.176018           1           1      634    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      684      -66.0129   1.56801e-05     0.0353485           1           1      726    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.4 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  13.5 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -71.9151     0.0150342       56.8019           1           1      107    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -70.3009    0.00139048       11.7159           1           1      209    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -69.9707    0.00080603       3.74186           1           1      312    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399        -69.84    0.00317164       2.65337           1           1      420    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -69.8204   0.000104776       1.31118      0.5308      0.5308      528    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599      -69.8173   0.000114141       1.00239      0.6144      0.6144      636    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699      -69.8166   8.22008e-05      0.196501           1           1      743    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799      -69.8164   3.91715e-05     0.0933568           1           1      854    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      848      -69.8164   7.65899e-05     0.0577596      0.8184      0.8184      907    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.6 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  13.4 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -68.7418     0.0195857        16.763           1           1      104    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -68.1203    0.00202201       1.86144           1           1      210    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -68.0864    0.00148912       1.18856           1           1      314    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399      -68.0838   0.000438149      0.141086           1           1      422    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      497      -68.0837   7.35563e-05     0.0461358      0.4757      0.9045      526    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.7 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.5 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_5 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691243 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.690149   0.000409155      0.982293           1           1      112    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.689296   0.000274904      0.207505      0.8759      0.8759      213    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.688166    0.00268191      0.985955           1           1      319    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.686336   0.000799422      0.673817           1           1      425    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.684463    0.00030835      0.568674           1           1      533    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.683539   4.84085e-05       0.53835           1           1      644    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699     -0.682164   0.000156494      0.373877           1           1      756    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.681505   0.000790564       0.51459           1           1      867    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899      -0.68053   0.000823065      0.923196           1           1      978    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.679331   0.000283913      0.332838           1           1     1083    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.678079    0.00151601       0.31704           1           1     1188    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.677423   0.000270581      0.267113           1           1     1298    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.677286   0.000121956      0.202839           1           1     1408    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399     -0.677077   0.000604423      0.241769           1           1     1517    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.676789    0.00153607      0.828586           1           1     1624    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.676329    0.00132184      0.504693           1           1     1734    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.675571   2.62998e-05      0.185216           1           1     1847    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799     -0.675384   0.000116494      0.113527           1           1     1960    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899     -0.675284   0.000239458      0.140387           1           1     2069    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.675174   1.25752e-05      0.211802      0.1884      0.1884     2174    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.675172   0.000132858      0.105866           1           1     2175    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  1.4 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  13.0 seconds.
0/2: Initial log joint probability = -0.733885 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.732209   0.000605035      0.398096           1           1      106    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -0.73076   0.000187727      0.593361      0.6623      0.6623      212    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299     -0.729559   0.000126995       0.23812           1           1      323    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.728557   0.000178833      0.474955      0.4759           1      431    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.728206   0.000271272       0.18402           1           1      538    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.727899    0.00029301      0.260463      0.8319      0.8319      645    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.727371   0.000180181      0.202722           1           1      752    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799      -0.72718   0.000308283      0.292058           1           1      856    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899     -0.727031   0.000158748      0.112059           1           1      964    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.726936   1.70833e-05     0.0700049           1           1     1067    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.726866   0.000100335     0.0719183           1           1     1176    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199      -0.72682   1.28006e-05     0.0635737      0.8238      0.8238     1280    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299     -0.726745   0.000483629      0.160135           1           1     1387    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399      -0.72667   0.000278573      0.113121           1           1     1494    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.726606   1.69671e-05     0.0320184           1           1     1600    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.726593   1.83352e-05     0.0378975      0.4145           1     1708    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.726583   8.64074e-06     0.0166865           1           1     1816    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799     -0.726573   0.000159678     0.0413225           1           1     1925    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899     -0.726557   0.000175592     0.0422498           1           1     2033    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1999     -0.726537   3.80894e-05     0.0355022           1           1     2141    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     2000     -0.726537   0.000125409     0.0401648           1           1     2142    
0/2: Optimization terminated normally:  
0/2:   Maximum number of iterations hit, may not be at an optima 
0/2: Finished in  1.1 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  14.0 seconds.
0/3: Initial log joint probability = -0.799595 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.797568   0.000231554      0.293243           1           1      106    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -0.79636   0.000268944      0.237013           1           1      211    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.795998   0.000137638      0.143007      0.7383      0.7383      318    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.795776   0.000346658      0.124357           1           1      424    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.795674   1.86004e-05     0.0548888           1           1      531    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.795649   6.24474e-06     0.0181409           1           1      637    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.795642   1.04718e-05     0.0153534           1           1      742    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799     -0.795638   2.44738e-05     0.0197867           1           1      845    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      899     -0.795637   1.74268e-05     0.0138915           1           1      948    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      972     -0.795636   4.22321e-06    0.00865539           1           1     1024    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.6 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  14.2 seconds.
0/4: Initial log joint probability = -0.871318 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99     -0.868761    0.00125575       0.99037           1           1      105    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -0.86581   0.000755076       2.12429           1           1      214    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299     -0.862956   0.000612351      0.970027           1           1      321    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399     -0.859806   5.77104e-05      0.557797      0.4375      0.4375      426    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499     -0.858625   0.000105993       0.54643           1           1      535    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.856778   0.000706565       0.79016           1           1      647    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699     -0.853292   0.000841828      0.740155           1           1      754    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799     -0.849446   0.000855763       1.25423      0.8643      0.8643      861    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.842929    0.00111776       1.03959           1           1      966    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999      -0.84011   2.55146e-05      0.554671      0.9053      0.9053     1074    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.839051   0.000402394      0.814332      0.4061           1     1182    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.838381   4.70824e-05      0.295452      0.3856      0.3856     1298    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.837957   0.000550535      0.951142           1           1     1402    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.837695   0.000892489      0.298202           1           1     1506    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.836657    0.00227375      0.683041           1           1     1616    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599     -0.831086   0.000579959      0.838371      0.4532      0.4532     1727    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.828469    0.00137084         1.187           1           1     1833    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799     -0.826555   0.000412478      0.700582           1           1     1941    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.825299    0.00089455      0.659375           1           1     2051    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.824795   0.000611564      0.280806           1           1     2160    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000     -0.824786   0.000552833      0.297106           1           1     2161    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  1.4 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  15.2 seconds.
0/5: Initial log joint probability = -0.729815 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -0.72785   0.000174313       0.25943           1           1      104    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.726991   0.000265347      0.256743           1           1      210    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.726826   8.08156e-05     0.0917116           1           1      314    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.726733    0.00010324      0.098079      0.4153           1      421    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499     -0.726689   1.68785e-05     0.0488287           1           1      522    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.726658   9.24468e-05     0.0466165           1           1      625    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.726644   2.11284e-05     0.0313042           1           1      728    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.726637   1.02154e-05     0.0183878           1           1      831    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.726627   2.95187e-05     0.0194036           1           1      936    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      999     -0.726619   5.12826e-05     0.0204599           1           1     1040    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1099     -0.726617   3.96145e-05     0.0142882           1           1     1145    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1199     -0.726615   3.77831e-05     0.0106085           1           1     1251    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1299     -0.726614   2.12339e-05      0.006904           1           1     1359    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1399     -0.726613   8.94378e-06    0.00825362           1           1     1462    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1431     -0.726613   2.37004e-06    0.00486916           1           1     1496    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.8 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  14.2 seconds.
0/6: Initial log joint probability = -0.917076 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916577   0.000233663       2.70627       0.222           1      139    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.916184   1.65437e-05       2.87472           1           1      284    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.915972    0.00022718       1.62889           1           1      418    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.915659   0.000288129      0.845668           1           1      540    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.915137   0.000104083      0.722392           1           1      672    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.914735   4.84427e-05      0.440402           1           1      797    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.914548   0.000102367       2.28468           1           1      921    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.914297   1.67989e-05      0.510128      0.8303      0.8303     1055    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.914241   5.72715e-05       1.38901           1           1     1196    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -0.91418   5.83622e-06      0.147478     0.06107           1     1323    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.914088   4.36436e-05      0.357007           1           1     1456    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.913997   1.33661e-05       1.16728      0.9275      0.9275     1583    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.913954   1.90515e-05      0.181383           1           1     1723    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.913912   4.65185e-05      0.520621       0.489           1     1860    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.913892   7.62595e-06       0.30713           1           1     1979    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.913884   7.43668e-05      0.172825           1           1     2109    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.913874   9.60014e-06      0.307853     0.06298           1     2241    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.913866    6.3827e-06      0.203543           1           1     2372    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.913859   9.78145e-07      0.157679           1           1     2507    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.913854   2.75355e-06      0.215435           1           1     2628    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000     -0.913854   3.57561e-06      0.225918           1           1     2629    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.5 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  14.8 seconds.
0/7: Initial log joint probability = -0.679176 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.677678   0.000326774      0.342784           1           1      105    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.677036   0.000568823      0.449529           1           1      212    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.676577   0.000425479      0.388219      0.9721      0.9721      320    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -0.67609    0.00286568       1.02893           1           1      427    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.675425    0.00102485      0.210994           1           1      534    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.675038    0.00126236      0.333937           1           1      643    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699      -0.67458   0.000596492      0.350485           1           1      749    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.673924   3.72109e-05      0.283096           1           1      856    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.673658   0.000229953      0.157024           1           1      962    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.673533   0.000154174      0.158489           1           1     1069    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099      -0.67347   2.69427e-06      0.106076      0.6662      0.6662     1173    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.673433   3.82189e-05     0.0643568           1           1     1279    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299     -0.673412   1.48185e-05     0.0686911       0.464           1     1382    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.673403   1.67282e-05     0.0487479           1           1     1486    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.673397   5.56127e-05     0.0374319       0.914       0.914     1594    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.673373   3.45149e-05     0.0274853           1           1     1701    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.673357   3.93374e-05     0.0422548           1           1     1807    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.673346   3.36977e-05     0.0402698           1           1     1911    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899     -0.673336   4.96572e-05     0.0421903           1           1     2019    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1999     -0.673333   3.42687e-05      0.039775           1           1     2122    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     2000     -0.673332   1.75725e-05     0.0163474      0.8186      0.8186     2123    
0/7: Optimization terminated normally:  
0/7:   Maximum number of iterations hit, may not be at an optima 
0/7: Finished in  1.3 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.2 seconds.
0/8: Initial log joint probability = -0.801847 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.799634   0.000533377      0.306789           1           1      107    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.798287   0.000223336      0.351626           1           1      212    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.797584   4.60196e-05      0.404059      0.3201      0.3201      319    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.797302    0.00022863       0.24708           1           1      424    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.796921   0.000663002      0.246573           1           1      530    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.796532   0.000655171      0.241732           1           1      636    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699     -0.796187    0.00118008      0.150997           1           1      748    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799     -0.795784   0.000317466      0.173978           1           1      855    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899     -0.795369   0.000129448      0.119542           1           1      959    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999     -0.795221   0.000290624      0.106206           1           1     1061    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.795062   0.000191139      0.203442        0.91        0.91     1163    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199     -0.794895   0.000275324      0.108833           1           1     1270    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.794811   0.000128406      0.087919           1           1     1374    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.794676   7.84452e-05      0.162447      0.4161      0.4161     1477    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499     -0.794391    0.00112536      0.287245           1           1     1581    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.794193   0.000283298       0.15818           1           1     1687    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1699     -0.794103   0.000181312     0.0747854           1           1     1796    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1799     -0.794043   0.000209333     0.0742874           1           1     1900    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1899     -0.793979   0.000600723      0.107346           1           1     2009    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1999     -0.793812   0.000659862      0.289971      0.4515           1     2113    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     2000      -0.79381   0.000413926      0.219535       0.456       0.456     2114    
0/8: Optimization terminated normally:  
0/8:   Maximum number of iterations hit, may not be at an optima 
0/8: Finished in  1.3 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.3 seconds.
0/9: Initial log joint probability = -0.809755 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.808406   0.000768121       1.87243           1           1      107    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.807864   1.85683e-05      0.234792           1           1      211    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299     -0.807713   0.000515966       0.32846           1           1      320    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.807423   0.000826367      0.614367           1           1      425    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.807239   0.000262175      0.149686           1           1      534    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.806981   1.51691e-05      0.380637      0.5533      0.5533      640    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.806816   0.000190196      0.415441      0.3879      0.3879      754    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.806565   0.000166343      0.228472      0.4825      0.4825      864    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.806246    0.00016215      0.385658      0.3098      0.3098      969    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.805823   0.000328987      0.292651           1           1     1074    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.805595   7.36077e-05      0.617028           1           1     1181    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199     -0.805427   0.000174945      0.176182           1           1     1293    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.805278   0.000338899      0.090778           1           1     1401    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.805217   3.62444e-05      0.105582           1           1     1508    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.805099   0.000246596      0.152657      0.4507      0.4507     1610    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.805019   0.000487834      0.416923           1           1     1721    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.804699    0.00189747       0.94913      0.3902           1     1830    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799     -0.804246    0.00120863      0.607058           1           1     1934    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899     -0.803907   9.70708e-05      0.264672           1           1     2048    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1999     -0.803803   3.41835e-05      0.173263      0.3062      0.3062     2152    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     2000     -0.803802   0.000178527     0.0896036           1           1     2153    
0/9: Optimization terminated normally:  
0/9:   Maximum number of iterations hit, may not be at an optima 
0/9: Finished in  1.2 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.5 seconds.
0/10: Initial log joint probability = -0.752984 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.752104     0.0005256      0.211063           1           1      104    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.751848   0.000233368      0.210459           1           1      208    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299     -0.751809   3.96143e-05     0.0507359           1           1      311    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.751804   4.70459e-05     0.0332331           1           1      416    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499     -0.751803    1.7512e-05    0.00954302           1           1      520    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      516     -0.751802   1.12257e-06     0.0037336      0.8361      0.8361      537    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.4 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  15.0 seconds.</code></pre>
</div>
</div>
<section id="gradient-conditions" class="level4">
<h4 class="anchored" data-anchor-id="gradient-conditions">Gradient conditions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>p31<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(prior_ma_5<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>p32<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(noprior_ma_5<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>iresults <span class="ot">=</span> <span class="fu">rbind</span>(prior_ma_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>                prior_ma_2<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>                 prior_ma_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>                 prior_ma_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>),</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>                 prior_ma_5<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_5"</span>),</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_5<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_5"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ivar =</span> <span class="fu">if_else</span>(ivar<span class="sc">&gt;</span><span class="fl">1e6</span>,<span class="fl">1e6</span>,ivar)) <span class="sc">%&gt;%</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.factor</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB))</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">1000000</span>))<span class="sc">+</span>    </span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>idx_exemple_analytes <span class="ot">=</span> iresults <span class="sc">%&gt;%</span></span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">==</span><span class="st">"prior_ref"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ivar)<span class="sc">%&gt;%</span></span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which</span>(<span class="fu">row_number</span>() <span class="sc">%%</span> <span class="dv">100</span> <span class="sc">==</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(i)<span class="sc">%&gt;%</span><span class="fu">pull</span>()</span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>iresults <span class="sc">%&gt;%</span></span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-da579176{}.cl-da4d9874{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-da51a32e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-da51a34c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-da51d272{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-da51d27c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-da51d29a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-da51d29b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-da51d2a4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-da51d2a5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-da579176"><thead><tr style="overflow-wrap:break-word;"><th class="cl-da51d272"><p class="cl-da51a32e"><span class="cl-da4d9874">method</span></p></th><th class="cl-da51d27c"><p class="cl-da51a34c"><span class="cl-da4d9874">&lt;=1x</span></p></th><th class="cl-da51d27c"><p class="cl-da51a34c"><span class="cl-da4d9874">&lt;=2x</span></p></th><th class="cl-da51d27c"><p class="cl-da51a34c"><span class="cl-da4d9874">&lt;=3x</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-da51d29a"><p class="cl-da51a32e"><span class="cl-da4d9874">noprior_3</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.000</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.460</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.692</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-da51d29a"><p class="cl-da51a32e"><span class="cl-da4d9874">noprior_4</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.010</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.850</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.924</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-da51d29a"><p class="cl-da51a32e"><span class="cl-da4d9874">noprior_5</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.684</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.902</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.940</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-da51d29a"><p class="cl-da51a32e"><span class="cl-da4d9874">noprior_ref</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.000</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.430</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.744</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-da51d29a"><p class="cl-da51a32e"><span class="cl-da4d9874">prior_2</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.028</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.198</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.502</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-da51d29a"><p class="cl-da51a32e"><span class="cl-da4d9874">prior_3</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.098</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.670</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.842</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-da51d29a"><p class="cl-da51a32e"><span class="cl-da4d9874">prior_4</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.128</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.970</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.986</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-da51d29a"><p class="cl-da51a32e"><span class="cl-da4d9874">prior_5</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.894</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.968</span></p></td><td class="cl-da51d29b"><p class="cl-da51a34c"><span class="cl-da4d9874">0.986</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-da51d2a4"><p class="cl-da51a32e"><span class="cl-da4d9874">prior_ref</span></p></td><td class="cl-da51d2a5"><p class="cl-da51a34c"><span class="cl-da4d9874">0.072</span></p></td><td class="cl-da51d2a5"><p class="cl-da51a34c"><span class="cl-da4d9874">0.828</span></p></td><td class="cl-da51d2a5"><p class="cl-da51a34c"><span class="cl-da4d9874">0.990</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>f55_1<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">"target"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value,<span class="at">color=</span><span class="fu">as.factor</span>(target)))<span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Probability"</span>, <span class="at">y =</span> <span class="st">"Method"</span>, <span class="at">color =</span> <span class="st">"target"</span>)<span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.9</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>f55_1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prob.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>f55_1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prob.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prior-p5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-noprior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-noprior-p5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-maxvar.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-maxvar.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>p31</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-gra-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>p32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-gra-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-gra-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>f33_1<span class="ot">=</span>p33</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>f55_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-gra-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="isocratic-conditions" class="level4">
<h4 class="anchored" data-anchor-id="isocratic-conditions">Isocratic conditions</h4>
<section id="individual-plots" class="level5">
<h5 class="anchored" data-anchor-id="individual-plots">Individual plots</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>plot_id <span class="ot">=</span> <span class="cf">function</span>(results) { </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  results <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>CV<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">ymin =</span> llog10tr, <span class="at">ymax =</span> ulog10tr), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>mlog10tr), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"log(tr)"</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">10</span>, <span class="at">name=</span><span class="st">"%CV"</span>)) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(i<span class="sc">~</span>mod) <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>results_prior_ma_ref<span class="ot">&lt;-</span>prior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_ref<span class="ot">&lt;-</span>noprior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>results_prior_ma_2<span class="ot">&lt;-</span>prior_ma_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>results_prior_ma_3<span class="ot">&lt;-</span>prior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> mrgmisc<span class="sc">::</span><span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_3<span class="ot">&lt;-</span>noprior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>results_prior_ma_4<span class="ot">&lt;-</span>prior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_4<span class="ot">&lt;-</span>noprior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a>results_prior_ma_5<span class="ot">&lt;-</span>prior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_5<span class="ot">&lt;-</span>noprior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ref <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_ref,plot_id) </span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ref <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_ref,plot_id) </span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_2 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_2,plot_id) </span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_3 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_3,plot_id) </span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_3 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_3,plot_id) </span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_4 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_4,plot_id) </span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_4 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_4,plot_id) </span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_5 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_5,plot_id) </span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_5 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_5,plot_id) </span>
<span id="cb44-96"><a href="#cb44-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-97"><a href="#cb44-97" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ref.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ref.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_5[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_5[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ref </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ref </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_3 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-5.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-6.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-7.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_5  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-8.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_5 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-9.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combined" class="level5">
<h5 class="anchored" data-anchor-id="combined">Combined</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>plot_id <span class="ot">=</span> <span class="cf">function</span>(results) { </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  results <span class="sc">%&gt;%</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>CV)) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">ymin =</span> llog10tr, <span class="at">ymax =</span> ulog10tr), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>mlog10tr), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"log(tr)"</span>,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">1</span>, <span class="at">name=</span><span class="st">"%CV"</span>)) <span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(i<span class="sc">~</span>mod) <span class="sc">+</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>izoresults <span class="ot">=</span> <span class="fu">rbind</span>( prior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>                prior_ma_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>                 prior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>                 prior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>),</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>                 prior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_5"</span>),</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_5"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&lt;=</span><span class="fu">log10</span>(<span class="dv">100</span>))<span class="sc">%&gt;%</span></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&gt;=</span><span class="fu">log10</span>(<span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.numeric</span>(c),</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(i,method,c)<span class="sc">%&gt;%</span></span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(i,method) <span class="sc">%&gt;%</span></span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">imaxcv =</span> <span class="fu">max</span>(CV), <span class="at">imincv =</span> <span class="fu">min</span>(CV), <span class="at">aveCV =</span> pracma<span class="sc">::</span><span class="fu">trapz</span>(c, CV)<span class="sc">/</span>(<span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">imaxcv =</span> <span class="fu">if_else</span>(imaxcv<span class="sc">&gt;</span><span class="fl">1e4</span>,<span class="fl">1e4</span>,imaxcv))<span class="sc">%&gt;%</span></span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.integer</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB)) </span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">10000</span>))<span class="sc">+</span>    </span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-izo-combined-CV.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-izo-combined-CV.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design2_files/figure-html/single-form-analytes-izo-summary-combined-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>f44_1 <span class="ot">=</span> p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" role="list">

</div>
</section>
<section id="licenses" class="level1 unnumbered">
<h1 class="unnumbered">Licenses</h1>
<ul>
<li>Code &amp; copy; 2024, Paweł Wiczling, licensed under BSD-3.</li>
<li>Text &amp; copy; 2024, Paweł Wiczling, licensed under CC-BY-NC 4.0.</li>
</ul>
</section>
<section id="original-computing-environment" class="level1 unnumbered">
<h1 class="unnumbered">Original Computing Environment</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.3 (2024-02-29)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 24.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: Europe/Warsaw
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] flextable_0.9.7     tibble_3.2.1        here_1.0.1         
 [4] reshape2_1.4.4      stringr_1.5.1       patchwork_1.3.0    
 [7] mrgmisc_0.2.1       purrr_1.0.2         tidyr_1.3.1        
[10] mvtnorm_1.3-1       ggplot2_3.5.1       dplyr_1.1.4        
[13] numDeriv_2016.8-1.1 pracma_2.4.4        cmdstanr_0.8.1     

loaded via a namespace (and not attached):
 [1] gtable_0.3.5            tensorA_0.36.2.1        xfun_0.48              
 [4] htmlwidgets_1.6.4       processx_3.8.4          vctrs_0.6.5            
 [7] tools_4.3.3             ps_1.8.0                generics_0.1.3         
[10] parallel_4.3.3          fansi_1.0.6             pkgconfig_2.0.3        
[13] data.table_1.16.2       checkmate_2.3.2         uuid_1.2-1             
[16] distributional_0.5.0    lifecycle_1.0.4         compiler_4.3.3         
[19] farver_2.1.2            textshaping_0.4.0       munsell_0.5.1          
[22] codetools_0.2-19        fontquiver_0.2.1        fontLiberation_0.1.0   
[25] htmltools_0.5.8.1       yaml_2.3.10             pillar_1.9.0           
[28] openssl_2.2.2           bettermc_1.2.2          abind_1.4-8            
[31] fontBitstreamVera_0.1.1 posterior_1.6.0         zip_2.3.1              
[34] tidyselect_1.2.1        digest_0.6.37           stringi_1.8.4          
[37] labeling_0.4.3          rprojroot_2.0.4         fastmap_1.2.0          
[40] grid_4.3.3              colorspace_2.1-1        cli_3.6.3              
[43] magrittr_2.0.3          utf8_1.2.4              withr_3.0.1            
[46] gdtools_0.4.0           scales_1.3.0            backports_1.5.0        
[49] rmarkdown_2.28          officer_0.6.7           askpass_1.2.1          
[52] ragg_1.3.3              evaluate_1.0.1          knitr_1.48             
[55] viridisLite_0.4.2       rlang_1.1.4             isoband_0.2.7          
[58] Rcpp_1.0.13             glue_1.8.0              xml2_1.3.6             
[61] rstudioapi_0.17.0       jsonlite_1.8.9          R6_2.5.1               
[64] plyr_1.8.9              systemfonts_1.1.0      </code></pre>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb67" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Design2: Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC"</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Paweł Wiczling*"</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co">      - name: "Department of Biopharmaceutics and Pharmacodynamics, Medical University of Gdańsk, Gen. J. Hallera 107, 80-416 Gdańsk, Poland"</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.Date())`"</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true  </span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 7</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 7</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setuphtml, include=FALSE}</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(cache=TRUE, message=FALSE, error=FALSE, warning=FALSE, comment=NA, out.width='95%')</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="in">#usethis::create_github_token()</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>The packages we will use are listed below.</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a><span class="in">library(cmdstanr)</span></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a><span class="in">library(pracma)</span></span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a><span class="in">library(numDeriv)</span></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a><span class="in">library(mvtnorm)</span></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr)</span></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a><span class="in">library(purrr)</span></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a><span class="in">library(mrgmisc)</span></span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a><span class="in">library(patchwork)</span></span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a><span class="in">library(stringr)</span></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a><span class="in">library(reshape2)</span></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a><span class="in">library(here)</span></span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a><span class="in">library(tibble)</span></span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a><span class="in">library(flextable)</span></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a><span class="in">select = dplyr::select</span></span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a><span class="in"># remotes::install_github("metrumresearchgroup/mrgmisc")</span></span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a><span class="in"># for parallel calculation use linux (mclaplly), i.e. Ubuntu 24.04 on Windows WSL</span></span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a><span class="in"># usethis::edit_r_environ(), add PROCESSX_NOTIFY_OLD_SIGCHLD = 1 ????</span></span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a><span class="in">#' Helper functions</span></span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a><span class="in">source("helper_functions.R")</span></span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{r paths}</span></span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a><span class="in">#' folder shortcuts:</span></span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a><span class="in">figures_dir1 &lt;- here("deliv", "figures", "design2","N")</span></span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a><span class="in">tables_dir1  &lt;- here("deliv", "tables", "design2","N")</span></span>
<span id="cb67-55"><a href="#cb67-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-56"><a href="#cb67-56" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(figures_dir1)) dir.create(figures_dir1, recursive = T)</span></span>
<span id="cb67-57"><a href="#cb67-57" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(tables_dir1)) dir.create(tables_dir1, recursive = T)</span></span>
<span id="cb67-58"><a href="#cb67-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-59"><a href="#cb67-59" aria-hidden="true" tabindex="-1"></a><span class="in">thisScript &lt;- "optimal-design-for-mixtures-design2"</span></span>
<span id="cb67-60"><a href="#cb67-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-61"><a href="#cb67-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-62"><a href="#cb67-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r helper-save-functions}</span></span>
<span id="cb67-63"><a href="#cb67-63" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave &lt;- function(.plot, .filename, .path=figures_dir, .height= 7, .width= 6) {</span></span>
<span id="cb67-64"><a href="#cb67-64" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(plot=.plot, filename=.filename, path=.path, height=.height, width=.width)</span></span>
<span id="cb67-65"><a href="#cb67-65" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb67-66"><a href="#cb67-66" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png &lt;- function(.plot, .filename, .path=figures_dir, .height=7, .width= 6) {</span></span>
<span id="cb67-67"><a href="#cb67-67" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(plot=.plot, filename=.filename, path=.path, height=.height, width=.width)</span></span>
<span id="cb67-68"><a href="#cb67-68" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb67-69"><a href="#cb67-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-70"><a href="#cb67-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-71"><a href="#cb67-71" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb67-72"><a href="#cb67-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-73"><a href="#cb67-73" aria-hidden="true" tabindex="-1"></a><span class="fu"># Priors</span></span>
<span id="cb67-74"><a href="#cb67-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-75"><a href="#cb67-75" aria-hidden="true" tabindex="-1"></a>Priors are based on the follwoing article "Comparison of Chromatographic Stationary Phases Using a Bayesian-Based Multilevel Model" by Paweł Wiczling and Agnieszka Kamedulska published in Analytical Chemistry 2024 96 (3), 1310-1319. </span>
<span id="cb67-76"><a href="#cb67-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-77"><a href="#cb67-77" aria-hidden="true" tabindex="-1"></a>In this work a simplified approach is taken with the focus on the neutral, acidic and basic forms of an analytes and single chromatographic stationary phase - assuming the pKa and changes of pKa with organic modifier are known.</span>
<span id="cb67-78"><a href="#cb67-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-79"><a href="#cb67-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r literature-priors}</span></span>
<span id="cb67-80"><a href="#cb67-80" aria-hidden="true" tabindex="-1"></a><span class="in"># fun_generate_priors defined in helper_functions.R</span></span>
<span id="cb67-81"><a href="#cb67-81" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN_MeOH=fun_generate_priors("N_MeOH", logP=2.2)</span></span>
<span id="cb67-82"><a href="#cb67-82" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN_ACN=fun_generate_priors("N_ACN", logP=2.2)</span></span>
<span id="cb67-83"><a href="#cb67-83" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN=fun_generate_priors("N", logP=2.2)</span></span>
<span id="cb67-84"><a href="#cb67-84" aria-hidden="true" tabindex="-1"></a><span class="in">priorsA=fun_generate_priors("A", logP=2.2)</span></span>
<span id="cb67-85"><a href="#cb67-85" aria-hidden="true" tabindex="-1"></a><span class="in">priorsB=fun_generate_priors("B", logP=2.2)</span></span>
<span id="cb67-86"><a href="#cb67-86" aria-hidden="true" tabindex="-1"></a><span class="in">priorsNB=fun_generate_priors("NB", logP=2.2)</span></span>
<span id="cb67-87"><a href="#cb67-87" aria-hidden="true" tabindex="-1"></a><span class="in">priorsNA=fun_generate_priors("NA", logP=2.2)</span></span>
<span id="cb67-88"><a href="#cb67-88" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-89"><a href="#cb67-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-90"><a href="#cb67-90" aria-hidden="true" tabindex="-1"></a>Here I consider a design space that consist of linear organic modifier gradients ranging from 9 to 270 min and organic modifier content ranging from 0.05 to 0.2 for MeOH and ACN.</span>
<span id="cb67-91"><a href="#cb67-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-92"><a href="#cb67-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r design-space}</span></span>
<span id="cb67-93"><a href="#cb67-93" aria-hidden="true" tabindex="-1"></a><span class="in">hplcparam_candidates_df = expand_grid(tg=seq(10,270,by=10), </span></span>
<span id="cb67-94"><a href="#cb67-94" aria-hidden="true" tabindex="-1"></a><span class="in">                                          td=2.1, </span></span>
<span id="cb67-95"><a href="#cb67-95" aria-hidden="true" tabindex="-1"></a><span class="in">                                          to=0.532,</span></span>
<span id="cb67-96"><a href="#cb67-96" aria-hidden="true" tabindex="-1"></a><span class="in">                                          te=0.04, </span></span>
<span id="cb67-97"><a href="#cb67-97" aria-hidden="true" tabindex="-1"></a><span class="in">                                          fio = seq(0.05, 0.2, by=0.05),</span></span>
<span id="cb67-98"><a href="#cb67-98" aria-hidden="true" tabindex="-1"></a><span class="in">                                          fif = 0.8,</span></span>
<span id="cb67-99"><a href="#cb67-99" aria-hidden="true" tabindex="-1"></a><span class="in">                                          m=c(0,1),</span></span>
<span id="cb67-100"><a href="#cb67-100" aria-hidden="true" tabindex="-1"></a><span class="in">                                          xpH=c(0,1))</span></span>
<span id="cb67-101"><a href="#cb67-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-102"><a href="#cb67-102" aria-hidden="true" tabindex="-1"></a><span class="in">hplcparam_candidates_df&lt;-hplcparam_candidates_df%&gt;%</span></span>
<span id="cb67-103"><a href="#cb67-103" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(tg=tg/3)</span></span>
<span id="cb67-104"><a href="#cb67-104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-105"><a href="#cb67-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-106"><a href="#cb67-106" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</span></span>
<span id="cb67-107"><a href="#cb67-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-108"><a href="#cb67-108" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile stan models</span></span>
<span id="cb67-109"><a href="#cb67-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-compilation}</span></span>
<span id="cb67-110"><a href="#cb67-110" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_gq= cmdstan_model("../stan/hplc-gra-single-form-analytes-gq.stan", stanc_options = list("O1"))</span></span>
<span id="cb67-111"><a href="#cb67-111" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_sim = cmdstan_model("../stan/hplc-gra-single-form-analytes-sim.stan", stanc_options = list("O1"))</span></span>
<span id="cb67-112"><a href="#cb67-112" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes = cmdstan_model("../stan/hplc-gra-single-form-analytes.stan", stanc_options = list("O1"))</span></span>
<span id="cb67-113"><a href="#cb67-113" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes$compile(compile_model_methods=TRUE,force_recompile=TRUE)</span></span>
<span id="cb67-114"><a href="#cb67-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-115"><a href="#cb67-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-116"><a href="#cb67-116" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulate retention times and create datasets</span></span>
<span id="cb67-117"><a href="#cb67-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-118"><a href="#cb67-118" aria-hidden="true" tabindex="-1"></a>Probability of occurrence 0.4 neutral, 0.3 A, 0.3 B with logP being sampled from 2.2+-2 and constrained between 0.5 and 7.</span>
<span id="cb67-119"><a href="#cb67-119" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-120"><a href="#cb67-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-simulations}</span></span>
<span id="cb67-121"><a href="#cb67-121" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma=hplcparam_candidates_df%&gt;%filter(xpH==0)</span></span>
<span id="cb67-122"><a href="#cb67-122" aria-hidden="true" tabindex="-1"></a><span class="in">nObs = nrow(data_ma);</span></span>
<span id="cb67-123"><a href="#cb67-123" aria-hidden="true" tabindex="-1"></a><span class="in">nAnalytes =50;</span></span>
<span id="cb67-124"><a href="#cb67-124" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = 1234;</span></span>
<span id="cb67-125"><a href="#cb67-125" aria-hidden="true" tabindex="-1"></a><span class="in">n_param = 3;</span></span>
<span id="cb67-126"><a href="#cb67-126" aria-hidden="true" tabindex="-1"></a><span class="in">n_rep = 10;</span></span>
<span id="cb67-127"><a href="#cb67-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-128"><a href="#cb67-128" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma=list()</span></span>
<span id="cb67-129"><a href="#cb67-129" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma=list()</span></span>
<span id="cb67-130"><a href="#cb67-130" aria-hidden="true" tabindex="-1"></a><span class="in">inits = list()</span></span>
<span id="cb67-131"><a href="#cb67-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-132"><a href="#cb67-132" aria-hidden="true" tabindex="-1"></a><span class="in">for (i in 1:n_rep) {</span></span>
<span id="cb67-133"><a href="#cb67-133" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]] = list(nObs=nObs,</span></span>
<span id="cb67-134"><a href="#cb67-134" aria-hidden="true" tabindex="-1"></a><span class="in">                   nAnalytes=nAnalytes,</span></span>
<span id="cb67-135"><a href="#cb67-135" aria-hidden="true" tabindex="-1"></a><span class="in">                   steps = 4 + 6*data_ma$m,</span></span>
<span id="cb67-136"><a href="#cb67-136" aria-hidden="true" tabindex="-1"></a><span class="in">                   hplcparam=as.matrix(data_ma%&gt;%dplyr::select(c(tg,td,to,te,fio,fif,m))),</span></span>
<span id="cb67-137"><a href="#cb67-137" aria-hidden="true" tabindex="-1"></a><span class="in">                   include_prior = 1,</span></span>
<span id="cb67-138"><a href="#cb67-138" aria-hidden="true" tabindex="-1"></a><span class="in">                   run_estimation=1,</span></span>
<span id="cb67-139"><a href="#cb67-139" aria-hidden="true" tabindex="-1"></a><span class="in">                   nSel = nObs,</span></span>
<span id="cb67-140"><a href="#cb67-140" aria-hidden="true" tabindex="-1"></a><span class="in">                   selected = 1:nObs)</span></span>
<span id="cb67-141"><a href="#cb67-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-142"><a href="#cb67-142" aria-hidden="true" tabindex="-1"></a><span class="in">fit_gq  = mod_analytes_gq$sample(data = datastruct_prior_ma[[i]],</span></span>
<span id="cb67-143"><a href="#cb67-143" aria-hidden="true" tabindex="-1"></a><span class="in">                                         seed = cseed,</span></span>
<span id="cb67-144"><a href="#cb67-144" aria-hidden="true" tabindex="-1"></a><span class="in">                                         fixed_param = TRUE,</span></span>
<span id="cb67-145"><a href="#cb67-145" aria-hidden="true" tabindex="-1"></a><span class="in">                                         chains = 1,</span></span>
<span id="cb67-146"><a href="#cb67-146" aria-hidden="true" tabindex="-1"></a><span class="in">                                         iter_sampling=1)</span></span>
<span id="cb67-147"><a href="#cb67-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-148"><a href="#cb67-148" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$trobs = matrix(fit_gq$draws(format = "matrix", variable = "y_hat_sim"),nAnalytes,nObs)</span></span>
<span id="cb67-149"><a href="#cb67-149" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$logPobs = fit_gq$draws(format = "matrix", variable = "logPobs")[1:nAnalytes]</span></span>
<span id="cb67-150"><a href="#cb67-150" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$N1A2B3 = fit_gq$draws(format = "matrix", variable = "N1A2B3")[1:nAnalytes]</span></span>
<span id="cb67-151"><a href="#cb67-151" aria-hidden="true" tabindex="-1"></a><span class="in">param = matrix(fit_gq$draws(format = "matrix", variable = "paramsim"),nAnalytes,3)</span></span>
<span id="cb67-152"><a href="#cb67-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-153"><a href="#cb67-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-154"><a href="#cb67-154" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma[[i]]=datastruct_prior_ma[[i]];</span></span>
<span id="cb67-155"><a href="#cb67-155" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma[[i]]$include_prior = 0.01;</span></span>
<span id="cb67-156"><a href="#cb67-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-157"><a href="#cb67-157" aria-hidden="true" tabindex="-1"></a><span class="in">inits[[i]]=param</span></span>
<span id="cb67-158"><a href="#cb67-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-159"><a href="#cb67-159" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = cseed+1</span></span>
<span id="cb67-160"><a href="#cb67-160" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb67-161"><a href="#cb67-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-162"><a href="#cb67-162" aria-hidden="true" tabindex="-1"></a><span class="in">mean_log_det_stan = function(data, init, chosen_indices, S){</span></span>
<span id="cb67-163"><a href="#cb67-163" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb67-164"><a href="#cb67-164" aria-hidden="true" tabindex="-1"></a><span class="in">init_ma = function(){list(param=init)}</span></span>
<span id="cb67-165"><a href="#cb67-165" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb67-166"><a href="#cb67-166" aria-hidden="true" tabindex="-1"></a><span class="in">data$selected = chosen_indices;</span></span>
<span id="cb67-167"><a href="#cb67-167" aria-hidden="true" tabindex="-1"></a><span class="in">data$nSel = length(chosen_indices);</span></span>
<span id="cb67-168"><a href="#cb67-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-169"><a href="#cb67-169" aria-hidden="true" tabindex="-1"></a><span class="in"> fit_opt  = mod_analytes$optimize(</span></span>
<span id="cb67-170"><a href="#cb67-170" aria-hidden="true" tabindex="-1"></a><span class="in">   data = data,</span></span>
<span id="cb67-171"><a href="#cb67-171" aria-hidden="true" tabindex="-1"></a><span class="in">   output_dir = here::here("stanfiles"),</span></span>
<span id="cb67-172"><a href="#cb67-172" aria-hidden="true" tabindex="-1"></a><span class="in">   output_basename = S,</span></span>
<span id="cb67-173"><a href="#cb67-173" aria-hidden="true" tabindex="-1"></a><span class="in">   seed = cseed,</span></span>
<span id="cb67-174"><a href="#cb67-174" aria-hidden="true" tabindex="-1"></a><span class="in">   init = init_ma,</span></span>
<span id="cb67-175"><a href="#cb67-175" aria-hidden="true" tabindex="-1"></a><span class="in">   jacobian = TRUE,</span></span>
<span id="cb67-176"><a href="#cb67-176" aria-hidden="true" tabindex="-1"></a><span class="in">   show_messages = F)</span></span>
<span id="cb67-177"><a href="#cb67-177" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb67-178"><a href="#cb67-178" aria-hidden="true" tabindex="-1"></a><span class="in"> mode=fit_opt$unconstrain_variables(list(param = fit_opt$mle("param")))</span></span>
<span id="cb67-179"><a href="#cb67-179" aria-hidden="true" tabindex="-1"></a><span class="in"> hessian = fit_opt$hessian(unconstrained_variables = mode)$hessian</span></span>
<span id="cb67-180"><a href="#cb67-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-181"><a href="#cb67-181" aria-hidden="true" tabindex="-1"></a><span class="in">logdet = unlist(purrr::map(1:data$nAnalytes,\(i) log(det(-hessian[((i-1)*3+1):((i-1)*3+3),((i-1)*3+1):((i-1)*3+3)]))))</span></span>
<span id="cb67-182"><a href="#cb67-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-183"><a href="#cb67-183" aria-hidden="true" tabindex="-1"></a><span class="in">return(logdet)</span></span>
<span id="cb67-184"><a href="#cb67-184" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb67-185"><a href="#cb67-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-186"><a href="#cb67-186" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(65,66,209,210)</span></span>
<span id="cb67-187"><a href="#cb67-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-188"><a href="#cb67-188" aria-hidden="true" tabindex="-1"></a><span class="in"># quick test:</span></span>
<span id="cb67-189"><a href="#cb67-189" aria-hidden="true" tabindex="-1"></a><span class="in">z_prior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan(datastruct_prior_ma[[i]], inits[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb67-190"><a href="#cb67-190" aria-hidden="true" tabindex="-1"></a><span class="in">z_noprior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan(datastruct_noprior_ma[[i]], inits[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb67-191"><a href="#cb67-191" aria-hidden="true" tabindex="-1"></a><span class="in">test = c(mean(unlist(z_prior)),mean(unlist(z_noprior)))</span></span>
<span id="cb67-192"><a href="#cb67-192" aria-hidden="true" tabindex="-1"></a><span class="in">test</span></span>
<span id="cb67-193"><a href="#cb67-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-194"><a href="#cb67-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-195"><a href="#cb67-195" aria-hidden="true" tabindex="-1"></a><span class="in">logP = unlist(purrr::map(1:length(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]$logPobs))</span></span>
<span id="cb67-196"><a href="#cb67-196" aria-hidden="true" tabindex="-1"></a><span class="in">NAB = unlist(purrr::map(1:length(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]$N1A2B3))</span></span>
<span id="cb67-197"><a href="#cb67-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-198"><a href="#cb67-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-199"><a href="#cb67-199" aria-hidden="true" tabindex="-1"></a><span class="fu">## Optimization</span></span>
<span id="cb67-200"><a href="#cb67-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-optimization, eval=F}</span></span>
<span id="cb67-201"><a href="#cb67-201" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(213,214) # initial values</span></span>
<span id="cb67-202"><a href="#cb67-202" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-203"><a href="#cb67-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-204"><a href="#cb67-204" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(214,209,215) # initial values</span></span>
<span id="cb67-205"><a href="#cb67-205" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-206"><a href="#cb67-206" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(214,211,63) # initial values</span></span>
<span id="cb67-207"><a href="#cb67-207" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-208"><a href="#cb67-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-209"><a href="#cb67-209" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(209,210,215,79) # initial values</span></span>
<span id="cb67-210"><a href="#cb67-210" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-211"><a href="#cb67-211" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(209,210,215,71) # initial values</span></span>
<span id="cb67-212"><a href="#cb67-212" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-213"><a href="#cb67-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-214"><a href="#cb67-214" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(210,209,212,215,79) # initial values</span></span>
<span id="cb67-215"><a href="#cb67-215" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-216"><a href="#cb67-216" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(210,209,212,215,71) # initial values</span></span>
<span id="cb67-217"><a href="#cb67-217" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb67-218"><a href="#cb67-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-219"><a href="#cb67-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-220"><a href="#cb67-220" aria-hidden="true" tabindex="-1"></a><span class="fu">### Read the results and compare</span></span>
<span id="cb67-221"><a href="#cb67-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-222"><a href="#cb67-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-logDet-read, eval=T}</span></span>
<span id="cb67-223"><a href="#cb67-223" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(65,66,209,210) # ref</span></span>
<span id="cb67-224"><a href="#cb67-224" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior= c(65,66,209,210) # ref</span></span>
<span id="cb67-225"><a href="#cb67-225" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb67-226"><a href="#cb67-226" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb67-227"><a href="#cb67-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-228"><a href="#cb67-228" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(209,212) # p=2</span></span>
<span id="cb67-229"><a href="#cb67-229" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb67-230"><a href="#cb67-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-231"><a href="#cb67-231" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(212,209,215) # p=3</span></span>
<span id="cb67-232"><a href="#cb67-232" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(212,209,71) # p=3</span></span>
<span id="cb67-233"><a href="#cb67-233" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb67-234"><a href="#cb67-234" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb67-235"><a href="#cb67-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-236"><a href="#cb67-236" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(209,212,215,71) # p=4</span></span>
<span id="cb67-237"><a href="#cb67-237" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(209,212,215,71) # p=4</span></span>
<span id="cb67-238"><a href="#cb67-238" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb67-239"><a href="#cb67-239" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb67-240"><a href="#cb67-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-241"><a href="#cb67-241" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(210,209,214,215,79) # p=5</span></span>
<span id="cb67-242"><a href="#cb67-242" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(210,209,216,215,71) # p=5</span></span>
<span id="cb67-243"><a href="#cb67-243" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb67-244"><a href="#cb67-244" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb67-245"><a href="#cb67-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-246"><a href="#cb67-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-247"><a href="#cb67-247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-logDet-summary}</span></span>
<span id="cb67-248"><a href="#cb67-248" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results = tibble( logP = logP,</span></span>
<span id="cb67-249"><a href="#cb67-249" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb67-250"><a href="#cb67-250" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb67-251"><a href="#cb67-251" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb67-252"><a href="#cb67-252" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_2 = fws_prior_2$log_det_FIM,</span></span>
<span id="cb67-253"><a href="#cb67-253" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb67-254"><a href="#cb67-254" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb67-255"><a href="#cb67-255" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb67-256"><a href="#cb67-256" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb67-257"><a href="#cb67-257" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb67-258"><a href="#cb67-258" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb67-259"><a href="#cb67-259" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(prior_ref:noprior_5, names_to = "method")</span></span>
<span id="cb67-260"><a href="#cb67-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-261"><a href="#cb67-261" aria-hidden="true" tabindex="-1"></a><span class="in">p1&lt;-ggplot(summary_results, aes(y=method,x=value))+</span></span>
<span id="cb67-262"><a href="#cb67-262" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-263"><a href="#cb67-263" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=value, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-264"><a href="#cb67-264" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-265"><a href="#cb67-265" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="log(|FIM|)", y = "Method")</span></span>
<span id="cb67-266"><a href="#cb67-266" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb67-267"><a href="#cb67-267" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diff = tibble(logP = logP,</span></span>
<span id="cb67-268"><a href="#cb67-268" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb67-269"><a href="#cb67-269" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb67-270"><a href="#cb67-270" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb67-271"><a href="#cb67-271" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_2 = fws_prior_2$log_det_FIM,</span></span>
<span id="cb67-272"><a href="#cb67-272" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb67-273"><a href="#cb67-273" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb67-274"><a href="#cb67-274" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb67-275"><a href="#cb67-275" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb67-276"><a href="#cb67-276" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb67-277"><a href="#cb67-277" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb67-278"><a href="#cb67-278" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_prior_2 = (fws_prior_2 - fws_prior_ref)/n_param,</span></span>
<span id="cb67-279"><a href="#cb67-279" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_3 = (fws_prior_3 - fws_prior_ref)/n_param,</span></span>
<span id="cb67-280"><a href="#cb67-280" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_3 = (fws_noprior_3 - fws_noprior_ref)/n_param,</span></span>
<span id="cb67-281"><a href="#cb67-281" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_4 = (fws_prior_4 - fws_prior_ref)/n_param,</span></span>
<span id="cb67-282"><a href="#cb67-282" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_4 = (fws_noprior_4 - fws_noprior_ref)/n_param,</span></span>
<span id="cb67-283"><a href="#cb67-283" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_5 = (fws_prior_5 - fws_prior_ref)/n_param,</span></span>
<span id="cb67-284"><a href="#cb67-284" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_5 = (fws_noprior_5 - fws_noprior_ref)/n_param)%&gt;%</span></span>
<span id="cb67-285"><a href="#cb67-285" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_prior_2:d_noprior_5, names_to = "method")</span></span>
<span id="cb67-286"><a href="#cb67-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-287"><a href="#cb67-287" aria-hidden="true" tabindex="-1"></a><span class="in">p2=ggplot(summary_results_diff, aes(y=method,x=exp(value)))+</span></span>
<span id="cb67-288"><a href="#cb67-288" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-289"><a href="#cb67-289" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-290"><a href="#cb67-290" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-291"><a href="#cb67-291" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Efficiency relative to the reference design", y = "Method")+</span></span>
<span id="cb67-292"><a href="#cb67-292" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")</span></span>
<span id="cb67-293"><a href="#cb67-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-294"><a href="#cb67-294" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diffprior = tibble(logP = logP,</span></span>
<span id="cb67-295"><a href="#cb67-295" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb67-296"><a href="#cb67-296" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb67-297"><a href="#cb67-297" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb67-298"><a href="#cb67-298" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb67-299"><a href="#cb67-299" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb67-300"><a href="#cb67-300" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb67-301"><a href="#cb67-301" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb67-302"><a href="#cb67-302" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb67-303"><a href="#cb67-303" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb67-304"><a href="#cb67-304" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_ref  = (fws_prior_ref-fws_noprior_ref)/n_param,</span></span>
<span id="cb67-305"><a href="#cb67-305" aria-hidden="true" tabindex="-1"></a><span class="in">         d_3 = (fws_prior_3-fws_noprior_3)/n_param,</span></span>
<span id="cb67-306"><a href="#cb67-306" aria-hidden="true" tabindex="-1"></a><span class="in">         d_4 = (fws_prior_4-fws_noprior_4)/n_param,</span></span>
<span id="cb67-307"><a href="#cb67-307" aria-hidden="true" tabindex="-1"></a><span class="in">         d_5 = (fws_prior_5-fws_noprior_5)/n_param)%&gt;%</span></span>
<span id="cb67-308"><a href="#cb67-308" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_ref:d_5, names_to = "method")</span></span>
<span id="cb67-309"><a href="#cb67-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-310"><a href="#cb67-310" aria-hidden="true" tabindex="-1"></a><span class="in">p3=ggplot(summary_results_diffprior, aes(y=method,x=exp(value)))+</span></span>
<span id="cb67-311"><a href="#cb67-311" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-312"><a href="#cb67-312" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-313"><a href="#cb67-313" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-314"><a href="#cb67-314" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Effect of prior on design efficiency", y = "Method")+</span></span>
<span id="cb67-315"><a href="#cb67-315" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")+</span></span>
<span id="cb67-316"><a href="#cb67-316" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0.5,100),</span></span>
<span id="cb67-317"><a href="#cb67-317" aria-hidden="true" tabindex="-1"></a><span class="in">                     trans='log10',</span></span>
<span id="cb67-318"><a href="#cb67-318" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.01, 100)),</span></span>
<span id="cb67-319"><a href="#cb67-319" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb67-320"><a href="#cb67-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-321"><a href="#cb67-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-322"><a href="#cb67-322" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb67-323"><a href="#cb67-323" aria-hidden="true" tabindex="-1"></a><span class="in">p2</span></span>
<span id="cb67-324"><a href="#cb67-324" aria-hidden="true" tabindex="-1"></a><span class="in">p3</span></span>
<span id="cb67-325"><a href="#cb67-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-326"><a href="#cb67-326" aria-hidden="true" tabindex="-1"></a><span class="in">f2_1 = p2</span></span>
<span id="cb67-327"><a href="#cb67-327" aria-hidden="true" tabindex="-1"></a><span class="in">f3_1 = p3</span></span>
<span id="cb67-328"><a href="#cb67-328" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p1, .filename=paste("single-form-analytes-logdFIM-abs.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-329"><a href="#cb67-329" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p1, .filename=paste("single-form-analytes-logdFIM-abs.png"), .path = figures_dir1)</span></span>
<span id="cb67-330"><a href="#cb67-330" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p2, .filename=paste("single-form-analytes-logdFIM-rel.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-331"><a href="#cb67-331" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p2, .filename=paste("single-form-analytes-logdFIM-rel.png"), .path = figures_dir1)</span></span>
<span id="cb67-332"><a href="#cb67-332" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p3, .filename=paste("single-form-analytes-logdFIM-prioreff.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-333"><a href="#cb67-333" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p3, .filename=paste("single-form-analytes-logdFIM-prioreff.png"), .path = figures_dir1)</span></span>
<span id="cb67-334"><a href="#cb67-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-335"><a href="#cb67-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-336"><a href="#cb67-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-337"><a href="#cb67-337" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table</span></span>
<span id="cb67-338"><a href="#cb67-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-table}</span></span>
<span id="cb67-339"><a href="#cb67-339" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma=hplcparam_candidates_df%&gt;%filter(xpH==0)%&gt;%</span></span>
<span id="cb67-340"><a href="#cb67-340" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(line=1:n())</span></span>
<span id="cb67-341"><a href="#cb67-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-342"><a href="#cb67-342" aria-hidden="true" tabindex="-1"></a><span class="in">combined_results = list(</span></span>
<span id="cb67-343"><a href="#cb67-343" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ref = fws_prior_ref$chosen_indices,</span></span>
<span id="cb67-344"><a href="#cb67-344" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ref = fws_noprior_ref$chosen_indices,</span></span>
<span id="cb67-345"><a href="#cb67-345" aria-hidden="true" tabindex="-1"></a><span class="in">prior_2 = fws_prior_2$chosen_indices,</span></span>
<span id="cb67-346"><a href="#cb67-346" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_2 = 10000+fws_prior_2$chosen_indices, # dummy</span></span>
<span id="cb67-347"><a href="#cb67-347" aria-hidden="true" tabindex="-1"></a><span class="in">prior_3 = fws_prior_3$chosen_indices,</span></span>
<span id="cb67-348"><a href="#cb67-348" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_3 = fws_noprior_3$chosen_indices,</span></span>
<span id="cb67-349"><a href="#cb67-349" aria-hidden="true" tabindex="-1"></a><span class="in">prior_4 = fws_prior_4$chosen_indices,</span></span>
<span id="cb67-350"><a href="#cb67-350" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_4 = fws_noprior_4$chosen_indices,</span></span>
<span id="cb67-351"><a href="#cb67-351" aria-hidden="true" tabindex="-1"></a><span class="in">prior_5 = fws_prior_5$chosen_indices,</span></span>
<span id="cb67-352"><a href="#cb67-352" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_5 = fws_noprior_5$chosen_indices)</span></span>
<span id="cb67-353"><a href="#cb67-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-354"><a href="#cb67-354" aria-hidden="true" tabindex="-1"></a><span class="in">selected_exp = enframe(combined_results)%&gt;%</span></span>
<span id="cb67-355"><a href="#cb67-355" aria-hidden="true" tabindex="-1"></a><span class="in">   unnest(value) %&gt;%</span></span>
<span id="cb67-356"><a href="#cb67-356" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(line=value, Name = name) %&gt;%</span></span>
<span id="cb67-357"><a href="#cb67-357" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(data_ma, by = "line")%&gt;%</span></span>
<span id="cb67-358"><a href="#cb67-358" aria-hidden="true" tabindex="-1"></a><span class="in">   arrange(Name,tg, fio)%&gt;%</span></span>
<span id="cb67-359"><a href="#cb67-359" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Modifier = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb67-360"><a href="#cb67-360" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-c(line,xpH,m,td,to,te,fif)) %&gt;%</span></span>
<span id="cb67-361"><a href="#cb67-361" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(type = if_else(str_detect(Name, 'noprior'), "No prior", "Prior"))%&gt;%</span></span>
<span id="cb67-362"><a href="#cb67-362" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(where(is.numeric), ~replace_na(., -1)))</span></span>
<span id="cb67-363"><a href="#cb67-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-364"><a href="#cb67-364" aria-hidden="true" tabindex="-1"></a><span class="in">tab1&lt;-selected_exp %&gt;%</span></span>
<span id="cb67-365"><a href="#cb67-365" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "Prior") %&gt;%</span></span>
<span id="cb67-366"><a href="#cb67-366" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-type)%&gt;%</span></span>
<span id="cb67-367"><a href="#cb67-367" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb67-368"><a href="#cb67-368" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb67-369"><a href="#cb67-369" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb67-370"><a href="#cb67-370" aria-hidden="true" tabindex="-1"></a><span class="in">tab2&lt;-selected_exp %&gt;%</span></span>
<span id="cb67-371"><a href="#cb67-371" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "No prior")%&gt;%</span></span>
<span id="cb67-372"><a href="#cb67-372" aria-hidden="true" tabindex="-1"></a><span class="in">    select(-type)%&gt;%</span></span>
<span id="cb67-373"><a href="#cb67-373" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb67-374"><a href="#cb67-374" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb67-375"><a href="#cb67-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-376"><a href="#cb67-376" aria-hidden="true" tabindex="-1"></a><span class="in">tab2 &lt;- set_formatter(</span></span>
<span id="cb67-377"><a href="#cb67-377" aria-hidden="true" tabindex="-1"></a><span class="in">  tab2, </span></span>
<span id="cb67-378"><a href="#cb67-378" aria-hidden="true" tabindex="-1"></a><span class="in">  tg = function(x) ifelse(x==-1," ", sprintf("%.0f", x) ),</span></span>
<span id="cb67-379"><a href="#cb67-379" aria-hidden="true" tabindex="-1"></a><span class="in">  fio = function(x) ifelse(x==-1," ", sprintf("%.2f", x) )</span></span>
<span id="cb67-380"><a href="#cb67-380" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb67-381"><a href="#cb67-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-382"><a href="#cb67-382" aria-hidden="true" tabindex="-1"></a><span class="in">p1 = gen_grob(tab1, fit = "auto", just = "centre")</span></span>
<span id="cb67-383"><a href="#cb67-383" aria-hidden="true" tabindex="-1"></a><span class="in">p2 = gen_grob(tab2, fit = "auto", just = "centre") </span></span>
<span id="cb67-384"><a href="#cb67-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-385"><a href="#cb67-385" aria-hidden="true" tabindex="-1"></a><span class="in">gg&lt;-ggplot()+</span></span>
<span id="cb67-386"><a href="#cb67-386" aria-hidden="true" tabindex="-1"></a><span class="in">       theme(</span></span>
<span id="cb67-387"><a href="#cb67-387" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.background = element_rect(fill='transparent'),</span></span>
<span id="cb67-388"><a href="#cb67-388" aria-hidden="true" tabindex="-1"></a><span class="in">         plot.background = element_rect(fill='transparent', color=NA),</span></span>
<span id="cb67-389"><a href="#cb67-389" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.major = element_blank(),</span></span>
<span id="cb67-390"><a href="#cb67-390" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.minor = element_blank(),</span></span>
<span id="cb67-391"><a href="#cb67-391" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.background = element_rect(fill='transparent'),</span></span>
<span id="cb67-392"><a href="#cb67-392" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.box.background = element_rect(fill='transparent')</span></span>
<span id="cb67-393"><a href="#cb67-393" aria-hidden="true" tabindex="-1"></a><span class="in">       )</span></span>
<span id="cb67-394"><a href="#cb67-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-395"><a href="#cb67-395" aria-hidden="true" tabindex="-1"></a><span class="in">plot1 &lt;- gg+p1+p2+ plot_layout(ncol = 3, widths = c(1, 20,20))</span></span>
<span id="cb67-396"><a href="#cb67-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-397"><a href="#cb67-397" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plot1, .filename=paste("single-form-analytes-table.pdf"), .path = tables_dir1)</span></span>
<span id="cb67-398"><a href="#cb67-398" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plot1, .filename=paste("single-form-analytes-table.png"), .path = tables_dir1)</span></span>
<span id="cb67-399"><a href="#cb67-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-400"><a href="#cb67-400" aria-hidden="true" tabindex="-1"></a><span class="in">tab1</span></span>
<span id="cb67-401"><a href="#cb67-401" aria-hidden="true" tabindex="-1"></a><span class="in">tab2</span></span>
<span id="cb67-402"><a href="#cb67-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-403"><a href="#cb67-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-404"><a href="#cb67-404" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stan simulations</span></span>
<span id="cb67-405"><a href="#cb67-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-laplace, eval=T}</span></span>
<span id="cb67-406"><a href="#cb67-406" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_ref$chosen_indices # ref</span></span>
<span id="cb67-407"><a href="#cb67-407" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_ref = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-408"><a href="#cb67-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-409"><a href="#cb67-409" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_ref$chosen_indices # ref</span></span>
<span id="cb67-410"><a href="#cb67-410" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_ref = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-411"><a href="#cb67-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-412"><a href="#cb67-412" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_2$chosen_indices # p=2</span></span>
<span id="cb67-413"><a href="#cb67-413" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_2 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-414"><a href="#cb67-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-415"><a href="#cb67-415" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_3$chosen_indices # p=3</span></span>
<span id="cb67-416"><a href="#cb67-416" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_3 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-417"><a href="#cb67-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-418"><a href="#cb67-418" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_3$chosen_indices # p=3</span></span>
<span id="cb67-419"><a href="#cb67-419" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_3 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-420"><a href="#cb67-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-421"><a href="#cb67-421" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_4$chosen_indices # p=4</span></span>
<span id="cb67-422"><a href="#cb67-422" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_4 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-423"><a href="#cb67-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-424"><a href="#cb67-424" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_4$chosen_indices # p=4</span></span>
<span id="cb67-425"><a href="#cb67-425" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_4 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-426"><a href="#cb67-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-427"><a href="#cb67-427" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_5$chosen_indices # p=5</span></span>
<span id="cb67-428"><a href="#cb67-428" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_5 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-429"><a href="#cb67-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-430"><a href="#cb67-430" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_5$chosen_indices # p=5</span></span>
<span id="cb67-431"><a href="#cb67-431" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_5 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb67-432"><a href="#cb67-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-433"><a href="#cb67-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-434"><a href="#cb67-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-435"><a href="#cb67-435" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gradient conditions</span></span>
<span id="cb67-436"><a href="#cb67-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-gra-summary}</span></span>
<span id="cb67-437"><a href="#cb67-437" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_5$chosen_indices # p=5</span></span>
<span id="cb67-438"><a href="#cb67-438" aria-hidden="true" tabindex="-1"></a><span class="in">p31=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb67-439"><a href="#cb67-439" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0)%&gt;%</span></span>
<span id="cb67-440"><a href="#cb67-440" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb67-441"><a href="#cb67-441" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(prior_ma_5$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb67-442"><a href="#cb67-442" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb67-443"><a href="#cb67-443" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb67-444"><a href="#cb67-444" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb67-445"><a href="#cb67-445" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb67-446"><a href="#cb67-446" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb67-447"><a href="#cb67-447" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb67-448"><a href="#cb67-448" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_5$chosen_indices # p=5</span></span>
<span id="cb67-449"><a href="#cb67-449" aria-hidden="true" tabindex="-1"></a><span class="in">p32=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb67-450"><a href="#cb67-450" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0)%&gt;%</span></span>
<span id="cb67-451"><a href="#cb67-451" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb67-452"><a href="#cb67-452" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(noprior_ma_5$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb67-453"><a href="#cb67-453" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb67-454"><a href="#cb67-454" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb67-455"><a href="#cb67-455" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb67-456"><a href="#cb67-456" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb67-457"><a href="#cb67-457" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb67-458"><a href="#cb67-458" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb67-459"><a href="#cb67-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-460"><a href="#cb67-460" aria-hidden="true" tabindex="-1"></a><span class="in">iresults = rbind(prior_ma_ref$iresults%&gt;%</span></span>
<span id="cb67-461"><a href="#cb67-461" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb67-462"><a href="#cb67-462" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ref$iresults%&gt;%</span></span>
<span id="cb67-463"><a href="#cb67-463" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb67-464"><a href="#cb67-464" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_2$iresults%&gt;%</span></span>
<span id="cb67-465"><a href="#cb67-465" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb67-466"><a href="#cb67-466" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_3$iresults%&gt;%</span></span>
<span id="cb67-467"><a href="#cb67-467" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb67-468"><a href="#cb67-468" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_3$iresults%&gt;%</span></span>
<span id="cb67-469"><a href="#cb67-469" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb67-470"><a href="#cb67-470" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_4$iresults%&gt;%</span></span>
<span id="cb67-471"><a href="#cb67-471" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb67-472"><a href="#cb67-472" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_4$iresults%&gt;%</span></span>
<span id="cb67-473"><a href="#cb67-473" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4"),</span></span>
<span id="cb67-474"><a href="#cb67-474" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_5$iresults%&gt;%</span></span>
<span id="cb67-475"><a href="#cb67-475" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_5"),</span></span>
<span id="cb67-476"><a href="#cb67-476" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_5$iresults%&gt;%</span></span>
<span id="cb67-477"><a href="#cb67-477" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_5"))%&gt;%</span></span>
<span id="cb67-478"><a href="#cb67-478" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(ivar = if_else(ivar&gt;1e6,1e6,ivar)) %&gt;%</span></span>
<span id="cb67-479"><a href="#cb67-479" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.factor(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB))</span></span>
<span id="cb67-480"><a href="#cb67-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-481"><a href="#cb67-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-482"><a href="#cb67-482" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=iresults %&gt;%</span></span>
<span id="cb67-483"><a href="#cb67-483" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb67-484"><a href="#cb67-484" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-485"><a href="#cb67-485" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-486"><a href="#cb67-486" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-487"><a href="#cb67-487" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb67-488"><a href="#cb67-488" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb67-489"><a href="#cb67-489" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(0.1,100))+   </span></span>
<span id="cb67-490"><a href="#cb67-490" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb67-491"><a href="#cb67-491" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb67-492"><a href="#cb67-492" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb67-493"><a href="#cb67-493" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=iresults %&gt;%</span></span>
<span id="cb67-494"><a href="#cb67-494" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb67-495"><a href="#cb67-495" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-496"><a href="#cb67-496" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-497"><a href="#cb67-497" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-498"><a href="#cb67-498" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb67-499"><a href="#cb67-499" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb67-500"><a href="#cb67-500" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,1000000))+    </span></span>
<span id="cb67-501"><a href="#cb67-501" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb67-502"><a href="#cb67-502" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb67-503"><a href="#cb67-503" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb67-504"><a href="#cb67-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-505"><a href="#cb67-505" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb67-506"><a href="#cb67-506" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb67-507"><a href="#cb67-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-508"><a href="#cb67-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-509"><a href="#cb67-509" aria-hidden="true" tabindex="-1"></a><span class="in">idx_exemple_analytes = iresults %&gt;%</span></span>
<span id="cb67-510"><a href="#cb67-510" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(method=="prior_ref") %&gt;%</span></span>
<span id="cb67-511"><a href="#cb67-511" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(ivar)%&gt;%</span></span>
<span id="cb67-512"><a href="#cb67-512" aria-hidden="true" tabindex="-1"></a><span class="in">  slice(which(row_number() %% 100 == 1)) %&gt;%</span></span>
<span id="cb67-513"><a href="#cb67-513" aria-hidden="true" tabindex="-1"></a><span class="in">  select(i)%&gt;%pull()</span></span>
<span id="cb67-514"><a href="#cb67-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-515"><a href="#cb67-515" aria-hidden="true" tabindex="-1"></a><span class="in">iresults %&gt;%</span></span>
<span id="cb67-516"><a href="#cb67-516" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb67-517"><a href="#cb67-517" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb67-518"><a href="#cb67-518" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb67-519"><a href="#cb67-519" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb67-520"><a href="#cb67-520" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb67-521"><a href="#cb67-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-522"><a href="#cb67-522" aria-hidden="true" tabindex="-1"></a><span class="in">f55_1=iresults %&gt;%</span></span>
<span id="cb67-523"><a href="#cb67-523" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb67-524"><a href="#cb67-524" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb67-525"><a href="#cb67-525" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb67-526"><a href="#cb67-526" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb67-527"><a href="#cb67-527" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(`&lt;=1x`:`&lt;=3x`, names_to = "target") %&gt;%</span></span>
<span id="cb67-528"><a href="#cb67-528" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=value,color=as.factor(target)))+</span></span>
<span id="cb67-529"><a href="#cb67-529" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point()+</span></span>
<span id="cb67-530"><a href="#cb67-530" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Probability", y = "Method", color = "target")+</span></span>
<span id="cb67-531"><a href="#cb67-531" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 0.9, linetype="dotted")</span></span>
<span id="cb67-532"><a href="#cb67-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-533"><a href="#cb67-533" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=f55_1, .filename=paste("single-form-analytes-gra-prob.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-534"><a href="#cb67-534" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=f55_1, .filename=paste("single-form-analytes-gra-prob.png"), .path = figures_dir1)</span></span>
<span id="cb67-535"><a href="#cb67-535" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p31, .filename=paste("single-form-analytes-gra-prior-p5.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-536"><a href="#cb67-536" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p31, .filename=paste("single-form-analytes-gra-prior-p5.png"), .path = figures_dir1)</span></span>
<span id="cb67-537"><a href="#cb67-537" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p32, .filename=paste("single-form-analytes-gra-noprior-p5.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-538"><a href="#cb67-538" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p32, .filename=paste("single-form-analytes-gra-noprior-p5.png"), .path = figures_dir1)</span></span>
<span id="cb67-539"><a href="#cb67-539" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-gra-maxvar.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-540"><a href="#cb67-540" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-gra-maxvar.png"), .path = figures_dir1)</span></span>
<span id="cb67-541"><a href="#cb67-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-542"><a href="#cb67-542" aria-hidden="true" tabindex="-1"></a><span class="in">p31</span></span>
<span id="cb67-543"><a href="#cb67-543" aria-hidden="true" tabindex="-1"></a><span class="in">p32</span></span>
<span id="cb67-544"><a href="#cb67-544" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb67-545"><a href="#cb67-545" aria-hidden="true" tabindex="-1"></a><span class="in">f33_1=p33</span></span>
<span id="cb67-546"><a href="#cb67-546" aria-hidden="true" tabindex="-1"></a><span class="in">f55_1</span></span>
<span id="cb67-547"><a href="#cb67-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-548"><a href="#cb67-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-549"><a href="#cb67-549" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Isocratic conditions</span></span>
<span id="cb67-550"><a href="#cb67-550" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Individual plots</span></span>
<span id="cb67-551"><a href="#cb67-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-izo-summary}</span></span>
<span id="cb67-552"><a href="#cb67-552" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb67-553"><a href="#cb67-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-554"><a href="#cb67-554" aria-hidden="true" tabindex="-1"></a><span class="in">plot_id = function(results) { </span></span>
<span id="cb67-555"><a href="#cb67-555" aria-hidden="true" tabindex="-1"></a><span class="in">  results %&gt;%</span></span>
<span id="cb67-556"><a href="#cb67-556" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=fi, y=CV/10)) +</span></span>
<span id="cb67-557"><a href="#cb67-557" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb67-558"><a href="#cb67-558" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(aes(x=fi, ymin = llog10tr, ymax = ulog10tr), alpha = 0.4, col = NA) +</span></span>
<span id="cb67-559"><a href="#cb67-559" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x=fi, y=mlog10tr), col = "black", size=0.25) +</span></span>
<span id="cb67-560"><a href="#cb67-560" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_y_continuous(</span></span>
<span id="cb67-561"><a href="#cb67-561" aria-hidden="true" tabindex="-1"></a><span class="in">    name = "log(tr)",</span></span>
<span id="cb67-562"><a href="#cb67-562" aria-hidden="true" tabindex="-1"></a><span class="in">    sec.axis = sec_axis(~.*10, name="%CV")) +</span></span>
<span id="cb67-563"><a href="#cb67-563" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0,1,by=0.2))+</span></span>
<span id="cb67-564"><a href="#cb67-564" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_grid(i~mod) +</span></span>
<span id="cb67-565"><a href="#cb67-565" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 1, linetype=2)+</span></span>
<span id="cb67-566"><a href="#cb67-566" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim=c(0,4))</span></span>
<span id="cb67-567"><a href="#cb67-567" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb67-568"><a href="#cb67-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-569"><a href="#cb67-569" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_ref&lt;-prior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb67-570"><a href="#cb67-570" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-571"><a href="#cb67-571" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-572"><a href="#cb67-572" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-573"><a href="#cb67-573" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-574"><a href="#cb67-574" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-575"><a href="#cb67-575" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-576"><a href="#cb67-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-577"><a href="#cb67-577" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_ref&lt;-noprior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb67-578"><a href="#cb67-578" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-579"><a href="#cb67-579" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-580"><a href="#cb67-580" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-581"><a href="#cb67-581" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-582"><a href="#cb67-582" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-583"><a href="#cb67-583" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-584"><a href="#cb67-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-585"><a href="#cb67-585" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_2&lt;-prior_ma_2$izoresults%&gt;%</span></span>
<span id="cb67-586"><a href="#cb67-586" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-587"><a href="#cb67-587" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-588"><a href="#cb67-588" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-589"><a href="#cb67-589" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-590"><a href="#cb67-590" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-591"><a href="#cb67-591" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-592"><a href="#cb67-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-593"><a href="#cb67-593" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_3&lt;-prior_ma_3$izoresults%&gt;%</span></span>
<span id="cb67-594"><a href="#cb67-594" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-595"><a href="#cb67-595" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-596"><a href="#cb67-596" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-597"><a href="#cb67-597" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-598"><a href="#cb67-598" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = mrgmisc::ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-599"><a href="#cb67-599" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-600"><a href="#cb67-600" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_3&lt;-noprior_ma_3$izoresults%&gt;%</span></span>
<span id="cb67-601"><a href="#cb67-601" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-602"><a href="#cb67-602" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-603"><a href="#cb67-603" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-604"><a href="#cb67-604" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-605"><a href="#cb67-605" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-606"><a href="#cb67-606" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-607"><a href="#cb67-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-608"><a href="#cb67-608" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_4&lt;-prior_ma_4$izoresults%&gt;%</span></span>
<span id="cb67-609"><a href="#cb67-609" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-610"><a href="#cb67-610" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-611"><a href="#cb67-611" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-612"><a href="#cb67-612" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-613"><a href="#cb67-613" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-614"><a href="#cb67-614" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-615"><a href="#cb67-615" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_4&lt;-noprior_ma_4$izoresults%&gt;%</span></span>
<span id="cb67-616"><a href="#cb67-616" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-617"><a href="#cb67-617" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-618"><a href="#cb67-618" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-619"><a href="#cb67-619" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-620"><a href="#cb67-620" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-621"><a href="#cb67-621" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-622"><a href="#cb67-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-623"><a href="#cb67-623" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_5&lt;-prior_ma_5$izoresults%&gt;%</span></span>
<span id="cb67-624"><a href="#cb67-624" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-625"><a href="#cb67-625" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-626"><a href="#cb67-626" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-627"><a href="#cb67-627" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-628"><a href="#cb67-628" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-629"><a href="#cb67-629" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-630"><a href="#cb67-630" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_5&lt;-noprior_ma_5$izoresults%&gt;%</span></span>
<span id="cb67-631"><a href="#cb67-631" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb67-632"><a href="#cb67-632" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-633"><a href="#cb67-633" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb67-634"><a href="#cb67-634" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb67-635"><a href="#cb67-635" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb67-636"><a href="#cb67-636" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb67-637"><a href="#cb67-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-638"><a href="#cb67-638" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ref = map(results_prior_ma_ref,plot_id) </span></span>
<span id="cb67-639"><a href="#cb67-639" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ref = map(results_noprior_ma_ref,plot_id) </span></span>
<span id="cb67-640"><a href="#cb67-640" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_2 = map(results_prior_ma_2,plot_id) </span></span>
<span id="cb67-641"><a href="#cb67-641" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_3 = map(results_prior_ma_3,plot_id) </span></span>
<span id="cb67-642"><a href="#cb67-642" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_3 = map(results_noprior_ma_3,plot_id) </span></span>
<span id="cb67-643"><a href="#cb67-643" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_4 = map(results_prior_ma_4,plot_id) </span></span>
<span id="cb67-644"><a href="#cb67-644" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_4 = map(results_noprior_ma_4,plot_id) </span></span>
<span id="cb67-645"><a href="#cb67-645" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_5 = map(results_prior_ma_5,plot_id) </span></span>
<span id="cb67-646"><a href="#cb67-646" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_5 = map(results_noprior_ma_5,plot_id) </span></span>
<span id="cb67-647"><a href="#cb67-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-648"><a href="#cb67-648" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_ref[[1]], .filename=paste("plots-results-prior-ma-ref.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-649"><a href="#cb67-649" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_ref[[1]], .filename=paste("plots-results-prior-ma-ref.png"), .path = figures_dir1)</span></span>
<span id="cb67-650"><a href="#cb67-650" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_5[[1]], .filename=paste("plots-results-prior-ma-5.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-651"><a href="#cb67-651" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_5[[1]], .filename=paste("plots-results-prior-ma-5.png"), .path = figures_dir1)</span></span>
<span id="cb67-652"><a href="#cb67-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-653"><a href="#cb67-653" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ref </span></span>
<span id="cb67-654"><a href="#cb67-654" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ref </span></span>
<span id="cb67-655"><a href="#cb67-655" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_2</span></span>
<span id="cb67-656"><a href="#cb67-656" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_3</span></span>
<span id="cb67-657"><a href="#cb67-657" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_3 </span></span>
<span id="cb67-658"><a href="#cb67-658" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_4 </span></span>
<span id="cb67-659"><a href="#cb67-659" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_4 </span></span>
<span id="cb67-660"><a href="#cb67-660" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_5  </span></span>
<span id="cb67-661"><a href="#cb67-661" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_5 </span></span>
<span id="cb67-662"><a href="#cb67-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-663"><a href="#cb67-663" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb67-664"><a href="#cb67-664" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb67-665"><a href="#cb67-665" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb67-666"><a href="#cb67-666" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb67-667"><a href="#cb67-667" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb67-668"><a href="#cb67-668" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span>
<span id="cb67-669"><a href="#cb67-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-670"><a href="#cb67-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-671"><a href="#cb67-671" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Combined</span></span>
<span id="cb67-672"><a href="#cb67-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-izo-summary-combined}</span></span>
<span id="cb67-673"><a href="#cb67-673" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb67-674"><a href="#cb67-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-675"><a href="#cb67-675" aria-hidden="true" tabindex="-1"></a><span class="in">plot_id = function(results) { </span></span>
<span id="cb67-676"><a href="#cb67-676" aria-hidden="true" tabindex="-1"></a><span class="in">  results %&gt;%</span></span>
<span id="cb67-677"><a href="#cb67-677" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=fi, y=CV)) +</span></span>
<span id="cb67-678"><a href="#cb67-678" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb67-679"><a href="#cb67-679" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(aes(x=fi, ymin = llog10tr, ymax = ulog10tr), alpha = 0.4, col = NA) +</span></span>
<span id="cb67-680"><a href="#cb67-680" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x=fi, y=mlog10tr), col = "black", size=0.25) +</span></span>
<span id="cb67-681"><a href="#cb67-681" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_y_continuous(</span></span>
<span id="cb67-682"><a href="#cb67-682" aria-hidden="true" tabindex="-1"></a><span class="in">    name = "log(tr)",</span></span>
<span id="cb67-683"><a href="#cb67-683" aria-hidden="true" tabindex="-1"></a><span class="in">    sec.axis = sec_axis(~.*1, name="%CV")) +</span></span>
<span id="cb67-684"><a href="#cb67-684" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0,1,by=0.2))+</span></span>
<span id="cb67-685"><a href="#cb67-685" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_grid(i~mod) +</span></span>
<span id="cb67-686"><a href="#cb67-686" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 1, linetype=2)+</span></span>
<span id="cb67-687"><a href="#cb67-687" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim=c(0,4))</span></span>
<span id="cb67-688"><a href="#cb67-688" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb67-689"><a href="#cb67-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-690"><a href="#cb67-690" aria-hidden="true" tabindex="-1"></a><span class="in">izoresults = rbind( prior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb67-691"><a href="#cb67-691" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb67-692"><a href="#cb67-692" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb67-693"><a href="#cb67-693" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb67-694"><a href="#cb67-694" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_2$izoresults%&gt;%</span></span>
<span id="cb67-695"><a href="#cb67-695" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb67-696"><a href="#cb67-696" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_3$izoresults%&gt;%</span></span>
<span id="cb67-697"><a href="#cb67-697" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb67-698"><a href="#cb67-698" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_3$izoresults%&gt;%</span></span>
<span id="cb67-699"><a href="#cb67-699" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb67-700"><a href="#cb67-700" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_4$izoresults%&gt;%</span></span>
<span id="cb67-701"><a href="#cb67-701" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb67-702"><a href="#cb67-702" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_4$izoresults%&gt;%</span></span>
<span id="cb67-703"><a href="#cb67-703" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4"),</span></span>
<span id="cb67-704"><a href="#cb67-704" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_5$izoresults%&gt;%</span></span>
<span id="cb67-705"><a href="#cb67-705" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_5"),</span></span>
<span id="cb67-706"><a href="#cb67-706" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_5$izoresults%&gt;%</span></span>
<span id="cb67-707"><a href="#cb67-707" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_5")) %&gt;%</span></span>
<span id="cb67-708"><a href="#cb67-708" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&lt;=log10(100))%&gt;%</span></span>
<span id="cb67-709"><a href="#cb67-709" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&gt;=log10(5))%&gt;%</span></span>
<span id="cb67-710"><a href="#cb67-710" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c = as.numeric(c),</span></span>
<span id="cb67-711"><a href="#cb67-711" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb67-712"><a href="#cb67-712" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(i,method,c)%&gt;%</span></span>
<span id="cb67-713"><a href="#cb67-713" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(i,method) %&gt;%</span></span>
<span id="cb67-714"><a href="#cb67-714" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(imaxcv = max(CV), imincv = min(CV), aveCV = pracma::trapz(c, CV)/(n()-1)) %&gt;%</span></span>
<span id="cb67-715"><a href="#cb67-715" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(imaxcv = if_else(imaxcv&gt;1e4,1e4,imaxcv))%&gt;%</span></span>
<span id="cb67-716"><a href="#cb67-716" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.integer(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB)) </span></span>
<span id="cb67-717"><a href="#cb67-717" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb67-718"><a href="#cb67-718" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=izoresults %&gt;%</span></span>
<span id="cb67-719"><a href="#cb67-719" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb67-720"><a href="#cb67-720" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-721"><a href="#cb67-721" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-722"><a href="#cb67-722" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb67-723"><a href="#cb67-723" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-724"><a href="#cb67-724" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb67-725"><a href="#cb67-725" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb67-726"><a href="#cb67-726" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(1,100))+   </span></span>
<span id="cb67-727"><a href="#cb67-727" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb67-728"><a href="#cb67-728" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb67-729"><a href="#cb67-729" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb67-730"><a href="#cb67-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-731"><a href="#cb67-731" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=izoresults %&gt;%</span></span>
<span id="cb67-732"><a href="#cb67-732" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb67-733"><a href="#cb67-733" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb67-734"><a href="#cb67-734" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb67-735"><a href="#cb67-735" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb67-736"><a href="#cb67-736" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb67-737"><a href="#cb67-737" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb67-738"><a href="#cb67-738" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb67-739"><a href="#cb67-739" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,10000))+    </span></span>
<span id="cb67-740"><a href="#cb67-740" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb67-741"><a href="#cb67-741" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb67-742"><a href="#cb67-742" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb67-743"><a href="#cb67-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-744"><a href="#cb67-744" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb67-745"><a href="#cb67-745" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb67-746"><a href="#cb67-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-747"><a href="#cb67-747" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-izo-combined-CV.pdf"), .path = figures_dir1)</span></span>
<span id="cb67-748"><a href="#cb67-748" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-izo-combined-CV.png"), .path = figures_dir1)</span></span>
<span id="cb67-749"><a href="#cb67-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-750"><a href="#cb67-750" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb67-751"><a href="#cb67-751" aria-hidden="true" tabindex="-1"></a><span class="in">f44_1 = p33</span></span>
<span id="cb67-752"><a href="#cb67-752" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-753"><a href="#cb67-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-754"><a href="#cb67-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-755"><a href="#cb67-755" aria-hidden="true" tabindex="-1"></a><span class="fu"># References {.unnumbered}</span></span>
<span id="cb67-756"><a href="#cb67-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-757"><a href="#cb67-757" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb67-758"><a href="#cb67-758" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-759"><a href="#cb67-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-760"><a href="#cb67-760" aria-hidden="true" tabindex="-1"></a><span class="fu"># Licenses {.unnumbered}</span></span>
<span id="cb67-761"><a href="#cb67-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-762"><a href="#cb67-762" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Code &amp; copy; 2024, Paweł Wiczling, licensed under BSD-3.</span>
<span id="cb67-763"><a href="#cb67-763" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Text &amp; copy; 2024, Paweł Wiczling, licensed under CC-BY-NC 4.0.</span>
<span id="cb67-764"><a href="#cb67-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-765"><a href="#cb67-765" aria-hidden="true" tabindex="-1"></a><span class="fu"># Original Computing Environment {.unnumbered}</span></span>
<span id="cb67-766"><a href="#cb67-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-767"><a href="#cb67-767" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sessionInfo}</span></span>
<span id="cb67-768"><a href="#cb67-768" aria-hidden="true" tabindex="-1"></a><span class="in">sessionInfo()</span></span>
<span id="cb67-769"><a href="#cb67-769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Paweł Wiczling*">
<meta name="dcterms.date" content="2024-12-26">

<title>Design3: Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="optimal-design-for-mixtures-design3_files/libs/clipboard/clipboard.min.js"></script>
<script src="optimal-design-for-mixtures-design3_files/libs/quarto-html/quarto.js"></script>
<script src="optimal-design-for-mixtures-design3_files/libs/quarto-html/popper.min.js"></script>
<script src="optimal-design-for-mixtures-design3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="optimal-design-for-mixtures-design3_files/libs/quarto-html/anchor.min.js"></script>
<link href="optimal-design-for-mixtures-design3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="optimal-design-for-mixtures-design3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="optimal-design-for-mixtures-design3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="optimal-design-for-mixtures-design3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="optimal-design-for-mixtures-design3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="optimal-design-for-mixtures-design3_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="optimal-design-for-mixtures-design3_files/libs/tabwid-1.1.3/tabwid.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#priors" id="toc-priors" class="nav-link" data-scroll-target="#priors">Priors</a></li>
  <li><a href="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" id="toc-stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" class="nav-link" data-scroll-target="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables">Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</a>
  <ul class="collapse">
  <li><a href="#compile-stan-models" id="toc-compile-stan-models" class="nav-link" data-scroll-target="#compile-stan-models">Compile stan models</a></li>
  <li><a href="#simulate-retention-times-and-create-datasets" id="toc-simulate-retention-times-and-create-datasets" class="nav-link" data-scroll-target="#simulate-retention-times-and-create-datasets">Simulate retention times and create datasets</a></li>
  <li><a href="#optimization" id="toc-optimization" class="nav-link" data-scroll-target="#optimization">Optimization</a>
  <ul class="collapse">
  <li><a href="#read-the-results-and-compare" id="toc-read-the-results-and-compare" class="nav-link" data-scroll-target="#read-the-results-and-compare">Read the results and compare</a></li>
  <li><a href="#table" id="toc-table" class="nav-link" data-scroll-target="#table">Table</a></li>
  </ul></li>
  <li><a href="#stan-simulations" id="toc-stan-simulations" class="nav-link" data-scroll-target="#stan-simulations">Stan simulations</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#licenses" id="toc-licenses" class="nav-link" data-scroll-target="#licenses">Licenses</a></li>
  <li><a href="#original-computing-environment" id="toc-original-computing-environment" class="nav-link" data-scroll-target="#original-computing-environment">Original Computing Environment</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Design3: Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Paweł Wiczling* </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Department of Biopharmaceutics and Pharmacodynamics, Medical University of Gdańsk, Gen.&nbsp;J. Hallera 107, 80-416 Gdańsk, Poland
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 26, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setup" class="level1">
<h1>Setup</h1>
<p>The packages we will use are listed below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(numDeriv)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mrgmisc)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>select <span class="ot">=</span> dplyr<span class="sc">::</span>select</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("metrumresearchgroup/mrgmisc")</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># for parallel calculation use linux (mclaplly), i.e. Ubuntu 24.04 on Windows WSL</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># usethis::edit_r_environ(), add PROCESSX_NOTIFY_OLD_SIGCHLD = 1 ????</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#' Helper functions</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"helper_functions.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' folder shortcuts:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>figures_dir1 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"figures"</span>, <span class="st">"design3"</span>,<span class="st">"N"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>tables_dir1  <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"tables"</span>, <span class="st">"design3"</span>,<span class="st">"N"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>figures_dir5 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"figures"</span>, <span class="st">"manuscript_d3"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>tables_dir5  <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"tables"</span>, <span class="st">"manuscript_d3"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(figures_dir1)) <span class="fu">dir.create</span>(figures_dir1, <span class="at">recursive =</span> T)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(tables_dir1)) <span class="fu">dir.create</span>(tables_dir1, <span class="at">recursive =</span> T)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(figures_dir5)) <span class="fu">dir.create</span>(figures_dir5, <span class="at">recursive =</span> T)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(tables_dir5)) <span class="fu">dir.create</span>(tables_dir5, <span class="at">recursive =</span> T)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>thisScript <span class="ot">&lt;-</span> <span class="st">"optimal-design-for-mixtures-design3"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>my.ggsave <span class="ot">&lt;-</span> <span class="cf">function</span>(.plot, .filename, <span class="at">.path=</span>figures_dir, <span class="at">.height=</span> <span class="dv">7</span>, <span class="at">.width=</span> <span class="dv">6</span>) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot=</span>.plot, <span class="at">filename=</span>.filename, <span class="at">path=</span>.path, <span class="at">height=</span>.height, <span class="at">width=</span>.width)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>my.ggsave.png <span class="ot">&lt;-</span> <span class="cf">function</span>(.plot, .filename, <span class="at">.path=</span>figures_dir, <span class="at">.height=</span><span class="dv">7</span>, <span class="at">.width=</span> <span class="dv">6</span>) {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot=</span>.plot, <span class="at">filename=</span>.filename, <span class="at">path=</span>.path, <span class="at">height=</span>.height, <span class="at">width=</span>.width)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
</section>
<section id="priors" class="level1">
<h1>Priors</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fun_generate_priors defined in helper_functions.R</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>priorsN_MeOH<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N_MeOH"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>priorsN_ACN<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N_ACN"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>priorsN<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>priorsA<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"A"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>priorsB<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"B"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>priorsNB<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"NB"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>priorsNA<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"NA"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>hplcparam_candidates_df <span class="ot">=</span> <span class="fu">expand_grid</span>(<span class="at">tg=</span><span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">270</span>,<span class="at">by=</span><span class="dv">10</span>), </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">td=</span><span class="fl">2.1</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">to=</span><span class="fl">0.532</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">te=</span><span class="fl">0.04</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fio =</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="at">by=</span><span class="fl">0.05</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fif =</span> <span class="fl">0.8</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">m=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">xpH=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>hplcparam_candidates_df<span class="ot">&lt;-</span>hplcparam_candidates_df<span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tg=</span>tg<span class="sc">/</span><span class="dv">3</span><span class="sc">/</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" class="level1">
<h1>Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</h1>
<section id="compile-stan-models" class="level2">
<h2 class="anchored" data-anchor-id="compile-stan-models">Compile stan models</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mod_analytes_gq<span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-gq.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mod_analytes_sim <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-sim.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>mod_analytes <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>mod_analytes<span class="sc">$</span><span class="fu">compile</span>(<span class="at">compile_model_methods=</span><span class="cn">TRUE</span>,<span class="at">force_recompile=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulate-retention-times-and-create-datasets" class="level2">
<h2 class="anchored" data-anchor-id="simulate-retention-times-and-create-datasets">Simulate retention times and create datasets</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_ma<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>nObs <span class="ot">=</span> <span class="fu">nrow</span>(data_ma);</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>nAnalytes <span class="ot">=</span><span class="dv">50</span>;</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> <span class="dv">1234</span>;</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>n_param <span class="ot">=</span> <span class="dv">3</span>;</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>n_rep <span class="ot">=</span> <span class="dv">10</span>;</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_rep) {</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]] <span class="ot">=</span> <span class="fu">list</span>(<span class="at">nObs=</span>nObs,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nAnalytes=</span>nAnalytes,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">steps =</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>data_ma<span class="sc">$</span>m,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">hplcparam=</span><span class="fu">as.matrix</span>(data_ma<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(tg,td,to,te,fio,fif,m))),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">include_prior =</span> <span class="dv">1</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">run_estimation=</span><span class="dv">1</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nSel =</span> nObs,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="dv">1</span><span class="sc">:</span>nObs)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>fit_gq  <span class="ot">=</span> mod_analytes_gq<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> datastruct_prior_ma[[i]],</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> cseed,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">fixed_param =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">iter_sampling=</span><span class="dv">1</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">matrix</span>(fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"y_hat_sim"</span>),nAnalytes,nObs)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>logPobs <span class="ot">=</span> fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"logPobs"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>N1A2B3 <span class="ot">=</span> fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"N1A2B3"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>param <span class="ot">=</span> <span class="fu">matrix</span>(fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"paramsim"</span>),nAnalytes,<span class="dv">3</span>)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma[[i]]<span class="ot">=</span>datastruct_prior_ma[[i]];</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma[[i]]<span class="sc">$</span>include_prior <span class="ot">=</span> <span class="fl">0.01</span>;</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>inits[[i]]<span class="ot">=</span>param</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> cseed<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mean_log_det_stan <span class="ot">=</span> <span class="cf">function</span>(data, init, chosen_indices, S){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>init_ma <span class="ot">=</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">param=</span>init)}</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>selected <span class="ot">=</span> chosen_indices;</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>nSel <span class="ot">=</span> <span class="fu">length</span>(chosen_indices);</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a> fit_opt  <span class="ot">=</span> mod_analytes<span class="sc">$</span><span class="fu">optimize</span>(</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_dir =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"stanfiles"</span>),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_basename =</span> S,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>   <span class="at">seed =</span> cseed,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>   <span class="at">init =</span> init_ma,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">jacobian =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>   <span class="at">show_messages =</span> F)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a> mode<span class="ot">=</span>fit_opt<span class="sc">$</span><span class="fu">unconstrain_variables</span>(<span class="fu">list</span>(<span class="at">param =</span> fit_opt<span class="sc">$</span><span class="fu">mle</span>(<span class="st">"param"</span>)))</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a> hessian <span class="ot">=</span> fit_opt<span class="sc">$</span><span class="fu">hessian</span>(<span class="at">unconstrained_variables =</span> mode)<span class="sc">$</span>hessian</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>logdet <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span>data<span class="sc">$</span>nAnalytes,\(i) <span class="fu">log</span>(<span class="fu">det</span>(<span class="sc">-</span>hessian[((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">3</span>),((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">3</span>)]))))</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(logdet)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co"># quick test:</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>z_prior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan</span>(datastruct_prior_ma[[i]], inits[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>z_noprior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan</span>(datastruct_noprior_ma[[i]], inits[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(<span class="fu">unlist</span>(z_prior)),<span class="fu">mean</span>(<span class="fu">unlist</span>(z_noprior)))</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.165162  8.123107</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>logP <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]<span class="sc">$</span>logPobs))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>NAB <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]<span class="sc">$</span>N1A2B3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="optimization" class="level2">
<h2 class="anchored" data-anchor-id="optimization">Optimization</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">213</span>,<span class="dv">214</span>) <span class="co"># initial values</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fws_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">214</span>,<span class="dv">209</span>,<span class="dv">215</span>) <span class="co"># initial values</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>fws_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">214</span>,<span class="dv">211</span>,<span class="dv">63</span>) <span class="co"># initial values</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>fws_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">210</span>,<span class="dv">215</span>,<span class="dv">79</span>) <span class="co"># initial values</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>fws_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">210</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># initial values</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>fws_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">210</span>,<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">79</span>) <span class="co"># initial values</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>fws_prior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">210</span>,<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># initial values</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>fws_noprior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>) <span class="co"># ref</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>) <span class="co"># ref</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>fws_prior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>fws_noprior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="read-the-results-and-compare" class="level3">
<h3 class="anchored" data-anchor-id="read-the-results-and-compare">Read the results and compare</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>) <span class="co"># ref</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>) <span class="co"># ref</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>fws_prior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>fws_noprior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">213</span>,<span class="dv">214</span>) <span class="co"># p=2</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>fws_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">214</span>,<span class="dv">209</span>,<span class="dv">215</span>) <span class="co"># p=3</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">214</span>,<span class="dv">211</span>,<span class="dv">63</span>) <span class="co"># p=3</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>fws_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>fws_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">216</span>) <span class="co"># p=4</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">214</span>,<span class="dv">215</span>,<span class="dv">63</span>) <span class="co"># p=4</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>fws_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>fws_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">207</span>,<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">216</span>) <span class="co"># p=5</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">216</span>,<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">63</span>) <span class="co"># p=5</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>fws_prior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>fws_noprior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>summary_results <span class="ot">=</span> <span class="fu">tibble</span>( <span class="at">logP =</span> logP,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_2 =</span> fws_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(prior_ref<span class="sc">:</span>noprior_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(summary_results, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value))<span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>value, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"log(|FIM|)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-logDet-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>summary_results_diff <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_2 =</span> fws_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_prior_2 =</span> (fws_prior_2 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_3 =</span> (fws_prior_3 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_3 =</span> (fws_noprior_3 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_4 =</span> (fws_prior_4 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_4 =</span> (fws_noprior_4 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_5 =</span> (fws_prior_5 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_5 =</span> (fws_noprior_5 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_prior_2<span class="sc">:</span>d_noprior_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diff, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Efficiency relative to the reference design"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>summary_results_diffprior <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_ref  =</span> (fws_prior_ref<span class="sc">-</span>fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_3 =</span> (fws_prior_3<span class="sc">-</span>fws_noprior_3)<span class="sc">/</span>n_param,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_4 =</span> (fws_prior_4<span class="sc">-</span>fws_noprior_4)<span class="sc">/</span>n_param,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_5 =</span> (fws_prior_5<span class="sc">-</span>fws_noprior_5)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_ref<span class="sc">:</span>d_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diffprior, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Effect of prior on design efficiency"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">100</span>),</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">100</span>)),</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-logDet-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-logDet-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-logDet-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>f2_1 <span class="ot">=</span> p2</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>f3_1 <span class="ot">=</span> p3</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-abs.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-abs.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-rel.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-rel.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-prioreff.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-prioreff.png"</span>), <span class="at">.path =</span> figures_dir1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="table-summary" class="level4">
<h4 class="anchored" data-anchor-id="table-summary">Table Summary</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tab1<span class="ot">=</span>summary_results_diff <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">exp</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ptc_value =</span> <span class="fu">quantile</span>(value, <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>)), <span class="at">q =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_value =</span> <span class="fu">mean</span>(value),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_value =</span> <span class="fu">std</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">'ptc_value'</span>, <span class="st">'mean_value'</span>,<span class="st">'sd_value'</span>), round, <span class="dv">2</span>))<span class="sc">%&gt;%</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"q"</span>, <span class="at">values_from =</span> ptc_value, <span class="at">names_prefix =</span> <span class="st">"q"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Efficiency median (5th-95th)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(q0<span class="fl">.5</span>, <span class="st">" ("</span>, q0<span class="fl">.05</span>, <span class="st">" - "</span>, q0<span class="fl">.95</span>, <span class="st">")"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Efficiency mean (sd)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(mean_value, <span class="st">" ("</span>, sd_value , <span class="st">")"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"q"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>mean_value, <span class="sc">-</span>sd_value)<span class="sc">%&gt;%</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>()</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>tab1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c1fe2536{}.cl-c1f276a0{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c1f745ea{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c1f77ca4{width:1.181in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c1f77cb8{width:2.473in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c1f77cb9{width:1.85in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c1f77cc2{width:1.181in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c1f77cc3{width:2.473in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c1f77ccc{width:1.85in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c1f77ccd{width:1.181in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c1f77cd6{width:2.473in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c1f77cd7{width:1.85in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c1fe2536"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c1f77ca4"><p class="cl-c1f745ea"><span class="cl-c1f276a0">method</span></p></th><th class="cl-c1f77cb8"><p class="cl-c1f745ea"><span class="cl-c1f276a0">Efficiency median (5th-95th)</span></p></th><th class="cl-c1f77cb9"><p class="cl-c1f745ea"><span class="cl-c1f276a0">Efficiency mean (sd)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c1f77cc2"><p class="cl-c1f745ea"><span class="cl-c1f276a0">d_noprior_3</span></p></td><td class="cl-c1f77cc3"><p class="cl-c1f745ea"><span class="cl-c1f276a0">0.96 (0.59 - 1.29)</span></p></td><td class="cl-c1f77ccc"><p class="cl-c1f745ea"><span class="cl-c1f276a0">0.97 (0.22)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c1f77cc2"><p class="cl-c1f745ea"><span class="cl-c1f276a0">d_noprior_4</span></p></td><td class="cl-c1f77cc3"><p class="cl-c1f745ea"><span class="cl-c1f276a0">1.31 (0.91 - 2.02)</span></p></td><td class="cl-c1f77ccc"><p class="cl-c1f745ea"><span class="cl-c1f276a0">1.36 (0.39)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c1f77cc2"><p class="cl-c1f745ea"><span class="cl-c1f276a0">d_noprior_5</span></p></td><td class="cl-c1f77cc3"><p class="cl-c1f745ea"><span class="cl-c1f276a0">1.71 (1.21 - 2.72)</span></p></td><td class="cl-c1f77ccc"><p class="cl-c1f745ea"><span class="cl-c1f276a0">1.8 (0.52)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c1f77cc2"><p class="cl-c1f745ea"><span class="cl-c1f276a0">d_prior_2</span></p></td><td class="cl-c1f77cc3"><p class="cl-c1f745ea"><span class="cl-c1f276a0">0.96 (0.5 - 1.04)</span></p></td><td class="cl-c1f77ccc"><p class="cl-c1f745ea"><span class="cl-c1f276a0">0.89 (0.17)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c1f77cc2"><p class="cl-c1f745ea"><span class="cl-c1f276a0">d_prior_3</span></p></td><td class="cl-c1f77cc3"><p class="cl-c1f745ea"><span class="cl-c1f276a0">1.21 (0.75 - 1.33)</span></p></td><td class="cl-c1f77ccc"><p class="cl-c1f745ea"><span class="cl-c1f276a0">1.15 (0.18)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c1f77cc2"><p class="cl-c1f745ea"><span class="cl-c1f276a0">d_prior_4</span></p></td><td class="cl-c1f77cc3"><p class="cl-c1f745ea"><span class="cl-c1f276a0">1.51 (0.86 - 1.64)</span></p></td><td class="cl-c1f77ccc"><p class="cl-c1f745ea"><span class="cl-c1f276a0">1.43 (0.23)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c1f77ccd"><p class="cl-c1f745ea"><span class="cl-c1f276a0">d_prior_5</span></p></td><td class="cl-c1f77cd6"><p class="cl-c1f745ea"><span class="cl-c1f276a0">1.75 (0.92 - 1.9)</span></p></td><td class="cl-c1f77cd7"><p class="cl-c1f745ea"><span class="cl-c1f276a0">1.65 (0.29)</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tab2<span class="ot">=</span>summary_results_diffprior <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">exp</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ptc_value =</span> <span class="fu">quantile</span>(value, <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>)), <span class="at">q =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_value =</span> <span class="fu">mean</span>(value),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_value =</span> <span class="fu">std</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">'ptc_value'</span>, <span class="st">'mean_value'</span>,<span class="st">'sd_value'</span>), round, <span class="dv">2</span>))<span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"q"</span>, <span class="at">values_from =</span> ptc_value, <span class="at">names_prefix =</span> <span class="st">"q"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Efficiency median (5th-95th)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(q0<span class="fl">.5</span>, <span class="st">" ("</span>, q0<span class="fl">.05</span>, <span class="st">" - "</span>, q0<span class="fl">.95</span>, <span class="st">")"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Efficiency mean (sd)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(mean_value, <span class="st">" ("</span>, sd_value , <span class="st">")"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"q"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>mean_value, <span class="sc">-</span>sd_value)<span class="sc">%&gt;%</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>()</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c22ad1f8{}.cl-c2225fc8{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c225ee72{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c22616a4{width:0.875in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c22616ae{width:2.473in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c22616af{width:1.85in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c22616b8{width:0.875in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c22616b9{width:2.473in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c22616c2{width:1.85in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c22616c3{width:0.875in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c22616cc{width:2.473in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c22616cd{width:1.85in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c22ad1f8"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c22616a4"><p class="cl-c225ee72"><span class="cl-c2225fc8">method</span></p></th><th class="cl-c22616ae"><p class="cl-c225ee72"><span class="cl-c2225fc8">Efficiency median (5th-95th)</span></p></th><th class="cl-c22616af"><p class="cl-c225ee72"><span class="cl-c2225fc8">Efficiency mean (sd)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c22616b8"><p class="cl-c225ee72"><span class="cl-c2225fc8">d_3</span></p></td><td class="cl-c22616b9"><p class="cl-c225ee72"><span class="cl-c2225fc8">2.26 (1.06 - 6.07)</span></p></td><td class="cl-c22616c2"><p class="cl-c225ee72"><span class="cl-c2225fc8">3.6 (7.89)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c22616b8"><p class="cl-c225ee72"><span class="cl-c2225fc8">d_4</span></p></td><td class="cl-c22616b9"><p class="cl-c225ee72"><span class="cl-c2225fc8">2.06 (0.99 - 4.6)</span></p></td><td class="cl-c22616c2"><p class="cl-c225ee72"><span class="cl-c2225fc8">2.92 (5.97)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c22616b8"><p class="cl-c225ee72"><span class="cl-c2225fc8">d_5</span></p></td><td class="cl-c22616b9"><p class="cl-c225ee72"><span class="cl-c2225fc8">1.75 (0.89 - 3.4)</span></p></td><td class="cl-c22616c2"><p class="cl-c225ee72"><span class="cl-c2225fc8">2.57 (5.78)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c22616c3"><p class="cl-c225ee72"><span class="cl-c2225fc8">d_ref</span></p></td><td class="cl-c22616cc"><p class="cl-c225ee72"><span class="cl-c2225fc8">1.83 (1 - 5.22)</span></p></td><td class="cl-c22616cd"><p class="cl-c225ee72"><span class="cl-c2225fc8">2.74 (5.47)</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
</section>
<section id="table" class="level3">
<h3 class="anchored" data-anchor-id="table">Table</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data_ma<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">line=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>combined_results <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="at">prior_ref =</span> fws_prior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="at">prior_2 =</span> fws_prior_2<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_2 =</span> <span class="dv">10000</span><span class="sc">+</span>fws_prior_2<span class="sc">$</span>chosen_indices, <span class="co"># dummy</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="at">prior_3 =</span> fws_prior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_3 =</span> fws_noprior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="at">prior_4 =</span> fws_prior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_4 =</span> fws_noprior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="at">prior_5 =</span> fws_prior_5<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_5 =</span> fws_noprior_5<span class="sc">$</span>chosen_indices)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>selected_exp <span class="ot">=</span> <span class="fu">enframe</span>(combined_results)<span class="sc">%&gt;%</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">line=</span>value, <span class="at">Name =</span> name) <span class="sc">%&gt;%</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_ma, <span class="at">by =</span> <span class="st">"line"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">arrange</span>(Name,tg, fio)<span class="sc">%&gt;%</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(line,xpH,m,td,to,te,fif)) <span class="sc">%&gt;%</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Name, <span class="st">'noprior'</span>), <span class="st">"No prior"</span>, <span class="st">"Prior"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>tab1<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Prior"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>tab2<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"No prior"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">set_formatter</span>(</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  tab2, </span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">tg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%.0f"</span>, x) ),</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">fio =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, x) )</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab1, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>)</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab2, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>) </span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>, <span class="at">color=</span><span class="cn">NA</span>),</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>)</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> gg<span class="sc">+</span>p1<span class="sc">+</span>p2<span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-table.pdf"</span>), <span class="at">.path =</span> tables_dir1)</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-table.png"</span>), <span class="at">.path =</span> tables_dir1)</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>tab1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c42ecf0e{}.cl-c41e0da4{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c421f928{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c421f932{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c42221fa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c4222204{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c422220e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c422220f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c4222210{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c4222218{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c42ecf0e"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c42221fa"><p class="cl-c421f928"><span class="cl-c41e0da4">Name</span></p></th><th class="cl-c4222204"><p class="cl-c421f932"><span class="cl-c41e0da4">tg</span></p></th><th class="cl-c4222204"><p class="cl-c421f932"><span class="cl-c41e0da4">fio</span></p></th><th class="cl-c42221fa"><p class="cl-c421f928"><span class="cl-c41e0da4">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">prior_2</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.15</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.15</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">prior_3</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.05</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.15</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.20</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">prior_4</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.05</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.10</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.20</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.20</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">prior_5</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">28.88889</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.20</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.05</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.10</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.20</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.20</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">prior_ref</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">10.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.05</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">10.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.05</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c422220f"><p class="cl-c421f932"><span class="cl-c41e0da4">0.05</span></p></td><td class="cl-c422220e"><p class="cl-c421f928"><span class="cl-c41e0da4">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c4222210"><p class="cl-c421f928"><span class="cl-c41e0da4"></span></p></td><td class="cl-c4222218"><p class="cl-c421f932"><span class="cl-c41e0da4">30.00000</span></p></td><td class="cl-c4222218"><p class="cl-c421f932"><span class="cl-c41e0da4">0.05</span></p></td><td class="cl-c4222210"><p class="cl-c421f928"><span class="cl-c41e0da4">ACN</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-c440fddc{}.cl-c4366246{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c43ab9e0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c43ab9f4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c43ae532{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c43ae546{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c43ae550{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c43ae551{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c43ae55a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c43ae55b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c440fddc"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c43ae532"><p class="cl-c43ab9e0"><span class="cl-c4366246">Name</span></p></th><th class="cl-c43ae546"><p class="cl-c43ab9f4"><span class="cl-c4366246">tg</span></p></th><th class="cl-c43ae546"><p class="cl-c43ab9f4"><span class="cl-c4366246">fio</span></p></th><th class="cl-c43ae532"><p class="cl-c43ab9e0"><span class="cl-c4366246">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">noprior_2</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"> </span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"> </span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"> </span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"> </span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">noprior_3</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">9</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.20</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">30</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.10</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">30</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.15</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">noprior_4</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">9</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.20</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">30</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.05</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">30</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.15</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">30</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.20</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">noprior_5</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">9</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.20</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">30</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.05</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">30</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.10</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">30</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.20</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">30</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.20</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">noprior_ref</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">10</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.05</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">10</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.05</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">30</span></p></td><td class="cl-c43ae551"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.05</span></p></td><td class="cl-c43ae550"><p class="cl-c43ab9e0"><span class="cl-c4366246">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c43ae55a"><p class="cl-c43ab9e0"><span class="cl-c4366246"></span></p></td><td class="cl-c43ae55b"><p class="cl-c43ab9f4"><span class="cl-c4366246">30</span></p></td><td class="cl-c43ae55b"><p class="cl-c43ab9f4"><span class="cl-c4366246">0.05</span></p></td><td class="cl-c43ae55a"><p class="cl-c43ab9e0"><span class="cl-c4366246">ACN</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
</section>
<section id="stan-simulations" class="level2">
<h2 class="anchored" data-anchor-id="stan-simulations">Stan simulations</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>prior_ma_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -45.2173     0.0169663       27.2472     0.08408           1      125    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -43.3859    0.00838397       3.88184           1           1      246    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -43.2068     0.0158961        1.5415           1           1      362    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399       -43.182   0.000442517      0.439309           1           1      483    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -43.1793   0.000224981      0.327975           1           1      597    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      573      -43.1791   2.96137e-05     0.0304433      0.2994           1      683    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.5 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  13.8 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -49.9482    0.00885418       8.58931           1           1      109    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -48.7712     0.0018632       1.61353      0.6773      0.6773      217    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299       -48.738    0.00051026       0.66332      0.4074      0.4074      324    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -48.7367   0.000446319      0.135813      0.4734           1      435    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      471      -48.7366   3.66066e-05       0.01789      0.8782      0.8782      512    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.5 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  14.8 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -51.8332      0.022819       1.84654           1           1      105    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -51.7741   0.000267723      0.117588      0.7357      0.7357      209    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      260      -51.7739   2.07948e-05     0.0102054           1           1      278    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.2 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  14.0 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -67.8551     0.0318239       47.8313           1           1      122    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -63.9884    0.00217168       8.44608      0.3108      0.3108      245    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -62.8342      0.012751       25.3216      0.2704           1      360    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -62.5881    0.00406549       5.18164      0.2438           1      479    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -62.5546    0.00165979       1.17177           1           1      607    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -62.5487   0.000398532       0.24023           1           1      721    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699       -62.548   0.000140358     0.0565193           1           1      840    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.7 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  14.9 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -43.2481      0.037976       2.53819           1           1      111    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -43.1984   0.000332438     0.0894122           1           1      215    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      285      -43.1982   4.34454e-05    0.00838253           1           1      306    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.3 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.7 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -84.8202    0.00798148       51.9546       1.049     0.01049      188    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -83.7908    0.00359184       49.8379           1           1      432    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -74.8645    0.00142909          62.8    0.001432           1      606    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399       -71.821    0.00372954       96.9819      0.2755    0.002755      856    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -69.2422     0.0219765        583.06           1           1      993    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -65.8835     0.0142967        87.572      0.7678    0.007678     1139    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -63.9621    0.00182486       84.2349           1           1     1266    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -63.1053    0.00602846       113.049           1           1     1397    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -62.3057   0.000195295       44.6202      0.5933      0.5933     1531    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -61.3132    0.00422063       49.9904           1           1     1657    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -60.9187    0.00134609       68.5301      0.6876      0.6876     1788    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199       -60.477      0.011104       187.096           1           1     1932    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -60.0621    0.00155624       47.9957      0.7788     0.07788     2064    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -59.9649   0.000378164       13.2978           1           1     2182    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -59.8454    0.00120871       5.02841      0.1448           1     2321    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -59.7728   0.000653317       14.9246           1           1     2453    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -59.7528   0.000173397       6.21415     0.00859           1     2597    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -59.7332    0.00355859       23.8774           1           1     2733    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -59.7205   0.000907855       18.6719           1           1     2863    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -59.7094   0.000103427       10.2195    0.008634           1     2996    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -59.7092    0.00144585       4.23212       0.872     0.00872     2999    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.7 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  14.9 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99       -47.976     0.0547549       32.8168           1           1      116    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -45.5807    0.00510427         9.929      0.3923           1      224    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -45.2197    0.00190055       1.35905           1           1      332    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -45.1887   0.000210659      0.529606           1           1      445    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -45.1824   0.000645567      0.613234      0.8041      0.8041      554    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599       -45.182   8.88661e-05     0.0606776      0.4065           1      663    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      670       -45.182   0.000105058      0.020071           1           1      742    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.6 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  15.6 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -52.9979     0.0490169        6.0843           1           1      103    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -52.9217    0.00109695      0.124403      0.4334           1      210    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      262      -52.9215   4.20468e-05    0.00795296           1           1      276    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.4 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.4 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -59.4004    0.00491278       16.8689      0.8265     0.08265      118    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -57.7461    0.00200751       8.11027      0.2924      0.2924      237    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -57.6583   0.000214507       1.26974      0.7429      0.7429      351    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -57.6505    0.00189608      0.285163           1           1      464    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499        -57.65   0.000159351     0.0619216           1           1      576    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      529        -57.65   6.40297e-05     0.0319564           1           1      607    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.5 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  15.4 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -56.7419     0.0144507       3.98787           1           1      109    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -56.6326    0.00131655      0.524049           1           1      217    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      290      -56.6315   5.92365e-05     0.0151028       0.976       0.976      319    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.3 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  15.0 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691241 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.682227   0.000665716      0.465756      0.6813      0.6813      124    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.675154   0.000387855      0.513646           1           1      238    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.670678   0.000117533      0.277342           1           1      351    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.667556    0.00111159       0.83316      0.5361      0.5361      469    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.663078    0.00392001      0.326843           1           1      587    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.658843    0.00797031       1.06447      0.3324           1      713    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699      -0.65475    0.00215992      0.384106      0.8883      0.8883      834    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.648902     0.0378009       1.50813           1           1      953    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.643208    0.00230331      0.572293           1           1     1066    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.638859   0.000344367      0.167335           1           1     1189    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.637611   0.000994715      0.879372      0.4474           1     1309    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199       -0.6365    0.00271931      0.165166           1           1     1433    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.635618   0.000823326      0.179926           1           1     1543    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399     -0.635154   6.33158e-05      0.346796      0.2477      0.2477     1655    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.634915   0.000208364      0.214411      0.6314      0.6314     1768    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599      -0.63482   4.57529e-05     0.0456661           1           1     1876    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.634769   0.000128909       0.03806           1           1     1994    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799     -0.634723   8.81633e-05     0.0441512           1           1     2108    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899      -0.63469   0.000108225     0.0458905       1.403      0.1403     2236    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.634669   0.000205441     0.0297309           1           1     2352    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.634669   0.000195748     0.0269502           1           1     2353    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  1.3 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  15.1 seconds.
0/2: Initial log joint probability = -0.733884 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.723672     0.0045481      0.550891      0.2485           1      114    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199     -0.716371   0.000254482      0.744633      0.6577      0.6577      223    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -0.71342    0.00275064      0.186557           1           1      336    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.711905    0.00233677      0.275543           1           1      442    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.710753    0.00130146      0.139731           1           1      549    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.710196   0.000140957       0.12784           1           1      662    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.708696   0.000628765      0.185118      0.8426      0.8426      776    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.707814   0.000417167      0.126667      0.8616      0.8616      883    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899     -0.707514   0.000516679      0.122902           1           1      994    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.707403   0.000242847     0.0677372           1           1     1102    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.707239   0.000516846      0.101268       0.384       0.384     1213    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199      -0.70671   0.000264265      0.095079           1           1     1324    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299     -0.706649   0.000396121     0.0535443           1           1     1434    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399     -0.706555   0.000510141      0.113746      0.9861      0.9861     1541    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.706368    0.00272611     0.0606845           1           1     1650    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.706231    0.00175904     0.0757699           1           1     1761    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.706097   0.000287637     0.0386141           1           1     1872    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799     -0.706052    1.9431e-05     0.0181699           1           1     1982    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899      -0.70604   6.72417e-05     0.0169803           1           1     2089    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1999     -0.706033   0.000140186     0.0165582      0.7956      0.7956     2196    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     2000     -0.706033   0.000156918     0.0174919           1           1     2197    
0/2: Optimization terminated normally:  
0/2:   Maximum number of iterations hit, may not be at an optima 
0/2: Finished in  1.2 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  16.4 seconds.
0/3: Initial log joint probability = -0.799593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.779424    0.00749959      0.382894           1           1      105    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.772107    0.00328838      0.341755           1           1      209    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.770028    0.00267515      0.112663           1           1      311    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.769098   0.000318594     0.0778071      0.8003      0.8003      416    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.768705    0.00169748     0.0361631           1           1      522    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.768571   0.000416841     0.0168939           1           1      626    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.768542    7.0869e-05     0.0095788           1           1      730    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799     -0.768521   0.000316504     0.0235314           1           1      837    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      899     -0.768501   3.94531e-05    0.00942954      0.6587      0.6587      940    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      999     -0.768498   9.97498e-05     0.0027212           1           1     1045    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1099     -0.768497   5.73867e-06    0.00224264      0.4397      0.4397     1149    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1199     -0.768495   7.96328e-05      0.002717           1           1     1253    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1226     -0.768495   2.53637e-05    0.00129565           1           1     1282    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.8 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  14.9 seconds.
0/4: Initial log joint probability = -0.871315 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -0.86694    0.00168958      0.875592      0.9641      0.9641      116    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.859811    0.00128432       1.47066           1           1      242    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299     -0.856089   0.000114498      0.132037           1           1      357    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399     -0.853896   6.73321e-05      0.458252           1           1      470    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499     -0.852547   0.000118151       0.41988      0.1703           1      586    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.846896    0.00886878        1.5472           1           1      704    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699     -0.831584    0.00102776      0.552066           1           1      826    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799     -0.828206    0.00138031       1.11283           1           1      944    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.826118   0.000108602       0.49777           1           1     1069    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.822291   0.000993023      0.821326           1           1     1183    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.818328    0.00465723      0.716397           1           1     1303    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.815831   0.000257729      0.334167           1           1     1426    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.814888    0.00220075      0.733583           1           1     1552    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.813631   0.000105972      0.270572           1           1     1678    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.813298   0.000423731      0.398543           1           1     1795    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599     -0.812674    0.00565628       1.31401           1           1     1909    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.811816     0.0041058       1.94821           1           1     2025    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799     -0.810771   9.46573e-05      0.269336           1           1     2139    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.810084    0.00420837      0.379114      0.4804           1     2257    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999      -0.80922   0.000383827      0.233899           1           1     2375    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000     -0.809212   0.000339379      0.415889           1           1     2376    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  1.8 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  16.3 seconds.
0/5: Initial log joint probability = -0.729812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.708977    0.00715481      0.459766           1           1      106    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.705495    0.00311737      0.185258           1           1      215    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.704096    0.00287475      0.113552      0.9499      0.9499      327    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.702478    0.00666165      0.328622           1           1      431    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499     -0.701529   0.000568743     0.0895502      0.5085      0.5085      538    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.701169   0.000254354     0.0320565           1           1      648    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.701058   0.000472121     0.0256123           1           1      755    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.700965   0.000325729     0.0310945       0.416       0.416      866    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.700871   7.97335e-05      0.013325      0.7777      0.7777      972    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      999     -0.700853   0.000509035     0.0110219           1           1     1078    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1099     -0.700824   0.000212613     0.0239832      0.1856           1     1185    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1199      -0.70081   0.000265898     0.0183214           1           1     1290    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1299     -0.700805   2.54705e-05    0.00440374      0.3951           1     1399    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1379     -0.700805   1.98616e-05    0.00127287           1           1     1486    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.9 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  16.9 seconds.
0/6: Initial log joint probability = -0.917087 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916062    0.00021067       3.01575           1           1      154    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.914066   0.000248606       3.61809     0.01466           1      306    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.912907   5.86386e-05      0.719209     0.05603           1      453    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.911775   1.04104e-05        2.0053     0.01549           1      583    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.910038    0.00192059        2.0421           1           1      725    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.908608   0.000348109       1.87161       2.636      0.2636      876    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.907741   0.000633925       2.11688           1           1     1008    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.907215    9.4784e-05       1.60005           1           1     1134    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.905884   0.000584197        1.6666           1           1     1269    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999     -0.904898   5.61165e-05       4.50907      0.2494      0.2494     1402    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.904441   0.000103855      0.653354           1           1     1537    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.904215   0.000111961      0.490032           1           1     1661    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.903572   0.000745421       2.01606       1.099      0.1099     1816    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.902883   8.18302e-05      0.979955      0.4021           1     1955    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.901298   0.000168151       4.91004     0.08996           1     2208    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.900491   7.31479e-05      0.848173     0.02499           1     2390    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.899991   2.06685e-05      0.232753    0.006503           1     2729    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.899608   0.000561079       1.85689       3.517      0.3517     2935    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.898655   0.000720658         7.804           1           1     3097    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.898387   0.000183464      0.982748           1           1     3238    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000     -0.898386   0.000257297       1.82985     0.05495           1     3240    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.8 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  16.7 seconds.
0/7: Initial log joint probability = -0.679173 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.675127   9.18948e-05      0.217046           1           1      113    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.669821    0.00203363      0.425466      0.7476      0.7476      220    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.665118    0.00281338       1.06281           1           1      335    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.663431   0.000259659      0.312425      0.4871      0.4871      444    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.662717   0.000558999      0.321002      0.2947           1      551    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.661268    0.00395334        1.0239           1           1      662    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.659131    0.00146171      0.215183           1           1      766    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.658405   0.000421599      0.212767      0.4457           1      875    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.658082   0.000129254      0.117705           1           1      984    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.657819   0.000148878     0.0576239           1           1     1094    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099     -0.657575    0.00023009      0.152454      0.3599           1     1200    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.657358   0.000239631     0.0749447           1           1     1310    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299      -0.65721   3.75527e-05      0.187975      0.7288      0.7288     1420    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.657125   2.57975e-05      0.093652       0.388       0.388     1529    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.657053   0.000145513     0.0884343      0.6796      0.6796     1640    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.656985   0.000190197     0.0405784           1           1     1745    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.656916   0.000173741     0.0495686           1           1     1851    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.656878   6.10721e-05     0.0258593           1           1     1962    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899     -0.656845   3.23793e-05     0.0287421           1           1     2076    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1999     -0.656786   0.000780201     0.0444114           1           1     2185    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     2000     -0.656785   3.55916e-05      0.041227           1           1     2186    
0/7: Optimization terminated normally:  
0/7:   Maximum number of iterations hit, may not be at an optima 
0/7: Finished in  1.5 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  15.8 seconds.
0/8: Initial log joint probability = -0.801845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.784206     0.0014532      0.340554      0.6841      0.6841      103    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.778481    0.00465254      0.365788           1           1      207    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.774895    0.00146435      0.188375           1           1      314    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.772688    0.00134987      0.139427           1           1      417    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.770652    0.00290028      0.103938           1           1      522    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.769987   0.000100613     0.0403201      0.8602      0.8602      626    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699      -0.76983   0.000910868     0.0395906           1           1      730    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799     -0.769757   0.000165739     0.0213876           1           1      837    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899      -0.76968    0.00025702     0.0137755           1           1      940    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999      -0.76962   0.000323727     0.0218836           1           1     1045    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099      -0.76959   4.01849e-05     0.0105257      0.5597      0.5597     1154    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199     -0.769579   6.69543e-05    0.00651156      0.3848           1     1265    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.769576   0.000315281    0.00984623           1           1     1372    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.769572   0.000334361    0.00892782      0.9923      0.9923     1475    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499      -0.76957   3.36738e-05    0.00388427           1           1     1584    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1591     -0.769569   1.58271e-05    0.00121928           1           1     1679    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  1.0 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  15.8 seconds.
0/9: Initial log joint probability = -0.809753 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.804682    0.00169627      0.581056           1           1      115    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.801439    0.00112131      0.629963           1           1      226    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299     -0.794908    0.00170833       0.50865           1           1      338    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.793618    0.00014248      0.180184      0.3179           1      450    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.791998   0.000567037      0.179557           1           1      565    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.790205    0.00064922      0.198399           1           1      682    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.787739      0.001324       0.19624           1           1      802    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.785548     0.0125591      0.251986           1           1      920    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.784567   8.58187e-05     0.0865143       0.197      0.9566     1042    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.784244   0.000100112     0.0733047           1           1     1159    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.783818    0.00277241      0.103408           1           1     1269    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199     -0.783489   0.000611283      0.116036      0.9984      0.9984     1385    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.783214   0.000445312      0.365551           1           1     1500    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.782646   0.000349403      0.109029           1           1     1622    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.782397   0.000285699     0.0624217      0.9128      0.9128     1741    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.782197   0.000465488     0.0754139           1           1     1857    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.782087   1.33626e-05     0.0231361      0.7808      0.7808     1973    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799     -0.782055   0.000371426      0.026525           1           1     2091    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899     -0.782003   6.25713e-06     0.0190954      0.8025      0.8025     2209    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1999     -0.781984   3.31848e-05     0.0574449      0.4646           1     2322    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     2000     -0.781984   1.47501e-05     0.0400801      0.4693      0.4693     2323    
0/9: Optimization terminated normally:  
0/9:   Maximum number of iterations hit, may not be at an optima 
0/9: Finished in  1.4 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  16.3 seconds.
0/10: Initial log joint probability = -0.752982 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.745604   0.000969799      0.201609      0.5113      0.5113      109    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.744242   4.63177e-05     0.0645557           1           1      213    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -0.74386   0.000509856     0.0567291           1           1      320    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.743835   1.91125e-05     0.0115022           1           1      430    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499     -0.743827   1.42345e-05     0.0065171           1           1      538    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599     -0.743826   1.03708e-05    0.00231831           1           1      645    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      633     -0.743826   1.48249e-06    0.00195145      0.6293      0.6293      679    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.5 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  17.2 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_2<span class="sc">$</span>chosen_indices <span class="co"># p=2</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>prior_ma_2 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -39.8844     0.0815096       54.5836           1           1      115    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -38.5772    0.00976249        1.6234           1           1      229    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -38.5345   0.000608399       0.38345      0.7614      0.7614      343    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -38.5314   0.000412907      0.152982           1           1      464    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      486      -38.5313   6.95142e-05     0.0195084           1           1      565    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.3 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  14.4 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -42.8214     0.0571232       7.94549           1           1      110    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199       -41.966    0.00609396       1.41823      0.3355           1      220    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -41.9536    0.00119898      0.188772           1           1      328    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -41.9535   9.95674e-05     0.0298738           1           1      433    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      402      -41.9535    2.0255e-05     0.0103669           1           1      436    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.3 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  15.6 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -46.4287     0.0328588       4.93543           1           1      103    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -46.1582    0.00171722      0.291518           1           1      211    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -46.1563   0.000495836     0.0217232           1           1      321    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      322      -46.1563   2.54578e-05    0.00728879           1           1      346    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.2 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  17.2 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -61.2623      0.024282       41.3399      0.9964      0.9964      116    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -56.3723     0.0472411       13.6622           1           1      230    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -55.3997     0.0298358       8.97117      0.3372           1      342    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -55.1371    0.00554296       2.52347           1           1      455    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -55.0978    0.00146937      0.589133           1           1      570    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -55.0952   0.000574253      0.321599           1           1      687    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -55.0947   0.000123883      0.113251      0.5124           1      796    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -55.0945   3.24127e-05     0.0881086      0.2096      0.2096      913    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      846      -55.0945   1.98286e-05     0.0469384     0.08624           1      965    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.4 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  16.1 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -36.0874    0.00834429       2.20834      0.6302      0.6302      105    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -35.9631   0.000731315      0.143469      0.2964           1      210    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -35.9625   1.44514e-05    0.00739744      0.6837      0.6837      315    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      303      -35.9625   6.65705e-05    0.00538748      0.9416      0.9416      319    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.2 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.7 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -81.9672    0.00129831       69.4388      0.1573     0.01573      170    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -67.6275     0.0374361       257.352      0.2201    0.002201      376    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -61.6539    0.00197241       128.766       0.173           1      504    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -58.4694    0.00929797       56.5299           1           1      644    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -57.2513    0.00372341        152.83           1           1      774    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -55.0795     0.0807713       168.405           1           1      911    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -54.4982     0.0063027       20.9664           1           1     1036    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -54.0305      0.003717       29.0322      0.1352      0.1352     1197    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899       -53.709    0.00494112        35.128     0.07315           1     1337    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -53.4773   0.000535352       2.80844           1           1     1479    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -53.4546   0.000111586         2.063           1           1     1665    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199       -53.412   0.000277734       4.34469     0.01254           1     1815    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -53.4021    0.00129139       5.78196    0.005173           1     2117    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -53.3882    0.00149459       7.01972    0.005695           1     2423    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -53.3816   0.000144238       3.61248    0.005402           1     2723    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -53.3768   0.000407691       3.74039    0.008054           1     3020    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -53.3727   0.000450335        3.9281    0.009835           1     3318    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -53.3683   0.000173721       3.87713    0.006607           1     3617    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -53.3643   0.000205788       4.04885    0.006209           1     3917    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -53.3606   0.000233501       3.52421    0.006198           1     4216    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -53.3606   0.000247026        3.5003       0.626     0.00626     4219    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.1 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  17.0 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -39.3122     0.0937145       32.7379           1           1      106    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -36.1989    0.00180661       2.18405           1           1      213    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -36.1229    0.00508497       1.01758      0.3916           1      327    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -36.1156   0.000899183      0.434646      0.3306           1      440    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -36.1149    0.00015283     0.0286694           1           1      552    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      546      -36.1149   3.38159e-05     0.0101728           1           1      604    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.3 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  16.1 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -44.8494     0.0110652       2.36464           1           1      104    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -44.6277   0.000578005        0.1742           1           1      209    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      284      -44.6272   4.64342e-05       0.01106           1           1      299    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.2 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.7 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -54.1928     0.0946753       26.1224      0.4631           1      112    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -51.7729    0.00130213       4.23836      0.3529      0.3529      228    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299       -51.681    0.00347346      0.677695           1           1      343    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -51.6736   0.000818926       0.19172           1           1      451    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -51.6733   5.71328e-05     0.0621814      0.5646      0.5646      565    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      582      -51.6732   4.36934e-05     0.0252298      0.4539      0.4539      658    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.4 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.8 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -51.2155     0.0225335       2.80764      0.9218      0.9218      110    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -50.8933    0.00549031      0.408381           1           1      221    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -50.8917   9.19827e-05      0.024063           1           1      326    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      320      -50.8917   4.65677e-05    0.00785741           1           1      352    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.1 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.1 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>prior_ma_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -46.8657     0.0418395       35.5741      0.3336           1      123    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -44.2718      0.018779       8.42886           1           1      232    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -44.0351    0.00301511       2.86669           1           1      349    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -44.0195    0.00339263       1.06439      0.2408           1      459    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -44.0174   0.000128616      0.115668           1           1      578    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -44.0172   0.000238904     0.0410827      0.9193      0.9193      694    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      615      -44.0172   8.93064e-05     0.0296484           1           1      711    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.4 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  15.6 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -45.8369     0.0902167       16.2199           1           1      111    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -44.5176    0.00453853       2.06817           1           1      223    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -44.4756   0.000413634      0.341218       0.436       0.436      337    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -44.4747   0.000360385      0.153101           1           1      444    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      445      -44.4746   2.68114e-05     0.0117651           1           1      493    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.3 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  15.7 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99       -49.788     0.0490939       15.3662           1           1      105    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -49.2625    0.00580394        1.3659           1           1      214    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -49.2581   4.17256e-05     0.0345914      0.8499      0.8499      317    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      363      -49.2581    2.9625e-05    0.00875209           1           1      387    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.4 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  15.2 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -62.7421     0.0907561       69.5679           1           1      109    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -59.2808    0.00461406       5.66184           1           1      221    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -58.7332    0.00331626       10.5653      0.5539     0.05539      340    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399       -58.374   0.000466728       2.00032           1           1      452    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -58.3338    0.00143762       1.67144      0.6445      0.6445      570    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599       -58.329     0.0010413      0.558175           1           1      686    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -58.3281   2.46001e-05     0.0677491       1.579      0.1579      799    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -58.3279   3.47969e-05     0.0399968      0.7911      0.7911      908    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      806      -58.3279   4.08908e-05     0.0273677           1           1      917    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.5 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  15.7 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -39.8684     0.0189091       2.75377           1           1      105    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -39.6235    0.00401061      0.699991           1           1      208    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -39.6213   0.000337983     0.0306757      0.8976      0.8976      313    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      346      -39.6213   1.31364e-05    0.00568024           1           1      363    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.3 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.3 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -84.2563     0.0214561       141.471      0.1921     0.01921      174    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -80.8322   0.000251731       23.4476      0.3001      0.3001      409    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -76.0612    0.00686817       57.6614      0.6167     0.06167      571    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -74.3851    0.00430676       61.7177      0.3062    0.003062      879    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -71.6665     0.0035626       77.7384      0.9465    0.009465     1183    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -70.0208    0.00146519       35.8613     0.01065           1     1429    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -68.0266     0.0675473       45.9608      0.7476      0.7476     1663    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -63.8028     0.0327779       86.4738           1           1     1777    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -60.9428      0.024904       46.5297           1           1     1903    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -60.5096     0.0167384       10.2502           1           1     2033    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099        -60.08    0.00162822       9.39838           1           1     2166    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -59.3797    0.00180146       41.3717      0.0369           1     2305    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -59.1239   0.000921373       16.5907      0.4009     0.04009     2451    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -58.8563   0.000491438       12.1933           1           1     2586    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -58.7778     0.0220303        5.3983           1           1     2727    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -58.6741    0.00213026       4.15358     0.03666           1     2910    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699       -58.611    0.00238934       43.7197      0.9274      0.9274     3111    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -58.4922    0.00298549       8.33307       1.195      0.1195     3238    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -58.3902    0.00215632       6.04344    0.004992           1     3382    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -58.3348   2.04405e-05       2.36515      0.4347      0.4347     3515    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -58.3348   8.44542e-05       3.33196           1           1     3516    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.3 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  14.9 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -44.0255     0.0556227       22.2056           1           1      109    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -40.4076     0.0150041       4.96046           1           1      222    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -39.9642    0.00552891        5.9316           1           1      330    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399       -39.862    0.00122383      0.742637           1           1      443    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -39.8557   0.000169241      0.140635           1           1      549    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -39.8554   0.000261066       0.11613           1           1      659    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699      -39.8553   2.64183e-05     0.0307465      0.4418      0.4418      770    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      702      -39.8553   4.69032e-05     0.0154589      0.9783      0.9783      773    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.5 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  13.5 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99       -49.181     0.0356246       3.42775           1           1      106    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -48.7099   0.000227302      0.571569      0.5687      0.5687      211    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -48.7065    6.6933e-05     0.0216152           1           1      318    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      369      -48.7065   9.21899e-05      0.012999           1           1      392    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.3 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.0 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -57.3136    0.00755323       18.0003      0.2795      0.2795      105    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -54.8297     0.0026116       7.43999      0.3047           1      218    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -54.6541    0.00327688       1.09745      0.6669      0.6669      327    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -54.6471   0.000292271      0.527073      0.1568           1      436    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -54.6464    2.9446e-05     0.0726136           1           1      545    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      571      -54.6464   0.000115865     0.0242955           1           1      627    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.4 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  15.8 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -53.1466      0.054868       6.38952           1           1      114    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -52.5422      0.003752      0.491914           1           1      221    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299       -52.536    0.00010551     0.0955741      0.2628           1      329    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      375      -52.5359   5.54044e-05     0.0131661           1           1      411    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.3 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.4 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691241 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.684848    0.00151026       1.81153      0.3907           1      120    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.677455   0.000196834      0.436794           1           1      239    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.672769    0.00113126      0.336963           1           1      355    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.667875    0.00101726       0.30233       1.997      0.1997      473    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.665682    0.00117188       0.56499           1           1      591    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.664318    0.00370547       0.30833           1           1      710    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699     -0.660913   0.000166113      0.344778      0.9103      0.9103      828    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.658571    0.00217787      0.352644       0.473       0.473      945    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.655677    0.00060838      0.889172           1           1     1056    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.654892   0.000165422      0.205378      0.4884           1     1172    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.654333   0.000129009      0.151409           1           1     1289    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.653952    6.4799e-05      0.265337       0.103           1     1406    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.653614   0.000518231     0.0738905           1           1     1525    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399      -0.65336     0.0015912      0.105248           1           1     1639    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.652908   2.88058e-05      0.097992           1           1     1759    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.652607   0.000276842      0.117681      0.7649      0.7649     1887    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.651815   0.000483785      0.153675      0.2316           1     2006    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799     -0.651489   0.000180665      0.278432      0.2542      0.2542     2119    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899      -0.65127   0.000234691     0.0529209           1           1     2231    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.651139    0.00132975     0.0907106           1           1     2359    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.651136    0.00111874      0.183169      0.3089           1     2361    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  0.9 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  14.4 seconds.
0/2: Initial log joint probability = -0.733884 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.720682    0.00203258       0.75693      0.6257      0.6257      112    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199     -0.713752    0.00493689      0.298485           1           1      228    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299     -0.709345    0.00131058      0.293903           1           1      335    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.707728   0.000753681      0.178314           1           1      444    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.706323   0.000180987      0.164088      0.7256      0.7256      547    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.705427   0.000710779      0.101716           1           1      656    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.704979    0.00456599      0.213624           1           1      763    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.704869   0.000607227     0.0784652      0.4639           1      878    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899      -0.70482   5.29125e-05     0.0260776           1           1      988    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.704783   0.000438458     0.0127521           1           1     1100    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.704758   3.58413e-05     0.0267517           1           1     1207    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.704746   7.30436e-05     0.0174951           1           1     1315    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299     -0.704737   6.48002e-06    0.00742409      0.2125           1     1431    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399     -0.704734   2.79061e-05     0.0104906           1           1     1542    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.704732   1.34419e-05    0.00552131           1           1     1658    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1502     -0.704732   4.82088e-06    0.00312578           1           1     1662    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.7 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  16.5 seconds.
0/3: Initial log joint probability = -0.799593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.777534     0.0113243      0.617997           1           1      105    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.768587    0.00399469      0.314332           1           1      208    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.765972   0.000187492     0.0497019           1           1      311    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.765581   0.000376177     0.0567913      0.7105      0.7105      413    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.765482   0.000920665     0.0548195           1           1      519    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.765463   0.000165406    0.00541892           1           1      623    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.765458   9.49977e-06     0.0023995           1           1      727    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799     -0.765457   2.36032e-05    0.00340161      0.2156           1      831    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      810     -0.765457   8.86405e-06    0.00103795           1           1      843    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.4 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  17.2 seconds.
0/4: Initial log joint probability = -0.871314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99     -0.859568    0.00187162      0.819239           1           1      114    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.848898     0.0014632      0.709567      0.2692           1      230    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299     -0.840362    0.00144329        1.0514           1           1      345    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399     -0.828388    0.00667682      0.677196           1           1      460    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -0.82221     0.0140126        1.0344       1.525      0.1525      574    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.814892   0.000938029       1.71343           1           1      691    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -0.80852   0.000693504      0.813306      0.5739      0.5739      815    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799       -0.8061   0.000380241      0.776906      0.7353      0.7353      931    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.803847   5.51033e-05      0.228225           1           1     1050    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.802221    0.00611375       1.12503      0.7732      0.7732     1163    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.801204   8.09056e-05      0.146355      0.5289      0.5289     1283    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.800959   0.000398441      0.107421           1           1     1398    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.798832    0.00729511      0.694555           1           1     1511    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.797848    0.00196511      0.252837           1           1     1627    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.796327   0.000146144      0.113376           1           1     1738    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599      -0.79577   0.000118085      0.277837           1           1     1852    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.795481   6.31499e-05     0.0802624           1           1     1967    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799     -0.795295   5.33896e-05     0.0543869           1           1     2076    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.795175   3.67354e-05     0.0667566      0.9049      0.9049     2197    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.794917   0.000170331      0.113132           1           1     2315    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000     -0.794915   0.000576169       0.14697           1           1     2316    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  0.9 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  18.4 seconds.
0/5: Initial log joint probability = -0.729812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.709412     0.0097659      0.885877           1           1      107    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.703848    0.00151512      0.148935      0.9494      0.9494      217    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.702392   0.000393981     0.0439321           1           1      324    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.702143   0.000636969     0.0320978           1           1      431    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499     -0.702083   0.000240483     0.0176514           1           1      536    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.702046   0.000396726     0.0378707      0.2267           1      646    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.702019   7.30016e-05    0.00830388           1           1      751    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.702014    3.3041e-05    0.00375614           1           1      863    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.702011   5.54045e-06    0.00183428           1           1      968    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      975     -0.702011   6.14305e-06    0.00132362           1           1     1047    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.5 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  18.1 seconds.
0/6: Initial log joint probability = -0.917062 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916154    0.00033123       2.89467           1           1      134    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.915072   0.000268141       13.5567           1           1      263    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.913152   3.58666e-05       1.08321      0.2181     0.02181      454    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.912808   1.75307e-05        0.4441      0.2972    0.002972      771    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.912688   9.54793e-05      0.678036      0.6047    0.006047     1151    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.912352   0.000191899       1.19749      0.5684    0.005684     1489    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.909588   0.000313429         5.382      0.9061      0.9061     1641    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.907183   0.000126311       4.99023     0.04617           1     1773    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.905641   0.000250905       9.71603           1           1     1901    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -0.90298   0.000624862       2.68694      0.1194           1     2041    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.901895   0.000402266       1.78654           1           1     2184    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.900414    0.00190436       5.94041           1           1     2305    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.899256    0.00026989       4.25379           1           1     2445    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.898381   0.000480435       1.01856       1.177      0.1177     2593    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.896688   0.000914881      0.872828           1           1     2724    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.895066   0.000206406       2.25112      0.2218      0.2218     2855    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.894431     0.0018809       3.81069           1           1     2990    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.893995   0.000146391       2.76962           1           1     3121    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -0.89376   6.70021e-05      0.688569           1           1     3253    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.893474   0.000383198      0.584121           1           1     3396    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000     -0.893474   1.23951e-05       1.17832     0.03257           1     3398    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.3 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  18.0 seconds.
0/7: Initial log joint probability = -0.679173 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.673539   0.000343525      0.657252      0.3417      0.3417      105    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.669468    0.00220076      0.545824           1           1      220    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.666244   0.000140515      0.309019      0.9176      0.9176      333    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.663673    0.00284042      0.240759           1           1      444    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.662059   0.000297593      0.137042           1           1      556    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -0.66142   1.29118e-05      0.121408       0.499       0.499      667    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.661131   0.000103728      0.316026      0.8664      0.8664      775    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.660775   0.000602214       0.24376      0.4176           1      884    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.660453    0.00221289      0.212247           1           1      989    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.660211   0.000613113     0.0512069           1           1     1098    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099     -0.660174   0.000150914     0.0951698           1           1     1206    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.660129   0.000393034     0.0373551           1           1     1321    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299      -0.66011   3.47948e-05     0.0381016           1           1     1432    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.660104   2.10412e-05     0.0303994      0.3688           1     1544    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.660097   2.67977e-05     0.0274649           1           1     1649    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599      -0.66009   3.90465e-05    0.00753632           1           1     1755    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.660088   1.05451e-05    0.00368591           1           1     1867    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1734     -0.660088   1.29213e-06    0.00417302           1           1     1904    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.8 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  18.4 seconds.
0/8: Initial log joint probability = -0.801845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.781795    0.00130938      0.160238       0.999       0.999      102    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -0.77416    0.00508485      0.393262      0.3891           1      207    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.770581    0.00143525      0.149047           1           1      315    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.769164   0.000407042     0.0808199      0.7712      0.7712      418    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.768615     0.0012072     0.0647379           1           1      522    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.768037    0.00726861      0.102084           1           1      626    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699     -0.767046   0.000380096     0.0592704           1           1      736    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799     -0.766659    0.00078393     0.0430136           1           1      849    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899      -0.76655    0.00065864     0.0436058           1           1      952    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999     -0.766497   0.000426484     0.0169852           1           1     1058    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.766467   0.000190222     0.0176747           1           1     1164    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199     -0.766448   0.000560091     0.0152535           1           1     1271    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.766432   2.47627e-05    0.00822713           1           1     1375    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.766426   0.000335396    0.00494176           1           1     1485    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499     -0.766421   5.59684e-05    0.00762123           1           1     1592    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.766418   0.000132988    0.00595692           1           1     1696    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1699     -0.766416   6.31586e-06    0.00324309      0.6099      0.6099     1803    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1767     -0.766415   2.73738e-05     0.0021243           1           1     1874    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.7 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  17.8 seconds.
0/9: Initial log joint probability = -0.809753 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.797916    0.00677482       0.65884      0.2241           1      116    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.793104   0.000154473      0.167315      0.6676      0.6676      230    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299        -0.791    0.00111319      0.166049      0.8997      0.8997      344    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.789603   0.000630291      0.114648           1           1      453    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.789028       0.00192      0.432213           1           1      558    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.788258   0.000726918      0.149821           1           1      671    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.787879   0.000271316      0.222385      0.4185      0.4185      776    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.787451    0.00344782      0.478888           1           1      883    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.786571    0.00169149      0.157771      0.8553      0.8553     1002    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.785914   7.84708e-05      0.126503      0.3017      0.3017     1113    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.785624   0.000690792     0.0809229           1           1     1229    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199     -0.785509   0.000231662     0.0401452           1           1     1341    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.785449   0.000331362     0.0275828           1           1     1452    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399      -0.78544   9.42615e-05      0.019954           1           1     1564    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.785435   2.50336e-06     0.0124413      0.6134      0.6134     1676    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.785432    2.3396e-05    0.00730702           1           1     1785    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.785429   4.58066e-05    0.00446883           1           1     1902    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799     -0.785427   9.32368e-05    0.00555377      0.4301           1     2018    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899     -0.785423   3.37761e-05    0.00584633           1           1     2129    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1954     -0.785423   1.56235e-05    0.00243265           1           1     2190    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.9 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  16.7 seconds.
0/10: Initial log joint probability = -0.752982 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -0.74432    0.00518581      0.473605           1           1      110    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.740694    0.00135079      0.124127           1           1      215    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299     -0.739819   0.000467203     0.0454451       2.911      0.2911      324    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.739645   3.53024e-05     0.0292512           1           1      430    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499     -0.739622   0.000358667     0.0190745           1           1      537    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599     -0.739617   1.27064e-05    0.00710391      0.4091      0.4091      642    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      693     -0.739616   5.49308e-06    0.00208477           1           1      739    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.3 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  18.3 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>prior_ma_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -47.8349     0.0221504       19.0463           1           1      117    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -45.7648    0.00571165       3.46335           1           1      230    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -45.5662     0.0100133       1.89596      0.3263           1      342    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399       -45.546    0.00169346        2.1254           1           1      459    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -45.5397   0.000317033      0.428709           1           1      576    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -45.5391   0.000364042     0.0877135           1           1      692    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      648       -45.539   1.49632e-05     0.0404052           1           1      750    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.5 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  16.2 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -48.7159     0.0786623       10.5955           1           1      103    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -46.5647     0.0140883       2.69444        1.54       0.154      213    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -46.4547   0.000713986       0.36996           1           1      322    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -46.4507   0.000308278      0.145021       2.376      0.2376      434    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -46.4505   0.000105123     0.0373666           1           1      545    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      507      -46.4505   9.61086e-05     0.0138326           1           1      555    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.4 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  16.3 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -52.3843     0.0627114         9.592           1           1      105    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -51.2153    0.00170242      0.984168           1           1      213    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299       -51.202   0.000303319      0.116614           1           1      321    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399      -51.2016   0.000252849     0.0320658           1           1      427    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      422      -51.2016    1.2997e-05     0.0116412           1           1      451    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.3 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  17.0 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -68.5514    0.00311121       56.6837       0.194       0.194      119    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199       -62.414    0.00184088       17.3648       1.194      0.1194      228    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -60.7294    0.00611886       10.5696           1           1      344    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -60.0813     0.0266808       11.9833           1           1      462    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -59.9341    0.00134365       3.89485           1           1      577    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -59.9077    0.00244858       1.04018           1           1      685    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -59.8976   0.000416499       1.98932       0.262           1      793    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -59.8952   0.000263351      0.325567      0.8911      0.8911      909    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899      -59.8942   9.47714e-06     0.0891111      0.4565      0.4565     1025    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999      -59.8941   0.000236563      0.121179           1           1     1140    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1022       -59.894   1.81502e-05     0.0500002           1           1     1165    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.7 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  16.6 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -42.6661     0.0223329       7.84462      0.5123      0.5123      105    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -41.9281    0.00637081       1.04221           1           1      212    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299       -41.918   0.000618328      0.101688           1           1      317    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      388      -41.9179   6.06717e-05     0.0134589      0.9341      0.9341      410    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.4 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  16.8 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -85.8422    0.00709893       61.7408      0.8166      0.8166      137    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -78.6696    0.00702271       46.5719           1           1      274    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299        -74.05    0.00697126       358.673      0.2763      0.2763      419    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399       -70.935    0.00418814       230.728      0.5376      0.5376      550    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -70.3511   0.000875318       25.0158           1           1      681    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -68.2899    0.00738067        73.267      0.4296           1      819    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699        -67.58    0.00586724       125.822           1           1      958    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -66.8617    0.00175538       127.389    0.004858           1     1096    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899       -66.256    0.00177588       20.0455    0.009223           1     1279    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -66.1654   0.000477772       39.1978    0.003634           1     1637    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -65.8236    0.00247104       56.9035    0.002278           1     2000    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -64.8399    0.00146392       37.4714     0.01021           1     2340    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -64.6641   0.000532386       57.0153    0.005335           1     2682    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -62.9842    0.00375988       83.9501           1           1     2886    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -62.6503    0.00177412       120.839           1           1     3029    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -62.2549    0.00351048       48.7981      0.3838      0.3838     3201    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -61.8964      0.020556       247.759           1           1     3340    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -61.3536    0.00526587        68.377      0.6193     0.06193     3477    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -61.0887   0.000504723       79.4987      0.6434      0.6434     3634    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -60.7647    0.00229979       24.3752           1           1     3794    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -60.7611    0.00358195       28.0339      0.3089           1     3796    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  2.0 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  17.6 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -46.1565    0.00996754       34.3965       0.307       0.307      107    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -42.9924     0.0105242       14.1897      0.3967           1      216    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -42.7254     0.0115494       5.41258      0.4134           1      327    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -42.5962    0.00422877       2.63103           1           1      438    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -42.5648     0.0014201      0.538934           1           1      546    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -42.5614   0.000417053      0.571283      0.3092           1      651    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699      -42.5603   0.000241659     0.0859049           1           1      762    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799      -42.5602   4.13428e-06     0.0357618      0.6481      0.6481      874    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      824      -42.5602   3.66829e-05      0.029568           1           1      902    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.6 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  17.3 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -50.6906     0.0137105       6.28209           1           1      103    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -49.8984   0.000506778       1.25328      0.5649      0.5649      207    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -49.8885   8.65487e-05     0.0690631           1           1      312    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      386      -49.8884   3.99233e-05    0.00920057           1           1      405    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.2 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  17.7 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -60.6041     0.0323004       13.4317           1           1      112    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -56.6363    0.00206657       8.79417           1           1      222    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -56.1907    0.00349587       2.03122           1           1      333    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -56.1277     0.0031291      0.863195           1           1      439    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499       -56.122     0.0011115       0.38229           1           1      552    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599       -56.121   0.000124454      0.128515           1           1      670    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699      -56.1208   0.000106572      0.100226           1           1      787    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      712      -56.1208   8.67435e-06     0.0197992           1           1      801    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.5 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  16.3 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -54.6004    0.00408514       5.99466      0.4462      0.4462      111    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -54.0376    0.00174287       1.87453        0.32        0.32      226    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -54.0136     0.0041019      0.449424           1           1      331    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399      -54.0128    0.00010758     0.0357057           1           1      438    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      402      -54.0128   9.13538e-05     0.0144651           1           1      442    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.4 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  16.0 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691241 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.686185   0.000992176      0.686283           1           1      116    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.681654    0.00114201      0.392696           1           1      239    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -0.67898   0.000696936      0.227574           1           1      356    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.676539    0.00202168      0.716122           1           1      476    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.673123    0.00196914      0.706416      0.5021           1      603    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.669349   0.000253179       0.52846           1           1      717    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699     -0.667306     0.0007384      0.699055       0.114           1      840    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.666288   0.000461986      0.182481           1           1      950    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.665689   0.000269041      0.265925           1           1     1068    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.665033   9.99968e-05      0.615566     0.09048           1     1186    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.664299    0.00166529      0.823804           1           1     1303    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.661957    0.00105432      0.404232           1           1     1425    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299      -0.66062   0.000113503     0.0954689           1           1     1545    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399     -0.660456   0.000497233      0.266857           1           1     1663    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.660326   0.000123645     0.0702575           1           1     1787    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.660262   0.000119121      0.134482           1           1     1898    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.660131   7.97527e-05      0.119258      0.3352           1     2012    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799      -0.65903    0.00132345      0.251045           1           1     2136    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899     -0.658934   7.06407e-05       0.25412           1           1     2257    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999       -0.6589   8.34616e-05     0.0651173           1           1     2367    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000       -0.6589   1.69755e-05     0.0274534      0.2601           1     2369    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  1.1 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  14.5 seconds.
0/2: Initial log joint probability = -0.733884 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.725779    0.00160635      0.501414      0.8869      0.8869      111    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199     -0.720387    0.00120736      0.494121           1           1      219    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299     -0.718486    0.00369873      0.358399           1           1      327    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.714308    0.00161744      0.361208      0.4427      0.4427      438    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499       -0.7127    0.00412192      0.422391           1           1      546    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.712144    2.3395e-05      0.078292      0.2931      0.2931      656    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.711908   0.000283746       0.10774           1           1      764    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.711664    0.00164089     0.0607627           1           1      874    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899     -0.711529   0.000139243      0.196094           1           1      984    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.711449   0.000306237     0.0484624           1           1     1092    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.711374   6.52595e-05      0.061022           1           1     1203    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.711334   0.000154913     0.0334886           1           1     1311    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299      -0.71132   6.71317e-05     0.0433233      0.7192      0.7192     1417    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399     -0.711298   3.23919e-05     0.0204997      0.8594      0.8594     1525    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.711287    0.00028384     0.0302071           1           1     1636    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.711268   3.23174e-05     0.0339097       0.302       0.302     1749    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.711248   3.69433e-05     0.0117833      0.9321      0.9321     1859    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799     -0.711239   1.99036e-05     0.0131075           1           1     1970    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899     -0.711237   1.26161e-05    0.00512639           1           1     2083    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1999     -0.711236   2.59043e-05       0.01197           1           1     2192    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     2000     -0.711236    2.1158e-05    0.00700647           1           1     2193    
0/2: Optimization terminated normally:  
0/2:   Maximum number of iterations hit, may not be at an optima 
0/2: Finished in  1.0 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  13.4 seconds.
0/3: Initial log joint probability = -0.799593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.783465   0.000195502      0.121868           1           1      105    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.775671    0.00512764      0.280187           1           1      209    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.772193   0.000431635     0.0850471           1           1      314    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.771643   0.000546455     0.0521529           1           1      418    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.771394   0.000261394     0.0417127           1           1      522    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.771292   0.000318129     0.0310254           1           1      626    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.771258   0.000186387     0.0248705           1           1      734    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799     -0.771251   3.93099e-06    0.00741229      0.7564      0.7564      844    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      899     -0.771249   2.13268e-05    0.00148581           1           1      951    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.5 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  16.9 seconds.
0/4: Initial log joint probability = -0.871315 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99     -0.860079   0.000612954      0.880884           1           1      116    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.850838    0.00860786       1.66245      0.4246           1      233    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -0.84131   0.000354611      0.455026           1           1      341    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399     -0.833578   0.000975841      0.557645           1           1      455    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499     -0.829677   0.000102528      0.678478      0.6069      0.6069      571    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.823171    0.00205368      0.540194           1           1      685    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -0.81987    0.00018218      0.371471           1           1      798    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799     -0.816349   0.000557468      0.625811           1           1      909    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.815504   0.000229428      0.372316      0.6961      0.6961     1024    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.814543    0.00174316      0.791301           1           1     1139    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.813776   0.000763713      0.250905       1.139      0.1139     1248    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.812988    0.00121075      0.278532           1           1     1365    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.810429    0.00117895      0.265363           1           1     1485    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.809252   9.00892e-05      0.353462      0.5303      0.5303     1599    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.808885   0.000304361      0.238793      0.6553      0.6553     1709    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599     -0.808398    0.00277466      0.714896           1           1     1825    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.808016    0.00153063      0.182509           1           1     1937    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799      -0.80781   0.000317239      0.143237           1           1     2052    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.807576   8.99131e-05      0.160222      0.9667     0.09667     2158    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.806956    0.00407645      0.414277           1           1     2271    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000     -0.806922    0.00471493      0.397663           1           1     2272    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  1.4 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  16.3 seconds.
0/5: Initial log joint probability = -0.729812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.713407     0.0167407        1.1873           1           1      102    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.709523    0.00143097      0.131297      0.9892      0.9892      208    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.708633    9.9603e-05     0.0608207           1           1      312    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.708235    0.00014335     0.0505652           1           1      419    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499      -0.70813    0.00025438     0.0182137           1           1      530    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.708099   0.000363159     0.0204586           1           1      640    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.708081   0.000287092     0.0247909           1           1      749    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.708077   0.000153626      0.014511           1           1      857    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.708073    3.0818e-05    0.00720183           1           1      966    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      999     -0.708071    4.2478e-05    0.00240234           1           1     1071    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1056     -0.708071   9.85649e-06    0.00146148      0.9538      0.9538     1133    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.7 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.5 seconds.
0/6: Initial log joint probability = -0.917062 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916393   5.42247e-05      0.760708    0.006803           1      137    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -0.91519   8.11367e-05      0.894713           1           1      273    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.914342   0.000821221      0.627132           1           1      408    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -0.91338   1.64234e-05       2.97592     0.01138           1      547    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499        -0.913   2.18032e-05      0.432818           1           1      699    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.912643   9.87103e-05       2.17226      0.4023           1      832    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.912229   6.47608e-05       1.27592      0.8851      0.8851      957    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.911255    0.00129235       4.48394     0.05076           1     1096    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.908414    0.00180987       5.24314           1           1     1225    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999     -0.906346   0.000124434       7.71438     0.04305           1     1347    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.904839   4.29184e-05       1.72224      0.4145           1     1495    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -0.90388   9.92382e-05      0.644553           1           1     1631    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.903014    0.00153586        1.1634           1           1     1850    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.901414   0.000116726      0.817867           1           1     1982    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.900838   6.31805e-05      0.227715        4.77       0.477     2110    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.900592    4.3054e-05      0.732659           1           1     2259    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.900417   5.13798e-05      0.493972           1           1     2395    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.900152   4.25857e-05      0.852542     0.08523           1     2517    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.899895   0.000205553       1.48988           1           1     2649    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.899675   2.09063e-05      0.201123      0.7796      0.7796     2788    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000     -0.899675     2.307e-05      0.141839           1           1     2789    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.3 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  15.7 seconds.
0/7: Initial log joint probability = -0.679173 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -0.67468    0.00112882      0.695694           1           1      107    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.671378    0.00188297      0.685138           1           1      218    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.669181   0.000126085      0.208271           1           1      327    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.668329   0.000126013      0.204812           1           1      438    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.667406   0.000249518      0.308394      0.7833      0.7833      546    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.666387   0.000262514      0.245305      0.3229      0.3229      657    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.665527   0.000410216      0.305592        0.36        0.36      769    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.665322   0.000320423     0.0774093           1           1      874    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.665184   2.26669e-05     0.0775065           1           1      984    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.665105   0.000288752       0.18761           1           1     1091    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099     -0.665009   0.000485425       0.14831      0.2843           1     1205    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.664926   0.000185174      0.052349           1           1     1314    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299     -0.664899    0.00015145     0.0530659           1           1     1429    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.664884   5.44519e-06     0.0191517           1           1     1539    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.664874   6.35929e-05     0.0838722           1           1     1649    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.664865   8.47313e-05     0.0286406           1           1     1757    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.664854   2.66575e-05     0.0290506      0.6446      0.6446     1868    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.664843   4.31087e-05     0.0149874           1           1     1976    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899      -0.66484   0.000126806     0.0110759           1           1     2083    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1999     -0.664839   4.39953e-05     0.0234241           1           1     2194    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     2000     -0.664839   3.55898e-06    0.00975143      0.7287      0.7287     2195    
0/7: Optimization terminated normally:  
0/7:   Maximum number of iterations hit, may not be at an optima 
0/7: Finished in  1.1 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  16.1 seconds.
0/8: Initial log joint probability = -0.801845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.788593    0.00107772      0.159236           1           1      105    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -0.78335     0.0012203      0.445396      0.5522      0.5522      210    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.780587   0.000309684      0.141115           1           1      320    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.779489   0.000313535     0.0875359      0.7209      0.7209      426    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.778721   0.000508456     0.0851308           1           1      530    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599      -0.77832   0.000829793     0.0660361           1           1      636    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699     -0.777897    0.00134491      0.100067      0.8383      0.8383      742    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799     -0.777606    0.00374006     0.0798815           1           1      849    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899     -0.777328   0.000137185     0.0562792      0.2653      0.2653      957    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999     -0.777167   0.000271232     0.0522201      0.4414           1     1067    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.777095    0.00165908      0.122727           1           1     1172    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199     -0.777065    6.6747e-05     0.0351576      0.5708      0.5708     1278    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.777052   0.000190497     0.0166449           1           1     1385    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.777034   0.000282147     0.0136794           1           1     1489    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499      -0.77703   0.000123106    0.00939004           1           1     1594    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.777027   8.93368e-06    0.00274053           1           1     1698    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1695     -0.777026   5.29027e-06    0.00238268      0.2977           1     1798    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.9 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.5 seconds.
0/9: Initial log joint probability = -0.809753 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.801026     0.0036483      0.447213           1           1      112    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -0.79662    0.00105085       0.21775           1           1      218    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299     -0.795137   0.000395226      0.290518      0.5363      0.5363      327    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -0.79457   0.000359655      0.113315           1           1      436    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.793773    0.00186265      0.172988           1           1      539    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.792752   0.000608085     0.0915071           1           1      650    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.792203   9.93427e-05     0.0734822      0.8606      0.8606      759    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.791922    0.00120098     0.0886612           1           1      871    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.791725   0.000317408     0.0823095           1           1      980    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.791508    0.00094259      0.296827           1           1     1088    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.791285    0.00435005      0.131322           1           1     1200    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199      -0.79111   0.000190994     0.0364847           1           1     1309    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.791078   0.000194802     0.0406438           1           1     1419    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.791027   1.99825e-05     0.0126648      0.3852           1     1532    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.791015   4.57178e-05     0.0213855      0.9994      0.9994     1641    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.791001   2.50787e-05     0.0178356      0.9133      0.9133     1748    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.790993   9.84842e-05     0.0177433      0.4115           1     1859    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799     -0.790989   0.000486085     0.0124746           1           1     1970    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899     -0.790985   3.46182e-05    0.00634913           1           1     2079    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1999     -0.790983   9.29677e-05     0.0104697           1           1     2193    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     2000     -0.790983   0.000116861     0.0105853           1           1     2194    
0/9: Optimization terminated normally:  
0/9:   Maximum number of iterations hit, may not be at an optima 
0/9: Finished in  1.1 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  15.7 seconds.
0/10: Initial log joint probability = -0.752982 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.746207    0.00164937      0.231033           1           1      107    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.743529   6.57746e-05      0.116819           1           1      211    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299     -0.742286   0.000196015     0.0928831           1           1      321    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.742144   0.000160525     0.0705433           1           1      429    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499     -0.742102   3.27035e-05     0.0296592      0.2913      0.2913      543    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599     -0.742088   0.000116838      0.011424           1           1      648    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      699     -0.742085   4.37177e-05    0.00958733      0.5222      0.5222      756    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      731     -0.742085   2.49773e-06    0.00192828           1           1      790    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.4 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  16.4 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>prior_ma_5 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -51.2576     0.0625672       23.3227           1           1      117    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -47.1248     0.0265609       8.27899           1           1      239    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -46.5924     0.0131252       3.69896           1           1      357    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -46.4769     0.0103237       2.20062           1           1      480    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -46.4326    0.00078964       1.04608        0.19           1      594    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -46.4299   0.000204741      0.954619      0.4199           1      709    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699      -46.4294   3.66466e-05      0.354455      0.2354      0.2354      819    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799      -46.4293   0.000106577     0.0464182           1           1      932    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      811      -46.4293   5.71727e-05     0.0238019           1           1      947    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.7 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  16.5 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -50.5073     0.0104711       11.6394           1           1      109    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -47.5542     0.0100447       4.07054           1           1      224    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -47.2696    0.00350726       1.08622           1           1      330    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -47.2509     0.0003915      0.251121           1           1      442    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -47.2496   0.000176751      0.141546      0.1757           1      550    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599      -47.2495    0.00010669     0.0663459           1           1      659    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      619      -47.2495   4.63622e-05     0.0225057           1           1      683    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.5 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  15.0 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99       -53.474     0.0465066       8.93451           1           1      106    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -52.2025     0.0104124       2.86925      0.4061           1      212    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -52.1548      0.001541        0.5103           1           1      318    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399       -52.152   0.000378704     0.0732272           1           1      426    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      498      -52.1519    4.3802e-05     0.0227785           1           1      534    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.4 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  16.9 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -71.2542      0.004333       57.7092      0.0449           1      115    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199       -62.806     0.0122153       28.3558           1           1      226    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -61.5263     0.0103262       14.0449           1           1      342    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -60.3674     0.0100649       29.9802           1           1      458    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -60.1859    0.00226003       5.48697           1           1      570    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -60.1614     0.0040685        2.7073           1           1      680    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -60.1423   0.000197694       1.81921      0.2724           1      797    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -60.1381   0.000547904      0.870131      0.8163      0.8163      914    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899      -60.1366   0.000671917      0.505423       4.781      0.4781     1029    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999      -60.1357   8.79956e-05      0.158359           1           1     1146    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1054      -60.1357    4.2967e-05     0.0574485           1           1     1208    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.8 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  17.2 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -43.9127      0.120643       23.8509           1           1      104    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -42.9365    0.00913549       2.58041           1           1      209    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -42.9045   0.000243919      0.136942           1           1      315    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399      -42.9039   0.000174803     0.0432353           1           1      420    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      456      -42.9039   9.28843e-05     0.0110581           1           1      479    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.4 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  14.3 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -86.4092    0.00139619       712.233    0.007841           1      141    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199       -80.873     0.0017056       84.9839    0.005095    0.005095      281    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -76.8118    0.00151791       330.444           1           1      410    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -74.8924   0.000357094       32.4419      0.8628      0.8628      546    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -74.2975   0.000374423       29.0295           1           1      672    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -71.3666    0.00952732       37.1635           1           1      812    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -69.0733     0.0331311       45.6709           1           1      942    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -67.3124     0.0152864       91.7273      0.2606           1     1091    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -65.0911    0.00254177       26.8904           1           1     1220    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -63.7347    0.00228016       65.8139           1           1     1342    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -63.3514   0.000746932       29.6366           1           1     1479    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -62.6524   0.000974532       15.8241           1           1     1605    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -62.4926    0.00116175       6.77087           1           1     1800    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -62.2938   0.000289095       21.6467       0.476      0.0476     1943    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -62.1038    0.00114177       17.3453           1           1     2087    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -61.9839   0.000523118       12.4977           1           1     2209    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -61.7639   0.000697655       23.4376      0.7035      0.7035     2340    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -61.7035   9.68767e-05       10.4006           1           1     2476    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -61.6394    0.00105552       11.6969     0.04428           1     2601    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -61.6047   0.000460453       11.7965      0.6417     0.06417     2725    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -61.6045    0.00254804       3.29289           1           1     2726    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.5 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  16.3 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99       -48.947     0.0068486       17.3619           1           1      109    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -44.6919     0.0141574       24.6939      0.2751      0.2751      218    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299        -43.77    0.00328268       8.65676      0.7183      0.7183      329    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -43.2557    0.00219931       2.46704           1           1      438    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499       -43.232     0.0018243      0.875716           1           1      550    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -43.2287   0.000466442      0.255969           1           1      659    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699      -43.2278   0.000139153      0.169124      0.4985      0.4985      767    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799      -43.2277   0.000143614     0.0929255           1           1      876    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      815      -43.2277   5.83843e-05     0.0317616       0.427           1      897    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.6 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  16.2 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -51.8563     0.0768809       7.00263           1           1      106    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -50.5814    0.00259606       1.27289           1           1      210    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -50.5584   0.000535888      0.157749           1           1      316    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399       -50.558   4.87435e-05     0.0273434       0.295       0.295      421    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      413       -50.558   1.82347e-05     0.0100063           1           1      436    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.3 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  17.5 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -60.4661     0.0472205       60.3123           1           1      108    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199        -57.25      0.016678       6.28882           1           1      221    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -56.7892    0.00161182       4.29363       0.618       0.618      330    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -56.7097   0.000262402       2.05757      0.6417      0.6417      438    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -56.7018    0.00146904      0.528273           1           1      550    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599      -56.7006    3.4802e-05      0.163819           1           1      667    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699      -56.7004   2.28421e-05     0.0535404      0.8185      0.8185      775    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      774      -56.7003   2.47325e-05     0.0213755           1           1      857    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.6 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  16.8 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -55.3551     0.0276252       11.7048           1           1      106    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -54.3978     0.0115178         1.427           1           1      214    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -54.3655    0.00124709      0.336585      0.4885           1      324    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399      -54.3643   7.09019e-05     0.0580495      0.8537      0.8537      428    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      488      -54.3643   6.40712e-05     0.0226093           1           1      524    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.4 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  15.3 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_5 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691241 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.686237   0.000754182      0.489758           1           1      119    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.683222   0.000154231      0.427519      0.1567           1      237    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.680854     0.0060255       1.54819           1           1      348    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399       -0.6779   0.000241809       0.97039      0.3899     0.03899      470    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.675679    0.00137373      0.302036           1           1      587    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.674525   0.000869022      0.431266           1           1      705    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699     -0.674117   0.000298931      0.473258           1           1      822    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.672204    0.00097583      0.328057           1           1      939    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.670841   0.000377278      0.312207           1           1     1052    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.669971   0.000104236      0.322855      0.3797      0.3797     1168    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.669261   5.48067e-05      0.385511      0.3614      0.3614     1281    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.668777   0.000426425      0.353903           1           1     1396    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.668235    0.00113071       0.19411           1           1     1507    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399     -0.667653     0.0043811      0.704773           1           1     1618    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.667023   0.000183553     0.0967118           1           1     1731    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.666859   2.05725e-05      0.149104      0.3575      0.3575     1859    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.666796   0.000457147      0.143418           1           1     1972    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799     -0.666758   8.97838e-05      0.116489      0.2526           1     2085    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899     -0.666746   1.26147e-05     0.0323163           1           1     2203    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.666694   0.000325803      0.137014      0.3006      0.3006     2318    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.666692    0.00115535     0.0864627           1           1     2319    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  1.3 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  16.6 seconds.
0/2: Initial log joint probability = -0.733884 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.727629    0.00181739       0.66488           1           1      108    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199     -0.723882    0.00194471      0.308753           1           1      218    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299     -0.721646    0.00133904       0.40431           1           1      324    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.719633    7.1476e-05      0.229918      0.2072      0.2072      438    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.718822   0.000727249       0.43739           1           1      545    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.718045   0.000682076      0.208689       0.736       0.736      658    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.717539    0.00117612       0.22946           1           1      767    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.717153   0.000336347      0.171591      0.6829      0.6829      871    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899       -0.7164    0.00117219      0.118368           1           1      980    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.716233   0.000243317      0.060266           1           1     1085    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.716197   2.61783e-05     0.0204118        2.28       0.228     1191    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.716159   5.43192e-05     0.0511238           1           1     1301    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299     -0.716101   5.40052e-05      0.031382           1           1     1412    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399     -0.716078   8.32877e-06     0.0181512           1           1     1521    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.716062   7.08601e-05     0.0313379           1           1     1630    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.716053   8.32016e-05     0.0118783           1           1     1739    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.716023   0.000446121     0.0658439           1           1     1848    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799     -0.716005   1.65952e-05     0.0106685           1           1     1959    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899     -0.716002   3.60096e-05    0.00973641           1           1     2063    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1999     -0.716001   5.81881e-05    0.00689582           1           1     2173    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     2000     -0.716001   5.27848e-05    0.00583491           1           1     2174    
0/2: Optimization terminated normally:  
0/2:   Maximum number of iterations hit, may not be at an optima 
0/2: Finished in  1.4 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  15.3 seconds.
0/3: Initial log joint probability = -0.799594 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.788848    0.00372736      0.800785      0.4043           1      102    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.785084   0.000212021      0.110335           1           1      207    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -0.78383   0.000308728      0.172634           1           1      311    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.783496   0.000503276     0.0650096           1           1      414    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.783388   0.000165475      0.028768           1           1      520    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.783368   2.70482e-05     0.0148099      0.8134      0.8134      624    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.783358   0.000159041       0.02388           1           1      726    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799     -0.783356   2.39572e-05    0.00373717           1           1      828    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      834     -0.783356   4.37668e-06    0.00280583           1           1      867    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.8 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  16.5 seconds.
0/4: Initial log joint probability = -0.871315 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99     -0.862882   0.000412633       1.25193           1           1      122    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.858196   0.000117629      0.510359           1           1      239    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299     -0.855727   0.000443697      0.582641           1           1      351    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -0.85287   0.000641026       1.70838      0.2288           1      470    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499     -0.848736   0.000921076       3.19496      0.2269           1      581    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.841484    0.00148329       1.56893       0.515           1      705    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -0.83431     0.0108601        1.4625           1           1      815    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799     -0.830095    0.00131561       1.59405           1           1      928    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.827797   0.000295751       1.33061      0.1262           1     1041    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.825043   9.16527e-05       0.12298           1           1     1160    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.823189   0.000817971      0.371007           1           1     1269    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.821392   0.000329216      0.606372      0.4213      0.4213     1386    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.819877   0.000634369      0.444362           1           1     1506    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.819111   3.15765e-05      0.473693      0.5163      0.5163     1622    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.818049   0.000224496      0.386152           1           1     1732    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599     -0.817346   0.000366289      0.513281      0.3433      0.3433     1845    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.815715    0.00037893      0.612613           1           1     1959    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799     -0.814225    0.00101028      0.741367           1           1     2082    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.812667    0.00226163      0.713202           1           1     2199    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.811949   0.000222669      0.382285      0.2949      0.2949     2315    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000     -0.811942     0.0041748      0.463995      0.3216           1     2317    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  1.7 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  15.8 seconds.
0/5: Initial log joint probability = -0.729812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.718468    0.00311159      0.391428           1           1      103    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.714056    0.00111952      0.190651           1           1      209    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.713005    0.00083618     0.0784114           1           1      313    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.712779   0.000518299      0.075898           1           1      417    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499     -0.712688   0.000137071     0.0397952      0.3879           1      524    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.712669   2.31221e-05    0.00688878           1           1      631    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.712664   0.000112154     0.0090895      0.8002      0.8002      742    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.712662    0.00010156     0.0045772       3.063      0.3063      851    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.712661   2.15408e-05    0.00237437           1           1      961    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      967      -0.71266   2.01413e-05    0.00209965      0.4964           1     1034    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.8 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  14.8 seconds.
0/6: Initial log joint probability = -0.917078 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916669   0.000313079       4.39318           1           1      145    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.916063   9.53566e-05      0.727246           1           1      267    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.915599   0.000220811      0.953635       1.634     0.01634      417    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.915227   2.49349e-05      0.345569      0.4895    0.004895      712    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.914475   0.000107891       1.68636      0.9093    0.009093     1012    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.914114   2.39016e-05      0.345835           1           1     1251    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.913884    1.3769e-05       1.48146      0.6534      0.6534     1374    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.913487    8.7841e-05      0.546149     0.01424           1     1567    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.912333   0.000105809       6.92311       0.272      0.0272     1727    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999     -0.911387   0.000445485       1.04918       0.999       0.999     1862    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.910779    0.00097081       2.53138      0.1766           1     2001    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.909537   7.45627e-05       4.59632      0.1301           1     2143    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.907353    0.00277552       4.22488      0.4164           1     2284    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.906227    3.2748e-05       1.01614      0.7649      0.7649     2403    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.905891   3.46728e-05        1.2729           1           1     2544    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.905609   1.65207e-05      0.229913     0.01356      0.9328     2670    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.905403   0.000270077      0.743665      0.3674      0.3674     2811    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.905076    6.3295e-05       4.71022      0.9244      0.9244     2952    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.904937   4.02888e-06      0.180017           1           1     3085    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.904832   0.000106984      0.501598     0.02565           1     3248    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -0.90483   8.89695e-05      0.490823       0.259      0.0259     3250    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  2.3 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  15.8 seconds.
0/7: Initial log joint probability = -0.679173 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.675452   0.000174987      0.586596      0.3532      0.3532      116    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.673009   0.000472575       0.30024           1           1      225    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.671363    0.00066977       0.26828           1           1      338    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.670536   0.000144889      0.210328      0.4272      0.4272      451    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.669939   0.000464039       0.27909           1           1      566    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.668885   0.000594999      0.148246           1           1      677    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.668625   0.000477199     0.0917833           1           1      784    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.668436   0.000304881     0.0610417           1           1      898    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.668378   0.000274232      0.135338           1           1     1009    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.668286   0.000121966     0.0609214           1           1     1117    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099     -0.668247   0.000103542     0.0337422           1           1     1225    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.668221   0.000348227      0.136789           1           1     1334    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299     -0.668208   0.000136546      0.142337           1           1     1441    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.668197    0.00010137     0.0300504           1           1     1553    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.668181   6.11651e-05     0.0337903      0.7255      0.7255     1661    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.668175   5.47108e-05    0.00976922           1           1     1769    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699      -0.66817    1.0135e-05     0.0168167           1           1     1879    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.668161   0.000219582     0.0337929      0.2431           1     1987    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899     -0.668154   2.54606e-05     0.0115502           1           1     2099    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1999     -0.668151   1.71774e-05     0.0121035           1           1     2207    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     2000     -0.668151   1.92707e-05     0.0133889      0.4308           1     2209    
0/7: Optimization terminated normally:  
0/7:   Maximum number of iterations hit, may not be at an optima 
0/7: Finished in  1.9 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  16.0 seconds.
0/8: Initial log joint probability = -0.801845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.790266    0.00017286      0.266465      0.4974      0.4974      105    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.785959    0.00182659      0.263064           1           1      211    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.783507    0.00321816      0.198153           1           1      319    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.782436   0.000208523     0.0913126           1           1      426    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.781898    0.00059935     0.0646847           1           1      534    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.781148   0.000273347      0.113672      0.7373      0.7373      640    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699     -0.780529    0.00248181     0.0869507           1           1      746    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799     -0.780138   5.70851e-05     0.0491295       0.458       0.458      855    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899     -0.780052   2.40324e-05     0.0546686      0.6444      0.6444      961    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999     -0.779967   0.000479986     0.0252229           1           1     1068    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.779863   0.000828455     0.0293275           1           1     1173    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199     -0.779801    0.00329282     0.0843345           1           1     1280    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.779777   9.69254e-05     0.0113523           1           1     1392    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.779763   0.000396711     0.0157366           1           1     1502    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499     -0.779752   0.000143438     0.0230807           1           1     1607    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.779748   6.91762e-05    0.00890605           1           1     1709    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1699     -0.779743   0.000763135     0.0158647           1           1     1819    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1799     -0.779738   0.000215902     0.0174595           1           1     1923    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1899     -0.779735   0.000177128     0.0128992           1           1     2027    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1999     -0.779732   6.98587e-06    0.00308231           1           1     2135    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     2000     -0.779732   2.01276e-05    0.00369666           1           1     2136    
0/8: Optimization terminated normally:  
0/8:   Maximum number of iterations hit, may not be at an optima 
0/8: Finished in  1.3 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  17.2 seconds.
0/9: Initial log joint probability = -0.809753 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.802883    0.00214166       1.23046      0.5841     0.05841      112    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.798801    0.00166922      0.438261           1           1      223    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299     -0.797013   0.000775002      0.781007           1           1      336    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -0.79646   0.000854009       0.33487           1           1      447    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.795924   0.000153822      0.171893           1           1      558    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.795574   4.95706e-05     0.0572836           1           1      669    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.795201    0.00600349      0.444026           1           1      776    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.794448   0.000251884      0.167352           1           1      884    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.793824     0.0026604      0.112212           1           1      998    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.793466   0.000111503      0.173364      0.8326      0.8326     1111    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.793196    0.00104432      0.180843           1           1     1229    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199      -0.79305   0.000181068      0.164331      0.9086      0.9086     1334    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.792994    7.4968e-05     0.0438909           1           1     1445    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.792971   0.000102722     0.0190769      0.9871      0.9871     1557    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.792958   0.000201496     0.0655295      0.9276      0.9276     1669    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.792943   4.56918e-05     0.0290677      0.6675      0.6675     1780    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.792937   1.43933e-05     0.0232246      0.2965           1     1895    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799     -0.792934   2.54517e-05     0.0115079           1           1     2007    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899     -0.792927   0.000103517     0.0194451           1           1     2116    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1999     -0.792922   1.14485e-05     0.0193165           1           1     2227    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     2000     -0.792921   2.15068e-05     0.0172103           1           1     2228    
0/9: Optimization terminated normally:  
0/9:   Maximum number of iterations hit, may not be at an optima 
0/9: Finished in  1.3 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  18.1 seconds.
0/10: Initial log joint probability = -0.752982 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.747214   0.000251063      0.264757      0.7529      0.7529      110    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.744739   0.000219408      0.138552           1           1      215    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299     -0.743905   0.000908938      0.092113      0.9469      0.9469      319    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.743768   2.99157e-05     0.0523286       0.806       0.806      424    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499      -0.74369   0.000196636     0.0291504           1           1      533    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599     -0.743678   1.59314e-05     0.0107697           1           1      636    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      699     -0.743672   2.15522e-05     0.0156681      0.4602      0.4602      745    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      771     -0.743671   6.91788e-06    0.00302451           1           1      822    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.6 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  16.9 seconds.</code></pre>
</div>
</div>
<section id="gradient-conditions" class="level4">
<h4 class="anchored" data-anchor-id="gradient-conditions">Gradient conditions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>p31<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(prior_ma_5<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>p32<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(noprior_ma_5<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>iresults <span class="ot">=</span> <span class="fu">rbind</span>(prior_ma_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>                prior_ma_2<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>                 prior_ma_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>                 prior_ma_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>),</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>                 prior_ma_5<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_5"</span>),</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_5<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_5"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ivar =</span> <span class="fu">if_else</span>(ivar<span class="sc">&gt;</span><span class="fl">1e6</span>,<span class="fl">1e6</span>,ivar)) <span class="sc">%&gt;%</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.factor</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB))</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">1000000</span>))<span class="sc">+</span>    </span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a>idx_exemple_analytes <span class="ot">=</span> iresults <span class="sc">%&gt;%</span></span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">==</span><span class="st">"prior_ref"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ivar)<span class="sc">%&gt;%</span></span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which</span>(<span class="fu">row_number</span>() <span class="sc">%%</span> <span class="dv">100</span> <span class="sc">==</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(i)<span class="sc">%&gt;%</span><span class="fu">pull</span>()</span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a>iresults <span class="sc">%&gt;%</span></span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-48d9eaea{}.cl-48cd9088{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-48d292cc{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-48d292e0{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-48d2c6ca{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-48d2c6d4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-48d2c6de{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-48d2c710{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-48d2c72e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-48d2c72f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-48d9eaea"><thead><tr style="overflow-wrap:break-word;"><th class="cl-48d2c6ca"><p class="cl-48d292cc"><span class="cl-48cd9088">method</span></p></th><th class="cl-48d2c6d4"><p class="cl-48d292e0"><span class="cl-48cd9088">&lt;=1x</span></p></th><th class="cl-48d2c6d4"><p class="cl-48d292e0"><span class="cl-48cd9088">&lt;=2x</span></p></th><th class="cl-48d2c6d4"><p class="cl-48d292e0"><span class="cl-48cd9088">&lt;=3x</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-48d2c6de"><p class="cl-48d292cc"><span class="cl-48cd9088">noprior_3</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.000</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.016</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.106</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-48d2c6de"><p class="cl-48d292cc"><span class="cl-48cd9088">noprior_4</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.000</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.170</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.374</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-48d2c6de"><p class="cl-48d292cc"><span class="cl-48cd9088">noprior_5</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.090</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.360</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.552</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-48d2c6de"><p class="cl-48d292cc"><span class="cl-48cd9088">noprior_ref</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.000</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.048</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.238</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-48d2c6de"><p class="cl-48d292cc"><span class="cl-48cd9088">prior_2</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.002</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.774</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.840</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-48d2c6de"><p class="cl-48d292cc"><span class="cl-48cd9088">prior_3</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.120</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.936</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.954</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-48d2c6de"><p class="cl-48d292cc"><span class="cl-48cd9088">prior_4</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.826</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.938</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.960</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-48d2c6de"><p class="cl-48d292cc"><span class="cl-48cd9088">prior_5</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.834</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.938</span></p></td><td class="cl-48d2c710"><p class="cl-48d292e0"><span class="cl-48cd9088">0.960</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-48d2c72e"><p class="cl-48d292cc"><span class="cl-48cd9088">prior_ref</span></p></td><td class="cl-48d2c72f"><p class="cl-48d292e0"><span class="cl-48cd9088">0.080</span></p></td><td class="cl-48d2c72f"><p class="cl-48d292e0"><span class="cl-48cd9088">0.966</span></p></td><td class="cl-48d2c72f"><p class="cl-48d292e0"><span class="cl-48cd9088">0.998</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>f55_1<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">"target"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value,<span class="at">color=</span><span class="fu">as.factor</span>(target)))<span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Probability"</span>, <span class="at">y =</span> <span class="st">"Method"</span>, <span class="at">color =</span> <span class="st">"target"</span>)<span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.9</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>f55_1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prob.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>f55_1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prob.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prior-p5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-noprior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-noprior-p5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-maxvar.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-maxvar.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>p31</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-gra-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>p32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-gra-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-gra-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>f33_1<span class="ot">=</span>p33</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>f55_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-gra-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="isocratic-conditions" class="level4">
<h4 class="anchored" data-anchor-id="isocratic-conditions">Isocratic conditions</h4>
<section id="individual-plots" class="level5">
<h5 class="anchored" data-anchor-id="individual-plots">Individual plots</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>plot_id <span class="ot">=</span> <span class="cf">function</span>(results) { </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  results <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>CV<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">ymin =</span> llog10tr, <span class="at">ymax =</span> ulog10tr), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>mlog10tr), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"log(tr)"</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">10</span>, <span class="at">name=</span><span class="st">"%CV"</span>)) <span class="sc">+</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(i<span class="sc">~</span>mod) <span class="sc">+</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>results_prior_ma_ref<span class="ot">&lt;-</span>prior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_ref<span class="ot">&lt;-</span>noprior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>results_prior_ma_2<span class="ot">&lt;-</span>prior_ma_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>results_prior_ma_3<span class="ot">&lt;-</span>prior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> mrgmisc<span class="sc">::</span><span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_3<span class="ot">&lt;-</span>noprior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a>results_prior_ma_4<span class="ot">&lt;-</span>prior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_4<span class="ot">&lt;-</span>noprior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a>results_prior_ma_5<span class="ot">&lt;-</span>prior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_5<span class="ot">&lt;-</span>noprior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ref <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_ref,plot_id) </span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ref <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_ref,plot_id) </span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_2 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_2,plot_id) </span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_3 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_3,plot_id) </span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_3 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_3,plot_id) </span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_4 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_4,plot_id) </span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_4 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_4,plot_id) </span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_5 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_5,plot_id) </span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_5 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_5,plot_id) </span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ref.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ref.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_5[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_5[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ref </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ref </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_3 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-5.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-6.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-7.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_5  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-8.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_5 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-9.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combined" class="level5">
<h5 class="anchored" data-anchor-id="combined">Combined</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>plot_id <span class="ot">=</span> <span class="cf">function</span>(results) { </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  results <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>CV)) <span class="sc">+</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">ymin =</span> llog10tr, <span class="at">ymax =</span> ulog10tr), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>mlog10tr), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"log(tr)"</span>,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">1</span>, <span class="at">name=</span><span class="st">"%CV"</span>)) <span class="sc">+</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(i<span class="sc">~</span>mod) <span class="sc">+</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>izoresults <span class="ot">=</span> <span class="fu">rbind</span>( prior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>                prior_ma_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>                 prior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>                 prior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>),</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>                 prior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_5"</span>),</span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_5"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&lt;=</span><span class="fu">log10</span>(<span class="dv">100</span>))<span class="sc">%&gt;%</span></span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&gt;=</span><span class="fu">log10</span>(<span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.numeric</span>(c),</span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(i,method,c)<span class="sc">%&gt;%</span></span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(i,method) <span class="sc">%&gt;%</span></span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">imaxcv =</span> <span class="fu">max</span>(CV), <span class="at">imincv =</span> <span class="fu">min</span>(CV), <span class="at">aveCV =</span> pracma<span class="sc">::</span><span class="fu">trapz</span>(c, CV)<span class="sc">/</span>(<span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">imaxcv =</span> <span class="fu">if_else</span>(imaxcv<span class="sc">&gt;</span><span class="fl">1e4</span>,<span class="fl">1e4</span>,imaxcv))<span class="sc">%&gt;%</span></span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.integer</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB)) </span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb65-63"><a href="#cb65-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb65-64"><a href="#cb65-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb65-65"><a href="#cb65-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb65-66"><a href="#cb65-66" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb65-67"><a href="#cb65-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">10000</span>))<span class="sc">+</span>    </span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb65-69"><a href="#cb65-69" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb65-70"><a href="#cb65-70" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb65-71"><a href="#cb65-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-72"><a href="#cb65-72" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb65-73"><a href="#cb65-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb65-74"><a href="#cb65-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-75"><a href="#cb65-75" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-izo-combined-CV.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb65-76"><a href="#cb65-76" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-izo-combined-CV.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb65-77"><a href="#cb65-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-78"><a href="#cb65-78" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-combined-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>f44_1 <span class="ot">=</span> p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" role="list">

</div>
</section>
<section id="licenses" class="level1 unnumbered">
<h1 class="unnumbered">Licenses</h1>
<ul>
<li>Code &amp; copy; 2024, Paweł Wiczling, licensed under BSD-3.</li>
<li>Text &amp; copy; 2024, Paweł Wiczling, licensed under CC-BY-NC 4.0.</li>
</ul>
</section>
<section id="original-computing-environment" class="level1 unnumbered">
<h1 class="unnumbered">Original Computing Environment</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.3 (2024-02-29)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 24.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: Europe/Warsaw
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] flextable_0.9.7     tibble_3.2.1        here_1.0.1         
 [4] reshape2_1.4.4      stringr_1.5.1       patchwork_1.3.0    
 [7] mrgmisc_0.2.1       purrr_1.0.2         tidyr_1.3.1        
[10] mvtnorm_1.3-1       ggplot2_3.5.1       dplyr_1.1.4        
[13] numDeriv_2016.8-1.1 pracma_2.4.4        cmdstanr_0.8.1     

loaded via a namespace (and not attached):
 [1] gtable_0.3.5            tensorA_0.36.2.1        xfun_0.48              
 [4] htmlwidgets_1.6.4       processx_3.8.4          vctrs_0.6.5            
 [7] tools_4.3.3             ps_1.8.0                generics_0.1.3         
[10] parallel_4.3.3          fansi_1.0.6             pkgconfig_2.0.3        
[13] data.table_1.16.2       checkmate_2.3.2         uuid_1.2-1             
[16] distributional_0.5.0    lifecycle_1.0.4         compiler_4.3.3         
[19] farver_2.1.2            textshaping_0.4.0       munsell_0.5.1          
[22] codetools_0.2-19        fontquiver_0.2.1        fontLiberation_0.1.0   
[25] htmltools_0.5.8.1       yaml_2.3.10             pillar_1.9.0           
[28] openssl_2.2.2           bettermc_1.2.2          abind_1.4-8            
[31] fontBitstreamVera_0.1.1 posterior_1.6.0         zip_2.3.1              
[34] tidyselect_1.2.1        digest_0.6.37           stringi_1.8.4          
[37] labeling_0.4.3          rprojroot_2.0.4         fastmap_1.2.0          
[40] grid_4.3.3              colorspace_2.1-1        cli_3.6.3              
[43] magrittr_2.0.3          utf8_1.2.4              withr_3.0.1            
[46] gdtools_0.4.0           scales_1.3.0            backports_1.5.0        
[49] rmarkdown_2.28          officer_0.6.7           askpass_1.2.1          
[52] ragg_1.3.3              evaluate_1.0.1          knitr_1.48             
[55] viridisLite_0.4.2       rlang_1.1.4             isoband_0.2.7          
[58] Rcpp_1.0.13             glue_1.8.0              xml2_1.3.6             
[61] rstudioapi_0.17.0       jsonlite_1.8.9          R6_2.5.1               
[64] plyr_1.8.9              systemfonts_1.1.0      </code></pre>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb69" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Design3: Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC"</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Paweł Wiczling*"</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co">      - name: "Department of Biopharmaceutics and Pharmacodynamics, Medical University of Gdańsk, Gen. J. Hallera 107, 80-416 Gdańsk, Poland"</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.Date())`"</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true  </span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 7</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 7</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setuphtml, include=FALSE}</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(cache=TRUE, message=FALSE, error=FALSE, warning=FALSE, comment=NA, out.width='95%')</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>The packages we will use are listed below.</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a><span class="in">library(cmdstanr)</span></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a><span class="in">library(pracma)</span></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a><span class="in">library(numDeriv)</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a><span class="in">library(mvtnorm)</span></span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr)</span></span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a><span class="in">library(purrr)</span></span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a><span class="in">library(mrgmisc)</span></span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a><span class="in">library(patchwork)</span></span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a><span class="in">library(stringr)</span></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a><span class="in">library(reshape2)</span></span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a><span class="in">library(here)</span></span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a><span class="in">library(tibble)</span></span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a><span class="in">library(flextable)</span></span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a><span class="in">select = dplyr::select</span></span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a><span class="in"># remotes::install_github("metrumresearchgroup/mrgmisc")</span></span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a><span class="in"># for parallel calculation use linux (mclaplly), i.e. Ubuntu 24.04 on Windows WSL</span></span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a><span class="in"># usethis::edit_r_environ(), add PROCESSX_NOTIFY_OLD_SIGCHLD = 1 ????</span></span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a><span class="in">#' Helper functions</span></span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a><span class="in">source("helper_functions.R")</span></span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a><span class="in">```{r paths}</span></span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a><span class="in">#' folder shortcuts:</span></span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a><span class="in">figures_dir1 &lt;- here("deliv", "figures", "design3","N")</span></span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a><span class="in">tables_dir1  &lt;- here("deliv", "tables", "design3","N")</span></span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a><span class="in">figures_dir5 &lt;- here("deliv", "figures", "manuscript_d3")</span></span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a><span class="in">tables_dir5  &lt;- here("deliv", "tables", "manuscript_d3")</span></span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-56"><a href="#cb69-56" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(figures_dir1)) dir.create(figures_dir1, recursive = T)</span></span>
<span id="cb69-57"><a href="#cb69-57" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(tables_dir1)) dir.create(tables_dir1, recursive = T)</span></span>
<span id="cb69-58"><a href="#cb69-58" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(figures_dir5)) dir.create(figures_dir5, recursive = T)</span></span>
<span id="cb69-59"><a href="#cb69-59" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(tables_dir5)) dir.create(tables_dir5, recursive = T)</span></span>
<span id="cb69-60"><a href="#cb69-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-61"><a href="#cb69-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-62"><a href="#cb69-62" aria-hidden="true" tabindex="-1"></a><span class="in">thisScript &lt;- "optimal-design-for-mixtures-design3"</span></span>
<span id="cb69-63"><a href="#cb69-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-64"><a href="#cb69-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-65"><a href="#cb69-65" aria-hidden="true" tabindex="-1"></a><span class="in">```{r helper-save-functions}</span></span>
<span id="cb69-66"><a href="#cb69-66" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave &lt;- function(.plot, .filename, .path=figures_dir, .height= 7, .width= 6) {</span></span>
<span id="cb69-67"><a href="#cb69-67" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(plot=.plot, filename=.filename, path=.path, height=.height, width=.width)</span></span>
<span id="cb69-68"><a href="#cb69-68" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb69-69"><a href="#cb69-69" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png &lt;- function(.plot, .filename, .path=figures_dir, .height=7, .width= 6) {</span></span>
<span id="cb69-70"><a href="#cb69-70" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(plot=.plot, filename=.filename, path=.path, height=.height, width=.width)</span></span>
<span id="cb69-71"><a href="#cb69-71" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb69-72"><a href="#cb69-72" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-73"><a href="#cb69-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-74"><a href="#cb69-74" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb69-75"><a href="#cb69-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-76"><a href="#cb69-76" aria-hidden="true" tabindex="-1"></a><span class="fu"># Priors</span></span>
<span id="cb69-77"><a href="#cb69-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r literature-priors}</span></span>
<span id="cb69-78"><a href="#cb69-78" aria-hidden="true" tabindex="-1"></a><span class="in"># fun_generate_priors defined in helper_functions.R</span></span>
<span id="cb69-79"><a href="#cb69-79" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN_MeOH=fun_generate_priors("N_MeOH", logP=2.2)</span></span>
<span id="cb69-80"><a href="#cb69-80" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN_ACN=fun_generate_priors("N_ACN", logP=2.2)</span></span>
<span id="cb69-81"><a href="#cb69-81" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN=fun_generate_priors("N", logP=2.2)</span></span>
<span id="cb69-82"><a href="#cb69-82" aria-hidden="true" tabindex="-1"></a><span class="in">priorsA=fun_generate_priors("A", logP=2.2)</span></span>
<span id="cb69-83"><a href="#cb69-83" aria-hidden="true" tabindex="-1"></a><span class="in">priorsB=fun_generate_priors("B", logP=2.2)</span></span>
<span id="cb69-84"><a href="#cb69-84" aria-hidden="true" tabindex="-1"></a><span class="in">priorsNB=fun_generate_priors("NB", logP=2.2)</span></span>
<span id="cb69-85"><a href="#cb69-85" aria-hidden="true" tabindex="-1"></a><span class="in">priorsNA=fun_generate_priors("NA", logP=2.2)</span></span>
<span id="cb69-86"><a href="#cb69-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-87"><a href="#cb69-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-88"><a href="#cb69-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r design-space}</span></span>
<span id="cb69-89"><a href="#cb69-89" aria-hidden="true" tabindex="-1"></a><span class="in">hplcparam_candidates_df = expand_grid(tg=seq(10,270,by=10), </span></span>
<span id="cb69-90"><a href="#cb69-90" aria-hidden="true" tabindex="-1"></a><span class="in">                                          td=2.1, </span></span>
<span id="cb69-91"><a href="#cb69-91" aria-hidden="true" tabindex="-1"></a><span class="in">                                          to=0.532,</span></span>
<span id="cb69-92"><a href="#cb69-92" aria-hidden="true" tabindex="-1"></a><span class="in">                                          te=0.04, </span></span>
<span id="cb69-93"><a href="#cb69-93" aria-hidden="true" tabindex="-1"></a><span class="in">                                          fio = seq(0.05, 0.2, by=0.05),</span></span>
<span id="cb69-94"><a href="#cb69-94" aria-hidden="true" tabindex="-1"></a><span class="in">                                          fif = 0.8,</span></span>
<span id="cb69-95"><a href="#cb69-95" aria-hidden="true" tabindex="-1"></a><span class="in">                                          m=c(0,1),</span></span>
<span id="cb69-96"><a href="#cb69-96" aria-hidden="true" tabindex="-1"></a><span class="in">                                          xpH=c(0,1))</span></span>
<span id="cb69-97"><a href="#cb69-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-98"><a href="#cb69-98" aria-hidden="true" tabindex="-1"></a><span class="in">hplcparam_candidates_df&lt;-hplcparam_candidates_df%&gt;%</span></span>
<span id="cb69-99"><a href="#cb69-99" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(tg=tg/3/3)</span></span>
<span id="cb69-100"><a href="#cb69-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-101"><a href="#cb69-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-102"><a href="#cb69-102" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</span></span>
<span id="cb69-103"><a href="#cb69-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-104"><a href="#cb69-104" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile stan models</span></span>
<span id="cb69-105"><a href="#cb69-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-compilation}</span></span>
<span id="cb69-106"><a href="#cb69-106" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_gq= cmdstan_model("../stan/hplc-gra-single-form-analytes-gq.stan", stanc_options = list("O1"))</span></span>
<span id="cb69-107"><a href="#cb69-107" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_sim = cmdstan_model("../stan/hplc-gra-single-form-analytes-sim.stan", stanc_options = list("O1"))</span></span>
<span id="cb69-108"><a href="#cb69-108" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes = cmdstan_model("../stan/hplc-gra-single-form-analytes.stan", stanc_options = list("O1"))</span></span>
<span id="cb69-109"><a href="#cb69-109" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes$compile(compile_model_methods=TRUE,force_recompile=TRUE)</span></span>
<span id="cb69-110"><a href="#cb69-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-111"><a href="#cb69-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-112"><a href="#cb69-112" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulate retention times and create datasets</span></span>
<span id="cb69-113"><a href="#cb69-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-simulations}</span></span>
<span id="cb69-114"><a href="#cb69-114" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma=hplcparam_candidates_df%&gt;%filter(xpH==0)</span></span>
<span id="cb69-115"><a href="#cb69-115" aria-hidden="true" tabindex="-1"></a><span class="in">nObs = nrow(data_ma);</span></span>
<span id="cb69-116"><a href="#cb69-116" aria-hidden="true" tabindex="-1"></a><span class="in">nAnalytes =50;</span></span>
<span id="cb69-117"><a href="#cb69-117" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = 1234;</span></span>
<span id="cb69-118"><a href="#cb69-118" aria-hidden="true" tabindex="-1"></a><span class="in">n_param = 3;</span></span>
<span id="cb69-119"><a href="#cb69-119" aria-hidden="true" tabindex="-1"></a><span class="in">n_rep = 10;</span></span>
<span id="cb69-120"><a href="#cb69-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-121"><a href="#cb69-121" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma=list()</span></span>
<span id="cb69-122"><a href="#cb69-122" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma=list()</span></span>
<span id="cb69-123"><a href="#cb69-123" aria-hidden="true" tabindex="-1"></a><span class="in">inits = list()</span></span>
<span id="cb69-124"><a href="#cb69-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-125"><a href="#cb69-125" aria-hidden="true" tabindex="-1"></a><span class="in">for (i in 1:n_rep) {</span></span>
<span id="cb69-126"><a href="#cb69-126" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]] = list(nObs=nObs,</span></span>
<span id="cb69-127"><a href="#cb69-127" aria-hidden="true" tabindex="-1"></a><span class="in">                   nAnalytes=nAnalytes,</span></span>
<span id="cb69-128"><a href="#cb69-128" aria-hidden="true" tabindex="-1"></a><span class="in">                   steps = 4 + 6*data_ma$m,</span></span>
<span id="cb69-129"><a href="#cb69-129" aria-hidden="true" tabindex="-1"></a><span class="in">                   hplcparam=as.matrix(data_ma%&gt;%dplyr::select(c(tg,td,to,te,fio,fif,m))),</span></span>
<span id="cb69-130"><a href="#cb69-130" aria-hidden="true" tabindex="-1"></a><span class="in">                   include_prior = 1,</span></span>
<span id="cb69-131"><a href="#cb69-131" aria-hidden="true" tabindex="-1"></a><span class="in">                   run_estimation=1,</span></span>
<span id="cb69-132"><a href="#cb69-132" aria-hidden="true" tabindex="-1"></a><span class="in">                   nSel = nObs,</span></span>
<span id="cb69-133"><a href="#cb69-133" aria-hidden="true" tabindex="-1"></a><span class="in">                   selected = 1:nObs)</span></span>
<span id="cb69-134"><a href="#cb69-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-135"><a href="#cb69-135" aria-hidden="true" tabindex="-1"></a><span class="in">fit_gq  = mod_analytes_gq$sample(data = datastruct_prior_ma[[i]],</span></span>
<span id="cb69-136"><a href="#cb69-136" aria-hidden="true" tabindex="-1"></a><span class="in">                                         seed = cseed,</span></span>
<span id="cb69-137"><a href="#cb69-137" aria-hidden="true" tabindex="-1"></a><span class="in">                                         fixed_param = TRUE,</span></span>
<span id="cb69-138"><a href="#cb69-138" aria-hidden="true" tabindex="-1"></a><span class="in">                                         chains = 1,</span></span>
<span id="cb69-139"><a href="#cb69-139" aria-hidden="true" tabindex="-1"></a><span class="in">                                         iter_sampling=1)</span></span>
<span id="cb69-140"><a href="#cb69-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-141"><a href="#cb69-141" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$trobs = matrix(fit_gq$draws(format = "matrix", variable = "y_hat_sim"),nAnalytes,nObs)</span></span>
<span id="cb69-142"><a href="#cb69-142" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$logPobs = fit_gq$draws(format = "matrix", variable = "logPobs")[1:nAnalytes]</span></span>
<span id="cb69-143"><a href="#cb69-143" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$N1A2B3 = fit_gq$draws(format = "matrix", variable = "N1A2B3")[1:nAnalytes]</span></span>
<span id="cb69-144"><a href="#cb69-144" aria-hidden="true" tabindex="-1"></a><span class="in">param = matrix(fit_gq$draws(format = "matrix", variable = "paramsim"),nAnalytes,3)</span></span>
<span id="cb69-145"><a href="#cb69-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-146"><a href="#cb69-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-147"><a href="#cb69-147" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma[[i]]=datastruct_prior_ma[[i]];</span></span>
<span id="cb69-148"><a href="#cb69-148" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma[[i]]$include_prior = 0.01;</span></span>
<span id="cb69-149"><a href="#cb69-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-150"><a href="#cb69-150" aria-hidden="true" tabindex="-1"></a><span class="in">inits[[i]]=param</span></span>
<span id="cb69-151"><a href="#cb69-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-152"><a href="#cb69-152" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = cseed+1</span></span>
<span id="cb69-153"><a href="#cb69-153" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb69-154"><a href="#cb69-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-155"><a href="#cb69-155" aria-hidden="true" tabindex="-1"></a><span class="in">mean_log_det_stan = function(data, init, chosen_indices, S){</span></span>
<span id="cb69-156"><a href="#cb69-156" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb69-157"><a href="#cb69-157" aria-hidden="true" tabindex="-1"></a><span class="in">init_ma = function(){list(param=init)}</span></span>
<span id="cb69-158"><a href="#cb69-158" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb69-159"><a href="#cb69-159" aria-hidden="true" tabindex="-1"></a><span class="in">data$selected = chosen_indices;</span></span>
<span id="cb69-160"><a href="#cb69-160" aria-hidden="true" tabindex="-1"></a><span class="in">data$nSel = length(chosen_indices);</span></span>
<span id="cb69-161"><a href="#cb69-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-162"><a href="#cb69-162" aria-hidden="true" tabindex="-1"></a><span class="in"> fit_opt  = mod_analytes$optimize(</span></span>
<span id="cb69-163"><a href="#cb69-163" aria-hidden="true" tabindex="-1"></a><span class="in">   data = data,</span></span>
<span id="cb69-164"><a href="#cb69-164" aria-hidden="true" tabindex="-1"></a><span class="in">   output_dir = here::here("stanfiles"),</span></span>
<span id="cb69-165"><a href="#cb69-165" aria-hidden="true" tabindex="-1"></a><span class="in">   output_basename = S,</span></span>
<span id="cb69-166"><a href="#cb69-166" aria-hidden="true" tabindex="-1"></a><span class="in">   seed = cseed,</span></span>
<span id="cb69-167"><a href="#cb69-167" aria-hidden="true" tabindex="-1"></a><span class="in">   init = init_ma,</span></span>
<span id="cb69-168"><a href="#cb69-168" aria-hidden="true" tabindex="-1"></a><span class="in">   jacobian = TRUE,</span></span>
<span id="cb69-169"><a href="#cb69-169" aria-hidden="true" tabindex="-1"></a><span class="in">   show_messages = F)</span></span>
<span id="cb69-170"><a href="#cb69-170" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb69-171"><a href="#cb69-171" aria-hidden="true" tabindex="-1"></a><span class="in"> mode=fit_opt$unconstrain_variables(list(param = fit_opt$mle("param")))</span></span>
<span id="cb69-172"><a href="#cb69-172" aria-hidden="true" tabindex="-1"></a><span class="in"> hessian = fit_opt$hessian(unconstrained_variables = mode)$hessian</span></span>
<span id="cb69-173"><a href="#cb69-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-174"><a href="#cb69-174" aria-hidden="true" tabindex="-1"></a><span class="in">logdet = unlist(purrr::map(1:data$nAnalytes,\(i) log(det(-hessian[((i-1)*3+1):((i-1)*3+3),((i-1)*3+1):((i-1)*3+3)]))))</span></span>
<span id="cb69-175"><a href="#cb69-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-176"><a href="#cb69-176" aria-hidden="true" tabindex="-1"></a><span class="in">return(logdet)</span></span>
<span id="cb69-177"><a href="#cb69-177" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb69-178"><a href="#cb69-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-179"><a href="#cb69-179" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(65,66,209,210)</span></span>
<span id="cb69-180"><a href="#cb69-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-181"><a href="#cb69-181" aria-hidden="true" tabindex="-1"></a><span class="in"># quick test:</span></span>
<span id="cb69-182"><a href="#cb69-182" aria-hidden="true" tabindex="-1"></a><span class="in">z_prior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan(datastruct_prior_ma[[i]], inits[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb69-183"><a href="#cb69-183" aria-hidden="true" tabindex="-1"></a><span class="in">z_noprior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan(datastruct_noprior_ma[[i]], inits[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb69-184"><a href="#cb69-184" aria-hidden="true" tabindex="-1"></a><span class="in">test = c(mean(unlist(z_prior)),mean(unlist(z_noprior)))</span></span>
<span id="cb69-185"><a href="#cb69-185" aria-hidden="true" tabindex="-1"></a><span class="in">test</span></span>
<span id="cb69-186"><a href="#cb69-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-187"><a href="#cb69-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-188"><a href="#cb69-188" aria-hidden="true" tabindex="-1"></a><span class="in">logP = unlist(purrr::map(1:length(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]$logPobs))</span></span>
<span id="cb69-189"><a href="#cb69-189" aria-hidden="true" tabindex="-1"></a><span class="in">NAB = unlist(purrr::map(1:length(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]$N1A2B3))</span></span>
<span id="cb69-190"><a href="#cb69-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-191"><a href="#cb69-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-192"><a href="#cb69-192" aria-hidden="true" tabindex="-1"></a><span class="fu">## Optimization</span></span>
<span id="cb69-193"><a href="#cb69-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-optimization, eval=F}</span></span>
<span id="cb69-194"><a href="#cb69-194" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(213,214) # initial values</span></span>
<span id="cb69-195"><a href="#cb69-195" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-196"><a href="#cb69-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-197"><a href="#cb69-197" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(214,209,215) # initial values</span></span>
<span id="cb69-198"><a href="#cb69-198" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-199"><a href="#cb69-199" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(214,211,63) # initial values</span></span>
<span id="cb69-200"><a href="#cb69-200" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-201"><a href="#cb69-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-202"><a href="#cb69-202" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(209,210,215,79) # initial values</span></span>
<span id="cb69-203"><a href="#cb69-203" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-204"><a href="#cb69-204" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(209,210,215,71) # initial values</span></span>
<span id="cb69-205"><a href="#cb69-205" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-206"><a href="#cb69-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-207"><a href="#cb69-207" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(210,209,212,215,79) # initial values</span></span>
<span id="cb69-208"><a href="#cb69-208" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-209"><a href="#cb69-209" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(210,209,212,215,71) # initial values</span></span>
<span id="cb69-210"><a href="#cb69-210" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-211"><a href="#cb69-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-212"><a href="#cb69-212" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(65,66,209,210) # ref</span></span>
<span id="cb69-213"><a href="#cb69-213" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior= c(65,66,209,210) # ref</span></span>
<span id="cb69-214"><a href="#cb69-214" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb69-215"><a href="#cb69-215" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb69-216"><a href="#cb69-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-217"><a href="#cb69-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-218"><a href="#cb69-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-219"><a href="#cb69-219" aria-hidden="true" tabindex="-1"></a><span class="fu">### Read the results and compare</span></span>
<span id="cb69-220"><a href="#cb69-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-logDet-read, eval=T}</span></span>
<span id="cb69-221"><a href="#cb69-221" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(65,66,209,210) # ref</span></span>
<span id="cb69-222"><a href="#cb69-222" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior= c(65,66,209,210) # ref</span></span>
<span id="cb69-223"><a href="#cb69-223" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb69-224"><a href="#cb69-224" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb69-225"><a href="#cb69-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-226"><a href="#cb69-226" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(213,214) # p=2</span></span>
<span id="cb69-227"><a href="#cb69-227" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb69-228"><a href="#cb69-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-229"><a href="#cb69-229" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(214,209,215) # p=3</span></span>
<span id="cb69-230"><a href="#cb69-230" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(214,211,63) # p=3</span></span>
<span id="cb69-231"><a href="#cb69-231" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb69-232"><a href="#cb69-232" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb69-233"><a href="#cb69-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-234"><a href="#cb69-234" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(209,212,215,216) # p=4</span></span>
<span id="cb69-235"><a href="#cb69-235" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(209,214,215,63) # p=4</span></span>
<span id="cb69-236"><a href="#cb69-236" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb69-237"><a href="#cb69-237" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb69-238"><a href="#cb69-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-239"><a href="#cb69-239" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(207,209,212,215,216) # p=5</span></span>
<span id="cb69-240"><a href="#cb69-240" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(216,209,212,215,63) # p=5</span></span>
<span id="cb69-241"><a href="#cb69-241" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb69-242"><a href="#cb69-242" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb69-243"><a href="#cb69-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-244"><a href="#cb69-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-245"><a href="#cb69-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-logDet-summary}</span></span>
<span id="cb69-246"><a href="#cb69-246" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results = tibble( logP = logP,</span></span>
<span id="cb69-247"><a href="#cb69-247" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb69-248"><a href="#cb69-248" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb69-249"><a href="#cb69-249" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb69-250"><a href="#cb69-250" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_2 = fws_prior_2$log_det_FIM,</span></span>
<span id="cb69-251"><a href="#cb69-251" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb69-252"><a href="#cb69-252" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb69-253"><a href="#cb69-253" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb69-254"><a href="#cb69-254" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb69-255"><a href="#cb69-255" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb69-256"><a href="#cb69-256" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb69-257"><a href="#cb69-257" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(prior_ref:noprior_5, names_to = "method")</span></span>
<span id="cb69-258"><a href="#cb69-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-259"><a href="#cb69-259" aria-hidden="true" tabindex="-1"></a><span class="in">p1&lt;-ggplot(summary_results, aes(y=method,x=value))+</span></span>
<span id="cb69-260"><a href="#cb69-260" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-261"><a href="#cb69-261" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=value, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-262"><a href="#cb69-262" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-263"><a href="#cb69-263" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="log(|FIM|)", y = "Method")</span></span>
<span id="cb69-264"><a href="#cb69-264" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb69-265"><a href="#cb69-265" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diff = tibble(logP = logP,</span></span>
<span id="cb69-266"><a href="#cb69-266" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb69-267"><a href="#cb69-267" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb69-268"><a href="#cb69-268" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb69-269"><a href="#cb69-269" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_2 = fws_prior_2$log_det_FIM,</span></span>
<span id="cb69-270"><a href="#cb69-270" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb69-271"><a href="#cb69-271" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb69-272"><a href="#cb69-272" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb69-273"><a href="#cb69-273" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb69-274"><a href="#cb69-274" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb69-275"><a href="#cb69-275" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb69-276"><a href="#cb69-276" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_prior_2 = (fws_prior_2 - fws_prior_ref)/n_param,</span></span>
<span id="cb69-277"><a href="#cb69-277" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_3 = (fws_prior_3 - fws_prior_ref)/n_param,</span></span>
<span id="cb69-278"><a href="#cb69-278" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_3 = (fws_noprior_3 - fws_noprior_ref)/n_param,</span></span>
<span id="cb69-279"><a href="#cb69-279" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_4 = (fws_prior_4 - fws_prior_ref)/n_param,</span></span>
<span id="cb69-280"><a href="#cb69-280" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_4 = (fws_noprior_4 - fws_noprior_ref)/n_param,</span></span>
<span id="cb69-281"><a href="#cb69-281" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_5 = (fws_prior_5 - fws_prior_ref)/n_param,</span></span>
<span id="cb69-282"><a href="#cb69-282" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_5 = (fws_noprior_5 - fws_noprior_ref)/n_param)%&gt;%</span></span>
<span id="cb69-283"><a href="#cb69-283" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_prior_2:d_noprior_5, names_to = "method")</span></span>
<span id="cb69-284"><a href="#cb69-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-285"><a href="#cb69-285" aria-hidden="true" tabindex="-1"></a><span class="in">p2=ggplot(summary_results_diff, aes(y=method,x=exp(value)))+</span></span>
<span id="cb69-286"><a href="#cb69-286" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-287"><a href="#cb69-287" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-288"><a href="#cb69-288" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-289"><a href="#cb69-289" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Efficiency relative to the reference design", y = "Method")+</span></span>
<span id="cb69-290"><a href="#cb69-290" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")</span></span>
<span id="cb69-291"><a href="#cb69-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-292"><a href="#cb69-292" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diffprior = tibble(logP = logP,</span></span>
<span id="cb69-293"><a href="#cb69-293" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb69-294"><a href="#cb69-294" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb69-295"><a href="#cb69-295" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb69-296"><a href="#cb69-296" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb69-297"><a href="#cb69-297" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb69-298"><a href="#cb69-298" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb69-299"><a href="#cb69-299" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb69-300"><a href="#cb69-300" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb69-301"><a href="#cb69-301" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb69-302"><a href="#cb69-302" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_ref  = (fws_prior_ref-fws_noprior_ref)/n_param,</span></span>
<span id="cb69-303"><a href="#cb69-303" aria-hidden="true" tabindex="-1"></a><span class="in">         d_3 = (fws_prior_3-fws_noprior_3)/n_param,</span></span>
<span id="cb69-304"><a href="#cb69-304" aria-hidden="true" tabindex="-1"></a><span class="in">         d_4 = (fws_prior_4-fws_noprior_4)/n_param,</span></span>
<span id="cb69-305"><a href="#cb69-305" aria-hidden="true" tabindex="-1"></a><span class="in">         d_5 = (fws_prior_5-fws_noprior_5)/n_param)%&gt;%</span></span>
<span id="cb69-306"><a href="#cb69-306" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_ref:d_5, names_to = "method")</span></span>
<span id="cb69-307"><a href="#cb69-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-308"><a href="#cb69-308" aria-hidden="true" tabindex="-1"></a><span class="in">p3=ggplot(summary_results_diffprior, aes(y=method,x=exp(value)))+</span></span>
<span id="cb69-309"><a href="#cb69-309" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-310"><a href="#cb69-310" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-311"><a href="#cb69-311" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-312"><a href="#cb69-312" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Effect of prior on design efficiency", y = "Method")+</span></span>
<span id="cb69-313"><a href="#cb69-313" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")+</span></span>
<span id="cb69-314"><a href="#cb69-314" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0.5,100),</span></span>
<span id="cb69-315"><a href="#cb69-315" aria-hidden="true" tabindex="-1"></a><span class="in">                     trans='log10',</span></span>
<span id="cb69-316"><a href="#cb69-316" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.01, 100)),</span></span>
<span id="cb69-317"><a href="#cb69-317" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb69-318"><a href="#cb69-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-319"><a href="#cb69-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-320"><a href="#cb69-320" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb69-321"><a href="#cb69-321" aria-hidden="true" tabindex="-1"></a><span class="in">p2</span></span>
<span id="cb69-322"><a href="#cb69-322" aria-hidden="true" tabindex="-1"></a><span class="in">p3</span></span>
<span id="cb69-323"><a href="#cb69-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-324"><a href="#cb69-324" aria-hidden="true" tabindex="-1"></a><span class="in">f2_1 = p2</span></span>
<span id="cb69-325"><a href="#cb69-325" aria-hidden="true" tabindex="-1"></a><span class="in">f3_1 = p3</span></span>
<span id="cb69-326"><a href="#cb69-326" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p1, .filename=paste("single-form-analytes-logdFIM-abs.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-327"><a href="#cb69-327" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p1, .filename=paste("single-form-analytes-logdFIM-abs.png"), .path = figures_dir1)</span></span>
<span id="cb69-328"><a href="#cb69-328" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p2, .filename=paste("single-form-analytes-logdFIM-rel.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-329"><a href="#cb69-329" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p2, .filename=paste("single-form-analytes-logdFIM-rel.png"), .path = figures_dir1)</span></span>
<span id="cb69-330"><a href="#cb69-330" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p3, .filename=paste("single-form-analytes-logdFIM-prioreff.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-331"><a href="#cb69-331" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p3, .filename=paste("single-form-analytes-logdFIM-prioreff.png"), .path = figures_dir1)</span></span>
<span id="cb69-332"><a href="#cb69-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-333"><a href="#cb69-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-334"><a href="#cb69-334" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Table Summary</span></span>
<span id="cb69-335"><a href="#cb69-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r table-single}</span></span>
<span id="cb69-336"><a href="#cb69-336" aria-hidden="true" tabindex="-1"></a><span class="in">tab1=summary_results_diff %&gt;% </span></span>
<span id="cb69-337"><a href="#cb69-337" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(value = exp(value)) %&gt;%</span></span>
<span id="cb69-338"><a href="#cb69-338" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;% </span></span>
<span id="cb69-339"><a href="#cb69-339" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(ptc_value = quantile(value, c(0.05, 0.5, 0.95)), q = c(0.05, 0.5, 0.95),</span></span>
<span id="cb69-340"><a href="#cb69-340" aria-hidden="true" tabindex="-1"></a><span class="in">            mean_value = mean(value),</span></span>
<span id="cb69-341"><a href="#cb69-341" aria-hidden="true" tabindex="-1"></a><span class="in">            sd_value = std(value)) %&gt;%</span></span>
<span id="cb69-342"><a href="#cb69-342" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;%</span></span>
<span id="cb69-343"><a href="#cb69-343" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(c('ptc_value', 'mean_value','sd_value'), round, 2))%&gt;%</span></span>
<span id="cb69-344"><a href="#cb69-344" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from = "q", values_from = ptc_value, names_prefix = "q")%&gt;%</span></span>
<span id="cb69-345"><a href="#cb69-345" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(`Efficiency median (5th-95th)` = paste0(q0.5, " (", q0.05, " - ", q0.95, ")"))%&gt;%</span></span>
<span id="cb69-346"><a href="#cb69-346" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(`Efficiency mean (sd)` = paste0(mean_value, " (", sd_value , ")"))%&gt;%</span></span>
<span id="cb69-347"><a href="#cb69-347" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-starts_with("q"))%&gt;%</span></span>
<span id="cb69-348"><a href="#cb69-348" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-mean_value, -sd_value)%&gt;%</span></span>
<span id="cb69-349"><a href="#cb69-349" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() %&gt;%</span></span>
<span id="cb69-350"><a href="#cb69-350" aria-hidden="true" tabindex="-1"></a><span class="in">  autofit()</span></span>
<span id="cb69-351"><a href="#cb69-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-352"><a href="#cb69-352" aria-hidden="true" tabindex="-1"></a><span class="in">tab1</span></span>
<span id="cb69-353"><a href="#cb69-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-354"><a href="#cb69-354" aria-hidden="true" tabindex="-1"></a><span class="in">tab2=summary_results_diffprior %&gt;% </span></span>
<span id="cb69-355"><a href="#cb69-355" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(value = exp(value)) %&gt;%</span></span>
<span id="cb69-356"><a href="#cb69-356" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;% </span></span>
<span id="cb69-357"><a href="#cb69-357" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(ptc_value = quantile(value, c(0.05, 0.5, 0.95)), q = c(0.05, 0.5, 0.95),</span></span>
<span id="cb69-358"><a href="#cb69-358" aria-hidden="true" tabindex="-1"></a><span class="in">            mean_value = mean(value),</span></span>
<span id="cb69-359"><a href="#cb69-359" aria-hidden="true" tabindex="-1"></a><span class="in">            sd_value = std(value)) %&gt;%</span></span>
<span id="cb69-360"><a href="#cb69-360" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;%</span></span>
<span id="cb69-361"><a href="#cb69-361" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(c('ptc_value', 'mean_value','sd_value'), round, 2))%&gt;%</span></span>
<span id="cb69-362"><a href="#cb69-362" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from = "q", values_from = ptc_value, names_prefix = "q")%&gt;%</span></span>
<span id="cb69-363"><a href="#cb69-363" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(`Efficiency median (5th-95th)` = paste0(q0.5, " (", q0.05, " - ", q0.95, ")"))%&gt;%</span></span>
<span id="cb69-364"><a href="#cb69-364" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(`Efficiency mean (sd)` = paste0(mean_value, " (", sd_value , ")"))%&gt;%</span></span>
<span id="cb69-365"><a href="#cb69-365" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-starts_with("q"))%&gt;%</span></span>
<span id="cb69-366"><a href="#cb69-366" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-mean_value, -sd_value)%&gt;%</span></span>
<span id="cb69-367"><a href="#cb69-367" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() %&gt;%</span></span>
<span id="cb69-368"><a href="#cb69-368" aria-hidden="true" tabindex="-1"></a><span class="in">  autofit()</span></span>
<span id="cb69-369"><a href="#cb69-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-370"><a href="#cb69-370" aria-hidden="true" tabindex="-1"></a><span class="in">tab2</span></span>
<span id="cb69-371"><a href="#cb69-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-372"><a href="#cb69-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-373"><a href="#cb69-373" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table</span></span>
<span id="cb69-374"><a href="#cb69-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-table}</span></span>
<span id="cb69-375"><a href="#cb69-375" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma=hplcparam_candidates_df%&gt;%filter(xpH==0)%&gt;%</span></span>
<span id="cb69-376"><a href="#cb69-376" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(line=1:n())</span></span>
<span id="cb69-377"><a href="#cb69-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-378"><a href="#cb69-378" aria-hidden="true" tabindex="-1"></a><span class="in">combined_results = list(</span></span>
<span id="cb69-379"><a href="#cb69-379" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ref = fws_prior_ref$chosen_indices,</span></span>
<span id="cb69-380"><a href="#cb69-380" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ref = fws_noprior_ref$chosen_indices,</span></span>
<span id="cb69-381"><a href="#cb69-381" aria-hidden="true" tabindex="-1"></a><span class="in">prior_2 = fws_prior_2$chosen_indices,</span></span>
<span id="cb69-382"><a href="#cb69-382" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_2 = 10000+fws_prior_2$chosen_indices, # dummy</span></span>
<span id="cb69-383"><a href="#cb69-383" aria-hidden="true" tabindex="-1"></a><span class="in">prior_3 = fws_prior_3$chosen_indices,</span></span>
<span id="cb69-384"><a href="#cb69-384" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_3 = fws_noprior_3$chosen_indices,</span></span>
<span id="cb69-385"><a href="#cb69-385" aria-hidden="true" tabindex="-1"></a><span class="in">prior_4 = fws_prior_4$chosen_indices,</span></span>
<span id="cb69-386"><a href="#cb69-386" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_4 = fws_noprior_4$chosen_indices,</span></span>
<span id="cb69-387"><a href="#cb69-387" aria-hidden="true" tabindex="-1"></a><span class="in">prior_5 = fws_prior_5$chosen_indices,</span></span>
<span id="cb69-388"><a href="#cb69-388" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_5 = fws_noprior_5$chosen_indices)</span></span>
<span id="cb69-389"><a href="#cb69-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-390"><a href="#cb69-390" aria-hidden="true" tabindex="-1"></a><span class="in">selected_exp = enframe(combined_results)%&gt;%</span></span>
<span id="cb69-391"><a href="#cb69-391" aria-hidden="true" tabindex="-1"></a><span class="in">   unnest(value) %&gt;%</span></span>
<span id="cb69-392"><a href="#cb69-392" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(line=value, Name = name) %&gt;%</span></span>
<span id="cb69-393"><a href="#cb69-393" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(data_ma, by = "line")%&gt;%</span></span>
<span id="cb69-394"><a href="#cb69-394" aria-hidden="true" tabindex="-1"></a><span class="in">   arrange(Name,tg, fio)%&gt;%</span></span>
<span id="cb69-395"><a href="#cb69-395" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Modifier = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb69-396"><a href="#cb69-396" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-c(line,xpH,m,td,to,te,fif)) %&gt;%</span></span>
<span id="cb69-397"><a href="#cb69-397" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(type = if_else(str_detect(Name, 'noprior'), "No prior", "Prior"))%&gt;%</span></span>
<span id="cb69-398"><a href="#cb69-398" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(where(is.numeric), ~replace_na(., -1)))</span></span>
<span id="cb69-399"><a href="#cb69-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-400"><a href="#cb69-400" aria-hidden="true" tabindex="-1"></a><span class="in">tab1&lt;-selected_exp %&gt;%</span></span>
<span id="cb69-401"><a href="#cb69-401" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "Prior") %&gt;%</span></span>
<span id="cb69-402"><a href="#cb69-402" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-type)%&gt;%</span></span>
<span id="cb69-403"><a href="#cb69-403" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb69-404"><a href="#cb69-404" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb69-405"><a href="#cb69-405" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb69-406"><a href="#cb69-406" aria-hidden="true" tabindex="-1"></a><span class="in">tab2&lt;-selected_exp %&gt;%</span></span>
<span id="cb69-407"><a href="#cb69-407" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "No prior")%&gt;%</span></span>
<span id="cb69-408"><a href="#cb69-408" aria-hidden="true" tabindex="-1"></a><span class="in">    select(-type)%&gt;%</span></span>
<span id="cb69-409"><a href="#cb69-409" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb69-410"><a href="#cb69-410" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb69-411"><a href="#cb69-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-412"><a href="#cb69-412" aria-hidden="true" tabindex="-1"></a><span class="in">tab2 &lt;- set_formatter(</span></span>
<span id="cb69-413"><a href="#cb69-413" aria-hidden="true" tabindex="-1"></a><span class="in">  tab2, </span></span>
<span id="cb69-414"><a href="#cb69-414" aria-hidden="true" tabindex="-1"></a><span class="in">  tg = function(x) ifelse(x==-1," ", sprintf("%.0f", x) ),</span></span>
<span id="cb69-415"><a href="#cb69-415" aria-hidden="true" tabindex="-1"></a><span class="in">  fio = function(x) ifelse(x==-1," ", sprintf("%.2f", x) )</span></span>
<span id="cb69-416"><a href="#cb69-416" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb69-417"><a href="#cb69-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-418"><a href="#cb69-418" aria-hidden="true" tabindex="-1"></a><span class="in">p1 = gen_grob(tab1, fit = "auto", just = "centre")</span></span>
<span id="cb69-419"><a href="#cb69-419" aria-hidden="true" tabindex="-1"></a><span class="in">p2 = gen_grob(tab2, fit = "auto", just = "centre") </span></span>
<span id="cb69-420"><a href="#cb69-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-421"><a href="#cb69-421" aria-hidden="true" tabindex="-1"></a><span class="in">gg&lt;-ggplot()+</span></span>
<span id="cb69-422"><a href="#cb69-422" aria-hidden="true" tabindex="-1"></a><span class="in">       theme(</span></span>
<span id="cb69-423"><a href="#cb69-423" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.background = element_rect(fill='transparent'),</span></span>
<span id="cb69-424"><a href="#cb69-424" aria-hidden="true" tabindex="-1"></a><span class="in">         plot.background = element_rect(fill='transparent', color=NA),</span></span>
<span id="cb69-425"><a href="#cb69-425" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.major = element_blank(),</span></span>
<span id="cb69-426"><a href="#cb69-426" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.minor = element_blank(),</span></span>
<span id="cb69-427"><a href="#cb69-427" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.background = element_rect(fill='transparent'),</span></span>
<span id="cb69-428"><a href="#cb69-428" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.box.background = element_rect(fill='transparent')</span></span>
<span id="cb69-429"><a href="#cb69-429" aria-hidden="true" tabindex="-1"></a><span class="in">       )</span></span>
<span id="cb69-430"><a href="#cb69-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-431"><a href="#cb69-431" aria-hidden="true" tabindex="-1"></a><span class="in">plot1 &lt;- gg+p1+p2+ plot_layout(ncol = 3, widths = c(1, 20,20))</span></span>
<span id="cb69-432"><a href="#cb69-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-433"><a href="#cb69-433" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plot1, .filename=paste("single-form-analytes-table.pdf"), .path = tables_dir1)</span></span>
<span id="cb69-434"><a href="#cb69-434" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plot1, .filename=paste("single-form-analytes-table.png"), .path = tables_dir1)</span></span>
<span id="cb69-435"><a href="#cb69-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-436"><a href="#cb69-436" aria-hidden="true" tabindex="-1"></a><span class="in">tab1</span></span>
<span id="cb69-437"><a href="#cb69-437" aria-hidden="true" tabindex="-1"></a><span class="in">tab2</span></span>
<span id="cb69-438"><a href="#cb69-438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-439"><a href="#cb69-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-440"><a href="#cb69-440" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stan simulations</span></span>
<span id="cb69-441"><a href="#cb69-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-laplace, eval=T}</span></span>
<span id="cb69-442"><a href="#cb69-442" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_ref$chosen_indices # ref</span></span>
<span id="cb69-443"><a href="#cb69-443" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_ref = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-444"><a href="#cb69-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-445"><a href="#cb69-445" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_ref$chosen_indices # ref</span></span>
<span id="cb69-446"><a href="#cb69-446" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_ref = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-447"><a href="#cb69-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-448"><a href="#cb69-448" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_2$chosen_indices # p=2</span></span>
<span id="cb69-449"><a href="#cb69-449" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_2 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-450"><a href="#cb69-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-451"><a href="#cb69-451" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_3$chosen_indices # p=3</span></span>
<span id="cb69-452"><a href="#cb69-452" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_3 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-453"><a href="#cb69-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-454"><a href="#cb69-454" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_3$chosen_indices # p=3</span></span>
<span id="cb69-455"><a href="#cb69-455" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_3 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-456"><a href="#cb69-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-457"><a href="#cb69-457" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_4$chosen_indices # p=4</span></span>
<span id="cb69-458"><a href="#cb69-458" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_4 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-459"><a href="#cb69-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-460"><a href="#cb69-460" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_4$chosen_indices # p=4</span></span>
<span id="cb69-461"><a href="#cb69-461" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_4 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-462"><a href="#cb69-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-463"><a href="#cb69-463" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_5$chosen_indices # p=5</span></span>
<span id="cb69-464"><a href="#cb69-464" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_5 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-465"><a href="#cb69-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-466"><a href="#cb69-466" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_5$chosen_indices # p=5</span></span>
<span id="cb69-467"><a href="#cb69-467" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_5 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-468"><a href="#cb69-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-469"><a href="#cb69-469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-470"><a href="#cb69-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-471"><a href="#cb69-471" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gradient conditions</span></span>
<span id="cb69-472"><a href="#cb69-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-gra-summary}</span></span>
<span id="cb69-473"><a href="#cb69-473" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_5$chosen_indices # p=5</span></span>
<span id="cb69-474"><a href="#cb69-474" aria-hidden="true" tabindex="-1"></a><span class="in">p31=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb69-475"><a href="#cb69-475" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0)%&gt;%</span></span>
<span id="cb69-476"><a href="#cb69-476" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb69-477"><a href="#cb69-477" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(prior_ma_5$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb69-478"><a href="#cb69-478" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb69-479"><a href="#cb69-479" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb69-480"><a href="#cb69-480" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb69-481"><a href="#cb69-481" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb69-482"><a href="#cb69-482" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb69-483"><a href="#cb69-483" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb69-484"><a href="#cb69-484" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_5$chosen_indices # p=5</span></span>
<span id="cb69-485"><a href="#cb69-485" aria-hidden="true" tabindex="-1"></a><span class="in">p32=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb69-486"><a href="#cb69-486" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0)%&gt;%</span></span>
<span id="cb69-487"><a href="#cb69-487" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb69-488"><a href="#cb69-488" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(noprior_ma_5$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb69-489"><a href="#cb69-489" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb69-490"><a href="#cb69-490" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb69-491"><a href="#cb69-491" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb69-492"><a href="#cb69-492" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb69-493"><a href="#cb69-493" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb69-494"><a href="#cb69-494" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb69-495"><a href="#cb69-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-496"><a href="#cb69-496" aria-hidden="true" tabindex="-1"></a><span class="in">iresults = rbind(prior_ma_ref$iresults%&gt;%</span></span>
<span id="cb69-497"><a href="#cb69-497" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb69-498"><a href="#cb69-498" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ref$iresults%&gt;%</span></span>
<span id="cb69-499"><a href="#cb69-499" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb69-500"><a href="#cb69-500" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_2$iresults%&gt;%</span></span>
<span id="cb69-501"><a href="#cb69-501" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb69-502"><a href="#cb69-502" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_3$iresults%&gt;%</span></span>
<span id="cb69-503"><a href="#cb69-503" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb69-504"><a href="#cb69-504" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_3$iresults%&gt;%</span></span>
<span id="cb69-505"><a href="#cb69-505" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb69-506"><a href="#cb69-506" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_4$iresults%&gt;%</span></span>
<span id="cb69-507"><a href="#cb69-507" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb69-508"><a href="#cb69-508" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_4$iresults%&gt;%</span></span>
<span id="cb69-509"><a href="#cb69-509" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4"),</span></span>
<span id="cb69-510"><a href="#cb69-510" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_5$iresults%&gt;%</span></span>
<span id="cb69-511"><a href="#cb69-511" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_5"),</span></span>
<span id="cb69-512"><a href="#cb69-512" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_5$iresults%&gt;%</span></span>
<span id="cb69-513"><a href="#cb69-513" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_5"))%&gt;%</span></span>
<span id="cb69-514"><a href="#cb69-514" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(ivar = if_else(ivar&gt;1e6,1e6,ivar)) %&gt;%</span></span>
<span id="cb69-515"><a href="#cb69-515" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.factor(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB))</span></span>
<span id="cb69-516"><a href="#cb69-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-517"><a href="#cb69-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-518"><a href="#cb69-518" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=iresults %&gt;%</span></span>
<span id="cb69-519"><a href="#cb69-519" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb69-520"><a href="#cb69-520" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-521"><a href="#cb69-521" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-522"><a href="#cb69-522" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-523"><a href="#cb69-523" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb69-524"><a href="#cb69-524" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb69-525"><a href="#cb69-525" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(0.1,100))+   </span></span>
<span id="cb69-526"><a href="#cb69-526" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb69-527"><a href="#cb69-527" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb69-528"><a href="#cb69-528" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb69-529"><a href="#cb69-529" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=iresults %&gt;%</span></span>
<span id="cb69-530"><a href="#cb69-530" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb69-531"><a href="#cb69-531" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-532"><a href="#cb69-532" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-533"><a href="#cb69-533" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-534"><a href="#cb69-534" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb69-535"><a href="#cb69-535" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb69-536"><a href="#cb69-536" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,1000000))+    </span></span>
<span id="cb69-537"><a href="#cb69-537" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb69-538"><a href="#cb69-538" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb69-539"><a href="#cb69-539" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb69-540"><a href="#cb69-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-541"><a href="#cb69-541" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb69-542"><a href="#cb69-542" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb69-543"><a href="#cb69-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-544"><a href="#cb69-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-545"><a href="#cb69-545" aria-hidden="true" tabindex="-1"></a><span class="in">idx_exemple_analytes = iresults %&gt;%</span></span>
<span id="cb69-546"><a href="#cb69-546" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(method=="prior_ref") %&gt;%</span></span>
<span id="cb69-547"><a href="#cb69-547" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(ivar)%&gt;%</span></span>
<span id="cb69-548"><a href="#cb69-548" aria-hidden="true" tabindex="-1"></a><span class="in">  slice(which(row_number() %% 100 == 1)) %&gt;%</span></span>
<span id="cb69-549"><a href="#cb69-549" aria-hidden="true" tabindex="-1"></a><span class="in">  select(i)%&gt;%pull()</span></span>
<span id="cb69-550"><a href="#cb69-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-551"><a href="#cb69-551" aria-hidden="true" tabindex="-1"></a><span class="in">iresults %&gt;%</span></span>
<span id="cb69-552"><a href="#cb69-552" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb69-553"><a href="#cb69-553" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb69-554"><a href="#cb69-554" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb69-555"><a href="#cb69-555" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb69-556"><a href="#cb69-556" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb69-557"><a href="#cb69-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-558"><a href="#cb69-558" aria-hidden="true" tabindex="-1"></a><span class="in">f55_1=iresults %&gt;%</span></span>
<span id="cb69-559"><a href="#cb69-559" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb69-560"><a href="#cb69-560" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb69-561"><a href="#cb69-561" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb69-562"><a href="#cb69-562" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb69-563"><a href="#cb69-563" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(`&lt;=1x`:`&lt;=3x`, names_to = "target") %&gt;%</span></span>
<span id="cb69-564"><a href="#cb69-564" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=value,color=as.factor(target)))+</span></span>
<span id="cb69-565"><a href="#cb69-565" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point()+</span></span>
<span id="cb69-566"><a href="#cb69-566" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Probability", y = "Method", color = "target")+</span></span>
<span id="cb69-567"><a href="#cb69-567" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 0.9, linetype="dotted")</span></span>
<span id="cb69-568"><a href="#cb69-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-569"><a href="#cb69-569" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=f55_1, .filename=paste("single-form-analytes-gra-prob.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-570"><a href="#cb69-570" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=f55_1, .filename=paste("single-form-analytes-gra-prob.png"), .path = figures_dir1)</span></span>
<span id="cb69-571"><a href="#cb69-571" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p31, .filename=paste("single-form-analytes-gra-prior-p5.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-572"><a href="#cb69-572" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p31, .filename=paste("single-form-analytes-gra-prior-p5.png"), .path = figures_dir1)</span></span>
<span id="cb69-573"><a href="#cb69-573" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p32, .filename=paste("single-form-analytes-gra-noprior-p5.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-574"><a href="#cb69-574" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p32, .filename=paste("single-form-analytes-gra-noprior-p5.png"), .path = figures_dir1)</span></span>
<span id="cb69-575"><a href="#cb69-575" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-gra-maxvar.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-576"><a href="#cb69-576" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-gra-maxvar.png"), .path = figures_dir1)</span></span>
<span id="cb69-577"><a href="#cb69-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-578"><a href="#cb69-578" aria-hidden="true" tabindex="-1"></a><span class="in">p31</span></span>
<span id="cb69-579"><a href="#cb69-579" aria-hidden="true" tabindex="-1"></a><span class="in">p32</span></span>
<span id="cb69-580"><a href="#cb69-580" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb69-581"><a href="#cb69-581" aria-hidden="true" tabindex="-1"></a><span class="in">f33_1=p33</span></span>
<span id="cb69-582"><a href="#cb69-582" aria-hidden="true" tabindex="-1"></a><span class="in">f55_1</span></span>
<span id="cb69-583"><a href="#cb69-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-584"><a href="#cb69-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-585"><a href="#cb69-585" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Isocratic conditions</span></span>
<span id="cb69-586"><a href="#cb69-586" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Individual plots</span></span>
<span id="cb69-587"><a href="#cb69-587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-izo-summary}</span></span>
<span id="cb69-588"><a href="#cb69-588" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb69-589"><a href="#cb69-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-590"><a href="#cb69-590" aria-hidden="true" tabindex="-1"></a><span class="in">plot_id = function(results) { </span></span>
<span id="cb69-591"><a href="#cb69-591" aria-hidden="true" tabindex="-1"></a><span class="in">  results %&gt;%</span></span>
<span id="cb69-592"><a href="#cb69-592" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=fi, y=CV/10)) +</span></span>
<span id="cb69-593"><a href="#cb69-593" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb69-594"><a href="#cb69-594" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(aes(x=fi, ymin = llog10tr, ymax = ulog10tr), alpha = 0.4, col = NA) +</span></span>
<span id="cb69-595"><a href="#cb69-595" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x=fi, y=mlog10tr), col = "black", size=0.25) +</span></span>
<span id="cb69-596"><a href="#cb69-596" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_y_continuous(</span></span>
<span id="cb69-597"><a href="#cb69-597" aria-hidden="true" tabindex="-1"></a><span class="in">    name = "log(tr)",</span></span>
<span id="cb69-598"><a href="#cb69-598" aria-hidden="true" tabindex="-1"></a><span class="in">    sec.axis = sec_axis(~.*10, name="%CV")) +</span></span>
<span id="cb69-599"><a href="#cb69-599" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0,1,by=0.2))+</span></span>
<span id="cb69-600"><a href="#cb69-600" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_grid(i~mod) +</span></span>
<span id="cb69-601"><a href="#cb69-601" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 1, linetype=2)+</span></span>
<span id="cb69-602"><a href="#cb69-602" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim=c(0,4))</span></span>
<span id="cb69-603"><a href="#cb69-603" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb69-604"><a href="#cb69-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-605"><a href="#cb69-605" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_ref&lt;-prior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb69-606"><a href="#cb69-606" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-607"><a href="#cb69-607" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-608"><a href="#cb69-608" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-609"><a href="#cb69-609" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-610"><a href="#cb69-610" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-611"><a href="#cb69-611" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-612"><a href="#cb69-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-613"><a href="#cb69-613" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_ref&lt;-noprior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb69-614"><a href="#cb69-614" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-615"><a href="#cb69-615" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-616"><a href="#cb69-616" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-617"><a href="#cb69-617" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-618"><a href="#cb69-618" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-619"><a href="#cb69-619" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-620"><a href="#cb69-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-621"><a href="#cb69-621" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_2&lt;-prior_ma_2$izoresults%&gt;%</span></span>
<span id="cb69-622"><a href="#cb69-622" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-623"><a href="#cb69-623" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-624"><a href="#cb69-624" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-625"><a href="#cb69-625" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-626"><a href="#cb69-626" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-627"><a href="#cb69-627" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-628"><a href="#cb69-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-629"><a href="#cb69-629" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_3&lt;-prior_ma_3$izoresults%&gt;%</span></span>
<span id="cb69-630"><a href="#cb69-630" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-631"><a href="#cb69-631" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-632"><a href="#cb69-632" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-633"><a href="#cb69-633" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-634"><a href="#cb69-634" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = mrgmisc::ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-635"><a href="#cb69-635" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-636"><a href="#cb69-636" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_3&lt;-noprior_ma_3$izoresults%&gt;%</span></span>
<span id="cb69-637"><a href="#cb69-637" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-638"><a href="#cb69-638" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-639"><a href="#cb69-639" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-640"><a href="#cb69-640" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-641"><a href="#cb69-641" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-642"><a href="#cb69-642" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-643"><a href="#cb69-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-644"><a href="#cb69-644" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_4&lt;-prior_ma_4$izoresults%&gt;%</span></span>
<span id="cb69-645"><a href="#cb69-645" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-646"><a href="#cb69-646" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-647"><a href="#cb69-647" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-648"><a href="#cb69-648" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-649"><a href="#cb69-649" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-650"><a href="#cb69-650" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-651"><a href="#cb69-651" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_4&lt;-noprior_ma_4$izoresults%&gt;%</span></span>
<span id="cb69-652"><a href="#cb69-652" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-653"><a href="#cb69-653" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-654"><a href="#cb69-654" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-655"><a href="#cb69-655" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-656"><a href="#cb69-656" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-657"><a href="#cb69-657" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-658"><a href="#cb69-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-659"><a href="#cb69-659" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_5&lt;-prior_ma_5$izoresults%&gt;%</span></span>
<span id="cb69-660"><a href="#cb69-660" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-661"><a href="#cb69-661" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-662"><a href="#cb69-662" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-663"><a href="#cb69-663" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-664"><a href="#cb69-664" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-665"><a href="#cb69-665" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-666"><a href="#cb69-666" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_5&lt;-noprior_ma_5$izoresults%&gt;%</span></span>
<span id="cb69-667"><a href="#cb69-667" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-668"><a href="#cb69-668" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-669"><a href="#cb69-669" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-670"><a href="#cb69-670" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-671"><a href="#cb69-671" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-672"><a href="#cb69-672" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-673"><a href="#cb69-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-674"><a href="#cb69-674" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ref = map(results_prior_ma_ref,plot_id) </span></span>
<span id="cb69-675"><a href="#cb69-675" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ref = map(results_noprior_ma_ref,plot_id) </span></span>
<span id="cb69-676"><a href="#cb69-676" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_2 = map(results_prior_ma_2,plot_id) </span></span>
<span id="cb69-677"><a href="#cb69-677" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_3 = map(results_prior_ma_3,plot_id) </span></span>
<span id="cb69-678"><a href="#cb69-678" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_3 = map(results_noprior_ma_3,plot_id) </span></span>
<span id="cb69-679"><a href="#cb69-679" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_4 = map(results_prior_ma_4,plot_id) </span></span>
<span id="cb69-680"><a href="#cb69-680" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_4 = map(results_noprior_ma_4,plot_id) </span></span>
<span id="cb69-681"><a href="#cb69-681" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_5 = map(results_prior_ma_5,plot_id) </span></span>
<span id="cb69-682"><a href="#cb69-682" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_5 = map(results_noprior_ma_5,plot_id) </span></span>
<span id="cb69-683"><a href="#cb69-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-684"><a href="#cb69-684" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_ref[[1]], .filename=paste("plots-results-prior-ma-ref.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-685"><a href="#cb69-685" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_ref[[1]], .filename=paste("plots-results-prior-ma-ref.png"), .path = figures_dir1)</span></span>
<span id="cb69-686"><a href="#cb69-686" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_5[[1]], .filename=paste("plots-results-prior-ma-5.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-687"><a href="#cb69-687" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_5[[1]], .filename=paste("plots-results-prior-ma-5.png"), .path = figures_dir1)</span></span>
<span id="cb69-688"><a href="#cb69-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-689"><a href="#cb69-689" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ref </span></span>
<span id="cb69-690"><a href="#cb69-690" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ref </span></span>
<span id="cb69-691"><a href="#cb69-691" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_2</span></span>
<span id="cb69-692"><a href="#cb69-692" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_3</span></span>
<span id="cb69-693"><a href="#cb69-693" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_3 </span></span>
<span id="cb69-694"><a href="#cb69-694" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_4 </span></span>
<span id="cb69-695"><a href="#cb69-695" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_4 </span></span>
<span id="cb69-696"><a href="#cb69-696" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_5  </span></span>
<span id="cb69-697"><a href="#cb69-697" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_5 </span></span>
<span id="cb69-698"><a href="#cb69-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-699"><a href="#cb69-699" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb69-700"><a href="#cb69-700" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb69-701"><a href="#cb69-701" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb69-702"><a href="#cb69-702" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb69-703"><a href="#cb69-703" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb69-704"><a href="#cb69-704" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span>
<span id="cb69-705"><a href="#cb69-705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-706"><a href="#cb69-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-707"><a href="#cb69-707" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Combined</span></span>
<span id="cb69-708"><a href="#cb69-708" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-izo-summary-combined}</span></span>
<span id="cb69-709"><a href="#cb69-709" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb69-710"><a href="#cb69-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-711"><a href="#cb69-711" aria-hidden="true" tabindex="-1"></a><span class="in">plot_id = function(results) { </span></span>
<span id="cb69-712"><a href="#cb69-712" aria-hidden="true" tabindex="-1"></a><span class="in">  results %&gt;%</span></span>
<span id="cb69-713"><a href="#cb69-713" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=fi, y=CV)) +</span></span>
<span id="cb69-714"><a href="#cb69-714" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb69-715"><a href="#cb69-715" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(aes(x=fi, ymin = llog10tr, ymax = ulog10tr), alpha = 0.4, col = NA) +</span></span>
<span id="cb69-716"><a href="#cb69-716" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x=fi, y=mlog10tr), col = "black", size=0.25) +</span></span>
<span id="cb69-717"><a href="#cb69-717" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_y_continuous(</span></span>
<span id="cb69-718"><a href="#cb69-718" aria-hidden="true" tabindex="-1"></a><span class="in">    name = "log(tr)",</span></span>
<span id="cb69-719"><a href="#cb69-719" aria-hidden="true" tabindex="-1"></a><span class="in">    sec.axis = sec_axis(~.*1, name="%CV")) +</span></span>
<span id="cb69-720"><a href="#cb69-720" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0,1,by=0.2))+</span></span>
<span id="cb69-721"><a href="#cb69-721" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_grid(i~mod) +</span></span>
<span id="cb69-722"><a href="#cb69-722" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 1, linetype=2)+</span></span>
<span id="cb69-723"><a href="#cb69-723" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim=c(0,4))</span></span>
<span id="cb69-724"><a href="#cb69-724" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb69-725"><a href="#cb69-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-726"><a href="#cb69-726" aria-hidden="true" tabindex="-1"></a><span class="in">izoresults = rbind( prior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb69-727"><a href="#cb69-727" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb69-728"><a href="#cb69-728" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb69-729"><a href="#cb69-729" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb69-730"><a href="#cb69-730" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_2$izoresults%&gt;%</span></span>
<span id="cb69-731"><a href="#cb69-731" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb69-732"><a href="#cb69-732" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_3$izoresults%&gt;%</span></span>
<span id="cb69-733"><a href="#cb69-733" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb69-734"><a href="#cb69-734" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_3$izoresults%&gt;%</span></span>
<span id="cb69-735"><a href="#cb69-735" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb69-736"><a href="#cb69-736" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_4$izoresults%&gt;%</span></span>
<span id="cb69-737"><a href="#cb69-737" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb69-738"><a href="#cb69-738" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_4$izoresults%&gt;%</span></span>
<span id="cb69-739"><a href="#cb69-739" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4"),</span></span>
<span id="cb69-740"><a href="#cb69-740" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_5$izoresults%&gt;%</span></span>
<span id="cb69-741"><a href="#cb69-741" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_5"),</span></span>
<span id="cb69-742"><a href="#cb69-742" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_5$izoresults%&gt;%</span></span>
<span id="cb69-743"><a href="#cb69-743" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_5")) %&gt;%</span></span>
<span id="cb69-744"><a href="#cb69-744" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&lt;=log10(100))%&gt;%</span></span>
<span id="cb69-745"><a href="#cb69-745" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&gt;=log10(5))%&gt;%</span></span>
<span id="cb69-746"><a href="#cb69-746" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c = as.numeric(c),</span></span>
<span id="cb69-747"><a href="#cb69-747" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-748"><a href="#cb69-748" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(i,method,c)%&gt;%</span></span>
<span id="cb69-749"><a href="#cb69-749" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(i,method) %&gt;%</span></span>
<span id="cb69-750"><a href="#cb69-750" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(imaxcv = max(CV), imincv = min(CV), aveCV = pracma::trapz(c, CV)/(n()-1)) %&gt;%</span></span>
<span id="cb69-751"><a href="#cb69-751" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(imaxcv = if_else(imaxcv&gt;1e4,1e4,imaxcv))%&gt;%</span></span>
<span id="cb69-752"><a href="#cb69-752" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.integer(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB)) </span></span>
<span id="cb69-753"><a href="#cb69-753" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb69-754"><a href="#cb69-754" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=izoresults %&gt;%</span></span>
<span id="cb69-755"><a href="#cb69-755" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb69-756"><a href="#cb69-756" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-757"><a href="#cb69-757" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-758"><a href="#cb69-758" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb69-759"><a href="#cb69-759" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-760"><a href="#cb69-760" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb69-761"><a href="#cb69-761" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb69-762"><a href="#cb69-762" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(1,100))+   </span></span>
<span id="cb69-763"><a href="#cb69-763" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb69-764"><a href="#cb69-764" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb69-765"><a href="#cb69-765" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb69-766"><a href="#cb69-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-767"><a href="#cb69-767" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=izoresults %&gt;%</span></span>
<span id="cb69-768"><a href="#cb69-768" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb69-769"><a href="#cb69-769" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-770"><a href="#cb69-770" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-771"><a href="#cb69-771" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb69-772"><a href="#cb69-772" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-773"><a href="#cb69-773" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb69-774"><a href="#cb69-774" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb69-775"><a href="#cb69-775" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,10000))+    </span></span>
<span id="cb69-776"><a href="#cb69-776" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb69-777"><a href="#cb69-777" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb69-778"><a href="#cb69-778" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb69-779"><a href="#cb69-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-780"><a href="#cb69-780" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb69-781"><a href="#cb69-781" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb69-782"><a href="#cb69-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-783"><a href="#cb69-783" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-izo-combined-CV.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-784"><a href="#cb69-784" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-izo-combined-CV.png"), .path = figures_dir1)</span></span>
<span id="cb69-785"><a href="#cb69-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-786"><a href="#cb69-786" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb69-787"><a href="#cb69-787" aria-hidden="true" tabindex="-1"></a><span class="in">f44_1 = p33</span></span>
<span id="cb69-788"><a href="#cb69-788" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-789"><a href="#cb69-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-790"><a href="#cb69-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-791"><a href="#cb69-791" aria-hidden="true" tabindex="-1"></a><span class="fu"># References {.unnumbered}</span></span>
<span id="cb69-792"><a href="#cb69-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-793"><a href="#cb69-793" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb69-794"><a href="#cb69-794" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb69-795"><a href="#cb69-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-796"><a href="#cb69-796" aria-hidden="true" tabindex="-1"></a><span class="fu"># Licenses {.unnumbered}</span></span>
<span id="cb69-797"><a href="#cb69-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-798"><a href="#cb69-798" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Code &amp; copy; 2024, Paweł Wiczling, licensed under BSD-3.</span>
<span id="cb69-799"><a href="#cb69-799" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Text &amp; copy; 2024, Paweł Wiczling, licensed under CC-BY-NC 4.0.</span>
<span id="cb69-800"><a href="#cb69-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-801"><a href="#cb69-801" aria-hidden="true" tabindex="-1"></a><span class="fu"># Original Computing Environment {.unnumbered}</span></span>
<span id="cb69-802"><a href="#cb69-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-803"><a href="#cb69-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sessionInfo}</span></span>
<span id="cb69-804"><a href="#cb69-804" aria-hidden="true" tabindex="-1"></a><span class="in">sessionInfo()</span></span>
<span id="cb69-805"><a href="#cb69-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Paweł Wiczling*">
<meta name="dcterms.date" content="2024-12-26">

<title>Design3: Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="optimal-design-for-mixtures-design3_files/libs/clipboard/clipboard.min.js"></script>
<script src="optimal-design-for-mixtures-design3_files/libs/quarto-html/quarto.js"></script>
<script src="optimal-design-for-mixtures-design3_files/libs/quarto-html/popper.min.js"></script>
<script src="optimal-design-for-mixtures-design3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="optimal-design-for-mixtures-design3_files/libs/quarto-html/anchor.min.js"></script>
<link href="optimal-design-for-mixtures-design3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="optimal-design-for-mixtures-design3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="optimal-design-for-mixtures-design3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="optimal-design-for-mixtures-design3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="optimal-design-for-mixtures-design3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="optimal-design-for-mixtures-design3_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="optimal-design-for-mixtures-design3_files/libs/tabwid-1.1.3/tabwid.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#priors" id="toc-priors" class="nav-link" data-scroll-target="#priors">Priors</a></li>
  <li><a href="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" id="toc-stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" class="nav-link" data-scroll-target="#stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables">Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</a>
  <ul class="collapse">
  <li><a href="#compile-stan-models" id="toc-compile-stan-models" class="nav-link" data-scroll-target="#compile-stan-models">Compile stan models</a></li>
  <li><a href="#simulate-retention-times-and-create-datasets" id="toc-simulate-retention-times-and-create-datasets" class="nav-link" data-scroll-target="#simulate-retention-times-and-create-datasets">Simulate retention times and create datasets</a></li>
  <li><a href="#optimization" id="toc-optimization" class="nav-link" data-scroll-target="#optimization">Optimization</a>
  <ul class="collapse">
  <li><a href="#read-the-results-and-compare" id="toc-read-the-results-and-compare" class="nav-link" data-scroll-target="#read-the-results-and-compare">Read the results and compare</a></li>
  <li><a href="#table" id="toc-table" class="nav-link" data-scroll-target="#table">Table</a></li>
  </ul></li>
  <li><a href="#stan-simulations" id="toc-stan-simulations" class="nav-link" data-scroll-target="#stan-simulations">Stan simulations</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#licenses" id="toc-licenses" class="nav-link" data-scroll-target="#licenses">Licenses</a></li>
  <li><a href="#original-computing-environment" id="toc-original-computing-environment" class="nav-link" data-scroll-target="#original-computing-environment">Original Computing Environment</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Design3: Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Paweł Wiczling* </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Department of Biopharmaceutics and Pharmacodynamics, Medical University of Gdańsk, Gen.&nbsp;J. Hallera 107, 80-416 Gdańsk, Poland
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 26, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setup" class="level1">
<h1>Setup</h1>
<p>The packages we will use are listed below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(numDeriv)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mrgmisc)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>select <span class="ot">=</span> dplyr<span class="sc">::</span>select</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("metrumresearchgroup/mrgmisc")</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># for parallel calculation use linux (mclaplly), i.e. Ubuntu 24.04 on Windows WSL</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># usethis::edit_r_environ(), add PROCESSX_NOTIFY_OLD_SIGCHLD = 1 ????</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#' Helper functions</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"helper_functions.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' folder shortcuts:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>figures_dir1 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"figures"</span>, <span class="st">"design3"</span>,<span class="st">"N"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>tables_dir1  <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"tables"</span>, <span class="st">"design3"</span>,<span class="st">"N"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>figures_dir5 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"figures"</span>, <span class="st">"manuscript_d3"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>tables_dir5  <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"tables"</span>, <span class="st">"manuscript_d3"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(figures_dir1)) <span class="fu">dir.create</span>(figures_dir1, <span class="at">recursive =</span> T)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(tables_dir1)) <span class="fu">dir.create</span>(tables_dir1, <span class="at">recursive =</span> T)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(figures_dir5)) <span class="fu">dir.create</span>(figures_dir5, <span class="at">recursive =</span> T)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(tables_dir5)) <span class="fu">dir.create</span>(tables_dir5, <span class="at">recursive =</span> T)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>thisScript <span class="ot">&lt;-</span> <span class="st">"optimal-design-for-mixtures-design3"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>my.ggsave <span class="ot">&lt;-</span> <span class="cf">function</span>(.plot, .filename, <span class="at">.path=</span>figures_dir, <span class="at">.height=</span> <span class="dv">7</span>, <span class="at">.width=</span> <span class="dv">6</span>) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot=</span>.plot, <span class="at">filename=</span>.filename, <span class="at">path=</span>.path, <span class="at">height=</span>.height, <span class="at">width=</span>.width)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>my.ggsave.png <span class="ot">&lt;-</span> <span class="cf">function</span>(.plot, .filename, <span class="at">.path=</span>figures_dir, <span class="at">.height=</span><span class="dv">7</span>, <span class="at">.width=</span> <span class="dv">6</span>) {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot=</span>.plot, <span class="at">filename=</span>.filename, <span class="at">path=</span>.path, <span class="at">height=</span>.height, <span class="at">width=</span>.width)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
</section>
<section id="priors" class="level1">
<h1>Priors</h1>
<p>Priors are based on the follwoing article “Comparison of Chromatographic Stationary Phases Using a Bayesian-Based Multilevel Model” by Paweł Wiczling and Agnieszka Kamedulska published in Analytical Chemistry 2024 96 (3), 1310-1319.</p>
<p>In this work a simplified approach is taken with the focus on the neutral, acidic and basic forms of an analytes and single chromatographic stationary phase - assuming the pKa and changes of pKa with organic modifier are known.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fun_generate_priors defined in helper_functions.R</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>priorsN_MeOH<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N_MeOH"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>priorsN_ACN<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N_ACN"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>priorsN<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"N"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>priorsA<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"A"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>priorsB<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"B"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>priorsNB<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"NB"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>priorsNA<span class="ot">=</span><span class="fu">fun_generate_priors</span>(<span class="st">"NA"</span>, <span class="at">logP=</span><span class="fl">2.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In this work I consider a design region that consist of linear organic modifier gradients ranging from 10 to 270 min and organic modifier content ranging from 0.05 to 0.2 for MeOH and ACN.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>hplcparam_candidates_df <span class="ot">=</span> <span class="fu">expand_grid</span>(<span class="at">tg=</span><span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">270</span>,<span class="at">by=</span><span class="dv">10</span>), </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">td=</span><span class="fl">2.1</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">to=</span><span class="fl">0.532</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">te=</span><span class="fl">0.04</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fio =</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="at">by=</span><span class="fl">0.05</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fif =</span> <span class="fl">0.8</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">m=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">xpH=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>hplcparam_candidates_df<span class="ot">&lt;-</span>hplcparam_candidates_df<span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tg=</span>tg<span class="sc">/</span><span class="dv">3</span><span class="sc">/</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="stan-multiple-analytes.-single-form-analytes.-fi-and-tg-for-meoh-and-acn-as-design-variables" class="level1">
<h1>Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</h1>
<section id="compile-stan-models" class="level2">
<h2 class="anchored" data-anchor-id="compile-stan-models">Compile stan models</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mod_analytes_gq<span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-gq.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mod_analytes_sim <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes-sim.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>mod_analytes <span class="ot">=</span> <span class="fu">cmdstan_model</span>(<span class="st">"../stan/hplc-gra-single-form-analytes.stan"</span>, <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>mod_analytes<span class="sc">$</span><span class="fu">compile</span>(<span class="at">compile_model_methods=</span><span class="cn">TRUE</span>,<span class="at">force_recompile=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulate-retention-times-and-create-datasets" class="level2">
<h2 class="anchored" data-anchor-id="simulate-retention-times-and-create-datasets">Simulate retention times and create datasets</h2>
<p>Probability of occurrence 0.4 neutral, 0.3 A, 0.3 B with logP being sampled from 2.2+-2 and constrained between 0.5 and 7.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_ma<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>nObs <span class="ot">=</span> <span class="fu">nrow</span>(data_ma);</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>nAnalytes <span class="ot">=</span><span class="dv">50</span>;</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> <span class="dv">1234</span>;</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>n_param <span class="ot">=</span> <span class="dv">3</span>;</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>n_rep <span class="ot">=</span> <span class="dv">10</span>;</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_rep) {</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]] <span class="ot">=</span> <span class="fu">list</span>(<span class="at">nObs=</span>nObs,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nAnalytes=</span>nAnalytes,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">steps =</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>data_ma<span class="sc">$</span>m,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">hplcparam=</span><span class="fu">as.matrix</span>(data_ma<span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(tg,td,to,te,fio,fif,m))),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">include_prior =</span> <span class="dv">1</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">run_estimation=</span><span class="dv">1</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nSel =</span> nObs,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="dv">1</span><span class="sc">:</span>nObs)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>fit_gq  <span class="ot">=</span> mod_analytes_gq<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> datastruct_prior_ma[[i]],</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> cseed,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">fixed_param =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">chains =</span> <span class="dv">1</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">iter_sampling=</span><span class="dv">1</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">matrix</span>(fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"y_hat_sim"</span>),nAnalytes,nObs)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>logPobs <span class="ot">=</span> fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"logPobs"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>datastruct_prior_ma[[i]]<span class="sc">$</span>N1A2B3 <span class="ot">=</span> fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"N1A2B3"</span>)[<span class="dv">1</span><span class="sc">:</span>nAnalytes]</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>param <span class="ot">=</span> <span class="fu">matrix</span>(fit_gq<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"matrix"</span>, <span class="at">variable =</span> <span class="st">"paramsim"</span>),nAnalytes,<span class="dv">3</span>)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma[[i]]<span class="ot">=</span>datastruct_prior_ma[[i]];</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>datastruct_noprior_ma[[i]]<span class="sc">$</span>include_prior <span class="ot">=</span> <span class="fl">0.01</span>;</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>inits[[i]]<span class="ot">=</span>param</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>cseed <span class="ot">=</span> cseed<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.
Running MCMC with 1 chain...

Chain 1 Iteration: 1 / 1 [100%]  (Sampling) 
Chain 1 finished in 0.0 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mean_log_det_stan <span class="ot">=</span> <span class="cf">function</span>(data, init, chosen_indices, S){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>init_ma <span class="ot">=</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">param=</span>init)}</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>selected <span class="ot">=</span> chosen_indices;</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>nSel <span class="ot">=</span> <span class="fu">length</span>(chosen_indices);</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a> fit_opt  <span class="ot">=</span> mod_analytes<span class="sc">$</span><span class="fu">optimize</span>(</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_dir =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"stanfiles"</span>),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>   <span class="at">output_basename =</span> S,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>   <span class="at">seed =</span> cseed,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>   <span class="at">init =</span> init_ma,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">jacobian =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>   <span class="at">show_messages =</span> F)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a> mode<span class="ot">=</span>fit_opt<span class="sc">$</span><span class="fu">unconstrain_variables</span>(<span class="fu">list</span>(<span class="at">param =</span> fit_opt<span class="sc">$</span><span class="fu">mle</span>(<span class="st">"param"</span>)))</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a> hessian <span class="ot">=</span> fit_opt<span class="sc">$</span><span class="fu">hessian</span>(<span class="at">unconstrained_variables =</span> mode)<span class="sc">$</span>hessian</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>logdet <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span>data<span class="sc">$</span>nAnalytes,\(i) <span class="fu">log</span>(<span class="fu">det</span>(<span class="sc">-</span>hessian[((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">3</span>),((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">3</span><span class="sc">+</span><span class="dv">3</span>)]))))</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(logdet)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co"># quick test:</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>z_prior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan</span>(datastruct_prior_ma[[i]], inits[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>z_noprior <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_rep,\(i) <span class="fu">mean_log_det_stan</span>(datastruct_noprior_ma[[i]], inits[[i]], chosen_indices, i), <span class="at">mc.cores=</span><span class="dv">10</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(<span class="fu">unlist</span>(z_prior)),<span class="fu">mean</span>(<span class="fu">unlist</span>(z_noprior)))</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.150551  8.106466</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>logP <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]<span class="sc">$</span>logPobs))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>NAB <span class="ot">=</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]<span class="sc">$</span>N1A2B3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="optimization" class="level2">
<h2 class="anchored" data-anchor-id="optimization">Optimization</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">213</span>,<span class="dv">214</span>) <span class="co"># initial values</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fws_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">214</span>,<span class="dv">209</span>,<span class="dv">215</span>) <span class="co"># initial values</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>fws_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">214</span>,<span class="dv">211</span>,<span class="dv">63</span>) <span class="co"># initial values</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>fws_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">210</span>,<span class="dv">215</span>,<span class="dv">79</span>) <span class="co"># initial values</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>fws_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">210</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># initial values</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>fws_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">210</span>,<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">79</span>) <span class="co"># initial values</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>fws_prior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">210</span>,<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">71</span>) <span class="co"># initial values</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>fws_noprior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, <span class="at">n_iter =</span> <span class="dv">100</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>) <span class="co"># ref</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>) <span class="co"># ref</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>fws_prior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>fws_noprior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="read-the-results-and-compare" class="level3">
<h3 class="anchored" data-anchor-id="read-the-results-and-compare">Read the results and compare</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>) <span class="co"># ref</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">66</span>,<span class="dv">209</span>,<span class="dv">210</span>) <span class="co"># ref</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>fws_prior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>fws_noprior_ref <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">213</span>,<span class="dv">214</span>) <span class="co"># p=2</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>fws_prior_2 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">214</span>,<span class="dv">209</span>,<span class="dv">215</span>) <span class="co"># p=3</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">214</span>,<span class="dv">211</span>,<span class="dv">63</span>) <span class="co"># p=3</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>fws_prior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>fws_noprior_3 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior   <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">216</span>) <span class="co"># p=4</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">209</span>,<span class="dv">214</span>,<span class="dv">215</span>,<span class="dv">63</span>) <span class="co"># p=4</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>fws_prior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>fws_noprior_4 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>chosen_indices_prior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">207</span>,<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">216</span>) <span class="co"># p=5</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>chosen_indices_noprior <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">216</span>,<span class="dv">209</span>,<span class="dv">212</span>,<span class="dv">215</span>,<span class="dv">63</span>) <span class="co"># p=5</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>fws_prior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>fws_noprior_5 <span class="ot">=</span> <span class="fu">fedorov_wynn_stan_par</span>(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, <span class="at">n_iter =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>summary_results <span class="ot">=</span> <span class="fu">tibble</span>( <span class="at">logP =</span> logP,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_2 =</span> fws_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(prior_ref<span class="sc">:</span>noprior_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(summary_results, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value))<span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>value, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"log(|FIM|)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-logDet-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>summary_results_diff <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_2 =</span> fws_prior_2<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_prior_2 =</span> (fws_prior_2 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_3 =</span> (fws_prior_3 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_3 =</span> (fws_noprior_3 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_4 =</span> (fws_prior_4 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_4 =</span> (fws_noprior_4 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_prior_5 =</span> (fws_prior_5 <span class="sc">-</span> fws_prior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_noprior_5 =</span> (fws_noprior_5 <span class="sc">-</span> fws_noprior_ref)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_prior_2<span class="sc">:</span>d_noprior_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diff, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Efficiency relative to the reference design"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>summary_results_diffprior <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">logP =</span> logP,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Type =</span> NAB,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_ref =</span> fws_prior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_3 =</span> fws_prior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_3 =</span> fws_noprior_3<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_4 =</span> fws_prior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_4 =</span> fws_noprior_4<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_prior_5 =</span> fws_prior_5<span class="sc">$</span>log_det_FIM,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fws_noprior_5 =</span> fws_noprior_5<span class="sc">$</span>log_det_FIM) <span class="sc">%&gt;%</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_ref  =</span> (fws_prior_ref<span class="sc">-</span>fws_noprior_ref)<span class="sc">/</span>n_param,</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_3 =</span> (fws_prior_3<span class="sc">-</span>fws_noprior_3)<span class="sc">/</span>n_param,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_4 =</span> (fws_prior_4<span class="sc">-</span>fws_noprior_4)<span class="sc">/</span>n_param,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_5 =</span> (fws_prior_5<span class="sc">-</span>fws_noprior_5)<span class="sc">/</span>n_param)<span class="sc">%&gt;%</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d_ref<span class="sc">:</span>d_5, <span class="at">names_to =</span> <span class="st">"method"</span>)</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">ggplot</span>(summary_results_diffprior, <span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span><span class="fu">exp</span>(value)))<span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span><span class="fu">exp</span>(value), <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Effect of prior on design efficiency"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">100</span>),</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">100</span>)),</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-logDet-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-logDet-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-logDet-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>f2_1 <span class="ot">=</span> p2</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>f3_1 <span class="ot">=</span> p3</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-abs.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-abs.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-rel.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p2, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-rel.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-prioreff.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p3, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-logdFIM-prioreff.png"</span>), <span class="at">.path =</span> figures_dir1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="table-summary" class="level4">
<h4 class="anchored" data-anchor-id="table-summary">Table Summary</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tab1<span class="ot">=</span>summary_results_diff <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">exp</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ptc_value =</span> <span class="fu">quantile</span>(value, <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>)), <span class="at">q =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_value =</span> <span class="fu">mean</span>(value),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_value =</span> <span class="fu">std</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">'ptc_value'</span>, <span class="st">'mean_value'</span>,<span class="st">'sd_value'</span>), round, <span class="dv">2</span>))<span class="sc">%&gt;%</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"q"</span>, <span class="at">values_from =</span> ptc_value, <span class="at">names_prefix =</span> <span class="st">"q"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Efficiency median (5th-95th)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(q0<span class="fl">.5</span>, <span class="st">" ("</span>, q0<span class="fl">.05</span>, <span class="st">" - "</span>, q0<span class="fl">.95</span>, <span class="st">")"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Efficiency mean (sd)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(mean_value, <span class="st">" ("</span>, sd_value , <span class="st">")"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"q"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>mean_value, <span class="sc">-</span>sd_value)<span class="sc">%&gt;%</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>()</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>tab1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-5133f3dc{}.cl-5127fac8{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-512c75b2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-512ca5fa{width:1.181in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512ca604{width:2.473in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512ca605{width:1.85in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512ca60e{width:1.181in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512ca60f{width:2.473in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512ca618{width:1.85in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512ca619{width:1.181in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512ca622{width:2.473in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-512ca623{width:1.85in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-5133f3dc"><thead><tr style="overflow-wrap:break-word;"><th class="cl-512ca5fa"><p class="cl-512c75b2"><span class="cl-5127fac8">method</span></p></th><th class="cl-512ca604"><p class="cl-512c75b2"><span class="cl-5127fac8">Efficiency median (5th-95th)</span></p></th><th class="cl-512ca605"><p class="cl-512c75b2"><span class="cl-5127fac8">Efficiency mean (sd)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-512ca60e"><p class="cl-512c75b2"><span class="cl-5127fac8">d_noprior_3</span></p></td><td class="cl-512ca60f"><p class="cl-512c75b2"><span class="cl-5127fac8">0.96 (0.59 - 1.29)</span></p></td><td class="cl-512ca618"><p class="cl-512c75b2"><span class="cl-5127fac8">0.97 (0.22)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-512ca60e"><p class="cl-512c75b2"><span class="cl-5127fac8">d_noprior_4</span></p></td><td class="cl-512ca60f"><p class="cl-512c75b2"><span class="cl-5127fac8">1.31 (0.91 - 2.02)</span></p></td><td class="cl-512ca618"><p class="cl-512c75b2"><span class="cl-5127fac8">1.36 (0.39)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-512ca60e"><p class="cl-512c75b2"><span class="cl-5127fac8">d_noprior_5</span></p></td><td class="cl-512ca60f"><p class="cl-512c75b2"><span class="cl-5127fac8">1.71 (1.21 - 2.72)</span></p></td><td class="cl-512ca618"><p class="cl-512c75b2"><span class="cl-5127fac8">1.8 (0.51)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-512ca60e"><p class="cl-512c75b2"><span class="cl-5127fac8">d_prior_2</span></p></td><td class="cl-512ca60f"><p class="cl-512c75b2"><span class="cl-5127fac8">0.96 (0.5 - 1.04)</span></p></td><td class="cl-512ca618"><p class="cl-512c75b2"><span class="cl-5127fac8">0.89 (0.17)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-512ca60e"><p class="cl-512c75b2"><span class="cl-5127fac8">d_prior_3</span></p></td><td class="cl-512ca60f"><p class="cl-512c75b2"><span class="cl-5127fac8">1.21 (0.75 - 1.33)</span></p></td><td class="cl-512ca618"><p class="cl-512c75b2"><span class="cl-5127fac8">1.15 (0.18)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-512ca60e"><p class="cl-512c75b2"><span class="cl-5127fac8">d_prior_4</span></p></td><td class="cl-512ca60f"><p class="cl-512c75b2"><span class="cl-5127fac8">1.51 (0.86 - 1.64)</span></p></td><td class="cl-512ca618"><p class="cl-512c75b2"><span class="cl-5127fac8">1.43 (0.23)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-512ca619"><p class="cl-512c75b2"><span class="cl-5127fac8">d_prior_5</span></p></td><td class="cl-512ca622"><p class="cl-512c75b2"><span class="cl-5127fac8">1.75 (0.92 - 1.9)</span></p></td><td class="cl-512ca623"><p class="cl-512c75b2"><span class="cl-5127fac8">1.65 (0.3)</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tab2<span class="ot">=</span>summary_results_diffprior <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">exp</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ptc_value =</span> <span class="fu">quantile</span>(value, <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>)), <span class="at">q =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_value =</span> <span class="fu">mean</span>(value),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_value =</span> <span class="fu">std</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">'ptc_value'</span>, <span class="st">'mean_value'</span>,<span class="st">'sd_value'</span>), round, <span class="dv">2</span>))<span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"q"</span>, <span class="at">values_from =</span> ptc_value, <span class="at">names_prefix =</span> <span class="st">"q"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Efficiency median (5th-95th)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(q0<span class="fl">.5</span>, <span class="st">" ("</span>, q0<span class="fl">.05</span>, <span class="st">" - "</span>, q0<span class="fl">.95</span>, <span class="st">")"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Efficiency mean (sd)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(mean_value, <span class="st">" ("</span>, sd_value , <span class="st">")"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"q"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>mean_value, <span class="sc">-</span>sd_value)<span class="sc">%&gt;%</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>()</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-516065e8{}.cl-51560d3c{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-515ac7b4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-515af4b4{width:0.875in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515af4c8{width:2.473in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515af4c9{width:1.85in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515af4d2{width:0.875in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515af4d3{width:2.473in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515af554{width:1.85in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515af55e{width:0.875in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515af55f{width:2.473in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-515af568{width:1.85in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-516065e8"><thead><tr style="overflow-wrap:break-word;"><th class="cl-515af4b4"><p class="cl-515ac7b4"><span class="cl-51560d3c">method</span></p></th><th class="cl-515af4c8"><p class="cl-515ac7b4"><span class="cl-51560d3c">Efficiency median (5th-95th)</span></p></th><th class="cl-515af4c9"><p class="cl-515ac7b4"><span class="cl-51560d3c">Efficiency mean (sd)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-515af4d2"><p class="cl-515ac7b4"><span class="cl-51560d3c">d_3</span></p></td><td class="cl-515af4d3"><p class="cl-515ac7b4"><span class="cl-51560d3c">2.27 (1.06 - 6.02)</span></p></td><td class="cl-515af554"><p class="cl-515ac7b4"><span class="cl-51560d3c">3.61 (7.97)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515af4d2"><p class="cl-515ac7b4"><span class="cl-51560d3c">d_4</span></p></td><td class="cl-515af4d3"><p class="cl-515ac7b4"><span class="cl-51560d3c">2.06 (0.98 - 4.52)</span></p></td><td class="cl-515af554"><p class="cl-515ac7b4"><span class="cl-51560d3c">2.93 (6.03)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515af4d2"><p class="cl-515ac7b4"><span class="cl-51560d3c">d_5</span></p></td><td class="cl-515af4d3"><p class="cl-515ac7b4"><span class="cl-51560d3c">1.75 (0.89 - 3.46)</span></p></td><td class="cl-515af554"><p class="cl-515ac7b4"><span class="cl-51560d3c">2.59 (5.98)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-515af55e"><p class="cl-515ac7b4"><span class="cl-51560d3c">d_ref</span></p></td><td class="cl-515af55f"><p class="cl-515ac7b4"><span class="cl-51560d3c">1.84 (1 - 5.22)</span></p></td><td class="cl-515af568"><p class="cl-515ac7b4"><span class="cl-51560d3c">2.74 (5.49)</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
</section>
<section id="table" class="level3">
<h3 class="anchored" data-anchor-id="table">Table</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data_ma<span class="ot">=</span>hplcparam_candidates_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">line=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>combined_results <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="at">prior_ref =</span> fws_prior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_ref =</span> fws_noprior_ref<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="at">prior_2 =</span> fws_prior_2<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_2 =</span> <span class="dv">10000</span><span class="sc">+</span>fws_prior_2<span class="sc">$</span>chosen_indices, <span class="co"># dummy</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="at">prior_3 =</span> fws_prior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_3 =</span> fws_noprior_3<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="at">prior_4 =</span> fws_prior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_4 =</span> fws_noprior_4<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="at">prior_5 =</span> fws_prior_5<span class="sc">$</span>chosen_indices,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="at">noprior_5 =</span> fws_noprior_5<span class="sc">$</span>chosen_indices)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>selected_exp <span class="ot">=</span> <span class="fu">enframe</span>(combined_results)<span class="sc">%&gt;%</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unnest</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">line=</span>value, <span class="at">Name =</span> name) <span class="sc">%&gt;%</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_ma, <span class="at">by =</span> <span class="st">"line"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">arrange</span>(Name,tg, fio)<span class="sc">%&gt;%</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(line,xpH,m,td,to,te,fif)) <span class="sc">%&gt;%</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(Name, <span class="st">'noprior'</span>), <span class="st">"No prior"</span>, <span class="st">"Prior"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>tab1<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Prior"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>tab2<span class="ot">&lt;-</span>selected_exp <span class="sc">%&gt;%</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"No prior"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>type)<span class="sc">%&gt;%</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_grouped_data</span>(<span class="at">groups =</span> <span class="st">"Name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">set_formatter</span>(</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  tab2, </span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">tg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%.0f"</span>, x) ),</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">fio =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==-</span><span class="dv">1</span>,<span class="st">" "</span>, <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, x) )</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab1, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>)</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">gen_grob</span>(tab2, <span class="at">fit =</span> <span class="st">"auto"</span>, <span class="at">just =</span> <span class="st">"centre"</span>) </span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>, <span class="at">color=</span><span class="cn">NA</span>),</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>),</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'transparent'</span>)</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> gg<span class="sc">+</span>p1<span class="sc">+</span>p2<span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-table.pdf"</span>), <span class="at">.path =</span> tables_dir1)</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plot1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-table.png"</span>), <span class="at">.path =</span> tables_dir1)</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>tab1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-85c4d48a{}.cl-85b99494{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-85be22c0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-85be22d4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-85be5588{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-85be559c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-85be559d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-85be55a6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-85be55a7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-85be55b0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-85c4d48a"><thead><tr style="overflow-wrap:break-word;"><th class="cl-85be5588"><p class="cl-85be22c0"><span class="cl-85b99494">Name</span></p></th><th class="cl-85be559c"><p class="cl-85be22d4"><span class="cl-85b99494">tg</span></p></th><th class="cl-85be559c"><p class="cl-85be22d4"><span class="cl-85b99494">fio</span></p></th><th class="cl-85be5588"><p class="cl-85be22c0"><span class="cl-85b99494">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">prior_2</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494"></span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.15</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.15</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">prior_3</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494"></span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.05</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.15</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.20</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">prior_4</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494"></span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.05</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.10</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.20</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.20</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">prior_5</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494"></span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">28.777778</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.20</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.05</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.10</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.20</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.20</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">prior_ref</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494"></span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">9.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.05</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">9.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.05</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55a6"><p class="cl-85be22d4"><span class="cl-85b99494">0.05</span></p></td><td class="cl-85be559d"><p class="cl-85be22c0"><span class="cl-85b99494">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85be55a7"><p class="cl-85be22c0"><span class="cl-85b99494"></span></p></td><td class="cl-85be55b0"><p class="cl-85be22d4"><span class="cl-85b99494">29.888889</span></p></td><td class="cl-85be55b0"><p class="cl-85be22d4"><span class="cl-85b99494">0.05</span></p></td><td class="cl-85be55a7"><p class="cl-85be22c0"><span class="cl-85b99494">ACN</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tab2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-85d99654{}.cl-85cd4e08{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-85d18144{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-85d18158{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-85d1ad0e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-85d1ad22{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-85d1ad23{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-85d1ad2c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-85d1ad36{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-85d1ad37{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-85d99654"><thead><tr style="overflow-wrap:break-word;"><th class="cl-85d1ad0e"><p class="cl-85d18144"><span class="cl-85cd4e08">Name</span></p></th><th class="cl-85d1ad22"><p class="cl-85d18158"><span class="cl-85cd4e08">tg</span></p></th><th class="cl-85d1ad22"><p class="cl-85d18158"><span class="cl-85cd4e08">fio</span></p></th><th class="cl-85d1ad0e"><p class="cl-85d18144"><span class="cl-85cd4e08">Modifier</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">noprior_2</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"> </span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"> </span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"> </span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"> </span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">noprior_3</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">9</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.20</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">30</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.10</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">30</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.15</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">noprior_4</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">9</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.20</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">30</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.05</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">30</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.15</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">30</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.20</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">noprior_5</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">9</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.20</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">30</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.05</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">30</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.10</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">30</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.20</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">30</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.20</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">noprior_ref</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">10</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.05</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">10</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.05</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">ACN</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">30</span></p></td><td class="cl-85d1ad2c"><p class="cl-85d18158"><span class="cl-85cd4e08">0.05</span></p></td><td class="cl-85d1ad23"><p class="cl-85d18144"><span class="cl-85cd4e08">MeOH</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-85d1ad36"><p class="cl-85d18144"><span class="cl-85cd4e08"></span></p></td><td class="cl-85d1ad37"><p class="cl-85d18158"><span class="cl-85cd4e08">30</span></p></td><td class="cl-85d1ad37"><p class="cl-85d18158"><span class="cl-85cd4e08">0.05</span></p></td><td class="cl-85d1ad36"><p class="cl-85d18144"><span class="cl-85cd4e08">ACN</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
</section>
<section id="stan-simulations" class="level2">
<h2 class="anchored" data-anchor-id="stan-simulations">Stan simulations</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>prior_ma_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -45.4391     0.0168657       34.9089      0.4887      0.4887      121    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -43.3207    0.00194222       2.12241      0.9399      0.9399      239    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -43.1687    0.00220602       1.18245      0.7766      0.7766      361    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -43.1541    0.00114897      0.352628      0.3778           1      475    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -43.1531   0.000113083     0.0599036      0.5096      0.5096      600    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      560       -43.153   9.25688e-05     0.0188888           1           1      675    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.5 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  14.2 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -50.2218    0.00889706       11.5966           1           1      111    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199       -48.732    0.00369417       2.47715           1           1      221    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -48.7063   9.58168e-05       0.34637      0.6152      0.6152      333    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -48.7051     0.0011642      0.373881           1           1      437    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      474       -48.705   1.85554e-05     0.0133267           1           1      520    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.3 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  14.4 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -51.8083    0.00283612       1.38623      0.7994      0.7994      103    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -51.7454   0.000956447      0.062927           1           1      208    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      258      -51.7453   5.96476e-05      0.011842      0.5124           1      272    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.3 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  15.0 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -67.5102     0.0312165       24.5207           1           1      115    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -63.7235     0.0144039       44.3644           1           1      233    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299       -62.694     0.0252418       5.30962           1           1      358    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -62.5606    0.00769332        17.374           1           1      472    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -62.5424    0.00561732       2.96824           1           1      589    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -62.5328   0.000360165       2.06234       0.308       0.308      713    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -62.5312   0.000281814      0.313001           1           1      832    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -62.5309   2.57592e-05      0.399414      0.1768      0.1768      946    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      845      -62.5308   5.41609e-05     0.0480552      0.9822      0.9822     1000    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.7 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  15.4 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -43.2219     0.0254729       1.71399           1           1      106    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -43.1668   0.000420062       0.06611           1           1      211    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      268      -43.1666   2.42524e-05    0.00713334           1           1      285    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.2 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  14.6 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -82.0826    0.00524244       127.992     0.04448           1      147    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -75.4533     0.0479169       310.652      0.1644           1      285    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299       -71.984    0.00465007       84.4453           1           1      521    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -69.3044    0.00201971       239.741     0.03265           1      645    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -66.5149    0.00717702       65.7203      0.7022      0.7022      783    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -64.4988      0.029965       31.1822       1.523    0.001523     1041    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -64.2289    0.00299071       16.1436       14.65     0.01465     1386    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -63.4425    0.00954817       34.3833           1           1     1521    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -63.1057    0.00346682       16.7536    0.009513           1     1696    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -62.8675    0.00450894       20.0008           1           1     1930    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -62.2609    0.00072416       35.4769           1           1     2054    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -61.1165    0.00139261       53.5447           1           1     2179    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -60.4112    0.00143623       48.4693           1           1     2326    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -60.2173    0.00574713       107.162           1           1     2469    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -59.9995    0.00467213       8.11152           1           1     2600    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -59.8354    0.00446543       6.78321           1           1     2733    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699       -59.786   0.000879051       90.3568      0.2739      0.2739     2859    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -59.7206    0.00265322       53.9888           1           1     2974    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -59.6814    0.00144491        5.7194           1           1     3116    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -59.6578   0.000238261       5.48371       3.549     0.03549     3254    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -59.6576    0.00164735       2.74537           1           1     3255    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.8 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  15.0 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -48.2891    0.00763735       15.3302           1           1      112    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199       -45.375     0.0152509        9.4287           1           1      222    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -45.1712   0.000859307       2.67071      0.4047           1      334    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -45.1537    0.00238576      0.714099           1           1      445    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -45.1519   0.000513655      0.315278           1           1      550    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -45.1518   1.62734e-05     0.0394484      0.1966           1      664    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      618      -45.1518   3.18371e-05     0.0202424      0.4088           1      686    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.5 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.7 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -52.9635     0.0118286       2.62409      0.6327      0.6327      104    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199       -52.894    0.00111545     0.0725678           1           1      210    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      261      -52.8938   5.56401e-05    0.00822614           1           1      274    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.2 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  15.7 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -59.3327     0.0340276       7.06279           1           1      115    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199       -57.765    0.00113651       10.9869      0.2547      0.2547      226    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -57.6255   0.000801475       1.40544           1           1      345    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -57.6189   0.000153622      0.352106      0.3261      0.3261      462    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -57.6181   0.000324607      0.214872           1           1      583    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      562      -57.6181   0.000172602     0.0235773           1           1      657    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.5 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  15.2 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -56.7593     0.0120078       2.15862           1           1      108    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -56.5978   0.000407502      0.136529      0.8362      0.8362      218    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      297      -56.5972   3.48124e-05     0.0104007           1           1      327    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.3 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  15.5 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_ref<span class="sc">$</span>chosen_indices <span class="co"># ref</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_ref <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691241 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.682024    0.00889889      0.674892           1           1      123    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -0.67512   0.000300043      0.517176      0.7088      0.7088      251    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.671225    0.00029669      0.459872           1           1      372    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.669467    0.00162776      0.566023           1           1      485    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.663759    0.00246054       1.02236           1           1      602    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.656408   0.000937927      0.528017           1           1      719    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699      -0.65295   0.000390308      0.174218           1           1      843    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.651947   0.000332276       0.53326      0.3605      0.3605      960    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.649482    0.00013184      0.251896      0.7909      0.7909     1073    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.647561   0.000433633      0.212234           1           1     1191    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.645645   0.000645589      0.176992      0.4928      0.4928     1307    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.644406   0.000505206       0.17596           1           1     1424    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.643552   0.000360169      0.161404      0.4486           1     1536    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399      -0.64292    0.00035254      0.146701           1           1     1651    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.642248   0.000809018      0.223794      0.8254     0.08254     1774    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.640359    0.00985285       2.23662      0.3823      0.3823     1894    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.638064    0.00464756      0.216054           1           1     2008    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799     -0.635893    0.00163497      0.242258           1           1     2131    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899     -0.635371   0.000508125      0.119562           1           1     2244    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.634905    0.00466595     0.0728971           1           1     2359    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.634904   0.000277362      0.191439      0.4228           1     2361    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  1.3 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  15.2 seconds.
0/2: Initial log joint probability = -0.733884 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.724568   0.000154393      0.752364      0.2688      0.2688      110    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -0.71708    0.00220146      0.341057           1           1      217    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299     -0.713711   0.000589619      0.602696           1           1      326    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.712695   0.000258632      0.102633           1           1      431    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.711532     0.0041072      0.251557           1           1      543    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.709013    0.00249097        0.1991           1           1      649    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.708334    0.00172707      0.211823      0.4306           1      759    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.707844   6.72547e-05      0.174152      0.2596      0.2596      866    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899     -0.707413     0.0003859     0.0663162           1           1      976    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.706944    0.00228053     0.0980535           1           1     1088    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.706754   0.000146368     0.0630809           1           1     1205    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.706667   2.04047e-05     0.0404567           1           1     1310    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299     -0.706557     0.0012895     0.0580079           1           1     1416    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399      -0.70631   0.000449124      0.170587           1           1     1521    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.706131   0.000184224     0.0572439           1           1     1632    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.706092   2.24478e-05     0.0321337      0.3642      0.3642     1740    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.706066   0.000226979     0.0278041           1           1     1848    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799     -0.706047   7.29932e-05      0.020504           1           1     1959    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899     -0.706032   0.000217439     0.0416487           1           1     2071    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1999     -0.706022   2.33871e-05    0.00730843           1           1     2181    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     2000     -0.706022   1.10978e-05    0.00767839           1           1     2182    
0/2: Optimization terminated normally:  
0/2:   Maximum number of iterations hit, may not be at an optima 
0/2: Finished in  1.3 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  15.7 seconds.
0/3: Initial log joint probability = -0.799593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.777392    0.00119281      0.318624           1           1      106    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.771521    0.00129902      0.153688           1           1      212    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.769461    0.00193238     0.0643506           1           1      318    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.768794   0.000220673     0.0301177           1           1      424    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499      -0.76855   9.96184e-05     0.0248775      0.8216      0.8216      528    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.768507   0.000497311      0.019864           1           1      631    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.768471   0.000214493     0.0136053           1           1      734    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799     -0.768453   0.000429299     0.0283906           1           1      837    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      899     -0.768446   8.01611e-05    0.00599733           1           1      942    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      999     -0.768443   0.000170874    0.00776825      0.3911           1     1048    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1099     -0.768439   6.99535e-05    0.00355286           1           1     1153    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1199     -0.768437   8.43994e-05    0.00409414           1           1     1257    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:     1269     -0.768436   5.13781e-06    0.00122781           1           1     1331    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.9 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  15.6 seconds.
0/4: Initial log joint probability = -0.871315 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99     -0.866231   0.000230196       1.16022      0.3187      0.3187      122    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.860876    0.00210408      0.844856        1.57       0.157      247    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299     -0.851534    0.00122124       0.70347           1           1      374    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399     -0.846413     0.0010496       1.28334      0.6129      0.6129      499    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -0.84133    0.00199985      0.965907      0.5379      0.5379      619    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.838596   0.000565428       0.48413           1           1      737    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699     -0.837325   0.000950652      0.819564      0.2968           1      847    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799     -0.836289   0.000316469      0.304405      0.3757           1      966    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.834852   0.000295703      0.384335      0.9288      0.9288     1085    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.828604    0.00495043       1.32241           1           1     1200    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.816761   0.000423256      0.733826           1           1     1322    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.812624   0.000619011      0.512698      0.7767      0.7767     1440    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.810228   7.29559e-05      0.261885           1           1     1552    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.806875    0.00217007      0.954353           1           1     1658    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.805434   2.75581e-05      0.637177      0.2765      0.2765     1779    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599     -0.805084   0.000168093      0.138572           1           1     1889    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.804436    0.00106871      0.291602           1           1     2005    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799      -0.80429   1.52412e-05      0.117191           1           1     2127    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.804034   6.39981e-05      0.119301      0.8379      0.8379     2241    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.802917    0.00299183       1.74397           1           1     2359    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000     -0.802906   0.000809896       1.07026      0.5416      0.5416     2360    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  1.4 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  16.1 seconds.
0/5: Initial log joint probability = -0.729812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.708796    0.00130818      0.161499           1           1      102    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.705549    0.00123697      0.202517      0.3735      0.3735      209    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.704388    0.00223165      0.126482           1           1      315    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.702794    0.00383214      0.151384           1           1      421    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499     -0.701515    0.00208789      0.170398      0.4936           1      530    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.701097   1.32403e-05     0.0387571      0.6974      0.6974      639    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.701011    0.00136446     0.0914701           1           1      745    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.700884   0.000184336     0.0263522           1           1      854    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.700809   0.000445374     0.0214842           1           1      962    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      999     -0.700776   4.54353e-05    0.00862418           1           1     1066    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1099     -0.700767   4.23132e-05    0.00822295           1           1     1173    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1199      -0.70075   0.000372976     0.0162862           1           1     1281    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1299     -0.700739   2.74655e-05    0.00620933      0.4749      0.4749     1387    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1398     -0.700738   2.63826e-05    0.00192076      0.7385      0.7385     1493    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.9 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  14.9 seconds.
0/6: Initial log joint probability = -0.917075 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.915515    0.00170531       2.94856      0.7519      0.7519      153    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.914498    0.00032997      0.876056           1           1      329    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.913786   8.92408e-05       1.82089           1           1      467    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.913211   0.000561362       2.69292      0.9221      0.9221      608    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.912575   6.89553e-05       3.26221     0.03422           1      792    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.911333   0.000686974       1.23536      0.0038           1      951    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.909409    0.00141512       5.28095      0.4989      0.4989     1098    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.907691   6.73773e-05       1.53364           1           1     1238    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -0.90689   0.000294041      0.665069      0.9257     0.09257     1365    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999       -0.9059   0.000300587       3.77506      0.6128     0.06128     1504    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.904929   0.000211832       1.67227     0.04816           1     1646    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.903818   0.000657884       1.67643      0.9696     0.09696     1786    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -0.90237   0.000732266       2.30577           1           1     1916    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.897469    0.00293765       3.89096      0.3219           1     2066    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.896223    0.00067834       2.78739           1           1     2191    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.895372    0.00239137       5.01326           1           1     2334    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.894641   0.000751139       5.26366       1.635     0.01635     2473    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.894343   8.54303e-06      0.205626           1           1     2607    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.894075   0.000525658      0.278725           1           1     2739    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.893582   0.000231619        1.1449           1           1     2892    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000     -0.893579   0.000316159       1.02438           1           1     2893    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.7 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  18.3 seconds.
0/7: Initial log joint probability = -0.679173 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.675648   0.000626141      0.392252           1           1      108    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.670682    0.00230284      0.675736      0.4694           1      220    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.665229    0.00160699      0.347658           1           1      330    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.662262   0.000992273      0.541298           1           1      435    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.660911    0.00133144      0.333238           1           1      542    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.659916   0.000512657      0.519511           1           1      657    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.659057   0.000568719      0.127362           1           1      766    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.658349   0.000461641      0.111871           1           1      877    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.657959   0.000231218      0.151395           1           1      992    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.657717   7.80508e-05     0.0686361      0.8312      0.8312     1103    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099     -0.657516   0.000396913     0.0983281           1           1     1210    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.657212   0.000196043      0.136422      0.3121           1     1324    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299     -0.657042   0.000407857      0.083458           1           1     1431    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399      -0.65693   0.000148385      0.105529       0.394      0.9923     1541    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.656858   0.000248112     0.0646498           1           1     1650    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.656815   5.84586e-05     0.0652746       0.422       0.422     1754    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.656794   3.55304e-05     0.0612892      0.5726      0.5726     1861    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.656775   6.94705e-05     0.0181147           1           1     1968    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899      -0.65676    0.00019457     0.0255325           1           1     2080    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1999     -0.656745   0.000245796     0.0378323      0.9441      0.9441     2196    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     2000     -0.656744   0.000101281     0.0219771           1           1     2197    
0/7: Optimization terminated normally:  
0/7:   Maximum number of iterations hit, may not be at an optima 
0/7: Finished in  1.5 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  16.2 seconds.
0/8: Initial log joint probability = -0.801845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.784845   0.000683271      0.220845           1           1      105    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.778446    0.00257239      0.170117           1           1      211    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.775086   0.000503306      0.182937      0.7503      0.7503      313    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.772964   0.000507549      0.118341      0.2911      0.2911      421    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.771078    0.00120237      0.168642      0.5874      0.5874      524    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.770704   0.000564939     0.0582174      0.8346      0.8346      630    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699     -0.770284    0.00521073     0.0653983           1           1      734    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799     -0.769842    0.00123145     0.0516393           1           1      843    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899      -0.76964    0.00027955     0.0253255           1           1      952    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999     -0.769602   0.000378968     0.0191086           1           1     1056    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.769574    0.00112733     0.0340681      0.4675           1     1160    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199     -0.769541   0.000373348     0.0106183           1           1     1262    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.769528   0.000122829     0.0118531           1           1     1367    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.769516   7.49193e-05    0.00679043           1           1     1472    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499     -0.769513   5.30046e-05    0.00474904           1           1     1580    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.769509   3.86701e-05    0.00794394      0.5668      0.5668     1688    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1699     -0.769505   0.000102614     0.0031904           1           1     1792    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1779     -0.769504   5.05116e-06    0.00178834      0.7865      0.7865     1874    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  1.1 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  16.2 seconds.
0/9: Initial log joint probability = -0.809753 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.800734    0.00168676       0.21639           1           1      120    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.796798   0.000432424      0.582672      0.4194      0.4194      232    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299     -0.793129   0.000387877       0.77801      0.2835           1      349    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.791953    0.00030123      0.112247           1           1      467    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.790857   0.000964342      0.130636           1           1      581    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.789883   0.000704642      0.151109           1           1      702    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699      -0.78843   0.000326084      0.396522     0.09832           1      821    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.787303   0.000342347      0.126524           1           1      939    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.786771   0.000212713     0.0615211           1           1     1051    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.786216   0.000233178       0.18456           1           1     1166    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.785719   0.000550796      0.234813      0.7781      0.7781     1280    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199      -0.78441   0.000275237      0.288308           1           1     1401    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.783937    0.00342181      0.179219           1           1     1518    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.783602    0.00245243     0.0840456           1           1     1640    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.783406   1.68613e-05     0.0911628      0.4725      0.4725     1754    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.783304   0.000178381      0.135173           1           1     1871    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.782854    0.00325777      0.202887      0.4277      0.4277     1991    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799     -0.782467    0.00153141     0.0748376           1           1     2115    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899       -0.7823   9.48448e-05       0.10102      0.2347           1     2232    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1999     -0.782212   3.79537e-05     0.0643835           1           1     2346    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     2000     -0.782212   0.000122976     0.0756951           1           1     2347    
0/9: Optimization terminated normally:  
0/9:   Maximum number of iterations hit, may not be at an optima 
0/9: Finished in  1.4 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  15.8 seconds.
0/10: Initial log joint probability = -0.752982 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.745061   0.000813138      0.161915           1           1      109    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.744003   0.000515748     0.0690166           1           1      222    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299     -0.743828   0.000476662     0.0430131           1           1      332    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.743794   2.79342e-05     0.0108591           1           1      442    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499      -0.74379   2.35324e-05    0.00662754           1           1      551    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599     -0.743787   3.22609e-05    0.00316879           1           1      664    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      603     -0.743787   4.14983e-06    0.00157026           1           1      668    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.7 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  16.2 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_2<span class="sc">$</span>chosen_indices <span class="co"># p=2</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>prior_ma_2 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -39.8498      0.204981       20.0425           1           1      112    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -38.5627    0.00486415       1.51405           1           1      231    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -38.5269    0.00135658       1.28869        0.24        0.24      342    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -38.5233   0.000294847     0.0898384           1           1      451    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -38.5231   0.000127377      0.030944           1           1      568    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      506      -38.5231   5.56037e-05     0.0111231           1           1      577    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.4 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  13.7 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -42.5398     0.0242076       14.7221           1           1      107    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -41.9566     0.0072625      0.721833           1           1      221    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -41.9487    0.00110596       0.10724           1           1      327    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      368      -41.9486    4.4075e-05     0.0117525           1           1      399    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.3 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  14.0 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99       -46.451     0.0262514       2.10681           1           1      103    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -46.1509    0.00122458      0.375733      0.4457      0.4457      208    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299       -46.148   0.000419693     0.0474568           1           1      314    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      338      -46.1479    4.0403e-05     0.0100842           1           1      355    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.2 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  13.8 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99       -61.603     0.0264932       36.4973           1           1      121    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -56.2879     0.0153187       22.7845           1           1      239    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -55.4026    0.00274846       7.54269      0.5795      0.5795      354    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399       -55.167    0.00267235       1.73996           1           1      468    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -55.1066    0.00184775      0.483294      0.8984      0.8984      582    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -55.0882    0.00224231      0.877787           1           1      700    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -55.0856   6.79718e-05      0.238214           1           1      813    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -55.0854   0.000975665     0.0790324           1           1      933    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      849      -55.0853    1.5021e-05     0.0477678           1           1      993    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.3 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  13.9 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -36.1056     0.0406884       3.17516           1           1      104    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -35.9627    0.00365761      0.378981           1           1      213    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -35.9621   0.000149155     0.0134864           1           1      318    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      311      -35.9621   1.60414e-05     0.0060321      0.6505      0.6505      331    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.3 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.8 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99       -78.451     0.0122095       65.5466           1           1      133    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -69.2017     0.0164216       781.317           1           1      284    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -64.4134     0.0407994       204.213           1           1      416    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -58.3837    0.00728924       69.7171      0.1373           1      557    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -56.1575    0.00105193       15.3829      0.4876      0.4876      711    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -55.2695    0.00474382       19.7954       1.841     0.01841      897    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -55.0277   0.000601627       5.88455       1.165     0.01165     1145    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799       -54.632     0.0116458       48.8508       8.824      0.8824     1297    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -54.0039    0.00172439       15.9723       0.116      0.0116     1440    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -53.8347    0.00070534       12.7294           1           1     1716    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -53.7057   0.000285498       5.34245           1           1     1839    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -53.6065    0.00197244       53.1041      0.2846      0.2846     1969    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299       -53.506    0.00068611       5.59879           1           1     2097    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -53.3811     0.0144838       3.55863           1           1     2250    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -53.2962    0.00454728       18.5029           1           1     2372    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -53.2546   0.000746691       2.25524           1           1     2513    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -53.2337   0.000367612       2.31314           1           1     2657    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -53.2213    0.00051467       2.04694           1           1     2785    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -53.2169    0.00139109       4.70319           1           1     2913    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -53.2147    0.00255889       10.2119           1           1     3078    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -53.2144    0.00183082       1.97019      0.8868      0.8868     3079    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.0 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  14.5 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -38.5092     0.0588295       17.6814      0.9218      0.9218      104    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -36.4069      0.032363       10.6361           1           1      216    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -36.1215   0.000824674      0.759774           1           1      324    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -36.1131    0.00037225     0.0935893           1           1      433    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -36.1129   0.000316873     0.0823799      0.5227           1      542    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      549      -36.1128   6.23344e-05     0.0123244           1           1      597    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.2 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  15.2 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -44.8162     0.0229963        3.0988           1           1      107    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -44.6215    0.00191286      0.391833           1           1      211    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      289       -44.621   5.02817e-05    0.00698941           1           1      309    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.1 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.3 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -54.4288     0.0189289       10.8314           1           1      109    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -51.7955     0.0306123       5.60602           1           1      221    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -51.6777       0.01675       2.70186           1           1      337    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -51.6692    0.00149518       0.33407           1           1      449    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -51.6686   0.000147179     0.0620583           1           1      559    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      539      -51.6685   1.65219e-05     0.0240348           1           1      603    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.2 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.5 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -51.1804     0.0355237       3.70459           1           1      105    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -50.8803    0.00106258      0.267191           1           1      217    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -50.8789   0.000159574      0.033208           1           1      327    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      332      -50.8789   4.88878e-05     0.0160228      0.9557      0.9557      362    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.2 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.3 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>prior_ma_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -48.2817     0.0396664       12.4701           1           1      117    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -44.4616    0.00535913       11.7885           1           1      238    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -44.0358    0.00581379       2.99527      0.1664           1      353    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -44.0011    0.00333372       1.85813           1           1      464    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499       -43.997    0.00127205      0.233068           1           1      576    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -43.9962   0.000310811       0.13806           1           1      687    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      698      -43.9961   6.87116e-05     0.0323142           1           1      796    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.5 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  13.7 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -46.4381      0.325201       12.3552           1           1      107    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -44.5396    0.00598374       3.27785           1           1      215    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -44.4644   0.000961736      0.229342           1           1      323    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -44.4634    0.00019536     0.0673522      0.7524      0.7524      431    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      457      -44.4634   0.000133734     0.0155169           1           1      496    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.2 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  13.8 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -49.7329     0.0244644       4.21108           1           1      105    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199       -49.245     0.0109489       1.75781           1           1      209    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -49.2375   0.000277405     0.0675924      0.7522      0.7522      317    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      358      -49.2375   5.77053e-05     0.0102228           1           1      379    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.2 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  14.2 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99       -66.834     0.0424357       32.0663           1           1      116    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -59.2663     0.0111746        10.994      0.6171      0.6171      226    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -58.5893    0.00314545       4.02149           1           1      343    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -58.3806   0.000692344       8.30185      0.1861      0.1861      456    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -58.3275    0.00178444       2.18441           1           1      575    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -58.3176   0.000688151      0.443382           1           1      688    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -58.3155   0.000429071      0.864443      0.2147           1      803    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -58.3149    0.00047545       0.11318           1           1      918    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899      -58.3147   1.40816e-05     0.0848433           1           1     1030    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      956      -58.3147   2.28567e-05     0.0251435      0.8792      0.8792     1094    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.4 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  14.1 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -39.8723      0.040434       6.25216           1           1      104    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -39.6089    0.00152482      0.373628      0.8246      0.8246      208    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -39.6067   0.000155408     0.0250205      0.9238      0.9238      315    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      333      -39.6067   2.99418e-05    0.00686346           1           1      349    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.3 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.1 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -82.7211     0.0256997       54.8169           1           1      136    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -73.9961     0.0134365        46.716      0.9549      0.9549      260    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -68.0777    0.00885495       86.7948     0.01199           1      385    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -64.1211    0.00808516       25.8116           1           1      506    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -62.1865    0.00431447       127.783      0.4654           1      639    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -61.3285    0.00439862       17.4471           1           1      772    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -61.0552    0.00147288       24.2429           1           1      907    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -60.5573     0.0453761       301.546           1           1     1040    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -59.6002     0.0022754       20.7401           1           1     1173    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -59.4246   0.000508755       14.7134           1           1     1310    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -58.9352    0.00670854       11.4454           1           1     1436    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199       -58.541    0.00533602       8.52124           1           1     1572    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -58.4323    0.00969436       30.7616           1           1     1707    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -58.3555    0.00174972       4.95939     0.01098           1     1851    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499       -58.338   0.000330956       2.14809       1.191     0.01191     2089    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -58.3202    0.00115441       5.21768      0.7412    0.007412     2411    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699       -58.312    0.00060871       1.93695      0.7434    0.007434     2722    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -58.3085   3.15292e-05       1.97087      0.1868     0.01868     3015    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -58.3056   0.000582315       5.48064      0.2825     0.02825     3235    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -58.2746    0.00125671       18.1077      0.5795      0.5795     3385    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -58.2745   0.000971543       4.91639           1           1     3386    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.3 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  14.1 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -43.1431      0.015744       12.7539           1           1      112    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -40.1939     0.0156869       6.58148           1           1      221    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -39.8702   0.000922773       1.80208           1           1      325    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -39.8485   0.000671293      0.604753           1           1      432    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -39.8449    0.00171543      0.176704           1           1      549    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -39.8446   0.000488113     0.0703265           1           1      657    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      617      -39.8446   4.06003e-05     0.0222668           1           1      676    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.3 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.1 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -49.1414      0.117412       18.7404           1           1      107    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -48.6957   0.000808965      0.239515       0.998       0.998      210    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -48.6926   5.41122e-05     0.0254676           1           1      314    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      330      -48.6925   5.07363e-05    0.00875203           1           1      346    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.2 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.2 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -57.1021    0.00761324       19.2214      0.3213      0.3213      113    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -54.7773     0.0015924       6.21233      0.5366      0.5366      223    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -54.6455    0.00267816        1.2336           1           1      333    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -54.6331     0.0019145      0.257094           1           1      438    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499       -54.632   2.43909e-05     0.0562682      0.8503      0.8503      547    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      560      -54.6319   3.79722e-05      0.025175           1           1      615    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.4 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.2 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -52.9969     0.0164747       3.00525           1           1      113    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -52.5263    0.00580359      0.882753           1           1      215    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -52.5191    0.00134245     0.0999213           1           1      321    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      390       -52.519   6.50948e-05     0.0126924           1           1      416    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.2 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.8 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_3<span class="sc">$</span>chosen_indices <span class="co"># p=3</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_3 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691241 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.683917    0.00182288      0.528008       1.943      0.1943      120    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.676849     0.0073672      0.369333           1           1      240    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.672057   0.000387432      0.587635      0.3806      0.3806      356    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.667808    0.00571488      0.740482           1           1      477    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.663972   0.000710554      0.118253           1           1      598    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.662557    0.00182827      0.467212           1           1      713    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699     -0.660233    0.00100088       0.21649           1           1      827    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.659425   0.000146773      0.180668       0.117      0.7887      940    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.658829   0.000800146      0.254233      0.5165           1     1059    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999       -0.6586   0.000454281       0.19759           1           1     1173    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.657245    0.00145108       0.42704      0.6715      0.6715     1293    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.654222    0.00470468      0.392483      0.5719      0.5719     1408    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.652004    0.00105117       0.27325           1           1     1523    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399     -0.651422   0.000739841      0.123348           1           1     1646    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.651166   0.000878542     0.0947875           1           1     1768    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.650495   0.000649679      0.191162           1           1     1884    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.650252    0.00107627     0.0792597           1           1     2013    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799     -0.650165   3.32829e-05     0.0421287           1           1     2134    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899     -0.650108   3.92766e-05     0.0462196           1           1     2246    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.650052   0.000184096     0.0352968           1           1     2361    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.650051   0.000257491     0.0623975           1           1     2362    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  0.8 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  13.4 seconds.
0/2: Initial log joint probability = -0.733883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.720764    0.00114052      0.491348           1           1      108    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199     -0.713581    0.00223498      0.400589           1           1      218    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299     -0.708477    0.00256931      0.524117           1           1      331    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.706585   9.98147e-05      0.152622           1           1      441    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.705759    0.00214703      0.142206           1           1      553    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.705151     0.0027368      0.132264           1           1      658    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.704887   0.000241168     0.0776663      0.4787           1      765    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.704809   0.000117863     0.0255329           1           1      876    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899     -0.704761    0.00020807     0.0408426      0.8439      0.8439      986    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.704714   0.000458138     0.0428973           1           1     1096    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.704676   0.000472875     0.0232946           1           1     1204    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.704662   0.000145343     0.0264368           1           1     1315    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299     -0.704656   1.26012e-05    0.00636221           1           1     1420    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399     -0.704653   2.46711e-05    0.00739211           1           1     1532    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.704649   0.000119617    0.00536228           1           1     1646    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.704648   2.24501e-05    0.00527245           1           1     1756    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1622     -0.704648   2.99469e-06    0.00350145      0.3929           1     1785    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.7 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  13.7 seconds.
0/3: Initial log joint probability = -0.799593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -0.77728    0.00526183      0.427028           1           1      103    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.767609     0.0102403      0.564346           1           1      206    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.765744    0.00131814      0.108692           1           1      311    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.765441   0.000412169     0.0384415           1           1      418    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.765374   7.40088e-05     0.0058967           1           1      523    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.765364   7.28905e-05    0.00586142           1           1      626    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.765362   2.99969e-05    0.00126311           1           1      731    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      706     -0.765362   1.33182e-05    0.00146114       0.877       0.877      738    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.4 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  14.2 seconds.
0/4: Initial log joint probability = -0.871314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99     -0.857849    0.00317129       1.55239           1           1      120    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.849326   0.000945072       1.44572      0.3594      0.3594      233    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -0.84314   0.000377924      0.478256           1           1      351    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399     -0.840404   0.000905304      0.548246           1           1      465    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499     -0.838562   0.000973005      0.275026           1           1      577    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.837097   0.000357539      0.511613           1           1      694    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699     -0.833688    0.00201088      0.679648      0.8471      0.8471      808    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799     -0.818259     0.0717475       4.24902      0.3787           1      923    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.809352   8.17434e-05      0.351983           1           1     1036    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.807576    0.00141851      0.591534           1           1     1149    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.805837   0.000611034      0.464567      0.1126           1     1270    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.803201   0.000843024      0.812853           1           1     1380    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.802626    0.00043526      0.152367           1           1     1493    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.802007   0.000717864      0.181495           1           1     1611    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.800213   0.000269685      0.335762           1           1     1725    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599     -0.797895   0.000905611      0.200223           1           1     1850    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.796591    0.00163123      0.806266      0.4857      0.4857     1976    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799     -0.796084    0.00244074      0.348807           1           1     2088    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.794906    0.00086255      0.215164           1           1     2197    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.794051   8.24803e-05      0.269999      0.1342           1     2313    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000      -0.79405   0.000153026      0.236733      0.1355      0.1355     2314    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  1.0 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  14.0 seconds.
0/5: Initial log joint probability = -0.729812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.709289    0.00472327      0.268103           1           1      103    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.703615    0.00489034       0.43705           1           1      214    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.702249     0.0020489      0.144438           1           1      323    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.702032   0.000207116     0.0246195           1           1      428    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499     -0.701954   0.000305419     0.0158969           1           1      536    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.701925   0.000257554     0.0114113           1           1      642    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.701907   5.72791e-05     0.0120025      0.7507      0.7507      747    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.701903    0.00020522    0.00771218           1           1      855    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.701901   7.30382e-05    0.00295158           1           1      964    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      999     -0.701899   0.000220501    0.00203297           1           1     1069    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1099     -0.701898   3.75477e-05    0.00283571           1           1     1174    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1115     -0.701898   4.41192e-06    0.00150281      0.9026      0.9026     1193    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.5 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.9 seconds.
0/6: Initial log joint probability = -0.917059 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916015   3.43763e-05      0.579393       1.437      0.1437      131    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.914284    0.00215183      0.635389           1           1      271    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.912828   0.000503057       5.05434     0.01712           1      401    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.910718    0.00378827       1.98635           1           1      550    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.908595   8.13502e-05       1.21132      0.2356      0.2356      673    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.906868    0.00014661       1.24185           1           1      807    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.905966   0.000371523       1.48184           1           1      934    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.905242   0.000883675       1.84052      0.7044     0.07044     1077    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -0.90435   0.000297591      0.652789           1           1     1202    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999     -0.903382   0.000194724       1.26882     0.04348           1     1345    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.902505    4.9091e-05       2.47522      0.3041           1     1558    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.901853   9.37205e-05       1.35504       1.195      0.1195     1694    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.901125    0.00107624       3.16364           1           1     1824    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.900821   3.66864e-05      0.290017           1           1     1957    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.900625   0.000120663      0.927692           1           1     2082    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.900471   6.83719e-05      0.369113           1           1     2218    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.900236    0.00412592       6.01226           1           1     2356    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.899521   0.000107691      0.558407     0.05621           1     2504    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.899061   0.000145444      0.775666     0.05819           1     2713    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.897371   5.48919e-05        4.0197     0.04567           1     2858    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000     -0.897317   0.000455094       3.12879      0.4613     0.04613     2860    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.1 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  14.0 seconds.
0/7: Initial log joint probability = -0.679173 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.673026   0.000100674      0.395245      0.8639      0.8639      115    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.669341     0.0019737       1.18674           1           1      225    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.664793     0.0019545      0.395739           1           1      334    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.663021     0.0011093      0.304206      0.6632      0.6632      442    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.662337    0.00045658       0.26238           1           1      548    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.661369   0.000518458      0.293404      0.7575      0.7575      655    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.660751   0.000733691      0.146605           1           1      761    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.660557   0.000258462      0.140366      0.8304      0.8304      870    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.660434   0.000140294     0.0879537      0.8388      0.8388      981    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.660391   2.84699e-05      0.039799      0.5036      0.5036     1090    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099     -0.660195   0.000712473      0.086607           1           1     1200    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.660135   0.000292526     0.0309906           1           1     1313    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299     -0.660095   6.33749e-05     0.0250465           1           1     1421    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.660088   0.000108041     0.0188111           1           1     1531    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.660082   9.85139e-05      0.025062           1           1     1636    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.660079   7.55148e-05    0.00723737           1           1     1743    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.660077   1.39113e-05    0.00888248      0.5127      0.5127     1854    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.660075   2.56331e-05     0.0148631      0.3686           1     1964    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899     -0.660074   1.34494e-05    0.00368369           1           1     2074    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1913     -0.660074   3.17995e-06    0.00290984           1           1     2089    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.8 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.2 seconds.
0/8: Initial log joint probability = -0.801845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -0.77987    0.00460803      0.347737           1           1      106    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.773329   0.000190453      0.129863      0.2979      0.2979      209    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.770226   0.000430076      0.149736      0.2672           1      316    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.768928    0.00239333     0.0540909           1           1      418    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.767669     0.0105271      0.313268           1           1      523    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.766951   0.000735321      0.042934           1           1      629    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699      -0.76675   0.000175068     0.0716767           1           1      737    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799      -0.76667   0.000946541     0.0188176           1           1      840    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899     -0.766477   0.000847064      0.058244           1           1      947    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999     -0.766391   3.95239e-05     0.0308009      0.6777      0.6777     1059    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099      -0.76634   0.000215029     0.0221258       0.509       0.509     1167    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199     -0.766319   0.000217127     0.0234908      0.2507           1     1274    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.766311     0.0008989     0.0262306           1           1     1379    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.766306   5.31196e-05    0.00556323      0.5077      0.5077     1483    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499     -0.766303   2.81012e-05    0.00212996           1           1     1588    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1547     -0.766303   1.51379e-05    0.00139744           1           1     1640    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.7 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.3 seconds.
0/9: Initial log joint probability = -0.809753 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.798924     0.0104861       0.50085           1           1      110    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.792506    0.00268695      0.326692           1           1      220    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299     -0.790803    0.00086916      0.184513           1           1      332    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.789961   0.000135945       0.13177           1           1      441    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -0.78881   0.000442499      0.187382      0.3163      0.3163      547    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.788158   0.000918916      0.276987      0.2255           1      660    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.787517     0.0013503       0.24772      0.3165           1      770    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.787033    0.00123473       0.13477           1           1      880    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.786541    0.00137756     0.0907772           1           1      995    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.786212   0.000396486     0.0562767           1           1     1113    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.786018   8.61169e-05      0.056235           1           1     1224    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199     -0.785888     0.0006033     0.0656715           1           1     1344    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.785693     0.0011439     0.0809227       0.666       0.666     1453    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.785435    0.00205887     0.0822193           1           1     1566    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.785381    2.6502e-05     0.0241892           1           1     1673    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.785366   0.000471017     0.0308406           1           1     1782    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.785346   6.60473e-05     0.0344901      0.5574      0.5574     1896    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799     -0.785341    5.1802e-05    0.00526069           1           1     2008    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1898     -0.785338   1.74441e-05    0.00298445           1           1     2118    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.9 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.7 seconds.
0/10: Initial log joint probability = -0.752982 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.742909   0.000778672      0.230844           1           1      113    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.741317    0.00336621      0.251365           1           1      218    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -0.73978    6.6809e-05      0.135841      0.5146      0.5146      328    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.739603   0.000125257     0.0385452           1           1      439    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499     -0.739562   5.28337e-05      0.029779      0.5679      0.5679      546    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599     -0.739555   6.96417e-05     0.0122285       0.415           1      656    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      699      -0.73955   0.000135395     0.0204591           1           1      764    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      732      -0.73955   1.91901e-05    0.00264179           1           1      799    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.5 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.5 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>prior_ma_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -48.5092     0.0543195       11.6213           1           1      117    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -45.8452     0.0324235       4.84894           1           1      233    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -45.5933    0.00262938       3.76856           1           1      347    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -45.5214    0.00411903       1.02654       0.285           1      465    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -45.5158   0.000390455      0.158452           1           1      579    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -45.5154   0.000278088     0.0841354           1           1      692    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      684      -45.5154   4.00958e-05     0.0189152           1           1      795    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.5 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  13.6 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -48.4805     0.0119288         6.583           1           1      106    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -46.6164     0.0287991       3.36364           1           1      217    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -46.4416    0.00125461       1.08367      0.5765      0.5765      328    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -46.4339    0.00258754      0.438769           1           1      441    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -46.4334   0.000269649     0.0557707           1           1      552    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      526      -46.4334   2.14208e-05     0.0200666           1           1      584    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.4 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  13.8 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -52.0051       0.03426       5.85969       0.429           1      104    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -51.1948    0.00156795      0.822261      0.8777      0.8777      209    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -51.1813   0.000111038      0.138293      0.6684      0.6684      316    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399       -51.181   0.000244034     0.0235613           1           1      424    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      417       -51.181   2.93209e-05     0.0103693           1           1      444    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.4 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  14.8 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -67.2366     0.0167882       45.5032           1           1      111    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -62.2181     0.0045686       12.8845           1           1      230    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -60.5165    0.00698052       5.62044           1           1      350    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -60.0896     0.0126273       25.3418     0.09975           1      463    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -59.9187   0.000738127       6.18988      0.1743           1      578    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -59.8915    0.00074086         2.808     0.06005           1      697    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699      -59.8843    0.00225325       1.56493      0.4532           1      808    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -59.8809   0.000405667       2.60604      0.1409           1      923    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899      -59.8787   0.000186458      0.831609           1           1     1039    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999      -59.8779   0.000265616      0.184782           1           1     1158    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099      -59.8777   0.000436703      0.158611       1.902      0.1902     1275    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199      -59.8776   1.43937e-05     0.0851383           1           1     1385    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1202      -59.8776   2.27251e-05     0.0598554      0.3676      0.7936     1389    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.8 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  14.7 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -42.5485     0.0383584       5.32676           1           1      104    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -41.9097     0.0107924        1.1904           1           1      212    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -41.8984   0.000493413      0.082472           1           1      315    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      395      -41.8982   4.68941e-05    0.00895229           1           1      418    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.3 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  14.2 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -86.4882    0.00781003       88.6036           1           1      137    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -81.0675    0.00869972       93.3758     0.01954           1      282    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -75.1865    0.00722764       319.702           1           1      488    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -71.0832    0.00070889       29.4698           1           1      617    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499      -68.2108   0.000733199       49.8479           1           1      754    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -66.0617     0.0313148       98.4368           1           1      897    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -65.3032    0.00963039       120.699           1           1     1035    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -64.5108   0.000778844       59.4014     0.07959           1     1189    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -63.8422    0.00972292        77.085           1           1     1325    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -62.7181    0.00412006       85.1861           1           1     1463    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -61.8249    0.00519526       16.2407        0.15           1     1596    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -61.3425    0.00610444       19.9453      0.7333      0.7333     1751    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -61.1381     0.0143359       18.6891       1.588      0.1588     1921    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399      -60.9023    0.00997876        127.04           1           1     2066    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -60.7426    0.00652297       10.1509      0.6732    0.006732     2201    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -60.6452     0.0012834       6.68036          10           1     2346    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -60.5772    0.00870035       28.6923      0.1978           1     2491    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -60.4702   0.000595175       26.1964           1           1     2617    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -60.4202     0.0022105       5.16321           1           1     2767    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -60.3991   0.000233273       4.06484      0.2118      0.2118     2903    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -60.3987     0.0027845       8.05299      0.5123           1     2905    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.5 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  15.8 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -46.2257     0.0556852       20.6206           1           1      107    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -42.9975      0.010377       6.10709           1           1      219    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -42.5844     0.0128659       1.67078           1           1      333    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -42.5523    0.00178182        1.3981      0.4098           1      444    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499       -42.546    9.0657e-05      0.372175      0.2306      0.2306      552    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -42.5451   0.000227684      0.257869      0.8402      0.8402      660    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699      -42.5449   0.000221749      0.191164           1           1      769    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      726      -42.5449   7.28821e-05     0.0217593           1           1      800    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.6 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.6 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -50.7704     0.0327903       8.86357      0.3825           1      103    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -49.8904    0.00185104      0.825557           1           1      209    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -49.8709     0.0002778     0.0919515           1           1      315    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      380      -49.8707   5.85468e-05     0.0159294           1           1      400    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.3 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.9 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -60.5772      0.026112       15.8169           1           1      115    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199      -56.6296    0.00768389       6.24341           1           1      231    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299       -56.175     0.0052399       3.06407           1           1      343    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -56.1091    0.00090699      0.878427           1           1      455    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -56.1046   0.000234872      0.342135      0.6996      0.6996      566    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599      -56.1028   0.000511874      0.078449           1           1      683    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      696      -56.1027   1.41759e-05     0.0149007      0.8373      0.8373      795    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.5 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  15.0 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99       -54.845      0.073953       14.9402           1           1      108    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -54.0226    0.00678683       1.71189           1           1      215    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -53.9975   0.000602911      0.215607           1           1      321    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399       -53.997   0.000136503     0.0262235           1           1      425    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      447       -53.997   1.43408e-05     0.0117891      0.8898      0.8898      476    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.5 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.8 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_4<span class="sc">$</span>chosen_indices <span class="co"># p=4</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_4 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691241 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.686222   0.000745751       0.40544           1           1      124    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.681217   0.000128819      0.435336      0.4765      0.4765      248    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.676336     0.0225626       1.25723           1           1      358    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399       -0.6726    0.00343067       1.74735      0.2367           1      474    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499     -0.668435   0.000584329      0.199222           1           1      592    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.667233    0.00224252      0.572559           1           1      708    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699     -0.665125     0.0023613      0.618898      0.4536           1      829    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.664348   6.42351e-05      0.260774           1           1      947    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.663374   0.000281102      0.168695           1           1     1066    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.662806   9.45387e-05      0.154263      0.8798      0.8798     1178    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.662247   9.24914e-05      0.403607     0.09055           1     1299    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.661543   0.000110699      0.222306           1           1     1414    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.661149   0.000176552      0.270254      0.3943      0.3943     1536    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399     -0.660948   0.000335368      0.400587      0.1989           1     1652    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.660486   0.000777552      0.426421       0.792       0.792     1769    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.660087   0.000271057      0.184392           1           1     1887    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.659921   0.000206238      0.296766       0.129           1     2006    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799     -0.659668    6.4088e-05      0.250753      0.2061      0.2061     2124    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899     -0.659599   9.23697e-05     0.0862391      0.9613      0.9613     2242    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.659392   0.000438955      0.118498           1           1     2360    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.659391   6.64978e-05      0.153964           1           1     2361    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  1.2 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  13.1 seconds.
0/2: Initial log joint probability = -0.733884 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.725907   0.000287557      0.540895      0.4559      0.4559      115    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -0.71976   0.000629491      0.413357           1           1      226    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299     -0.715846   0.000585507      0.346027           1           1      334    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.714407    0.00148528      0.612547           1           1      445    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.713412    0.00190968      0.151451      0.3382           1      553    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.712435     0.0017316      0.204436           1           1      662    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.711948    0.00236314      0.195903           1           1      771    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.711535   8.31211e-05     0.0871216      0.8437      0.8437      880    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899     -0.711437   0.000183593     0.0333651           1           1      994    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.711395   0.000144241     0.0449627           1           1     1104    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099     -0.711336   0.000361724      0.082634           1           1     1215    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.711295   6.50337e-05     0.0526228      0.2801      0.2801     1330    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299     -0.711244   7.18801e-05     0.0201101      0.9815      0.9815     1440    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399     -0.711233    3.0287e-05     0.0310321           1           1     1544    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.711226   0.000156949     0.0346214           1           1     1651    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.711205    4.2142e-05     0.0477756           1           1     1760    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.711187   2.92778e-05     0.0230791           1           1     1870    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799     -0.711181   6.49512e-06    0.00676379           1           1     1976    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899     -0.711179    1.2335e-05    0.00644462           1           1     2082    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1926     -0.711179   9.05335e-06    0.00381552           1           1     2112    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  1.0 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  15.0 seconds.
0/3: Initial log joint probability = -0.799593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.783165    0.00166556      0.167838           1           1      102    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.775367    0.00432332      0.321143           1           1      204    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.772043    0.00237918     0.0747594           1           1      311    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.771528   0.000261396     0.0560361           1           1      413    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.771245   0.000448878     0.0380031           1           1      515    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599     -0.771174   7.67832e-05     0.0147027           1           1      621    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.771157   5.80925e-05     0.0100414      0.5335      0.5335      724    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      799     -0.771153    2.8979e-06    0.00438074      0.6657      0.6657      834    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      867     -0.771152   7.00512e-06    0.00141842           1           1      907    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.5 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  14.4 seconds.
0/4: Initial log joint probability = -0.871315 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99       -0.8611    0.00175721       1.44505      0.3965      0.3965      115    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.853027    0.00630244      0.676716           1           1      230    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299     -0.841595   0.000147847       1.47677      0.3516      0.3516      339    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399     -0.835197    0.00144158      0.535978      0.4736      0.4736      457    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499       -0.8312    0.00211189      0.756135      0.5027           1      573    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.824599   0.000705547      0.439922           1           1      690    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699     -0.822665    0.00032092      0.735843      0.4257           1      807    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799     -0.821569   0.000591312      0.203172           1           1      919    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.820304   0.000310298      0.357722           1           1     1033    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.817523    0.00193833      0.434069           1           1     1148    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.813834   0.000591297      0.593923           1           1     1259    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.810412    0.00183667      0.997969       0.475       0.475     1374    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.808131   0.000162275      0.548473           1           1     1485    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.807242     0.0013655      0.217616           1           1     1601    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.806485    0.00191634      0.302299           1           1     1710    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599     -0.805653   0.000977239       0.28165           1           1     1823    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.805151   0.000535285      0.315374           1           1     1938    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799      -0.80478   7.29742e-05     0.0818626           1           1     2059    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.804483   0.000111609      0.114068           1           1     2174    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.804311   0.000129984      0.187036           1           1     2284    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000      -0.80431   1.33661e-05      0.084307      0.5695      0.5695     2285    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  1.3 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  14.5 seconds.
0/5: Initial log joint probability = -0.729812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99     -0.713091     0.0059968      0.358476           1           1      104    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.709445   0.000919685      0.107214           1           1      209    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.708457    0.00287586       0.17353           1           1      318    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.708109   0.000376771      0.065798       0.463       0.463      425    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499     -0.708006   0.000370373     0.0176704           1           1      534    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.707977   0.000152561      0.023176           1           1      639    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.707961   2.47055e-05    0.00952345           1           1      745    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.707952   7.51392e-05    0.00569059           1           1      851    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.707948   2.20055e-05    0.00388032           1           1      958    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      999     -0.707947     6.428e-05    0.00379515           1           1     1063    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:     1020     -0.707947   6.55171e-06    0.00131786           1           1     1086    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.6 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.7 seconds.
0/6: Initial log joint probability = -0.917059 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916194   0.000391536       1.01224           1           1      134    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.915225   8.43183e-05      0.664889           1           1      280    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299      -0.91475   0.000327495      0.707987           1           1      405    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.913484   2.95094e-05      0.856673           1           1      534    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.912139    0.00206442       5.55386           1           1      676    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.907997   0.000868172       9.14088      0.1665      0.1665      815    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.905975   0.000438159       1.36982        1.35       0.135      951    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.905047    8.4032e-06      0.741295    0.002165           1     1124    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.904709   6.43587e-05      0.683568      0.0504           1     1377    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999     -0.904214    0.00019545       1.20249           1           1     1529    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.902682   0.000832864       6.41481      0.1401           1     1660    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.901769   5.12598e-05       3.97258     0.03967           1     1792    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299     -0.901335   2.88598e-05      0.272139      0.7191      0.7191     1919    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.900961   0.000181138        1.4996      0.4439           1     2056    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.900508   0.000107384       1.19142           1           1     2202    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.899942   8.29202e-05       3.09414      0.1802           1     2340    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.899406   0.000145864       2.63064           1           1     2478    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.899092   2.01432e-05      0.413415      0.2026     0.02026     2604    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.898815   5.81002e-05      0.452796           1           1     2787    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.898606   8.86732e-06       0.62816     0.02381           1     2925    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000     -0.898606   7.39578e-06      0.540777      0.2405     0.02405     2927    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.7 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  15.6 seconds.
0/7: Initial log joint probability = -0.679173 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99     -0.674236   0.000316548      0.271141           1           1      108    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.671769     0.0031583      0.935913           1           1      217    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.669334   0.000441999      0.240848           1           1      329    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.668173   0.000439687      0.177276           1           1      441    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.667238    0.00152512      0.364352           1           1      555    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.666357   0.000152136      0.131739           1           1      666    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.665875   0.000105853       0.16494      0.6211      0.6211      779    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.665753   8.37527e-05     0.0479973           1           1      889    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.665534   0.000895469      0.177663           1           1     1000    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.665289   0.000541723      0.122107           1           1     1108    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099     -0.665086   2.55212e-05      0.111102      0.5824      0.5824     1212    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.664977   3.71496e-05     0.0424938           1           1     1318    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299     -0.664952   7.75182e-05      0.115358      0.3473      0.3473     1426    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.664914    0.00050147     0.0548167           1           1     1534    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.664868     0.0001067     0.0577688           1           1     1648    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.664835   0.000164127     0.0392986           1           1     1754    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699     -0.664824   0.000114608     0.0658284           1           1     1868    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799      -0.66482   4.86909e-05     0.0102738           1           1     1976    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899     -0.664817   2.59725e-05     0.0196331           1           1     2083    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1979     -0.664816   2.63875e-06     0.0033068           1           1     2170    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  1.0 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.6 seconds.
0/8: Initial log joint probability = -0.801845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.787305     0.0046558      0.317448           1           1      105    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.783126    0.00141146      0.281302           1           1      210    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -0.78042   0.000517976      0.234412      0.5912      0.5912      319    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.779148    0.00202008      0.106995           1           1      425    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.778504   0.000221714      0.195232      0.8589      0.8589      529    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.777652    0.00136029      0.137489      0.4482           1      635    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699     -0.777326     0.0010104     0.0650586           1           1      739    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799     -0.777104   9.62403e-05     0.0313904           1           1      846    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899     -0.777048   3.33447e-05     0.0155888           1           1      957    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999     -0.777013   0.000191408     0.0178366           1           1     1068    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.776973    6.4864e-05     0.0157441      0.3867      0.3867     1175    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199     -0.776951   0.000109881     0.0203618      0.4931      0.4931     1282    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299     -0.776941   0.000645605      0.014722           1           1     1386    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.776932    0.00016949     0.0127023           1           1     1491    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499     -0.776927   4.78553e-05     0.0036995           1           1     1597    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.776926   6.03027e-05    0.00300261           1           1     1705    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1696     -0.776925   7.31927e-06    0.00157287           1           1     1807    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.9 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  13.9 seconds.
0/9: Initial log joint probability = -0.809753 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.800664   0.000322634       0.78218      0.5898      0.5898      104    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.796854   0.000319551      0.397641      0.5779      0.5779      216    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299     -0.795279    0.00282378      0.285681           1           1      322    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.794237    0.00126796      0.197527       0.327           1      436    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499     -0.793178     0.0013889      0.149045           1           1      549    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.792446   0.000670416       0.16942           1           1      661    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.791899   0.000895492       0.16798           1           1      769    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799      -0.79138   0.000172561     0.0807636           1           1      881    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.791126   3.76551e-05       0.04931           1           1      991    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.791014   0.000124629     0.0415127           1           1     1096    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.790958   0.000156383     0.0404575           1           1     1205    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199     -0.790937   3.33236e-05     0.0194217           1           1     1310    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.790923   0.000164561     0.0188711           1           1     1422    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.790909   1.94311e-05     0.0312333      0.3566      0.3566     1529    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.790906   1.55217e-05    0.00883747           1           1     1639    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599     -0.790904   1.38354e-05    0.00565555           1           1     1742    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.790902   7.41641e-06    0.00668448           1           1     1851    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1775     -0.790901   1.89314e-05    0.00341216           1           1     1931    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  1.1 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.2 seconds.
0/10: Initial log joint probability = -0.752982 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.746022    0.00428504      0.451436           1           1      107    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -0.74285    0.00229473      0.313744           1           1      211    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -0.74218    0.00099505      0.112803           1           1      317    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.742056   2.09519e-05      0.024335      0.6584      0.6584      422    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499     -0.742037   0.000121417       0.01791           1           1      528    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599     -0.742023   2.39949e-05    0.00425121           1           1      633    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      699     -0.742021   5.29306e-05      0.003013           1           1      743    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      799     -0.742019   2.28674e-06    0.00649224      0.5859      0.5859      852    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      800     -0.742019   2.67416e-06    0.00189298           1           1      853    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.5 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.6 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>prior_ma_5 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -69.124 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99      -50.7065     0.0506984       20.9819           1           1      119    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199      -47.2165    0.00267318       7.94676           1           1      233    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299      -46.5637    0.00583444       7.24755           1           1      349    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399      -46.4311   0.000215633       1.12438      0.8091      0.8091      470    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -46.4103   0.000930226      0.552429           1           1      580    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599      -46.4049   0.000563075      0.463755           1           1      696    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699      -46.4041   0.000501485      0.109507           1           1      806    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799       -46.404   7.09703e-05     0.0469202           1           1      921    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      805       -46.404   1.82071e-05     0.0521529           1           1      928    
0/1: Optimization terminated normally:  
0/1:   Convergence detected: relative gradient magnitude is below tolerance 
0/1: Finished in  0.6 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  14.1 seconds.
0/2: Initial log joint probability = -73.3883 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99      -50.5718    0.00938733       15.5624           1           1      111    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199      -47.4731     0.0113266         8.964      0.4323           1      225    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299      -47.2503    0.00316996       1.44621           1           1      336    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399      -47.2328    0.00127521      0.486676           1           1      443    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499      -47.2314    0.00171128      0.113478           1           1      549    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599      -47.2312    0.00015519     0.0414674       0.299           1      663    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      614      -47.2312   2.79557e-05     0.0259449           1           1      678    
0/2: Optimization terminated normally:  
0/2:   Convergence detected: relative gradient magnitude is below tolerance 
0/2: Finished in  0.5 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  13.8 seconds.
0/3: Initial log joint probability = -79.9593 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99      -53.4544     0.0322844       19.7877      0.3116      0.3116      104    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199      -52.1543    0.00848799       2.05386           1           1      209    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299      -52.1302    0.00106234      0.352588      0.7183      0.7183      314    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399       -52.129   0.000205732     0.0938194      0.5031           1      422    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      426       -52.129   9.93058e-06     0.0118966           1           1      451    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.3 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  14.3 seconds.
0/4: Initial log joint probability = -87.1314 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99      -69.4816     0.0508234       41.6275      0.4944           1      124    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199      -62.5735      0.055924       34.6895           1           1      243    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299      -60.8892    0.00575321       29.1087           1           1      360    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399       -60.277    0.00261488       9.47877      0.5083           1      480    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499      -60.1663     0.0204564       8.71198           1           1      593    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599      -60.1312     0.0026628       2.57648           1           1      708    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699       -60.121    0.00011212       1.66632      0.2354      0.2354      829    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799      -60.1196   0.000307541      0.281933           1           1      945    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899      -60.1191   0.000333329      0.287291           1           1     1062    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999      -60.1189   9.93776e-06       0.15545      0.1266           1     1181    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1028      -60.1189   8.67265e-05     0.0577611           1           1     1215    
0/4: Optimization terminated normally:  
0/4:   Convergence detected: relative gradient magnitude is below tolerance 
0/4: Finished in  0.9 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  14.9 seconds.
0/5: Initial log joint probability = -72.9812 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -43.8887     0.0398169       9.21195      0.9327      0.9327      104    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199      -42.9007   0.000821576       1.12293      0.3204      0.3204      211    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299      -42.8822    0.00134064      0.191305           1           1      322    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399      -42.8817   0.000615296     0.0333878           1           1      428    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      449      -42.8817   1.35287e-05    0.00873995           1           1      481    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.4 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  13.2 seconds.
0/6: Initial log joint probability = -91.7051 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99      -86.1439     0.0172723       171.254      0.1456     0.01456      145    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199      -79.6316     0.0131218       169.098           1           1      274    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299       -73.334     0.0172486       98.9048      0.2686           1      423    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399      -70.2539     0.0104095       94.7709           1           1      556    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499       -66.986     0.0173632        133.41      0.6101      0.6101      696    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599      -65.5332    0.00603891       97.7376       0.298       0.298      824    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699      -64.8255     0.0021454       178.041           1           1      953    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799      -63.5971    0.00122301       25.6882           1           1     1096    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899      -62.9159    0.00555767       15.0831           1           1     1239    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999      -62.7802   0.000794471       11.1334           1           1     1382    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099      -62.5624    0.00221659       164.478      0.4697      0.4697     1517    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199      -62.3748    0.00634247       9.57943       3.677    0.003677     1691    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -62.1954     0.0119573       9.13789      0.3297           1     1847    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399       -62.054   0.000963424       8.52932           1           1     1981    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499      -61.9163    0.00454084       11.9741           1           1     2119    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599      -61.8452    0.00328508       9.07212           1           1     2254    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699      -61.7762   0.000984063       64.0746      0.6931      0.6931     2377    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799      -61.6556    0.00418408       30.2089      0.4661      0.4661     2513    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899      -61.5249   0.000634402       9.53909           1           1     2639    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999      -61.4727   0.000250212       7.45252           1           1     2773    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -61.4727    0.00010522       5.15394     0.02502           1     2775    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.8 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  15.1 seconds.
0/7: Initial log joint probability = -67.9172 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -48.1486     0.0366301       36.4733           1           1      108    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199      -44.0299      0.033173       8.29411           1           1      215    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299      -43.3034    0.00112385       1.62964           1           1      323    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399      -43.2287    0.00292245       1.83783           1           1      431    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499      -43.2136   0.000256569      0.372171           1           1      541    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599      -43.2118   9.07779e-05      0.193562           1           1      654    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699      -43.2113    0.00023314     0.0820587           1           1      762    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799      -43.2112   8.03782e-06     0.0769971      0.5357      0.5357      869    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      800      -43.2112   1.62015e-05     0.0315974           1           1      870    
0/7: Optimization terminated normally:  
0/7:   Convergence detected: relative gradient magnitude is below tolerance 
0/7: Finished in  0.6 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  13.9 seconds.
0/8: Initial log joint probability = -80.1845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99      -51.7963      0.105388       24.2635           1           1      105    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199      -50.5552    0.00827119       1.40429           1           1      209    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299      -50.5394   2.87926e-05      0.153066      0.6203      0.6203      315    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399      -50.5389   8.32981e-05     0.0162651           1           1      419    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      410      -50.5389   1.40092e-05     0.0124852           1           1      430    
0/8: Optimization terminated normally:  
0/8:   Convergence detected: relative gradient magnitude is below tolerance 
0/8: Finished in  0.4 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  15.0 seconds.
0/9: Initial log joint probability = -80.9752 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99      -60.9422     0.0424075       73.6555           1           1      111    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199       -57.125    0.00421422       6.96156           1           1      228    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299      -56.7246   0.000531337        2.4337      0.8722      0.8722      337    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399      -56.6849   0.000177204      0.725711      0.5314      0.5314      449    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -56.6816   0.000318465      0.249646           1           1      554    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599      -56.6808   0.000160836      0.121637           1           1      670    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699      -56.6807   0.000270092     0.0806691           1           1      782    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      718      -56.6807   8.48561e-05     0.0162965           1           1      805    
0/9: Optimization terminated normally:  
0/9:   Convergence detected: relative gradient magnitude is below tolerance 
0/9: Finished in  0.6 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.4 seconds.
0/10: Initial log joint probability = -75.2981 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99      -55.2765     0.0175649       8.15187           1           1      107    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199      -54.4025    0.00387963       1.80932           1           1      211    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299      -54.3518    0.00067072      0.549571           1           1      316    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399      -54.3486   0.000766072      0.229348      0.2941           1      424    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      497      -54.3482   5.22415e-05     0.0097781           1           1      527    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.4 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  15.0 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>noprior_ma_5 <span class="ot">=</span> <span class="fu">fun_predict_stan_results</span>(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, <span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0/1: Initial log joint probability = -0.691241 
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:       99     -0.687035   0.000557614      0.629937      0.6742      0.6742      124    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      199     -0.682483   4.81622e-05      0.354477      0.2852      0.2852      243    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      299     -0.678977   0.000280033      0.299132           1           1      353    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      399     -0.677585   0.000257258      0.359614      0.3445      0.3445      473    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      499      -0.67691   0.000608447      0.168566           1           1      584    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      599     -0.675476   0.000573013      0.741284           1           1      699    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      699     -0.675088    0.00284162      0.318116           1           1      817    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      799     -0.672628     0.0139807       1.55653           1           1      933    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      899     -0.670438   0.000490413      0.741808      0.1373      0.5888     1042    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:      999     -0.669755   0.000675349      0.312804           1           1     1161    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1099     -0.669319   6.64895e-05      0.212037           1           1     1283    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1199     -0.669097   0.000203364       0.11935           1           1     1402    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1299     -0.668572   8.59789e-05      0.239964           1           1     1519    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1399     -0.667791   0.000159063      0.221728      0.3846           1     1636    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1499     -0.667064   0.000127268     0.0921581      0.1452           1     1749    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1599     -0.666961   4.68523e-05     0.0470538           1           1     1864    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1699     -0.666935   3.46825e-05      0.125383      0.3435      0.3435     1980    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1799     -0.666828    0.00140135      0.143367           1           1     2096    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1899     -0.666724   0.000434881      0.147173           1           1     2219    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     1999     -0.666658   1.04496e-05     0.0476395           1           1     2331    
0/1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/1:     2000     -0.666658   0.000176627      0.032344           1           1     2332    
0/1: Optimization terminated normally:  
0/1:   Maximum number of iterations hit, may not be at an optima 
0/1: Finished in  1.3 seconds.
0/1: Calculating Hessian 
0/1: Calculating inverse of Cholesky factor 
0/1: Generating draws 
0/1: iteration: 0 
0/1: iteration: 100 
0/1: iteration: 200 
0/1: iteration: 300 
0/1: iteration: 400 
0/1: iteration: 500 
0/1: iteration: 600 
0/1: iteration: 700 
0/1: iteration: 800 
0/1: iteration: 900 
0/1: Finished in  14.7 seconds.
0/2: Initial log joint probability = -0.733884 
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:       99     -0.727081    0.00138918      0.583655           1           1      106    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      199     -0.722717    0.00123403      0.569818           1           1      213    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      299     -0.719823   0.000253796      0.300578      0.8924      0.8924      323    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      399     -0.718519   0.000637368      0.150204           1           1      433    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      499     -0.717468    0.00081368      0.302308      0.6037      0.6037      538    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      599     -0.716723   9.84065e-05     0.0890328           1           1      646    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      699     -0.716407   0.000129376     0.0997815      0.4522      0.4522      759    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      799     -0.716241   0.000104675     0.0450158           1           1      865    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      899     -0.716174   0.000106091     0.0790629      0.7238      0.7238      972    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:      999     -0.716123   9.95001e-06     0.0437372      0.7373      0.7373     1078    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1099      -0.71608   0.000248258     0.0778629      0.3878           1     1185    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1199     -0.716041   0.000895298     0.0886726           1           1     1294    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1299        -0.716    0.00076934     0.0631289           1           1     1401    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1399     -0.715982   0.000173077     0.0188605           1           1     1507    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1499     -0.715969    0.00013932     0.0210324           1           1     1614    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1599     -0.715957   0.000130389     0.0408513           1           1     1725    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1699     -0.715954   2.90845e-06    0.00859186           1           1     1830    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1799     -0.715951   9.10112e-06    0.00966705           1           1     1938    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1899     -0.715948   5.45726e-05     0.0135426           1           1     2042    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     1999     -0.715945   7.96608e-05    0.00842505           1           1     2152    
0/2:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/2:     2000     -0.715945   0.000414168     0.0268204           1           1     2153    
0/2: Optimization terminated normally:  
0/2:   Maximum number of iterations hit, may not be at an optima 
0/2: Finished in  1.3 seconds.
0/2: Calculating Hessian 
0/2: Calculating inverse of Cholesky factor 
0/2: Generating draws 
0/2: iteration: 0 
0/2: iteration: 100 
0/2: iteration: 200 
0/2: iteration: 300 
0/2: iteration: 400 
0/2: iteration: 500 
0/2: iteration: 600 
0/2: iteration: 700 
0/2: iteration: 800 
0/2: iteration: 900 
0/2: Finished in  14.4 seconds.
0/3: Initial log joint probability = -0.799594 
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:       99     -0.788036    0.00577187      0.440605           1           1      103    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      199     -0.784366   0.000892125      0.275514           1           1      209    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      299     -0.783619     0.0012176     0.0819494           1           1      317    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      399     -0.783374   0.000231349     0.0482371           1           1      423    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      499     -0.783317   2.72472e-05     0.0224111           1           1      528    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      599       -0.7833   2.87142e-05     0.0137333      0.5983      0.5983      632    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      699     -0.783295   4.29729e-05    0.00697438           1           1      737    
0/3:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/3:      739     -0.783295   1.19759e-05    0.00192513           1           1      778    
0/3: Optimization terminated normally:  
0/3:   Convergence detected: relative gradient magnitude is below tolerance 
0/3: Finished in  0.7 seconds.
0/3: Calculating Hessian 
0/3: Calculating inverse of Cholesky factor 
0/3: Generating draws 
0/3: iteration: 0 
0/3: iteration: 100 
0/3: iteration: 200 
0/3: iteration: 300 
0/3: iteration: 400 
0/3: iteration: 500 
0/3: iteration: 600 
0/3: iteration: 700 
0/3: iteration: 800 
0/3: iteration: 900 
0/3: Finished in  14.9 seconds.
0/4: Initial log joint probability = -0.871315 
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:       99     -0.863795    0.00811083      0.897367           1           1      114    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      199     -0.858403   0.000677589      0.566903           1           1      226    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      299     -0.852279   2.65267e-05       2.61515      0.7447      0.7447      340    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      399      -0.84483     0.0146726        2.4833           1           1      454    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      499     -0.839888     0.0133684        2.9134           1           1      562    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      599     -0.835607    0.00052442      0.623932           1           1      676    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      699     -0.831626   0.000269193       1.90383      0.0493           1      789    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      799     -0.828125   0.000210839       1.00262           1           1      907    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      899     -0.826703   0.000151042      0.480512           1           1     1017    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:      999     -0.825205   0.000340784      0.599569      0.8389      0.8389     1134    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1099     -0.824509    0.00116967      0.586263           1           1     1247    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1199     -0.822711    0.00436846      0.484626           1           1     1369    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1299     -0.820607   0.000310664       1.28611           1           1     1483    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1399     -0.818408   0.000513373      0.544909           1           1     1600    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1499     -0.817412   0.000289961       0.36206           1           1     1712    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1599     -0.816082   0.000199982      0.107016           1           1     1826    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1699     -0.815711   0.000242857      0.472299      0.5185           1     1941    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1799     -0.815466   0.000471462      0.137526      0.7287     0.07287     2050    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1899     -0.814838   0.000583899      0.258387           1           1     2164    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     1999     -0.814257   0.000520081      0.304288      0.6971      0.6971     2278    
0/4:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/4:     2000     -0.814256   0.000115812       0.15076      0.8399      0.8399     2279    
0/4: Optimization terminated normally:  
0/4:   Maximum number of iterations hit, may not be at an optima 
0/4: Finished in  1.5 seconds.
0/4: Calculating Hessian 
0/4: Calculating inverse of Cholesky factor 
0/4: Generating draws 
0/4: iteration: 0 
0/4: iteration: 100 
0/4: iteration: 200 
0/4: iteration: 300 
0/4: iteration: 400 
0/4: iteration: 500 
0/4: iteration: 600 
0/4: iteration: 700 
0/4: iteration: 800 
0/4: iteration: 900 
0/4: Finished in  15.9 seconds.
0/5: Initial log joint probability = -0.729813 
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:       99      -0.71831    0.00218303      0.434193      0.8983      0.8983      103    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      199     -0.714061   0.000234382      0.142005           1           1      205    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      299     -0.712935    0.00231697      0.210221           1           1      314    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      399     -0.712654   0.000133303     0.0703214      0.2736      0.2736      421    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      499      -0.71259   4.92806e-05     0.0190138      0.8287      0.8287      527    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      599     -0.712569   0.000116567     0.0149141           1           1      634    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      699     -0.712562    7.8702e-05     0.0141621           1           1      739    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      799     -0.712559   1.93867e-05    0.00443512           1           1      847    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      899     -0.712558   3.81655e-05    0.00376101           1           1      956    
0/5:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/5:      926     -0.712558   1.04001e-05    0.00179316           1           1      987    
0/5: Optimization terminated normally:  
0/5:   Convergence detected: relative gradient magnitude is below tolerance 
0/5: Finished in  0.6 seconds.
0/5: Calculating Hessian 
0/5: Calculating inverse of Cholesky factor 
0/5: Generating draws 
0/5: iteration: 0 
0/5: iteration: 100 
0/5: iteration: 200 
0/5: iteration: 300 
0/5: iteration: 400 
0/5: iteration: 500 
0/5: iteration: 600 
0/5: iteration: 700 
0/5: iteration: 800 
0/5: iteration: 900 
0/5: Finished in  14.4 seconds.
0/6: Initial log joint probability = -0.917075 
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:       99     -0.916273   5.41228e-05       4.65767      0.3054           1      143    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      199     -0.915368   2.29515e-05       1.49697           1           1      283    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      299     -0.914483    3.0695e-05       1.61602           1           1      422    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      399     -0.914157    3.5886e-05       1.58413    0.007104           1      549    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      499     -0.913688    6.6924e-05       0.43963      0.8107      0.8107      711    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      599     -0.913286   7.99345e-05      0.574575           1           1      839    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      699     -0.911997   0.000258265        2.1453           1           1      974    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      799     -0.910788   0.000150673       2.50623           1           1     1107    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      899     -0.910374   0.000245578      0.581115           1           1     1308    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:      999     -0.909478    0.00158631       4.05494      0.9769      0.9769     1441    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1099     -0.908317   0.000239976       1.38607      0.1009      0.1009     1579    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1199     -0.907931   7.54048e-05       6.92588           1           1     1715    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1299      -0.90763     0.0003436      0.866399           1           1     1848    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1399     -0.906767   0.000443284       4.37336           1           1     1976    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1499     -0.906048   0.000828529       5.89264      0.3759      0.3759     2114    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1599     -0.905602      3.63e-05       5.42516    0.004487           1     2263    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1699     -0.905306   0.000134628       1.41176     0.07019           1     2386    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1799     -0.904837   7.77356e-05      0.224671           1           1     2538    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1899     -0.904664   3.90271e-05      0.413739           1           1     2710    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     1999     -0.904552   4.91731e-05      0.821905       1.123     0.01123     2848    
0/6:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/6:     2000      -0.90455   0.000151149      0.677403      0.1167           1     2850    
0/6: Optimization terminated normally:  
0/6:   Maximum number of iterations hit, may not be at an optima 
0/6: Finished in  1.7 seconds.
0/6: Calculating Hessian 
0/6: Calculating inverse of Cholesky factor 
0/6: Generating draws 
0/6: iteration: 0 
0/6: iteration: 100 
0/6: iteration: 200 
0/6: iteration: 300 
0/6: iteration: 400 
0/6: iteration: 500 
0/6: iteration: 600 
0/6: iteration: 700 
0/6: iteration: 800 
0/6: iteration: 900 
0/6: Finished in  15.3 seconds.
0/7: Initial log joint probability = -0.679173 
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:       99      -0.67565   0.000872569      0.366084       1.718      0.1718      116    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      199     -0.673095   0.000717738      0.490203           1           1      225    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      299     -0.671062   0.000311588      0.841236           1           1      336    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      399     -0.670002    0.00015725      0.181085           1           1      448    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      499     -0.669609   0.000204552      0.123103           1           1      558    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      599     -0.669265   0.000236252      0.373683      0.4528           1      667    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      699     -0.668984   2.52425e-05      0.203615      0.5593      0.5593      782    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      799     -0.668817   0.000123446     0.0837188           1           1      891    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      899     -0.668661    0.00112533      0.358583           1           1     1000    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:      999     -0.668387   0.000696729      0.183269           1           1     1113    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1099     -0.668239   2.83595e-05     0.0424693      0.8427      0.8427     1223    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1199     -0.668218   3.16046e-05     0.0259455           1           1     1332    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1299     -0.668209   2.41527e-05      0.019524           1           1     1444    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1399     -0.668198   5.84467e-05     0.0485614      0.7161      0.7161     1551    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1499     -0.668175   0.000138554     0.0309438           1           1     1659    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1599     -0.668162    3.2212e-05     0.0334344      0.5037      0.5037     1768    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1699      -0.66815   0.000102493     0.0327261           1           1     1876    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1799     -0.668142   1.42217e-05     0.0157492           1           1     1985    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1899     -0.668139   7.02689e-06    0.00955672           1           1     2091    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     1999     -0.668136   7.81485e-06     0.0128844           1           1     2200    
0/7:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/7:     2000     -0.668136   1.27178e-05     0.0155901           1           1     2201    
0/7: Optimization terminated normally:  
0/7:   Maximum number of iterations hit, may not be at an optima 
0/7: Finished in  1.3 seconds.
0/7: Calculating Hessian 
0/7: Calculating inverse of Cholesky factor 
0/7: Generating draws 
0/7: iteration: 0 
0/7: iteration: 100 
0/7: iteration: 200 
0/7: iteration: 300 
0/7: iteration: 400 
0/7: iteration: 500 
0/7: iteration: 600 
0/7: iteration: 700 
0/7: iteration: 800 
0/7: iteration: 900 
0/7: Finished in  14.4 seconds.
0/8: Initial log joint probability = -0.801845 
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:       99     -0.789714     0.0056314      0.739556           1           1      104    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      199     -0.785435    0.00148206      0.329417           1           1      210    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      299     -0.783743   5.97721e-05     0.0719264           1           1      315    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      399     -0.782849    0.00047875      0.140075           1           1      422    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      499     -0.782253   0.000264132     0.0874036           1           1      528    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      599     -0.781265    0.00173192        0.1143           1           1      633    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      699      -0.78086    0.00051614     0.0768106           1           1      738    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      799     -0.780584    0.00148737     0.0806437           1           1      847    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      899     -0.780376   0.000776453     0.0772063           1           1      953    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:      999     -0.780105   0.000348139      0.114594      0.9192      0.9192     1056    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1099     -0.779978    0.00034876     0.0563704           1           1     1162    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1199     -0.779886   0.000194549     0.0239072           1           1     1268    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1299      -0.77984   0.000292853     0.0371621           1           1     1374    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1399     -0.779765   0.000151752     0.0490623      0.5826      0.5826     1477    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1499     -0.779699   3.93727e-05    0.00914117           1           1     1582    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1599     -0.779674   0.000592897     0.0525292           1           1     1686    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1699     -0.779659   0.000172702     0.0145311      0.2949           1     1790    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1799     -0.779655   3.54896e-05    0.00876173           1           1     1895    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1899     -0.779654   0.000342507    0.00834631           1           1     1998    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     1999     -0.779651   6.16527e-06    0.00627064      0.2406      0.2406     2103    
0/8:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/8:     2000     -0.779651   3.20108e-05    0.00293803           1           1     2104    
0/8: Optimization terminated normally:  
0/8:   Maximum number of iterations hit, may not be at an optima 
0/8: Finished in  1.3 seconds.
0/8: Calculating Hessian 
0/8: Calculating inverse of Cholesky factor 
0/8: Generating draws 
0/8: iteration: 0 
0/8: iteration: 100 
0/8: iteration: 200 
0/8: iteration: 300 
0/8: iteration: 400 
0/8: iteration: 500 
0/8: iteration: 600 
0/8: iteration: 700 
0/8: iteration: 800 
0/8: iteration: 900 
0/8: Finished in  14.3 seconds.
0/9: Initial log joint probability = -0.809753 
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:       99     -0.802757   0.000177343       1.05848      0.3803           1      106    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      199     -0.798722   0.000802986      0.495616           1           1      222    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      299     -0.796833    0.00149267      0.168286           1           1      336    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      399     -0.796227    7.7261e-05      0.458445      0.6164      0.6164      450    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      499      -0.79558    0.00419307      0.289497           1           1      562    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      599     -0.795016   0.000658328      0.310606           1           1      680    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      699     -0.794617   0.000664706      0.192633           1           1      785    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      799     -0.794108    0.00029352      0.377341       0.435       0.435      896    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      899     -0.793581   6.54684e-05     0.0833665      0.4341      0.4341     1004    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:      999     -0.793448   2.68186e-05     0.0973386      0.1428           1     1120    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1099     -0.793334    8.6459e-05     0.0480146      0.4247      0.4247     1232    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1199     -0.793255   3.63194e-05     0.0435857           1           1     1340    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1299     -0.793219   9.46939e-05     0.0327696           1           1     1446    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1399     -0.793138    0.00111262     0.0688245           1           1     1557    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1499     -0.793052   3.74332e-05     0.0272902           1           1     1671    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1599        -0.793   2.75164e-05      0.029531           1           1     1790    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1699     -0.792985   5.58406e-05     0.0310808           1           1     1898    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1799     -0.792964   3.96165e-05     0.0333513           1           1     2007    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1899     -0.792907   0.000569287     0.0574066           1           1     2123    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     1999     -0.792876   3.74829e-05     0.0241756           1           1     2235    
0/9:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/9:     2000     -0.792876    2.0686e-05     0.0288523           1           1     2236    
0/9: Optimization terminated normally:  
0/9:   Maximum number of iterations hit, may not be at an optima 
0/9: Finished in  1.4 seconds.
0/9: Calculating Hessian 
0/9: Calculating inverse of Cholesky factor 
0/9: Generating draws 
0/9: iteration: 0 
0/9: iteration: 100 
0/9: iteration: 200 
0/9: iteration: 300 
0/9: iteration: 400 
0/9: iteration: 500 
0/9: iteration: 600 
0/9: iteration: 700 
0/9: iteration: 800 
0/9: iteration: 900 
0/9: Finished in  14.6 seconds.
0/10: Initial log joint probability = -0.752982 
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:       99     -0.746783    0.00190067      0.345146           1           1      110    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      199     -0.744843    0.00149448      0.160127           1           1      219    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      299     -0.743862   0.000512648     0.0805189           1           1      324    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      399     -0.743661    7.2682e-05     0.0345774           1           1      433    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      499     -0.743632   5.08689e-05     0.0214258           1           1      538    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      599     -0.743616   0.000199709     0.0120496           1           1      646    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      699     -0.743614   8.91933e-06    0.00355071      0.8389      0.8389      756    
0/10:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  
0/10:      748     -0.743614   8.73187e-06    0.00157695           1           1      807    
0/10: Optimization terminated normally:  
0/10:   Convergence detected: relative gradient magnitude is below tolerance 
0/10: Finished in  0.7 seconds.
0/10: Calculating Hessian 
0/10: Calculating inverse of Cholesky factor 
0/10: Generating draws 
0/10: iteration: 0 
0/10: iteration: 100 
0/10: iteration: 200 
0/10: iteration: 300 
0/10: iteration: 400 
0/10: iteration: 500 
0/10: iteration: 600 
0/10: iteration: 700 
0/10: iteration: 800 
0/10: iteration: 900 
0/10: Finished in  14.8 seconds.</code></pre>
</div>
</div>
<section id="gradient-conditions" class="level4">
<h4 class="anchored" data-anchor-id="gradient-conditions">Gradient conditions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_prior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>p31<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(prior_ma_5<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>chosen_indices <span class="ot">=</span> fws_noprior_5<span class="sc">$</span>chosen_indices <span class="co"># p=5</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>p32<span class="ot">=</span>hplcparam_candidates_df <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(xpH<span class="sc">==</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lines =</span> <span class="fu">row_number</span>())<span class="sc">%&gt;%</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(noprior_ma_5<span class="sc">$</span>cresults<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">lines=</span><span class="fu">as.integer</span>(c))) <span class="sc">%&gt;%</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">selected =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(lines <span class="sc">%in%</span> chosen_indices,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_f =</span> <span class="fu">if_else</span>(m<span class="sc">==</span><span class="dv">0</span>, <span class="st">"MeOH"</span>, <span class="st">"ACN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>tg, <span class="at">y=</span>fio, <span class="at">z=</span>qvar)) <span class="sc">+</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>()<span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(selected<span class="sc">==</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>m_f)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>iresults <span class="ot">=</span> <span class="fu">rbind</span>(prior_ma_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ref<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>                prior_ma_2<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>                 prior_ma_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_3<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>                 prior_ma_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_4<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>),</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>                 prior_ma_5<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_5"</span>),</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_5<span class="sc">$</span>iresults<span class="sc">%&gt;%</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_5"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ivar =</span> <span class="fu">if_else</span>(ivar<span class="sc">&gt;</span><span class="fl">1e6</span>,<span class="fl">1e6</span>,ivar)) <span class="sc">%&gt;%</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.factor</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB))</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>ivar))<span class="sc">+</span></span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>ivar, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"max(Var)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)<span class="sc">+</span></span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">1000000</span>))<span class="sc">+</span>    </span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a>idx_exemple_analytes <span class="ot">=</span> iresults <span class="sc">%&gt;%</span></span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">==</span><span class="st">"prior_ref"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ivar)<span class="sc">%&gt;%</span></span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which</span>(<span class="fu">row_number</span>() <span class="sc">%%</span> <span class="dv">100</span> <span class="sc">==</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(i)<span class="sc">%&gt;%</span><span class="fu">pull</span>()</span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a>iresults <span class="sc">%&gt;%</span></span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-f0d7a0da{}.cl-f0cd180e{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f0d186fa{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f0d1870e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f0d1b1e8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f0d1b1f2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f0d1b1fc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f0d1b1fd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f0d1b1fe{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f0d1b206{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-f0d7a0da"><thead><tr style="overflow-wrap:break-word;"><th class="cl-f0d1b1e8"><p class="cl-f0d186fa"><span class="cl-f0cd180e">method</span></p></th><th class="cl-f0d1b1f2"><p class="cl-f0d1870e"><span class="cl-f0cd180e">&lt;=1x</span></p></th><th class="cl-f0d1b1f2"><p class="cl-f0d1870e"><span class="cl-f0cd180e">&lt;=2x</span></p></th><th class="cl-f0d1b1f2"><p class="cl-f0d1870e"><span class="cl-f0cd180e">&lt;=3x</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-f0d1b1fc"><p class="cl-f0d186fa"><span class="cl-f0cd180e">noprior_3</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.000</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.012</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.108</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f0d1b1fc"><p class="cl-f0d186fa"><span class="cl-f0cd180e">noprior_4</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.000</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.176</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.350</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f0d1b1fc"><p class="cl-f0d186fa"><span class="cl-f0cd180e">noprior_5</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.086</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.348</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.530</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f0d1b1fc"><p class="cl-f0d186fa"><span class="cl-f0cd180e">noprior_ref</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.000</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.050</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.218</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f0d1b1fc"><p class="cl-f0d186fa"><span class="cl-f0cd180e">prior_2</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.002</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.772</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.838</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f0d1b1fc"><p class="cl-f0d186fa"><span class="cl-f0cd180e">prior_3</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.112</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.926</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.954</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f0d1b1fc"><p class="cl-f0d186fa"><span class="cl-f0cd180e">prior_4</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.826</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.932</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.956</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f0d1b1fc"><p class="cl-f0d186fa"><span class="cl-f0cd180e">prior_5</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.842</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.932</span></p></td><td class="cl-f0d1b1fd"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.956</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f0d1b1fe"><p class="cl-f0d186fa"><span class="cl-f0cd180e">prior_ref</span></p></td><td class="cl-f0d1b206"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.076</span></p></td><td class="cl-f0d1b206"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.960</span></p></td><td class="cl-f0d1b206"><p class="cl-f0d1870e"><span class="cl-f0cd180e">0.998</span></p></td></tr></tbody></table></div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>f55_1<span class="ot">=</span>iresults <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">1</span>),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=2x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">2</span>),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(ivar<span class="sc">&lt;=</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">&lt;=1x</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">&lt;=3x</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">"target"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>value,<span class="at">color=</span><span class="fu">as.factor</span>(target)))<span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Probability"</span>, <span class="at">y =</span> <span class="st">"Method"</span>, <span class="at">color =</span> <span class="st">"target"</span>)<span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.9</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>f55_1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prob.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>f55_1, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prob.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p31, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-prior-p5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-noprior-p5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p32, <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-noprior-p5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-maxvar.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"single-form-analytes-gra-maxvar.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>p31</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-gra-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>p32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-gra-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-gra-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>f33_1<span class="ot">=</span>p33</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>f55_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-gra-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="isocratic-conditions" class="level4">
<h4 class="anchored" data-anchor-id="isocratic-conditions">Isocratic conditions</h4>
<section id="individual-plots" class="level5">
<h5 class="anchored" data-anchor-id="individual-plots">Individual plots</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>plot_id <span class="ot">=</span> <span class="cf">function</span>(results) { </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  results <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>CV<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">ymin =</span> llog10tr, <span class="at">ymax =</span> ulog10tr), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>mlog10tr), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"log(tr)"</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">10</span>, <span class="at">name=</span><span class="st">"%CV"</span>)) <span class="sc">+</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(i<span class="sc">~</span>mod) <span class="sc">+</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>results_prior_ma_ref<span class="ot">&lt;-</span>prior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_ref<span class="ot">&lt;-</span>noprior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>results_prior_ma_2<span class="ot">&lt;-</span>prior_ma_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>results_prior_ma_3<span class="ot">&lt;-</span>prior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> mrgmisc<span class="sc">::</span><span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_3<span class="ot">&lt;-</span>noprior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a>results_prior_ma_4<span class="ot">&lt;-</span>prior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_4<span class="ot">&lt;-</span>noprior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a>results_prior_ma_5<span class="ot">&lt;-</span>prior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a>results_noprior_ma_5<span class="ot">&lt;-</span>noprior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span><span class="fu">as.integer</span>(c),</span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(fi_temp) <span class="sc">%&gt;%</span></span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(i <span class="sc">%in%</span> idx_exemple_analytes) <span class="sc">%&gt;%</span></span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PLOTS =</span> <span class="fu">ids_per_plot</span>(i,<span class="at">id_per_plot =</span> <span class="dv">5</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.[[<span class="st">"PLOTS"</span>]])</span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ref <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_ref,plot_id) </span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ref <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_ref,plot_id) </span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_2 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_2,plot_id) </span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_3 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_3,plot_id) </span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_3 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_3,plot_id) </span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_4 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_4,plot_id) </span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_4 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_4,plot_id) </span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_5 <span class="ot">=</span> <span class="fu">map</span>(results_prior_ma_5,plot_id) </span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_5 <span class="ot">=</span> <span class="fu">map</span>(results_noprior_ma_5,plot_id) </span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ref.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_ref[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-ref.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>plots_results_prior_ma_5[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-5.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>plots_results_prior_ma_5[[<span class="dv">1</span>]], <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"plots-results-prior-ma-5.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_ref </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_ref </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-3.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-4.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_3 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-5.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-6.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-7.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>plots_results_prior_ma_5  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-8.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>plots_results_noprior_ma_5 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-9.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combined" class="level5">
<h5 class="anchored" data-anchor-id="combined">Combined</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>fi_temp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">c=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">fi=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>plot_id <span class="ot">=</span> <span class="cf">function</span>(results) { </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  results <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>CV)) <span class="sc">+</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">ymin =</span> llog10tr, <span class="at">ymax =</span> ulog10tr), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>fi, <span class="at">y=</span>mlog10tr), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"log(tr)"</span>,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">1</span>, <span class="at">name=</span><span class="st">"%CV"</span>)) <span class="sc">+</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(i<span class="sc">~</span>mod) <span class="sc">+</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>izoresults <span class="ot">=</span> <span class="fu">rbind</span>( prior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_ref"</span>),</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_ref<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_ref"</span>),</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>                prior_ma_2<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_2"</span>),</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>                 prior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_3"</span>),</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_3<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_3"</span>),</span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>                 prior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_4"</span>),</span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_4<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_4"</span>),</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>                 prior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"prior_5"</span>),</span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>                 noprior_ma_5<span class="sc">$</span>izoresults<span class="sc">%&gt;%</span></span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">method =</span><span class="st">"noprior_5"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&lt;=</span><span class="fu">log10</span>(<span class="dv">100</span>))<span class="sc">%&gt;%</span></span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mlog10tr<span class="sc">&gt;=</span><span class="fu">log10</span>(<span class="dv">5</span>))<span class="sc">%&gt;%</span></span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c =</span> <span class="fu">as.numeric</span>(c),</span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">i=</span><span class="fu">as.integer</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(i,method,c)<span class="sc">%&gt;%</span></span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(i,method) <span class="sc">%&gt;%</span></span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">imaxcv =</span> <span class="fu">max</span>(CV), <span class="at">imincv =</span> <span class="fu">min</span>(CV), <span class="at">aveCV =</span> pracma<span class="sc">::</span><span class="fu">trapz</span>(c, CV)<span class="sc">/</span>(<span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">imaxcv =</span> <span class="fu">if_else</span>(imaxcv<span class="sc">&gt;</span><span class="fl">1e4</span>,<span class="fl">1e4</span>,imaxcv))<span class="sc">%&gt;%</span></span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">i=</span><span class="fu">as.integer</span>(<span class="fu">seq</span>(<span class="dv">1</span>,nAnalytes<span class="sc">*</span>n_rep,<span class="dv">1</span>)),<span class="at">logP=</span>logP, <span class="at">Type=</span>NAB)) </span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>p33_1<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">100</span>))<span class="sc">+</span>   </span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a>p33_2<span class="ot">=</span>izoresults <span class="sc">%&gt;%</span></span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imaxcv))<span class="sc">+</span></span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">y=</span>method, <span class="at">x=</span>imaxcv, <span class="at">color=</span>logP),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb65-63"><a href="#cb65-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>method,<span class="at">x=</span>imincv),<span class="at">outlier.size =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb65-64"><a href="#cb65-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_continuous</span>(<span class="at">type=</span><span class="st">"viridis"</span>)<span class="sc">+</span></span>
<span id="cb65-65"><a href="#cb65-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"min(CV), max(CV)"</span>, <span class="at">y =</span> <span class="st">"Method"</span>)<span class="sc">+</span></span>
<span id="cb65-66"><a href="#cb65-66" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb65-67"><a href="#cb65-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">10000</span>))<span class="sc">+</span>    </span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb65-69"><a href="#cb65-69" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span>scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x)(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>)),</span>
<span id="cb65-70"><a href="#cb65-70" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))</span>
<span id="cb65-71"><a href="#cb65-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-72"><a href="#cb65-72" aria-hidden="true" tabindex="-1"></a>p33<span class="ot">=</span>p33_1<span class="sc">+</span>p33_2<span class="sc">+</span></span>
<span id="cb65-73"><a href="#cb65-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),<span class="at">axes =</span> <span class="st">"collect"</span>)</span>
<span id="cb65-74"><a href="#cb65-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-75"><a href="#cb65-75" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-izo-combined-CV.pdf"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb65-76"><a href="#cb65-76" aria-hidden="true" tabindex="-1"></a><span class="fu">my.ggsave.png</span>(<span class="at">.plot=</span>p33<span class="sc">+</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>), <span class="at">.filename=</span><span class="fu">paste</span>(<span class="st">"N-izo-combined-CV.png"</span>), <span class="at">.path =</span> figures_dir1)</span>
<span id="cb65-77"><a href="#cb65-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-78"><a href="#cb65-78" aria-hidden="true" tabindex="-1"></a>p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="optimal-design-for-mixtures-design3_files/figure-html/single-form-analytes-izo-summary-combined-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>f44_1 <span class="ot">=</span> p33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" role="list">

</div>
</section>
<section id="licenses" class="level1 unnumbered">
<h1 class="unnumbered">Licenses</h1>
<ul>
<li>Code &amp; copy; 2024, Paweł Wiczling, licensed under BSD-3.</li>
<li>Text &amp; copy; 2024, Paweł Wiczling, licensed under CC-BY-NC 4.0.</li>
</ul>
</section>
<section id="original-computing-environment" class="level1 unnumbered">
<h1 class="unnumbered">Original Computing Environment</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.3 (2024-02-29)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 24.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: Europe/Warsaw
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] flextable_0.9.7     tibble_3.2.1        here_1.0.1         
 [4] reshape2_1.4.4      stringr_1.5.1       patchwork_1.3.0    
 [7] mrgmisc_0.2.1       purrr_1.0.2         tidyr_1.3.1        
[10] mvtnorm_1.3-1       ggplot2_3.5.1       dplyr_1.1.4        
[13] numDeriv_2016.8-1.1 pracma_2.4.4        cmdstanr_0.8.1     

loaded via a namespace (and not attached):
 [1] gtable_0.3.5            tensorA_0.36.2.1        xfun_0.48              
 [4] htmlwidgets_1.6.4       processx_3.8.4          vctrs_0.6.5            
 [7] tools_4.3.3             ps_1.8.0                generics_0.1.3         
[10] parallel_4.3.3          fansi_1.0.6             pkgconfig_2.0.3        
[13] data.table_1.16.2       checkmate_2.3.2         uuid_1.2-1             
[16] distributional_0.5.0    lifecycle_1.0.4         compiler_4.3.3         
[19] farver_2.1.2            textshaping_0.4.0       munsell_0.5.1          
[22] codetools_0.2-19        fontquiver_0.2.1        fontLiberation_0.1.0   
[25] htmltools_0.5.8.1       yaml_2.3.10             pillar_1.9.0           
[28] openssl_2.2.2           bettermc_1.2.2          abind_1.4-8            
[31] fontBitstreamVera_0.1.1 posterior_1.6.0         zip_2.3.1              
[34] tidyselect_1.2.1        digest_0.6.37           stringi_1.8.4          
[37] labeling_0.4.3          rprojroot_2.0.4         fastmap_1.2.0          
[40] grid_4.3.3              colorspace_2.1-1        cli_3.6.3              
[43] magrittr_2.0.3          utf8_1.2.4              withr_3.0.1            
[46] gdtools_0.4.0           scales_1.3.0            backports_1.5.0        
[49] rmarkdown_2.28          officer_0.6.7           askpass_1.2.1          
[52] ragg_1.3.3              evaluate_1.0.1          knitr_1.48             
[55] viridisLite_0.4.2       rlang_1.1.4             isoband_0.2.7          
[58] Rcpp_1.0.13             glue_1.8.0              xml2_1.3.6             
[61] rstudioapi_0.17.0       jsonlite_1.8.9          R6_2.5.1               
[64] plyr_1.8.9              systemfonts_1.1.0      </code></pre>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb69" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Design3: Leveraging Prior Knowledge for Improved Retention Prediction in Reversed-Phase HPLC"</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Paweł Wiczling*"</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co">      - name: "Department of Biopharmaceutics and Pharmacodynamics, Medical University of Gdańsk, Gen. J. Hallera 107, 80-416 Gdańsk, Poland"</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.Date())`"</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true  </span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 7</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 7</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setuphtml, include=FALSE}</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(cache=TRUE, message=FALSE, error=FALSE, warning=FALSE, comment=NA, out.width='95%')</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a><span class="in">#usethis::create_github_token()</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup</span></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>The packages we will use are listed below.</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a><span class="in">library(cmdstanr)</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a><span class="in">library(pracma)</span></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a><span class="in">library(numDeriv)</span></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a><span class="in">library(mvtnorm)</span></span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr)</span></span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a><span class="in">library(purrr)</span></span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a><span class="in">library(mrgmisc)</span></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a><span class="in">library(patchwork)</span></span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a><span class="in">library(stringr)</span></span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a><span class="in">library(reshape2)</span></span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a><span class="in">library(here)</span></span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a><span class="in">library(tibble)</span></span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a><span class="in">library(flextable)</span></span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a><span class="in">select = dplyr::select</span></span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a><span class="in"># remotes::install_github("metrumresearchgroup/mrgmisc")</span></span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a><span class="in"># for parallel calculation use linux (mclaplly), i.e. Ubuntu 24.04 on Windows WSL</span></span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a><span class="in"># usethis::edit_r_environ(), add PROCESSX_NOTIFY_OLD_SIGCHLD = 1 ????</span></span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a><span class="in">#' Helper functions</span></span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a><span class="in">source("helper_functions.R")</span></span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{r paths}</span></span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a><span class="in">#' folder shortcuts:</span></span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a><span class="in">figures_dir1 &lt;- here("deliv", "figures", "design3","N")</span></span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a><span class="in">tables_dir1  &lt;- here("deliv", "tables", "design3","N")</span></span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-56"><a href="#cb69-56" aria-hidden="true" tabindex="-1"></a><span class="in">figures_dir5 &lt;- here("deliv", "figures", "manuscript_d3")</span></span>
<span id="cb69-57"><a href="#cb69-57" aria-hidden="true" tabindex="-1"></a><span class="in">tables_dir5  &lt;- here("deliv", "tables", "manuscript_d3")</span></span>
<span id="cb69-58"><a href="#cb69-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-59"><a href="#cb69-59" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(figures_dir1)) dir.create(figures_dir1, recursive = T)</span></span>
<span id="cb69-60"><a href="#cb69-60" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(tables_dir1)) dir.create(tables_dir1, recursive = T)</span></span>
<span id="cb69-61"><a href="#cb69-61" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(figures_dir5)) dir.create(figures_dir5, recursive = T)</span></span>
<span id="cb69-62"><a href="#cb69-62" aria-hidden="true" tabindex="-1"></a><span class="in">if (!file.exists(tables_dir5)) dir.create(tables_dir5, recursive = T)</span></span>
<span id="cb69-63"><a href="#cb69-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-64"><a href="#cb69-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-65"><a href="#cb69-65" aria-hidden="true" tabindex="-1"></a><span class="in">thisScript &lt;- "optimal-design-for-mixtures-design3"</span></span>
<span id="cb69-66"><a href="#cb69-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-67"><a href="#cb69-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-68"><a href="#cb69-68" aria-hidden="true" tabindex="-1"></a><span class="in">```{r helper-save-functions}</span></span>
<span id="cb69-69"><a href="#cb69-69" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave &lt;- function(.plot, .filename, .path=figures_dir, .height= 7, .width= 6) {</span></span>
<span id="cb69-70"><a href="#cb69-70" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(plot=.plot, filename=.filename, path=.path, height=.height, width=.width)</span></span>
<span id="cb69-71"><a href="#cb69-71" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb69-72"><a href="#cb69-72" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png &lt;- function(.plot, .filename, .path=figures_dir, .height=7, .width= 6) {</span></span>
<span id="cb69-73"><a href="#cb69-73" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(plot=.plot, filename=.filename, path=.path, height=.height, width=.width)</span></span>
<span id="cb69-74"><a href="#cb69-74" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb69-75"><a href="#cb69-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-76"><a href="#cb69-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-77"><a href="#cb69-77" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb69-78"><a href="#cb69-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-79"><a href="#cb69-79" aria-hidden="true" tabindex="-1"></a><span class="fu"># Priors</span></span>
<span id="cb69-80"><a href="#cb69-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-81"><a href="#cb69-81" aria-hidden="true" tabindex="-1"></a>Priors are based on the follwoing article "Comparison of Chromatographic Stationary Phases Using a Bayesian-Based Multilevel Model" by Paweł Wiczling and Agnieszka Kamedulska published in Analytical Chemistry 2024 96 (3), 1310-1319. </span>
<span id="cb69-82"><a href="#cb69-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-83"><a href="#cb69-83" aria-hidden="true" tabindex="-1"></a>In this work a simplified approach is taken with the focus on the neutral, acidic and basic forms of an analytes and single chromatographic stationary phase - assuming the pKa and changes of pKa with organic modifier are known.</span>
<span id="cb69-84"><a href="#cb69-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-85"><a href="#cb69-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r literature-priors}</span></span>
<span id="cb69-86"><a href="#cb69-86" aria-hidden="true" tabindex="-1"></a><span class="in"># fun_generate_priors defined in helper_functions.R</span></span>
<span id="cb69-87"><a href="#cb69-87" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN_MeOH=fun_generate_priors("N_MeOH", logP=2.2)</span></span>
<span id="cb69-88"><a href="#cb69-88" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN_ACN=fun_generate_priors("N_ACN", logP=2.2)</span></span>
<span id="cb69-89"><a href="#cb69-89" aria-hidden="true" tabindex="-1"></a><span class="in">priorsN=fun_generate_priors("N", logP=2.2)</span></span>
<span id="cb69-90"><a href="#cb69-90" aria-hidden="true" tabindex="-1"></a><span class="in">priorsA=fun_generate_priors("A", logP=2.2)</span></span>
<span id="cb69-91"><a href="#cb69-91" aria-hidden="true" tabindex="-1"></a><span class="in">priorsB=fun_generate_priors("B", logP=2.2)</span></span>
<span id="cb69-92"><a href="#cb69-92" aria-hidden="true" tabindex="-1"></a><span class="in">priorsNB=fun_generate_priors("NB", logP=2.2)</span></span>
<span id="cb69-93"><a href="#cb69-93" aria-hidden="true" tabindex="-1"></a><span class="in">priorsNA=fun_generate_priors("NA", logP=2.2)</span></span>
<span id="cb69-94"><a href="#cb69-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-95"><a href="#cb69-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-96"><a href="#cb69-96" aria-hidden="true" tabindex="-1"></a>In this work I consider a design region that consist of linear organic modifier gradients ranging from 10 to 270 min and organic modifier content ranging from 0.05 to 0.2 for MeOH and ACN.</span>
<span id="cb69-97"><a href="#cb69-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-98"><a href="#cb69-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r design-space}</span></span>
<span id="cb69-99"><a href="#cb69-99" aria-hidden="true" tabindex="-1"></a><span class="in">hplcparam_candidates_df = expand_grid(tg=seq(10,270,by=10), </span></span>
<span id="cb69-100"><a href="#cb69-100" aria-hidden="true" tabindex="-1"></a><span class="in">                                          td=2.1, </span></span>
<span id="cb69-101"><a href="#cb69-101" aria-hidden="true" tabindex="-1"></a><span class="in">                                          to=0.532,</span></span>
<span id="cb69-102"><a href="#cb69-102" aria-hidden="true" tabindex="-1"></a><span class="in">                                          te=0.04, </span></span>
<span id="cb69-103"><a href="#cb69-103" aria-hidden="true" tabindex="-1"></a><span class="in">                                          fio = seq(0.05, 0.2, by=0.05),</span></span>
<span id="cb69-104"><a href="#cb69-104" aria-hidden="true" tabindex="-1"></a><span class="in">                                          fif = 0.8,</span></span>
<span id="cb69-105"><a href="#cb69-105" aria-hidden="true" tabindex="-1"></a><span class="in">                                          m=c(0,1),</span></span>
<span id="cb69-106"><a href="#cb69-106" aria-hidden="true" tabindex="-1"></a><span class="in">                                          xpH=c(0,1))</span></span>
<span id="cb69-107"><a href="#cb69-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-108"><a href="#cb69-108" aria-hidden="true" tabindex="-1"></a><span class="in">hplcparam_candidates_df&lt;-hplcparam_candidates_df%&gt;%</span></span>
<span id="cb69-109"><a href="#cb69-109" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(tg=tg/3/3)</span></span>
<span id="cb69-110"><a href="#cb69-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-111"><a href="#cb69-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-112"><a href="#cb69-112" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stan multiple analytes. Single form analytes. fi and tg for MeOH and ACN as design variables</span></span>
<span id="cb69-113"><a href="#cb69-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-114"><a href="#cb69-114" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile stan models</span></span>
<span id="cb69-115"><a href="#cb69-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-compilation}</span></span>
<span id="cb69-116"><a href="#cb69-116" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_gq= cmdstan_model("../stan/hplc-gra-single-form-analytes-gq.stan", stanc_options = list("O1"))</span></span>
<span id="cb69-117"><a href="#cb69-117" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes_sim = cmdstan_model("../stan/hplc-gra-single-form-analytes-sim.stan", stanc_options = list("O1"))</span></span>
<span id="cb69-118"><a href="#cb69-118" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes = cmdstan_model("../stan/hplc-gra-single-form-analytes.stan", stanc_options = list("O1"))</span></span>
<span id="cb69-119"><a href="#cb69-119" aria-hidden="true" tabindex="-1"></a><span class="in">mod_analytes$compile(compile_model_methods=TRUE,force_recompile=TRUE)</span></span>
<span id="cb69-120"><a href="#cb69-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-121"><a href="#cb69-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-122"><a href="#cb69-122" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulate retention times and create datasets</span></span>
<span id="cb69-123"><a href="#cb69-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-124"><a href="#cb69-124" aria-hidden="true" tabindex="-1"></a>Probability of occurrence 0.4 neutral, 0.3 A, 0.3 B with logP being sampled from 2.2+-2 and constrained between 0.5 and 7.</span>
<span id="cb69-125"><a href="#cb69-125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-126"><a href="#cb69-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-simulations}</span></span>
<span id="cb69-127"><a href="#cb69-127" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma=hplcparam_candidates_df%&gt;%filter(xpH==0)</span></span>
<span id="cb69-128"><a href="#cb69-128" aria-hidden="true" tabindex="-1"></a><span class="in">nObs = nrow(data_ma);</span></span>
<span id="cb69-129"><a href="#cb69-129" aria-hidden="true" tabindex="-1"></a><span class="in">nAnalytes =50;</span></span>
<span id="cb69-130"><a href="#cb69-130" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = 1234;</span></span>
<span id="cb69-131"><a href="#cb69-131" aria-hidden="true" tabindex="-1"></a><span class="in">n_param = 3;</span></span>
<span id="cb69-132"><a href="#cb69-132" aria-hidden="true" tabindex="-1"></a><span class="in">n_rep = 10;</span></span>
<span id="cb69-133"><a href="#cb69-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-134"><a href="#cb69-134" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma=list()</span></span>
<span id="cb69-135"><a href="#cb69-135" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma=list()</span></span>
<span id="cb69-136"><a href="#cb69-136" aria-hidden="true" tabindex="-1"></a><span class="in">inits = list()</span></span>
<span id="cb69-137"><a href="#cb69-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-138"><a href="#cb69-138" aria-hidden="true" tabindex="-1"></a><span class="in">for (i in 1:n_rep) {</span></span>
<span id="cb69-139"><a href="#cb69-139" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]] = list(nObs=nObs,</span></span>
<span id="cb69-140"><a href="#cb69-140" aria-hidden="true" tabindex="-1"></a><span class="in">                   nAnalytes=nAnalytes,</span></span>
<span id="cb69-141"><a href="#cb69-141" aria-hidden="true" tabindex="-1"></a><span class="in">                   steps = 4 + 6*data_ma$m,</span></span>
<span id="cb69-142"><a href="#cb69-142" aria-hidden="true" tabindex="-1"></a><span class="in">                   hplcparam=as.matrix(data_ma%&gt;%dplyr::select(c(tg,td,to,te,fio,fif,m))),</span></span>
<span id="cb69-143"><a href="#cb69-143" aria-hidden="true" tabindex="-1"></a><span class="in">                   include_prior = 1,</span></span>
<span id="cb69-144"><a href="#cb69-144" aria-hidden="true" tabindex="-1"></a><span class="in">                   run_estimation=1,</span></span>
<span id="cb69-145"><a href="#cb69-145" aria-hidden="true" tabindex="-1"></a><span class="in">                   nSel = nObs,</span></span>
<span id="cb69-146"><a href="#cb69-146" aria-hidden="true" tabindex="-1"></a><span class="in">                   selected = 1:nObs)</span></span>
<span id="cb69-147"><a href="#cb69-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-148"><a href="#cb69-148" aria-hidden="true" tabindex="-1"></a><span class="in">fit_gq  = mod_analytes_gq$sample(data = datastruct_prior_ma[[i]],</span></span>
<span id="cb69-149"><a href="#cb69-149" aria-hidden="true" tabindex="-1"></a><span class="in">                                         seed = cseed,</span></span>
<span id="cb69-150"><a href="#cb69-150" aria-hidden="true" tabindex="-1"></a><span class="in">                                         fixed_param = TRUE,</span></span>
<span id="cb69-151"><a href="#cb69-151" aria-hidden="true" tabindex="-1"></a><span class="in">                                         chains = 1,</span></span>
<span id="cb69-152"><a href="#cb69-152" aria-hidden="true" tabindex="-1"></a><span class="in">                                         iter_sampling=1)</span></span>
<span id="cb69-153"><a href="#cb69-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-154"><a href="#cb69-154" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$trobs = matrix(fit_gq$draws(format = "matrix", variable = "y_hat_sim"),nAnalytes,nObs)</span></span>
<span id="cb69-155"><a href="#cb69-155" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$logPobs = fit_gq$draws(format = "matrix", variable = "logPobs")[1:nAnalytes]</span></span>
<span id="cb69-156"><a href="#cb69-156" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_prior_ma[[i]]$N1A2B3 = fit_gq$draws(format = "matrix", variable = "N1A2B3")[1:nAnalytes]</span></span>
<span id="cb69-157"><a href="#cb69-157" aria-hidden="true" tabindex="-1"></a><span class="in">param = matrix(fit_gq$draws(format = "matrix", variable = "paramsim"),nAnalytes,3)</span></span>
<span id="cb69-158"><a href="#cb69-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-159"><a href="#cb69-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-160"><a href="#cb69-160" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma[[i]]=datastruct_prior_ma[[i]];</span></span>
<span id="cb69-161"><a href="#cb69-161" aria-hidden="true" tabindex="-1"></a><span class="in">datastruct_noprior_ma[[i]]$include_prior = 0.01;</span></span>
<span id="cb69-162"><a href="#cb69-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-163"><a href="#cb69-163" aria-hidden="true" tabindex="-1"></a><span class="in">inits[[i]]=param</span></span>
<span id="cb69-164"><a href="#cb69-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-165"><a href="#cb69-165" aria-hidden="true" tabindex="-1"></a><span class="in">cseed = cseed+1</span></span>
<span id="cb69-166"><a href="#cb69-166" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb69-167"><a href="#cb69-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-168"><a href="#cb69-168" aria-hidden="true" tabindex="-1"></a><span class="in">mean_log_det_stan = function(data, init, chosen_indices, S){</span></span>
<span id="cb69-169"><a href="#cb69-169" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb69-170"><a href="#cb69-170" aria-hidden="true" tabindex="-1"></a><span class="in">init_ma = function(){list(param=init)}</span></span>
<span id="cb69-171"><a href="#cb69-171" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb69-172"><a href="#cb69-172" aria-hidden="true" tabindex="-1"></a><span class="in">data$selected = chosen_indices;</span></span>
<span id="cb69-173"><a href="#cb69-173" aria-hidden="true" tabindex="-1"></a><span class="in">data$nSel = length(chosen_indices);</span></span>
<span id="cb69-174"><a href="#cb69-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-175"><a href="#cb69-175" aria-hidden="true" tabindex="-1"></a><span class="in"> fit_opt  = mod_analytes$optimize(</span></span>
<span id="cb69-176"><a href="#cb69-176" aria-hidden="true" tabindex="-1"></a><span class="in">   data = data,</span></span>
<span id="cb69-177"><a href="#cb69-177" aria-hidden="true" tabindex="-1"></a><span class="in">   output_dir = here::here("stanfiles"),</span></span>
<span id="cb69-178"><a href="#cb69-178" aria-hidden="true" tabindex="-1"></a><span class="in">   output_basename = S,</span></span>
<span id="cb69-179"><a href="#cb69-179" aria-hidden="true" tabindex="-1"></a><span class="in">   seed = cseed,</span></span>
<span id="cb69-180"><a href="#cb69-180" aria-hidden="true" tabindex="-1"></a><span class="in">   init = init_ma,</span></span>
<span id="cb69-181"><a href="#cb69-181" aria-hidden="true" tabindex="-1"></a><span class="in">   jacobian = TRUE,</span></span>
<span id="cb69-182"><a href="#cb69-182" aria-hidden="true" tabindex="-1"></a><span class="in">   show_messages = F)</span></span>
<span id="cb69-183"><a href="#cb69-183" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb69-184"><a href="#cb69-184" aria-hidden="true" tabindex="-1"></a><span class="in"> mode=fit_opt$unconstrain_variables(list(param = fit_opt$mle("param")))</span></span>
<span id="cb69-185"><a href="#cb69-185" aria-hidden="true" tabindex="-1"></a><span class="in"> hessian = fit_opt$hessian(unconstrained_variables = mode)$hessian</span></span>
<span id="cb69-186"><a href="#cb69-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-187"><a href="#cb69-187" aria-hidden="true" tabindex="-1"></a><span class="in">logdet = unlist(purrr::map(1:data$nAnalytes,\(i) log(det(-hessian[((i-1)*3+1):((i-1)*3+3),((i-1)*3+1):((i-1)*3+3)]))))</span></span>
<span id="cb69-188"><a href="#cb69-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-189"><a href="#cb69-189" aria-hidden="true" tabindex="-1"></a><span class="in">return(logdet)</span></span>
<span id="cb69-190"><a href="#cb69-190" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb69-191"><a href="#cb69-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-192"><a href="#cb69-192" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(65,66,209,210)</span></span>
<span id="cb69-193"><a href="#cb69-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-194"><a href="#cb69-194" aria-hidden="true" tabindex="-1"></a><span class="in"># quick test:</span></span>
<span id="cb69-195"><a href="#cb69-195" aria-hidden="true" tabindex="-1"></a><span class="in">z_prior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan(datastruct_prior_ma[[i]], inits[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb69-196"><a href="#cb69-196" aria-hidden="true" tabindex="-1"></a><span class="in">z_noprior = parallel::mclapply(1:n_rep,\(i) mean_log_det_stan(datastruct_noprior_ma[[i]], inits[[i]], chosen_indices, i), mc.cores=10)</span></span>
<span id="cb69-197"><a href="#cb69-197" aria-hidden="true" tabindex="-1"></a><span class="in">test = c(mean(unlist(z_prior)),mean(unlist(z_noprior)))</span></span>
<span id="cb69-198"><a href="#cb69-198" aria-hidden="true" tabindex="-1"></a><span class="in">test</span></span>
<span id="cb69-199"><a href="#cb69-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-200"><a href="#cb69-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-201"><a href="#cb69-201" aria-hidden="true" tabindex="-1"></a><span class="in">logP = unlist(purrr::map(1:length(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]$logPobs))</span></span>
<span id="cb69-202"><a href="#cb69-202" aria-hidden="true" tabindex="-1"></a><span class="in">NAB = unlist(purrr::map(1:length(datastruct_noprior_ma),\(i) datastruct_noprior_ma[[i]]$N1A2B3))</span></span>
<span id="cb69-203"><a href="#cb69-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-204"><a href="#cb69-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-205"><a href="#cb69-205" aria-hidden="true" tabindex="-1"></a><span class="fu">## Optimization</span></span>
<span id="cb69-206"><a href="#cb69-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-optimization, eval=F}</span></span>
<span id="cb69-207"><a href="#cb69-207" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(213,214) # initial values</span></span>
<span id="cb69-208"><a href="#cb69-208" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-209"><a href="#cb69-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-210"><a href="#cb69-210" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(214,209,215) # initial values</span></span>
<span id="cb69-211"><a href="#cb69-211" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-212"><a href="#cb69-212" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(214,211,63) # initial values</span></span>
<span id="cb69-213"><a href="#cb69-213" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-214"><a href="#cb69-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-215"><a href="#cb69-215" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(209,210,215,79) # initial values</span></span>
<span id="cb69-216"><a href="#cb69-216" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-217"><a href="#cb69-217" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(209,210,215,71) # initial values</span></span>
<span id="cb69-218"><a href="#cb69-218" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-219"><a href="#cb69-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-220"><a href="#cb69-220" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(210,209,212,215,79) # initial values</span></span>
<span id="cb69-221"><a href="#cb69-221" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-222"><a href="#cb69-222" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = c(210,209,212,215,71) # initial values</span></span>
<span id="cb69-223"><a href="#cb69-223" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices, n_iter = 100)</span></span>
<span id="cb69-224"><a href="#cb69-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-225"><a href="#cb69-225" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(65,66,209,210) # ref</span></span>
<span id="cb69-226"><a href="#cb69-226" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior= c(65,66,209,210) # ref</span></span>
<span id="cb69-227"><a href="#cb69-227" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb69-228"><a href="#cb69-228" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb69-229"><a href="#cb69-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-230"><a href="#cb69-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-231"><a href="#cb69-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-232"><a href="#cb69-232" aria-hidden="true" tabindex="-1"></a><span class="fu">### Read the results and compare</span></span>
<span id="cb69-233"><a href="#cb69-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-234"><a href="#cb69-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-logDet-read, eval=T}</span></span>
<span id="cb69-235"><a href="#cb69-235" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(65,66,209,210) # ref</span></span>
<span id="cb69-236"><a href="#cb69-236" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior= c(65,66,209,210) # ref</span></span>
<span id="cb69-237"><a href="#cb69-237" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb69-238"><a href="#cb69-238" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_ref = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb69-239"><a href="#cb69-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-240"><a href="#cb69-240" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(213,214) # p=2</span></span>
<span id="cb69-241"><a href="#cb69-241" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_2 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb69-242"><a href="#cb69-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-243"><a href="#cb69-243" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(214,209,215) # p=3</span></span>
<span id="cb69-244"><a href="#cb69-244" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(214,211,63) # p=3</span></span>
<span id="cb69-245"><a href="#cb69-245" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb69-246"><a href="#cb69-246" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_3 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb69-247"><a href="#cb69-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-248"><a href="#cb69-248" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior   = c(209,212,215,216) # p=4</span></span>
<span id="cb69-249"><a href="#cb69-249" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(209,214,215,63) # p=4</span></span>
<span id="cb69-250"><a href="#cb69-250" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb69-251"><a href="#cb69-251" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_4 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb69-252"><a href="#cb69-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-253"><a href="#cb69-253" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_prior = c(207,209,212,215,216) # p=5</span></span>
<span id="cb69-254"><a href="#cb69-254" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices_noprior = c(216,209,212,215,63) # p=5</span></span>
<span id="cb69-255"><a href="#cb69-255" aria-hidden="true" tabindex="-1"></a><span class="in">fws_prior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_prior_ma, inits, chosen_indices_prior, n_iter = 0)</span></span>
<span id="cb69-256"><a href="#cb69-256" aria-hidden="true" tabindex="-1"></a><span class="in">fws_noprior_5 = fedorov_wynn_stan_par(mean_log_det_stan, datastruct_noprior_ma, inits, chosen_indices_noprior, n_iter = 0)</span></span>
<span id="cb69-257"><a href="#cb69-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-258"><a href="#cb69-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-259"><a href="#cb69-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-logDet-summary}</span></span>
<span id="cb69-260"><a href="#cb69-260" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results = tibble( logP = logP,</span></span>
<span id="cb69-261"><a href="#cb69-261" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb69-262"><a href="#cb69-262" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb69-263"><a href="#cb69-263" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb69-264"><a href="#cb69-264" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_2 = fws_prior_2$log_det_FIM,</span></span>
<span id="cb69-265"><a href="#cb69-265" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb69-266"><a href="#cb69-266" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb69-267"><a href="#cb69-267" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb69-268"><a href="#cb69-268" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb69-269"><a href="#cb69-269" aria-hidden="true" tabindex="-1"></a><span class="in">                          prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb69-270"><a href="#cb69-270" aria-hidden="true" tabindex="-1"></a><span class="in">                          noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb69-271"><a href="#cb69-271" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(prior_ref:noprior_5, names_to = "method")</span></span>
<span id="cb69-272"><a href="#cb69-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-273"><a href="#cb69-273" aria-hidden="true" tabindex="-1"></a><span class="in">p1&lt;-ggplot(summary_results, aes(y=method,x=value))+</span></span>
<span id="cb69-274"><a href="#cb69-274" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-275"><a href="#cb69-275" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=value, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-276"><a href="#cb69-276" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-277"><a href="#cb69-277" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="log(|FIM|)", y = "Method")</span></span>
<span id="cb69-278"><a href="#cb69-278" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb69-279"><a href="#cb69-279" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diff = tibble(logP = logP,</span></span>
<span id="cb69-280"><a href="#cb69-280" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb69-281"><a href="#cb69-281" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb69-282"><a href="#cb69-282" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb69-283"><a href="#cb69-283" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_2 = fws_prior_2$log_det_FIM,</span></span>
<span id="cb69-284"><a href="#cb69-284" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb69-285"><a href="#cb69-285" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb69-286"><a href="#cb69-286" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb69-287"><a href="#cb69-287" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb69-288"><a href="#cb69-288" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb69-289"><a href="#cb69-289" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb69-290"><a href="#cb69-290" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_prior_2 = (fws_prior_2 - fws_prior_ref)/n_param,</span></span>
<span id="cb69-291"><a href="#cb69-291" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_3 = (fws_prior_3 - fws_prior_ref)/n_param,</span></span>
<span id="cb69-292"><a href="#cb69-292" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_3 = (fws_noprior_3 - fws_noprior_ref)/n_param,</span></span>
<span id="cb69-293"><a href="#cb69-293" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_4 = (fws_prior_4 - fws_prior_ref)/n_param,</span></span>
<span id="cb69-294"><a href="#cb69-294" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_4 = (fws_noprior_4 - fws_noprior_ref)/n_param,</span></span>
<span id="cb69-295"><a href="#cb69-295" aria-hidden="true" tabindex="-1"></a><span class="in">         d_prior_5 = (fws_prior_5 - fws_prior_ref)/n_param,</span></span>
<span id="cb69-296"><a href="#cb69-296" aria-hidden="true" tabindex="-1"></a><span class="in">         d_noprior_5 = (fws_noprior_5 - fws_noprior_ref)/n_param)%&gt;%</span></span>
<span id="cb69-297"><a href="#cb69-297" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_prior_2:d_noprior_5, names_to = "method")</span></span>
<span id="cb69-298"><a href="#cb69-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-299"><a href="#cb69-299" aria-hidden="true" tabindex="-1"></a><span class="in">p2=ggplot(summary_results_diff, aes(y=method,x=exp(value)))+</span></span>
<span id="cb69-300"><a href="#cb69-300" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-301"><a href="#cb69-301" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-302"><a href="#cb69-302" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-303"><a href="#cb69-303" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Efficiency relative to the reference design", y = "Method")+</span></span>
<span id="cb69-304"><a href="#cb69-304" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")</span></span>
<span id="cb69-305"><a href="#cb69-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-306"><a href="#cb69-306" aria-hidden="true" tabindex="-1"></a><span class="in">summary_results_diffprior = tibble(logP = logP,</span></span>
<span id="cb69-307"><a href="#cb69-307" aria-hidden="true" tabindex="-1"></a><span class="in">                          Type = NAB,</span></span>
<span id="cb69-308"><a href="#cb69-308" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_ref = fws_prior_ref$log_det_FIM,</span></span>
<span id="cb69-309"><a href="#cb69-309" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_ref = fws_noprior_ref$log_det_FIM,</span></span>
<span id="cb69-310"><a href="#cb69-310" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_3 = fws_prior_3$log_det_FIM,</span></span>
<span id="cb69-311"><a href="#cb69-311" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_3 = fws_noprior_3$log_det_FIM,</span></span>
<span id="cb69-312"><a href="#cb69-312" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_4 = fws_prior_4$log_det_FIM,</span></span>
<span id="cb69-313"><a href="#cb69-313" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_4 = fws_noprior_4$log_det_FIM,</span></span>
<span id="cb69-314"><a href="#cb69-314" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_prior_5 = fws_prior_5$log_det_FIM,</span></span>
<span id="cb69-315"><a href="#cb69-315" aria-hidden="true" tabindex="-1"></a><span class="in">                          fws_noprior_5 = fws_noprior_5$log_det_FIM) %&gt;%</span></span>
<span id="cb69-316"><a href="#cb69-316" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(d_ref  = (fws_prior_ref-fws_noprior_ref)/n_param,</span></span>
<span id="cb69-317"><a href="#cb69-317" aria-hidden="true" tabindex="-1"></a><span class="in">         d_3 = (fws_prior_3-fws_noprior_3)/n_param,</span></span>
<span id="cb69-318"><a href="#cb69-318" aria-hidden="true" tabindex="-1"></a><span class="in">         d_4 = (fws_prior_4-fws_noprior_4)/n_param,</span></span>
<span id="cb69-319"><a href="#cb69-319" aria-hidden="true" tabindex="-1"></a><span class="in">         d_5 = (fws_prior_5-fws_noprior_5)/n_param)%&gt;%</span></span>
<span id="cb69-320"><a href="#cb69-320" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(d_ref:d_5, names_to = "method")</span></span>
<span id="cb69-321"><a href="#cb69-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-322"><a href="#cb69-322" aria-hidden="true" tabindex="-1"></a><span class="in">p3=ggplot(summary_results_diffprior, aes(y=method,x=exp(value)))+</span></span>
<span id="cb69-323"><a href="#cb69-323" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-324"><a href="#cb69-324" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=exp(value), color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-325"><a href="#cb69-325" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-326"><a href="#cb69-326" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Effect of prior on design efficiency", y = "Method")+</span></span>
<span id="cb69-327"><a href="#cb69-327" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype = "dotted")+</span></span>
<span id="cb69-328"><a href="#cb69-328" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0.5,100),</span></span>
<span id="cb69-329"><a href="#cb69-329" aria-hidden="true" tabindex="-1"></a><span class="in">                     trans='log10',</span></span>
<span id="cb69-330"><a href="#cb69-330" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.01, 100)),</span></span>
<span id="cb69-331"><a href="#cb69-331" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb69-332"><a href="#cb69-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-333"><a href="#cb69-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-334"><a href="#cb69-334" aria-hidden="true" tabindex="-1"></a><span class="in">p1</span></span>
<span id="cb69-335"><a href="#cb69-335" aria-hidden="true" tabindex="-1"></a><span class="in">p2</span></span>
<span id="cb69-336"><a href="#cb69-336" aria-hidden="true" tabindex="-1"></a><span class="in">p3</span></span>
<span id="cb69-337"><a href="#cb69-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-338"><a href="#cb69-338" aria-hidden="true" tabindex="-1"></a><span class="in">f2_1 = p2</span></span>
<span id="cb69-339"><a href="#cb69-339" aria-hidden="true" tabindex="-1"></a><span class="in">f3_1 = p3</span></span>
<span id="cb69-340"><a href="#cb69-340" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p1, .filename=paste("single-form-analytes-logdFIM-abs.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-341"><a href="#cb69-341" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p1, .filename=paste("single-form-analytes-logdFIM-abs.png"), .path = figures_dir1)</span></span>
<span id="cb69-342"><a href="#cb69-342" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p2, .filename=paste("single-form-analytes-logdFIM-rel.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-343"><a href="#cb69-343" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p2, .filename=paste("single-form-analytes-logdFIM-rel.png"), .path = figures_dir1)</span></span>
<span id="cb69-344"><a href="#cb69-344" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p3, .filename=paste("single-form-analytes-logdFIM-prioreff.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-345"><a href="#cb69-345" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p3, .filename=paste("single-form-analytes-logdFIM-prioreff.png"), .path = figures_dir1)</span></span>
<span id="cb69-346"><a href="#cb69-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-347"><a href="#cb69-347" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Table Summary</span></span>
<span id="cb69-348"><a href="#cb69-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r table-single}</span></span>
<span id="cb69-349"><a href="#cb69-349" aria-hidden="true" tabindex="-1"></a><span class="in">tab1=summary_results_diff %&gt;% </span></span>
<span id="cb69-350"><a href="#cb69-350" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(value = exp(value)) %&gt;%</span></span>
<span id="cb69-351"><a href="#cb69-351" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;% </span></span>
<span id="cb69-352"><a href="#cb69-352" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(ptc_value = quantile(value, c(0.05, 0.5, 0.95)), q = c(0.05, 0.5, 0.95),</span></span>
<span id="cb69-353"><a href="#cb69-353" aria-hidden="true" tabindex="-1"></a><span class="in">            mean_value = mean(value),</span></span>
<span id="cb69-354"><a href="#cb69-354" aria-hidden="true" tabindex="-1"></a><span class="in">            sd_value = std(value)) %&gt;%</span></span>
<span id="cb69-355"><a href="#cb69-355" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;%</span></span>
<span id="cb69-356"><a href="#cb69-356" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(c('ptc_value', 'mean_value','sd_value'), round, 2))%&gt;%</span></span>
<span id="cb69-357"><a href="#cb69-357" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from = "q", values_from = ptc_value, names_prefix = "q")%&gt;%</span></span>
<span id="cb69-358"><a href="#cb69-358" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(`Efficiency median (5th-95th)` = paste0(q0.5, " (", q0.05, " - ", q0.95, ")"))%&gt;%</span></span>
<span id="cb69-359"><a href="#cb69-359" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(`Efficiency mean (sd)` = paste0(mean_value, " (", sd_value , ")"))%&gt;%</span></span>
<span id="cb69-360"><a href="#cb69-360" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-starts_with("q"))%&gt;%</span></span>
<span id="cb69-361"><a href="#cb69-361" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-mean_value, -sd_value)%&gt;%</span></span>
<span id="cb69-362"><a href="#cb69-362" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() %&gt;%</span></span>
<span id="cb69-363"><a href="#cb69-363" aria-hidden="true" tabindex="-1"></a><span class="in">  autofit()</span></span>
<span id="cb69-364"><a href="#cb69-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-365"><a href="#cb69-365" aria-hidden="true" tabindex="-1"></a><span class="in">tab1</span></span>
<span id="cb69-366"><a href="#cb69-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-367"><a href="#cb69-367" aria-hidden="true" tabindex="-1"></a><span class="in">tab2=summary_results_diffprior %&gt;% </span></span>
<span id="cb69-368"><a href="#cb69-368" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(value = exp(value)) %&gt;%</span></span>
<span id="cb69-369"><a href="#cb69-369" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;% </span></span>
<span id="cb69-370"><a href="#cb69-370" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(ptc_value = quantile(value, c(0.05, 0.5, 0.95)), q = c(0.05, 0.5, 0.95),</span></span>
<span id="cb69-371"><a href="#cb69-371" aria-hidden="true" tabindex="-1"></a><span class="in">            mean_value = mean(value),</span></span>
<span id="cb69-372"><a href="#cb69-372" aria-hidden="true" tabindex="-1"></a><span class="in">            sd_value = std(value)) %&gt;%</span></span>
<span id="cb69-373"><a href="#cb69-373" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;%</span></span>
<span id="cb69-374"><a href="#cb69-374" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(c('ptc_value', 'mean_value','sd_value'), round, 2))%&gt;%</span></span>
<span id="cb69-375"><a href="#cb69-375" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_wider(names_from = "q", values_from = ptc_value, names_prefix = "q")%&gt;%</span></span>
<span id="cb69-376"><a href="#cb69-376" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(`Efficiency median (5th-95th)` = paste0(q0.5, " (", q0.05, " - ", q0.95, ")"))%&gt;%</span></span>
<span id="cb69-377"><a href="#cb69-377" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(`Efficiency mean (sd)` = paste0(mean_value, " (", sd_value , ")"))%&gt;%</span></span>
<span id="cb69-378"><a href="#cb69-378" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-starts_with("q"))%&gt;%</span></span>
<span id="cb69-379"><a href="#cb69-379" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-mean_value, -sd_value)%&gt;%</span></span>
<span id="cb69-380"><a href="#cb69-380" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() %&gt;%</span></span>
<span id="cb69-381"><a href="#cb69-381" aria-hidden="true" tabindex="-1"></a><span class="in">  autofit()</span></span>
<span id="cb69-382"><a href="#cb69-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-383"><a href="#cb69-383" aria-hidden="true" tabindex="-1"></a><span class="in">tab2</span></span>
<span id="cb69-384"><a href="#cb69-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-385"><a href="#cb69-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-386"><a href="#cb69-386" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table</span></span>
<span id="cb69-387"><a href="#cb69-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-table}</span></span>
<span id="cb69-388"><a href="#cb69-388" aria-hidden="true" tabindex="-1"></a><span class="in">data_ma=hplcparam_candidates_df%&gt;%filter(xpH==0)%&gt;%</span></span>
<span id="cb69-389"><a href="#cb69-389" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(line=1:n())</span></span>
<span id="cb69-390"><a href="#cb69-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-391"><a href="#cb69-391" aria-hidden="true" tabindex="-1"></a><span class="in">combined_results = list(</span></span>
<span id="cb69-392"><a href="#cb69-392" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ref = fws_prior_ref$chosen_indices,</span></span>
<span id="cb69-393"><a href="#cb69-393" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ref = fws_noprior_ref$chosen_indices,</span></span>
<span id="cb69-394"><a href="#cb69-394" aria-hidden="true" tabindex="-1"></a><span class="in">prior_2 = fws_prior_2$chosen_indices,</span></span>
<span id="cb69-395"><a href="#cb69-395" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_2 = 10000+fws_prior_2$chosen_indices, # dummy</span></span>
<span id="cb69-396"><a href="#cb69-396" aria-hidden="true" tabindex="-1"></a><span class="in">prior_3 = fws_prior_3$chosen_indices,</span></span>
<span id="cb69-397"><a href="#cb69-397" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_3 = fws_noprior_3$chosen_indices,</span></span>
<span id="cb69-398"><a href="#cb69-398" aria-hidden="true" tabindex="-1"></a><span class="in">prior_4 = fws_prior_4$chosen_indices,</span></span>
<span id="cb69-399"><a href="#cb69-399" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_4 = fws_noprior_4$chosen_indices,</span></span>
<span id="cb69-400"><a href="#cb69-400" aria-hidden="true" tabindex="-1"></a><span class="in">prior_5 = fws_prior_5$chosen_indices,</span></span>
<span id="cb69-401"><a href="#cb69-401" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_5 = fws_noprior_5$chosen_indices)</span></span>
<span id="cb69-402"><a href="#cb69-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-403"><a href="#cb69-403" aria-hidden="true" tabindex="-1"></a><span class="in">selected_exp = enframe(combined_results)%&gt;%</span></span>
<span id="cb69-404"><a href="#cb69-404" aria-hidden="true" tabindex="-1"></a><span class="in">   unnest(value) %&gt;%</span></span>
<span id="cb69-405"><a href="#cb69-405" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(line=value, Name = name) %&gt;%</span></span>
<span id="cb69-406"><a href="#cb69-406" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(data_ma, by = "line")%&gt;%</span></span>
<span id="cb69-407"><a href="#cb69-407" aria-hidden="true" tabindex="-1"></a><span class="in">   arrange(Name,tg, fio)%&gt;%</span></span>
<span id="cb69-408"><a href="#cb69-408" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Modifier = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb69-409"><a href="#cb69-409" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-c(line,xpH,m,td,to,te,fif)) %&gt;%</span></span>
<span id="cb69-410"><a href="#cb69-410" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(type = if_else(str_detect(Name, 'noprior'), "No prior", "Prior"))%&gt;%</span></span>
<span id="cb69-411"><a href="#cb69-411" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(where(is.numeric), ~replace_na(., -1)))</span></span>
<span id="cb69-412"><a href="#cb69-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-413"><a href="#cb69-413" aria-hidden="true" tabindex="-1"></a><span class="in">tab1&lt;-selected_exp %&gt;%</span></span>
<span id="cb69-414"><a href="#cb69-414" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "Prior") %&gt;%</span></span>
<span id="cb69-415"><a href="#cb69-415" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-type)%&gt;%</span></span>
<span id="cb69-416"><a href="#cb69-416" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb69-417"><a href="#cb69-417" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb69-418"><a href="#cb69-418" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb69-419"><a href="#cb69-419" aria-hidden="true" tabindex="-1"></a><span class="in">tab2&lt;-selected_exp %&gt;%</span></span>
<span id="cb69-420"><a href="#cb69-420" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "No prior")%&gt;%</span></span>
<span id="cb69-421"><a href="#cb69-421" aria-hidden="true" tabindex="-1"></a><span class="in">    select(-type)%&gt;%</span></span>
<span id="cb69-422"><a href="#cb69-422" aria-hidden="true" tabindex="-1"></a><span class="in">  as_grouped_data(groups = "Name") %&gt;%</span></span>
<span id="cb69-423"><a href="#cb69-423" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb69-424"><a href="#cb69-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-425"><a href="#cb69-425" aria-hidden="true" tabindex="-1"></a><span class="in">tab2 &lt;- set_formatter(</span></span>
<span id="cb69-426"><a href="#cb69-426" aria-hidden="true" tabindex="-1"></a><span class="in">  tab2, </span></span>
<span id="cb69-427"><a href="#cb69-427" aria-hidden="true" tabindex="-1"></a><span class="in">  tg = function(x) ifelse(x==-1," ", sprintf("%.0f", x) ),</span></span>
<span id="cb69-428"><a href="#cb69-428" aria-hidden="true" tabindex="-1"></a><span class="in">  fio = function(x) ifelse(x==-1," ", sprintf("%.2f", x) )</span></span>
<span id="cb69-429"><a href="#cb69-429" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb69-430"><a href="#cb69-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-431"><a href="#cb69-431" aria-hidden="true" tabindex="-1"></a><span class="in">p1 = gen_grob(tab1, fit = "auto", just = "centre")</span></span>
<span id="cb69-432"><a href="#cb69-432" aria-hidden="true" tabindex="-1"></a><span class="in">p2 = gen_grob(tab2, fit = "auto", just = "centre") </span></span>
<span id="cb69-433"><a href="#cb69-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-434"><a href="#cb69-434" aria-hidden="true" tabindex="-1"></a><span class="in">gg&lt;-ggplot()+</span></span>
<span id="cb69-435"><a href="#cb69-435" aria-hidden="true" tabindex="-1"></a><span class="in">       theme(</span></span>
<span id="cb69-436"><a href="#cb69-436" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.background = element_rect(fill='transparent'),</span></span>
<span id="cb69-437"><a href="#cb69-437" aria-hidden="true" tabindex="-1"></a><span class="in">         plot.background = element_rect(fill='transparent', color=NA),</span></span>
<span id="cb69-438"><a href="#cb69-438" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.major = element_blank(),</span></span>
<span id="cb69-439"><a href="#cb69-439" aria-hidden="true" tabindex="-1"></a><span class="in">         panel.grid.minor = element_blank(),</span></span>
<span id="cb69-440"><a href="#cb69-440" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.background = element_rect(fill='transparent'),</span></span>
<span id="cb69-441"><a href="#cb69-441" aria-hidden="true" tabindex="-1"></a><span class="in">         legend.box.background = element_rect(fill='transparent')</span></span>
<span id="cb69-442"><a href="#cb69-442" aria-hidden="true" tabindex="-1"></a><span class="in">       )</span></span>
<span id="cb69-443"><a href="#cb69-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-444"><a href="#cb69-444" aria-hidden="true" tabindex="-1"></a><span class="in">plot1 &lt;- gg+p1+p2+ plot_layout(ncol = 3, widths = c(1, 20,20))</span></span>
<span id="cb69-445"><a href="#cb69-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-446"><a href="#cb69-446" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plot1, .filename=paste("single-form-analytes-table.pdf"), .path = tables_dir1)</span></span>
<span id="cb69-447"><a href="#cb69-447" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plot1, .filename=paste("single-form-analytes-table.png"), .path = tables_dir1)</span></span>
<span id="cb69-448"><a href="#cb69-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-449"><a href="#cb69-449" aria-hidden="true" tabindex="-1"></a><span class="in">tab1</span></span>
<span id="cb69-450"><a href="#cb69-450" aria-hidden="true" tabindex="-1"></a><span class="in">tab2</span></span>
<span id="cb69-451"><a href="#cb69-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-452"><a href="#cb69-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-453"><a href="#cb69-453" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stan simulations</span></span>
<span id="cb69-454"><a href="#cb69-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-laplace, eval=T}</span></span>
<span id="cb69-455"><a href="#cb69-455" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_ref$chosen_indices # ref</span></span>
<span id="cb69-456"><a href="#cb69-456" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_ref = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-457"><a href="#cb69-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-458"><a href="#cb69-458" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_ref$chosen_indices # ref</span></span>
<span id="cb69-459"><a href="#cb69-459" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_ref = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-460"><a href="#cb69-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-461"><a href="#cb69-461" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_2$chosen_indices # p=2</span></span>
<span id="cb69-462"><a href="#cb69-462" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_2 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-463"><a href="#cb69-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-464"><a href="#cb69-464" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_3$chosen_indices # p=3</span></span>
<span id="cb69-465"><a href="#cb69-465" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_3 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-466"><a href="#cb69-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-467"><a href="#cb69-467" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_3$chosen_indices # p=3</span></span>
<span id="cb69-468"><a href="#cb69-468" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_3 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-469"><a href="#cb69-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-470"><a href="#cb69-470" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_4$chosen_indices # p=4</span></span>
<span id="cb69-471"><a href="#cb69-471" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_4 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-472"><a href="#cb69-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-473"><a href="#cb69-473" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_4$chosen_indices # p=4</span></span>
<span id="cb69-474"><a href="#cb69-474" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_4 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-475"><a href="#cb69-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-476"><a href="#cb69-476" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_5$chosen_indices # p=5</span></span>
<span id="cb69-477"><a href="#cb69-477" aria-hidden="true" tabindex="-1"></a><span class="in">prior_ma_5 = fun_predict_stan_results(mod_analytes_sim, datastruct_prior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-478"><a href="#cb69-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-479"><a href="#cb69-479" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_5$chosen_indices # p=5</span></span>
<span id="cb69-480"><a href="#cb69-480" aria-hidden="true" tabindex="-1"></a><span class="in">noprior_ma_5 = fun_predict_stan_results(mod_analytes_sim, datastruct_noprior_ma, inits, chosen_indices, 10) </span></span>
<span id="cb69-481"><a href="#cb69-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-482"><a href="#cb69-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-483"><a href="#cb69-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-484"><a href="#cb69-484" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gradient conditions</span></span>
<span id="cb69-485"><a href="#cb69-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-gra-summary}</span></span>
<span id="cb69-486"><a href="#cb69-486" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_prior_5$chosen_indices # p=5</span></span>
<span id="cb69-487"><a href="#cb69-487" aria-hidden="true" tabindex="-1"></a><span class="in">p31=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb69-488"><a href="#cb69-488" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0)%&gt;%</span></span>
<span id="cb69-489"><a href="#cb69-489" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb69-490"><a href="#cb69-490" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(prior_ma_5$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb69-491"><a href="#cb69-491" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb69-492"><a href="#cb69-492" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb69-493"><a href="#cb69-493" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb69-494"><a href="#cb69-494" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb69-495"><a href="#cb69-495" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb69-496"><a href="#cb69-496" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb69-497"><a href="#cb69-497" aria-hidden="true" tabindex="-1"></a><span class="in">chosen_indices = fws_noprior_5$chosen_indices # p=5</span></span>
<span id="cb69-498"><a href="#cb69-498" aria-hidden="true" tabindex="-1"></a><span class="in">p32=hplcparam_candidates_df %&gt;%</span></span>
<span id="cb69-499"><a href="#cb69-499" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(xpH==0)%&gt;%</span></span>
<span id="cb69-500"><a href="#cb69-500" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lines = row_number())%&gt;%</span></span>
<span id="cb69-501"><a href="#cb69-501" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(noprior_ma_5$cresults%&gt;%mutate(lines=as.integer(c))) %&gt;%</span></span>
<span id="cb69-502"><a href="#cb69-502" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(selected = factor(if_else(lines %in% chosen_indices,1,0))) %&gt;%</span></span>
<span id="cb69-503"><a href="#cb69-503" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(m_f = if_else(m==0, "MeOH", "ACN")) %&gt;%</span></span>
<span id="cb69-504"><a href="#cb69-504" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=tg, y=fio, z=qvar)) +</span></span>
<span id="cb69-505"><a href="#cb69-505" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_contour_filled()+</span></span>
<span id="cb69-506"><a href="#cb69-506" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = . %&gt;% filter(selected==1))+</span></span>
<span id="cb69-507"><a href="#cb69-507" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~m_f)</span></span>
<span id="cb69-508"><a href="#cb69-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-509"><a href="#cb69-509" aria-hidden="true" tabindex="-1"></a><span class="in">iresults = rbind(prior_ma_ref$iresults%&gt;%</span></span>
<span id="cb69-510"><a href="#cb69-510" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb69-511"><a href="#cb69-511" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ref$iresults%&gt;%</span></span>
<span id="cb69-512"><a href="#cb69-512" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb69-513"><a href="#cb69-513" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_2$iresults%&gt;%</span></span>
<span id="cb69-514"><a href="#cb69-514" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb69-515"><a href="#cb69-515" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_3$iresults%&gt;%</span></span>
<span id="cb69-516"><a href="#cb69-516" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb69-517"><a href="#cb69-517" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_3$iresults%&gt;%</span></span>
<span id="cb69-518"><a href="#cb69-518" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb69-519"><a href="#cb69-519" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_4$iresults%&gt;%</span></span>
<span id="cb69-520"><a href="#cb69-520" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb69-521"><a href="#cb69-521" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_4$iresults%&gt;%</span></span>
<span id="cb69-522"><a href="#cb69-522" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4"),</span></span>
<span id="cb69-523"><a href="#cb69-523" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_5$iresults%&gt;%</span></span>
<span id="cb69-524"><a href="#cb69-524" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_5"),</span></span>
<span id="cb69-525"><a href="#cb69-525" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_5$iresults%&gt;%</span></span>
<span id="cb69-526"><a href="#cb69-526" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_5"))%&gt;%</span></span>
<span id="cb69-527"><a href="#cb69-527" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(ivar = if_else(ivar&gt;1e6,1e6,ivar)) %&gt;%</span></span>
<span id="cb69-528"><a href="#cb69-528" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.factor(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB))</span></span>
<span id="cb69-529"><a href="#cb69-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-530"><a href="#cb69-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-531"><a href="#cb69-531" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=iresults %&gt;%</span></span>
<span id="cb69-532"><a href="#cb69-532" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb69-533"><a href="#cb69-533" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-534"><a href="#cb69-534" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-535"><a href="#cb69-535" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-536"><a href="#cb69-536" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb69-537"><a href="#cb69-537" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb69-538"><a href="#cb69-538" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(0.1,100))+   </span></span>
<span id="cb69-539"><a href="#cb69-539" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb69-540"><a href="#cb69-540" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb69-541"><a href="#cb69-541" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb69-542"><a href="#cb69-542" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=iresults %&gt;%</span></span>
<span id="cb69-543"><a href="#cb69-543" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=ivar))+</span></span>
<span id="cb69-544"><a href="#cb69-544" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-545"><a href="#cb69-545" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=ivar, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-546"><a href="#cb69-546" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-547"><a href="#cb69-547" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="max(Var)", y = "Method")+</span></span>
<span id="cb69-548"><a href="#cb69-548" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 1, linetype="dotted")+</span></span>
<span id="cb69-549"><a href="#cb69-549" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,1000000))+    </span></span>
<span id="cb69-550"><a href="#cb69-550" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb69-551"><a href="#cb69-551" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(0.1, 1e6)),</span></span>
<span id="cb69-552"><a href="#cb69-552" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb69-553"><a href="#cb69-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-554"><a href="#cb69-554" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb69-555"><a href="#cb69-555" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb69-556"><a href="#cb69-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-557"><a href="#cb69-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-558"><a href="#cb69-558" aria-hidden="true" tabindex="-1"></a><span class="in">idx_exemple_analytes = iresults %&gt;%</span></span>
<span id="cb69-559"><a href="#cb69-559" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(method=="prior_ref") %&gt;%</span></span>
<span id="cb69-560"><a href="#cb69-560" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(ivar)%&gt;%</span></span>
<span id="cb69-561"><a href="#cb69-561" aria-hidden="true" tabindex="-1"></a><span class="in">  slice(which(row_number() %% 100 == 1)) %&gt;%</span></span>
<span id="cb69-562"><a href="#cb69-562" aria-hidden="true" tabindex="-1"></a><span class="in">  select(i)%&gt;%pull()</span></span>
<span id="cb69-563"><a href="#cb69-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-564"><a href="#cb69-564" aria-hidden="true" tabindex="-1"></a><span class="in">iresults %&gt;%</span></span>
<span id="cb69-565"><a href="#cb69-565" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb69-566"><a href="#cb69-566" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb69-567"><a href="#cb69-567" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb69-568"><a href="#cb69-568" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb69-569"><a href="#cb69-569" aria-hidden="true" tabindex="-1"></a><span class="in">  flextable() </span></span>
<span id="cb69-570"><a href="#cb69-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-571"><a href="#cb69-571" aria-hidden="true" tabindex="-1"></a><span class="in">f55_1=iresults %&gt;%</span></span>
<span id="cb69-572"><a href="#cb69-572" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(method) %&gt;%</span></span>
<span id="cb69-573"><a href="#cb69-573" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(`&lt;=1x` = mean(ivar&lt;=1),</span></span>
<span id="cb69-574"><a href="#cb69-574" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=2x` = mean(ivar&lt;=2),</span></span>
<span id="cb69-575"><a href="#cb69-575" aria-hidden="true" tabindex="-1"></a><span class="in">  `&lt;=3x` = mean(ivar&lt;=3)) %&gt;%</span></span>
<span id="cb69-576"><a href="#cb69-576" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(`&lt;=1x`:`&lt;=3x`, names_to = "target") %&gt;%</span></span>
<span id="cb69-577"><a href="#cb69-577" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=value,color=as.factor(target)))+</span></span>
<span id="cb69-578"><a href="#cb69-578" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point()+</span></span>
<span id="cb69-579"><a href="#cb69-579" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="Probability", y = "Method", color = "target")+</span></span>
<span id="cb69-580"><a href="#cb69-580" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 0.9, linetype="dotted")</span></span>
<span id="cb69-581"><a href="#cb69-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-582"><a href="#cb69-582" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=f55_1, .filename=paste("single-form-analytes-gra-prob.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-583"><a href="#cb69-583" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=f55_1, .filename=paste("single-form-analytes-gra-prob.png"), .path = figures_dir1)</span></span>
<span id="cb69-584"><a href="#cb69-584" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p31, .filename=paste("single-form-analytes-gra-prior-p5.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-585"><a href="#cb69-585" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p31, .filename=paste("single-form-analytes-gra-prior-p5.png"), .path = figures_dir1)</span></span>
<span id="cb69-586"><a href="#cb69-586" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p32, .filename=paste("single-form-analytes-gra-noprior-p5.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-587"><a href="#cb69-587" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p32, .filename=paste("single-form-analytes-gra-noprior-p5.png"), .path = figures_dir1)</span></span>
<span id="cb69-588"><a href="#cb69-588" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-gra-maxvar.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-589"><a href="#cb69-589" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("single-form-analytes-gra-maxvar.png"), .path = figures_dir1)</span></span>
<span id="cb69-590"><a href="#cb69-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-591"><a href="#cb69-591" aria-hidden="true" tabindex="-1"></a><span class="in">p31</span></span>
<span id="cb69-592"><a href="#cb69-592" aria-hidden="true" tabindex="-1"></a><span class="in">p32</span></span>
<span id="cb69-593"><a href="#cb69-593" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb69-594"><a href="#cb69-594" aria-hidden="true" tabindex="-1"></a><span class="in">f33_1=p33</span></span>
<span id="cb69-595"><a href="#cb69-595" aria-hidden="true" tabindex="-1"></a><span class="in">f55_1</span></span>
<span id="cb69-596"><a href="#cb69-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-597"><a href="#cb69-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-598"><a href="#cb69-598" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Isocratic conditions</span></span>
<span id="cb69-599"><a href="#cb69-599" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Individual plots</span></span>
<span id="cb69-600"><a href="#cb69-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-izo-summary}</span></span>
<span id="cb69-601"><a href="#cb69-601" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb69-602"><a href="#cb69-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-603"><a href="#cb69-603" aria-hidden="true" tabindex="-1"></a><span class="in">plot_id = function(results) { </span></span>
<span id="cb69-604"><a href="#cb69-604" aria-hidden="true" tabindex="-1"></a><span class="in">  results %&gt;%</span></span>
<span id="cb69-605"><a href="#cb69-605" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=fi, y=CV/10)) +</span></span>
<span id="cb69-606"><a href="#cb69-606" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb69-607"><a href="#cb69-607" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(aes(x=fi, ymin = llog10tr, ymax = ulog10tr), alpha = 0.4, col = NA) +</span></span>
<span id="cb69-608"><a href="#cb69-608" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x=fi, y=mlog10tr), col = "black", size=0.25) +</span></span>
<span id="cb69-609"><a href="#cb69-609" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_y_continuous(</span></span>
<span id="cb69-610"><a href="#cb69-610" aria-hidden="true" tabindex="-1"></a><span class="in">    name = "log(tr)",</span></span>
<span id="cb69-611"><a href="#cb69-611" aria-hidden="true" tabindex="-1"></a><span class="in">    sec.axis = sec_axis(~.*10, name="%CV")) +</span></span>
<span id="cb69-612"><a href="#cb69-612" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0,1,by=0.2))+</span></span>
<span id="cb69-613"><a href="#cb69-613" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_grid(i~mod) +</span></span>
<span id="cb69-614"><a href="#cb69-614" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 1, linetype=2)+</span></span>
<span id="cb69-615"><a href="#cb69-615" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim=c(0,4))</span></span>
<span id="cb69-616"><a href="#cb69-616" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb69-617"><a href="#cb69-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-618"><a href="#cb69-618" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_ref&lt;-prior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb69-619"><a href="#cb69-619" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-620"><a href="#cb69-620" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-621"><a href="#cb69-621" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-622"><a href="#cb69-622" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-623"><a href="#cb69-623" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-624"><a href="#cb69-624" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-625"><a href="#cb69-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-626"><a href="#cb69-626" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_ref&lt;-noprior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb69-627"><a href="#cb69-627" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-628"><a href="#cb69-628" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-629"><a href="#cb69-629" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-630"><a href="#cb69-630" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-631"><a href="#cb69-631" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-632"><a href="#cb69-632" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-633"><a href="#cb69-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-634"><a href="#cb69-634" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_2&lt;-prior_ma_2$izoresults%&gt;%</span></span>
<span id="cb69-635"><a href="#cb69-635" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-636"><a href="#cb69-636" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-637"><a href="#cb69-637" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-638"><a href="#cb69-638" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-639"><a href="#cb69-639" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-640"><a href="#cb69-640" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-641"><a href="#cb69-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-642"><a href="#cb69-642" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_3&lt;-prior_ma_3$izoresults%&gt;%</span></span>
<span id="cb69-643"><a href="#cb69-643" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-644"><a href="#cb69-644" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-645"><a href="#cb69-645" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-646"><a href="#cb69-646" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-647"><a href="#cb69-647" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = mrgmisc::ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-648"><a href="#cb69-648" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-649"><a href="#cb69-649" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_3&lt;-noprior_ma_3$izoresults%&gt;%</span></span>
<span id="cb69-650"><a href="#cb69-650" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-651"><a href="#cb69-651" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-652"><a href="#cb69-652" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-653"><a href="#cb69-653" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-654"><a href="#cb69-654" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-655"><a href="#cb69-655" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-656"><a href="#cb69-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-657"><a href="#cb69-657" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_4&lt;-prior_ma_4$izoresults%&gt;%</span></span>
<span id="cb69-658"><a href="#cb69-658" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-659"><a href="#cb69-659" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-660"><a href="#cb69-660" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-661"><a href="#cb69-661" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-662"><a href="#cb69-662" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-663"><a href="#cb69-663" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-664"><a href="#cb69-664" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_4&lt;-noprior_ma_4$izoresults%&gt;%</span></span>
<span id="cb69-665"><a href="#cb69-665" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-666"><a href="#cb69-666" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-667"><a href="#cb69-667" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-668"><a href="#cb69-668" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-669"><a href="#cb69-669" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-670"><a href="#cb69-670" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-671"><a href="#cb69-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-672"><a href="#cb69-672" aria-hidden="true" tabindex="-1"></a><span class="in">results_prior_ma_5&lt;-prior_ma_5$izoresults%&gt;%</span></span>
<span id="cb69-673"><a href="#cb69-673" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-674"><a href="#cb69-674" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-675"><a href="#cb69-675" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-676"><a href="#cb69-676" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-677"><a href="#cb69-677" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-678"><a href="#cb69-678" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-679"><a href="#cb69-679" aria-hidden="true" tabindex="-1"></a><span class="in">results_noprior_ma_5&lt;-noprior_ma_5$izoresults%&gt;%</span></span>
<span id="cb69-680"><a href="#cb69-680" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c=as.integer(c),</span></span>
<span id="cb69-681"><a href="#cb69-681" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-682"><a href="#cb69-682" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(fi_temp) %&gt;%</span></span>
<span id="cb69-683"><a href="#cb69-683" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(i %in% idx_exemple_analytes) %&gt;%</span></span>
<span id="cb69-684"><a href="#cb69-684" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(PLOTS = ids_per_plot(i,id_per_plot = 5))%&gt;% </span></span>
<span id="cb69-685"><a href="#cb69-685" aria-hidden="true" tabindex="-1"></a><span class="in">  split(.[["PLOTS"]])</span></span>
<span id="cb69-686"><a href="#cb69-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-687"><a href="#cb69-687" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ref = map(results_prior_ma_ref,plot_id) </span></span>
<span id="cb69-688"><a href="#cb69-688" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ref = map(results_noprior_ma_ref,plot_id) </span></span>
<span id="cb69-689"><a href="#cb69-689" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_2 = map(results_prior_ma_2,plot_id) </span></span>
<span id="cb69-690"><a href="#cb69-690" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_3 = map(results_prior_ma_3,plot_id) </span></span>
<span id="cb69-691"><a href="#cb69-691" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_3 = map(results_noprior_ma_3,plot_id) </span></span>
<span id="cb69-692"><a href="#cb69-692" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_4 = map(results_prior_ma_4,plot_id) </span></span>
<span id="cb69-693"><a href="#cb69-693" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_4 = map(results_noprior_ma_4,plot_id) </span></span>
<span id="cb69-694"><a href="#cb69-694" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_5 = map(results_prior_ma_5,plot_id) </span></span>
<span id="cb69-695"><a href="#cb69-695" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_5 = map(results_noprior_ma_5,plot_id) </span></span>
<span id="cb69-696"><a href="#cb69-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-697"><a href="#cb69-697" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_ref[[1]], .filename=paste("plots-results-prior-ma-ref.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-698"><a href="#cb69-698" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_ref[[1]], .filename=paste("plots-results-prior-ma-ref.png"), .path = figures_dir1)</span></span>
<span id="cb69-699"><a href="#cb69-699" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=plots_results_prior_ma_5[[1]], .filename=paste("plots-results-prior-ma-5.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-700"><a href="#cb69-700" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=plots_results_prior_ma_5[[1]], .filename=paste("plots-results-prior-ma-5.png"), .path = figures_dir1)</span></span>
<span id="cb69-701"><a href="#cb69-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-702"><a href="#cb69-702" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_ref </span></span>
<span id="cb69-703"><a href="#cb69-703" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_ref </span></span>
<span id="cb69-704"><a href="#cb69-704" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_2</span></span>
<span id="cb69-705"><a href="#cb69-705" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_3</span></span>
<span id="cb69-706"><a href="#cb69-706" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_3 </span></span>
<span id="cb69-707"><a href="#cb69-707" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_4 </span></span>
<span id="cb69-708"><a href="#cb69-708" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_4 </span></span>
<span id="cb69-709"><a href="#cb69-709" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_prior_ma_5  </span></span>
<span id="cb69-710"><a href="#cb69-710" aria-hidden="true" tabindex="-1"></a><span class="in">plots_results_noprior_ma_5 </span></span>
<span id="cb69-711"><a href="#cb69-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-712"><a href="#cb69-712" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_ref[[i]])</span></span>
<span id="cb69-713"><a href="#cb69-713" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_ref[[i]])</span></span>
<span id="cb69-714"><a href="#cb69-714" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_4[[i]])</span></span>
<span id="cb69-715"><a href="#cb69-715" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_4[[i]])</span></span>
<span id="cb69-716"><a href="#cb69-716" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_prior_ma_5[[i]])</span></span>
<span id="cb69-717"><a href="#cb69-717" aria-hidden="true" tabindex="-1"></a><span class="in"># map(show, function(i) plots_results_noprior_ma_5[[i]])</span></span>
<span id="cb69-718"><a href="#cb69-718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-719"><a href="#cb69-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-720"><a href="#cb69-720" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Combined</span></span>
<span id="cb69-721"><a href="#cb69-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r single-form-analytes-izo-summary-combined}</span></span>
<span id="cb69-722"><a href="#cb69-722" aria-hidden="true" tabindex="-1"></a><span class="in">fi_temp = tibble(c=1:11, fi=seq(0,1,by=0.1))</span></span>
<span id="cb69-723"><a href="#cb69-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-724"><a href="#cb69-724" aria-hidden="true" tabindex="-1"></a><span class="in">plot_id = function(results) { </span></span>
<span id="cb69-725"><a href="#cb69-725" aria-hidden="true" tabindex="-1"></a><span class="in">  results %&gt;%</span></span>
<span id="cb69-726"><a href="#cb69-726" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x=fi, y=CV)) +</span></span>
<span id="cb69-727"><a href="#cb69-727" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb69-728"><a href="#cb69-728" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(aes(x=fi, ymin = llog10tr, ymax = ulog10tr), alpha = 0.4, col = NA) +</span></span>
<span id="cb69-729"><a href="#cb69-729" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(aes(x=fi, y=mlog10tr), col = "black", size=0.25) +</span></span>
<span id="cb69-730"><a href="#cb69-730" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_y_continuous(</span></span>
<span id="cb69-731"><a href="#cb69-731" aria-hidden="true" tabindex="-1"></a><span class="in">    name = "log(tr)",</span></span>
<span id="cb69-732"><a href="#cb69-732" aria-hidden="true" tabindex="-1"></a><span class="in">    sec.axis = sec_axis(~.*1, name="%CV")) +</span></span>
<span id="cb69-733"><a href="#cb69-733" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0,1,by=0.2))+</span></span>
<span id="cb69-734"><a href="#cb69-734" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_grid(i~mod) +</span></span>
<span id="cb69-735"><a href="#cb69-735" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 1, linetype=2)+</span></span>
<span id="cb69-736"><a href="#cb69-736" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(ylim=c(0,4))</span></span>
<span id="cb69-737"><a href="#cb69-737" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb69-738"><a href="#cb69-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-739"><a href="#cb69-739" aria-hidden="true" tabindex="-1"></a><span class="in">izoresults = rbind( prior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb69-740"><a href="#cb69-740" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_ref"),</span></span>
<span id="cb69-741"><a href="#cb69-741" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_ref$izoresults%&gt;%</span></span>
<span id="cb69-742"><a href="#cb69-742" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_ref"),</span></span>
<span id="cb69-743"><a href="#cb69-743" aria-hidden="true" tabindex="-1"></a><span class="in">                prior_ma_2$izoresults%&gt;%</span></span>
<span id="cb69-744"><a href="#cb69-744" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_2"),</span></span>
<span id="cb69-745"><a href="#cb69-745" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_3$izoresults%&gt;%</span></span>
<span id="cb69-746"><a href="#cb69-746" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_3"),</span></span>
<span id="cb69-747"><a href="#cb69-747" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_3$izoresults%&gt;%</span></span>
<span id="cb69-748"><a href="#cb69-748" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_3"),</span></span>
<span id="cb69-749"><a href="#cb69-749" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_4$izoresults%&gt;%</span></span>
<span id="cb69-750"><a href="#cb69-750" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_4"),</span></span>
<span id="cb69-751"><a href="#cb69-751" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_4$izoresults%&gt;%</span></span>
<span id="cb69-752"><a href="#cb69-752" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_4"),</span></span>
<span id="cb69-753"><a href="#cb69-753" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior_ma_5$izoresults%&gt;%</span></span>
<span id="cb69-754"><a href="#cb69-754" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="prior_5"),</span></span>
<span id="cb69-755"><a href="#cb69-755" aria-hidden="true" tabindex="-1"></a><span class="in">                 noprior_ma_5$izoresults%&gt;%</span></span>
<span id="cb69-756"><a href="#cb69-756" aria-hidden="true" tabindex="-1"></a><span class="in">                   mutate(method ="noprior_5")) %&gt;%</span></span>
<span id="cb69-757"><a href="#cb69-757" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&lt;=log10(100))%&gt;%</span></span>
<span id="cb69-758"><a href="#cb69-758" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(mlog10tr&gt;=log10(5))%&gt;%</span></span>
<span id="cb69-759"><a href="#cb69-759" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(c = as.numeric(c),</span></span>
<span id="cb69-760"><a href="#cb69-760" aria-hidden="true" tabindex="-1"></a><span class="in">         i=as.integer(i)) %&gt;%</span></span>
<span id="cb69-761"><a href="#cb69-761" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(i,method,c)%&gt;%</span></span>
<span id="cb69-762"><a href="#cb69-762" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(i,method) %&gt;%</span></span>
<span id="cb69-763"><a href="#cb69-763" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(imaxcv = max(CV), imincv = min(CV), aveCV = pracma::trapz(c, CV)/(n()-1)) %&gt;%</span></span>
<span id="cb69-764"><a href="#cb69-764" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(imaxcv = if_else(imaxcv&gt;1e4,1e4,imaxcv))%&gt;%</span></span>
<span id="cb69-765"><a href="#cb69-765" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tibble(i=as.integer(seq(1,nAnalytes*n_rep,1)),logP=logP, Type=NAB)) </span></span>
<span id="cb69-766"><a href="#cb69-766" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb69-767"><a href="#cb69-767" aria-hidden="true" tabindex="-1"></a><span class="in">p33_1=izoresults %&gt;%</span></span>
<span id="cb69-768"><a href="#cb69-768" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb69-769"><a href="#cb69-769" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-770"><a href="#cb69-770" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-771"><a href="#cb69-771" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb69-772"><a href="#cb69-772" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-773"><a href="#cb69-773" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb69-774"><a href="#cb69-774" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb69-775"><a href="#cb69-775" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(1,100))+   </span></span>
<span id="cb69-776"><a href="#cb69-776" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb69-777"><a href="#cb69-777" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb69-778"><a href="#cb69-778" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb69-779"><a href="#cb69-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-780"><a href="#cb69-780" aria-hidden="true" tabindex="-1"></a><span class="in">p33_2=izoresults %&gt;%</span></span>
<span id="cb69-781"><a href="#cb69-781" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=method,x=imaxcv))+</span></span>
<span id="cb69-782"><a href="#cb69-782" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(outlier.size = 0.5)+</span></span>
<span id="cb69-783"><a href="#cb69-783" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_jitter(aes(y=method, x=imaxcv, color=logP),size=0.5, alpha=0.1)+</span></span>
<span id="cb69-784"><a href="#cb69-784" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(aes(y=method,x=imincv),outlier.size = 0, color="lightblue", alpha=0.1)+</span></span>
<span id="cb69-785"><a href="#cb69-785" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_continuous(type="viridis")+</span></span>
<span id="cb69-786"><a href="#cb69-786" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x="min(CV), max(CV)", y = "Method")+</span></span>
<span id="cb69-787"><a href="#cb69-787" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb69-788"><a href="#cb69-788" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim=c(100,10000))+    </span></span>
<span id="cb69-789"><a href="#cb69-789" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(trans='log10',</span></span>
<span id="cb69-790"><a href="#cb69-790" aria-hidden="true" tabindex="-1"></a><span class="in">                      breaks=scales::trans_breaks('log10', function(x) 10^x)(c(1, 1e6)),</span></span>
<span id="cb69-791"><a href="#cb69-791" aria-hidden="true" tabindex="-1"></a><span class="in">                      labels=scales::trans_format('log10', scales::math_format(10^.x)))</span></span>
<span id="cb69-792"><a href="#cb69-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-793"><a href="#cb69-793" aria-hidden="true" tabindex="-1"></a><span class="in">p33=p33_1+p33_2+</span></span>
<span id="cb69-794"><a href="#cb69-794" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(widths = c(3, 1),axes = "collect")</span></span>
<span id="cb69-795"><a href="#cb69-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-796"><a href="#cb69-796" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-izo-combined-CV.pdf"), .path = figures_dir1)</span></span>
<span id="cb69-797"><a href="#cb69-797" aria-hidden="true" tabindex="-1"></a><span class="in">my.ggsave.png(.plot=p33+plot_layout(guides = "collect"), .filename=paste("N-izo-combined-CV.png"), .path = figures_dir1)</span></span>
<span id="cb69-798"><a href="#cb69-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-799"><a href="#cb69-799" aria-hidden="true" tabindex="-1"></a><span class="in">p33</span></span>
<span id="cb69-800"><a href="#cb69-800" aria-hidden="true" tabindex="-1"></a><span class="in">f44_1 = p33</span></span>
<span id="cb69-801"><a href="#cb69-801" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-802"><a href="#cb69-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-803"><a href="#cb69-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-804"><a href="#cb69-804" aria-hidden="true" tabindex="-1"></a><span class="fu"># References {.unnumbered}</span></span>
<span id="cb69-805"><a href="#cb69-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-806"><a href="#cb69-806" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb69-807"><a href="#cb69-807" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb69-808"><a href="#cb69-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-809"><a href="#cb69-809" aria-hidden="true" tabindex="-1"></a><span class="fu"># Licenses {.unnumbered}</span></span>
<span id="cb69-810"><a href="#cb69-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-811"><a href="#cb69-811" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Code &amp; copy; 2024, Paweł Wiczling, licensed under BSD-3.</span>
<span id="cb69-812"><a href="#cb69-812" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Text &amp; copy; 2024, Paweł Wiczling, licensed under CC-BY-NC 4.0.</span>
<span id="cb69-813"><a href="#cb69-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-814"><a href="#cb69-814" aria-hidden="true" tabindex="-1"></a><span class="fu"># Original Computing Environment {.unnumbered}</span></span>
<span id="cb69-815"><a href="#cb69-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-816"><a href="#cb69-816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sessionInfo}</span></span>
<span id="cb69-817"><a href="#cb69-817" aria-hidden="true" tabindex="-1"></a><span class="in">sessionInfo()</span></span>
<span id="cb69-818"><a href="#cb69-818" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>